var uT=Object.defineProperty;var cT=(i,a,c)=>a in i?uT(i,a,{enumerable:!0,configurable:!0,writable:!0,value:c}):i[a]=c;var tc=(i,a,c)=>(cT(i,typeof a!="symbol"?a+"":a,c),c);(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const E of document.querySelectorAll('link[rel="modulepreload"]'))v(E);new MutationObserver(E=>{for(const D of E)if(D.type==="childList")for(const F of D.addedNodes)F.tagName==="LINK"&&F.rel==="modulepreload"&&v(F)}).observe(document,{childList:!0,subtree:!0});function c(E){const D={};return E.integrity&&(D.integrity=E.integrity),E.referrerpolicy&&(D.referrerPolicy=E.referrerpolicy),E.crossorigin==="use-credentials"?D.credentials="include":E.crossorigin==="anonymous"?D.credentials="omit":D.credentials="same-origin",D}function v(E){if(E.ep)return;E.ep=!0;const D=c(E);fetch(E.href,D)}})();var du=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function hT(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var rr={exports:{}},On={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dg=Symbol.for("react.element"),dT=Symbol.for("react.portal"),fT=Symbol.for("react.fragment"),pT=Symbol.for("react.strict_mode"),mT=Symbol.for("react.profiler"),_T=Symbol.for("react.provider"),gT=Symbol.for("react.context"),yT=Symbol.for("react.forward_ref"),vT=Symbol.for("react.suspense"),xT=Symbol.for("react.memo"),wT=Symbol.for("react.lazy"),Pb=Symbol.iterator;function AT(i){return i===null||typeof i!="object"?null:(i=Pb&&i[Pb]||i["@@iterator"],typeof i=="function"?i:null)}var PE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},LE=Object.assign,zE={};function um(i,a,c){this.props=i,this.context=a,this.refs=zE,this.updater=c||PE}um.prototype.isReactComponent={};um.prototype.setState=function(i,a){if(typeof i!="object"&&typeof i!="function"&&i!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,i,a,"setState")};um.prototype.forceUpdate=function(i){this.updater.enqueueForceUpdate(this,i,"forceUpdate")};function FE(){}FE.prototype=um.prototype;function gA(i,a,c){this.props=i,this.context=a,this.refs=zE,this.updater=c||PE}var yA=gA.prototype=new FE;yA.constructor=gA;LE(yA,um.prototype);yA.isPureReactComponent=!0;var Lb=Array.isArray,RE=Object.prototype.hasOwnProperty,vA={current:null},OE={key:!0,ref:!0,__self:!0,__source:!0};function GE(i,a,c){var v,E={},D=null,F=null;if(a!=null)for(v in a.ref!==void 0&&(F=a.ref),a.key!==void 0&&(D=""+a.key),a)RE.call(a,v)&&!OE.hasOwnProperty(v)&&(E[v]=a[v]);var s=arguments.length-2;if(s===1)E.children=c;else if(1<s){for(var N=Array(s),pe=0;pe<s;pe++)N[pe]=arguments[pe+2];E.children=N}if(i&&i.defaultProps)for(v in s=i.defaultProps,s)E[v]===void 0&&(E[v]=s[v]);return{$$typeof:dg,type:i,key:D,ref:F,props:E,_owner:vA.current}}function bT(i,a){return{$$typeof:dg,type:i.type,key:a,ref:i.ref,props:i.props,_owner:i._owner}}function xA(i){return typeof i=="object"&&i!==null&&i.$$typeof===dg}function CT(i){var a={"=":"=0",":":"=2"};return"$"+i.replace(/[=:]/g,function(c){return a[c]})}var zb=/\/+/g;function F1(i,a){return typeof i=="object"&&i!==null&&i.key!=null?CT(""+i.key):a.toString(36)}function D0(i,a,c,v,E){var D=typeof i;(D==="undefined"||D==="boolean")&&(i=null);var F=!1;if(i===null)F=!0;else switch(D){case"string":case"number":F=!0;break;case"object":switch(i.$$typeof){case dg:case dT:F=!0}}if(F)return F=i,E=E(F),i=v===""?"."+F1(F,0):v,Lb(E)?(c="",i!=null&&(c=i.replace(zb,"$&/")+"/"),D0(E,a,c,"",function(pe){return pe})):E!=null&&(xA(E)&&(E=bT(E,c+(!E.key||F&&F.key===E.key?"":(""+E.key).replace(zb,"$&/")+"/")+i)),a.push(E)),1;if(F=0,v=v===""?".":v+":",Lb(i))for(var s=0;s<i.length;s++){D=i[s];var N=v+F1(D,s);F+=D0(D,a,c,N,E)}else if(N=AT(i),typeof N=="function")for(i=N.call(i),s=0;!(D=i.next()).done;)D=D.value,N=v+F1(D,s++),F+=D0(D,a,c,N,E);else if(D==="object")throw a=String(i),Error("Objects are not valid as a React child (found: "+(a==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":a)+"). If you meant to render a collection of children, use an array instead.");return F}function o0(i,a,c){if(i==null)return i;var v=[],E=0;return D0(i,v,"","",function(D){return a.call(c,D,E++)}),v}function ET(i){if(i._status===-1){var a=i._result;a=a(),a.then(function(c){(i._status===0||i._status===-1)&&(i._status=1,i._result=c)},function(c){(i._status===0||i._status===-1)&&(i._status=2,i._result=c)}),i._status===-1&&(i._status=0,i._result=a)}if(i._status===1)return i._result.default;throw i._result}var No={current:null},S0={transition:null},BT={ReactCurrentDispatcher:No,ReactCurrentBatchConfig:S0,ReactCurrentOwner:vA};On.Children={map:o0,forEach:function(i,a,c){o0(i,function(){a.apply(this,arguments)},c)},count:function(i){var a=0;return o0(i,function(){a++}),a},toArray:function(i){return o0(i,function(a){return a})||[]},only:function(i){if(!xA(i))throw Error("React.Children.only expected to receive a single React element child.");return i}};On.Component=um;On.Fragment=fT;On.Profiler=mT;On.PureComponent=gA;On.StrictMode=pT;On.Suspense=vT;On.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=BT;On.cloneElement=function(i,a,c){if(i==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+i+".");var v=LE({},i.props),E=i.key,D=i.ref,F=i._owner;if(a!=null){if(a.ref!==void 0&&(D=a.ref,F=vA.current),a.key!==void 0&&(E=""+a.key),i.type&&i.type.defaultProps)var s=i.type.defaultProps;for(N in a)RE.call(a,N)&&!OE.hasOwnProperty(N)&&(v[N]=a[N]===void 0&&s!==void 0?s[N]:a[N])}var N=arguments.length-2;if(N===1)v.children=c;else if(1<N){s=Array(N);for(var pe=0;pe<N;pe++)s[pe]=arguments[pe+2];v.children=s}return{$$typeof:dg,type:i.type,key:E,ref:D,props:v,_owner:F}};On.createContext=function(i){return i={$$typeof:gT,_currentValue:i,_currentValue2:i,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},i.Provider={$$typeof:_T,_context:i},i.Consumer=i};On.createElement=GE;On.createFactory=function(i){var a=GE.bind(null,i);return a.type=i,a};On.createRef=function(){return{current:null}};On.forwardRef=function(i){return{$$typeof:yT,render:i}};On.isValidElement=xA;On.lazy=function(i){return{$$typeof:wT,_payload:{_status:-1,_result:i},_init:ET}};On.memo=function(i,a){return{$$typeof:xT,type:i,compare:a===void 0?null:a}};On.startTransition=function(i){var a=S0.transition;S0.transition={};try{i()}finally{S0.transition=a}};On.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};On.useCallback=function(i,a){return No.current.useCallback(i,a)};On.useContext=function(i){return No.current.useContext(i)};On.useDebugValue=function(){};On.useDeferredValue=function(i){return No.current.useDeferredValue(i)};On.useEffect=function(i,a){return No.current.useEffect(i,a)};On.useId=function(){return No.current.useId()};On.useImperativeHandle=function(i,a,c){return No.current.useImperativeHandle(i,a,c)};On.useInsertionEffect=function(i,a){return No.current.useInsertionEffect(i,a)};On.useLayoutEffect=function(i,a){return No.current.useLayoutEffect(i,a)};On.useMemo=function(i,a){return No.current.useMemo(i,a)};On.useReducer=function(i,a,c){return No.current.useReducer(i,a,c)};On.useRef=function(i){return No.current.useRef(i)};On.useState=function(i){return No.current.useState(i)};On.useSyncExternalStore=function(i,a,c){return No.current.useSyncExternalStore(i,a,c)};On.useTransition=function(){return No.current.useTransition()};On.version="18.2.0";(function(i){i.exports=On})(rr);const Lt=hT(rr.exports);var NE={exports:{}},Ws={},UE={exports:{}},qE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(i){function a(xt,Qt){var Mt=xt.length;xt.push(Qt);e:for(;0<Mt;){var _n=Mt-1>>>1,Ln=xt[_n];if(0<E(Ln,Qt))xt[_n]=Qt,xt[Mt]=Ln,Mt=_n;else break e}}function c(xt){return xt.length===0?null:xt[0]}function v(xt){if(xt.length===0)return null;var Qt=xt[0],Mt=xt.pop();if(Mt!==Qt){xt[0]=Mt;e:for(var _n=0,Ln=xt.length,Or=Ln>>>1;_n<Or;){var Qn=2*(_n+1)-1,wr=xt[Qn],jt=Qn+1,St=xt[jt];if(0>E(wr,Mt))jt<Ln&&0>E(St,wr)?(xt[_n]=St,xt[jt]=Mt,_n=jt):(xt[_n]=wr,xt[Qn]=Mt,_n=Qn);else if(jt<Ln&&0>E(St,Mt))xt[_n]=St,xt[jt]=Mt,_n=jt;else break e}}return Qt}function E(xt,Qt){var Mt=xt.sortIndex-Qt.sortIndex;return Mt!==0?Mt:xt.id-Qt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var D=performance;i.unstable_now=function(){return D.now()}}else{var F=Date,s=F.now();i.unstable_now=function(){return F.now()-s}}var N=[],pe=[],Re=1,we=null,Ae=3,$e=!1,Qe=!1,ot=!1,Vt=typeof setTimeout=="function"?setTimeout:null,be=typeof clearTimeout=="function"?clearTimeout:null,ge=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Be(xt){for(var Qt=c(pe);Qt!==null;){if(Qt.callback===null)v(pe);else if(Qt.startTime<=xt)v(pe),Qt.sortIndex=Qt.expirationTime,a(N,Qt);else break;Qt=c(pe)}}function Xe(xt){if(ot=!1,Be(xt),!Qe)if(c(N)!==null)Qe=!0,di(Ie);else{var Qt=c(pe);Qt!==null&&fr(Xe,Qt.startTime-xt)}}function Ie(xt,Qt){Qe=!1,ot&&(ot=!1,be(Ct),Ct=-1),$e=!0;var Mt=Ae;try{for(Be(Qt),we=c(N);we!==null&&(!(we.expirationTime>Qt)||xt&&!dr());){var _n=we.callback;if(typeof _n=="function"){we.callback=null,Ae=we.priorityLevel;var Ln=_n(we.expirationTime<=Qt);Qt=i.unstable_now(),typeof Ln=="function"?we.callback=Ln:we===c(N)&&v(N),Be(Qt)}else v(N);we=c(N)}if(we!==null)var Or=!0;else{var Qn=c(pe);Qn!==null&&fr(Xe,Qn.startTime-Qt),Or=!1}return Or}finally{we=null,Ae=Mt,$e=!1}}var at=!1,ft=null,Ct=-1,Et=5,Ot=-1;function dr(){return!(i.unstable_now()-Ot<Et)}function Wr(){if(ft!==null){var xt=i.unstable_now();Ot=xt;var Qt=!0;try{Qt=ft(!0,xt)}finally{Qt?ir():(at=!1,ft=null)}}else at=!1}var ir;if(typeof ge=="function")ir=function(){ge(Wr)};else if(typeof MessageChannel<"u"){var hi=new MessageChannel,en=hi.port2;hi.port1.onmessage=Wr,ir=function(){en.postMessage(null)}}else ir=function(){Vt(Wr,0)};function di(xt){ft=xt,at||(at=!0,ir())}function fr(xt,Qt){Ct=Vt(function(){xt(i.unstable_now())},Qt)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(xt){xt.callback=null},i.unstable_continueExecution=function(){Qe||$e||(Qe=!0,di(Ie))},i.unstable_forceFrameRate=function(xt){0>xt||125<xt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Et=0<xt?Math.floor(1e3/xt):5},i.unstable_getCurrentPriorityLevel=function(){return Ae},i.unstable_getFirstCallbackNode=function(){return c(N)},i.unstable_next=function(xt){switch(Ae){case 1:case 2:case 3:var Qt=3;break;default:Qt=Ae}var Mt=Ae;Ae=Qt;try{return xt()}finally{Ae=Mt}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(xt,Qt){switch(xt){case 1:case 2:case 3:case 4:case 5:break;default:xt=3}var Mt=Ae;Ae=xt;try{return Qt()}finally{Ae=Mt}},i.unstable_scheduleCallback=function(xt,Qt,Mt){var _n=i.unstable_now();switch(typeof Mt=="object"&&Mt!==null?(Mt=Mt.delay,Mt=typeof Mt=="number"&&0<Mt?_n+Mt:_n):Mt=_n,xt){case 1:var Ln=-1;break;case 2:Ln=250;break;case 5:Ln=1073741823;break;case 4:Ln=1e4;break;default:Ln=5e3}return Ln=Mt+Ln,xt={id:Re++,callback:Qt,priorityLevel:xt,startTime:Mt,expirationTime:Ln,sortIndex:-1},Mt>_n?(xt.sortIndex=Mt,a(pe,xt),c(N)===null&&xt===c(pe)&&(ot?(be(Ct),Ct=-1):ot=!0,fr(Xe,Mt-_n))):(xt.sortIndex=Ln,a(N,xt),Qe||$e||(Qe=!0,di(Ie))),xt},i.unstable_shouldYield=dr,i.unstable_wrapCallback=function(xt){var Qt=Ae;return function(){var Mt=Ae;Ae=Qt;try{return xt.apply(this,arguments)}finally{Ae=Mt}}}})(qE);(function(i){i.exports=qE})(UE);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jE=rr.exports,$s=UE.exports;function _t(i){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+i,c=1;c<arguments.length;c++)a+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+i+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var VE=new Set,Z_={};function of(i,a){tm(i,a),tm(i+"Capture",a)}function tm(i,a){for(Z_[i]=a,i=0;i<a.length;i++)VE.add(a[i])}var lc=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),vw=Object.prototype.hasOwnProperty,TT=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Fb={},Rb={};function DT(i){return vw.call(Rb,i)?!0:vw.call(Fb,i)?!1:TT.test(i)?Rb[i]=!0:(Fb[i]=!0,!1)}function ST(i,a,c,v){if(c!==null&&c.type===0)return!1;switch(typeof a){case"function":case"symbol":return!0;case"boolean":return v?!1:c!==null?!c.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function IT(i,a,c,v){if(a===null||typeof a>"u"||ST(i,a,c,v))return!0;if(v)return!1;if(c!==null)switch(c.type){case 3:return!a;case 4:return a===!1;case 5:return isNaN(a);case 6:return isNaN(a)||1>a}return!1}function Uo(i,a,c,v,E,D,F){this.acceptsBooleans=a===2||a===3||a===4,this.attributeName=v,this.attributeNamespace=E,this.mustUseProperty=c,this.propertyName=i,this.type=a,this.sanitizeURL=D,this.removeEmptyString=F}var Xi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){Xi[i]=new Uo(i,0,!1,i,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var a=i[0];Xi[a]=new Uo(a,1,!1,i[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(i){Xi[i]=new Uo(i,2,!1,i.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){Xi[i]=new Uo(i,2,!1,i,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){Xi[i]=new Uo(i,3,!1,i.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(i){Xi[i]=new Uo(i,3,!0,i,null,!1,!1)});["capture","download"].forEach(function(i){Xi[i]=new Uo(i,4,!1,i,null,!1,!1)});["cols","rows","size","span"].forEach(function(i){Xi[i]=new Uo(i,6,!1,i,null,!1,!1)});["rowSpan","start"].forEach(function(i){Xi[i]=new Uo(i,5,!1,i.toLowerCase(),null,!1,!1)});var wA=/[\-:]([a-z])/g;function AA(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var a=i.replace(wA,AA);Xi[a]=new Uo(a,1,!1,i,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var a=i.replace(wA,AA);Xi[a]=new Uo(a,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(i){var a=i.replace(wA,AA);Xi[a]=new Uo(a,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(i){Xi[i]=new Uo(i,1,!1,i.toLowerCase(),null,!1,!1)});Xi.xlinkHref=new Uo("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(i){Xi[i]=new Uo(i,1,!1,i.toLowerCase(),null,!0,!0)});function bA(i,a,c,v){var E=Xi.hasOwnProperty(a)?Xi[a]:null;(E!==null?E.type!==0:v||!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(IT(a,c,E,v)&&(c=null),v||E===null?DT(a)&&(c===null?i.removeAttribute(a):i.setAttribute(a,""+c)):E.mustUseProperty?i[E.propertyName]=c===null?E.type===3?!1:"":c:(a=E.attributeName,v=E.attributeNamespace,c===null?i.removeAttribute(a):(E=E.type,c=E===3||E===4&&c===!0?"":""+c,v?i.setAttributeNS(v,a,c):i.setAttribute(a,c))))}var dc=jE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,s0=Symbol.for("react.element"),zp=Symbol.for("react.portal"),Fp=Symbol.for("react.fragment"),CA=Symbol.for("react.strict_mode"),xw=Symbol.for("react.profiler"),HE=Symbol.for("react.provider"),$E=Symbol.for("react.context"),EA=Symbol.for("react.forward_ref"),ww=Symbol.for("react.suspense"),Aw=Symbol.for("react.suspense_list"),BA=Symbol.for("react.memo"),wh=Symbol.for("react.lazy"),WE=Symbol.for("react.offscreen"),Ob=Symbol.iterator;function T_(i){return i===null||typeof i!="object"?null:(i=Ob&&i[Ob]||i["@@iterator"],typeof i=="function"?i:null)}var $r=Object.assign,R1;function F_(i){if(R1===void 0)try{throw Error()}catch(c){var a=c.stack.trim().match(/\n( *(at )?)/);R1=a&&a[1]||""}return`
`+R1+i}var O1=!1;function G1(i,a){if(!i||O1)return"";O1=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(pe){var v=pe}Reflect.construct(i,[],a)}else{try{a.call()}catch(pe){v=pe}i.call(a.prototype)}else{try{throw Error()}catch(pe){v=pe}i()}}catch(pe){if(pe&&v&&typeof pe.stack=="string"){for(var E=pe.stack.split(`
`),D=v.stack.split(`
`),F=E.length-1,s=D.length-1;1<=F&&0<=s&&E[F]!==D[s];)s--;for(;1<=F&&0<=s;F--,s--)if(E[F]!==D[s]){if(F!==1||s!==1)do if(F--,s--,0>s||E[F]!==D[s]){var N=`
`+E[F].replace(" at new "," at ");return i.displayName&&N.includes("<anonymous>")&&(N=N.replace("<anonymous>",i.displayName)),N}while(1<=F&&0<=s);break}}}finally{O1=!1,Error.prepareStackTrace=c}return(i=i?i.displayName||i.name:"")?F_(i):""}function MT(i){switch(i.tag){case 5:return F_(i.type);case 16:return F_("Lazy");case 13:return F_("Suspense");case 19:return F_("SuspenseList");case 0:case 2:case 15:return i=G1(i.type,!1),i;case 11:return i=G1(i.type.render,!1),i;case 1:return i=G1(i.type,!0),i;default:return""}}function bw(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case Fp:return"Fragment";case zp:return"Portal";case xw:return"Profiler";case CA:return"StrictMode";case ww:return"Suspense";case Aw:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case $E:return(i.displayName||"Context")+".Consumer";case HE:return(i._context.displayName||"Context")+".Provider";case EA:var a=i.render;return i=i.displayName,i||(i=a.displayName||a.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case BA:return a=i.displayName||null,a!==null?a:bw(i.type)||"Memo";case wh:a=i._payload,i=i._init;try{return bw(i(a))}catch{}}return null}function kT(i){var a=i.type;switch(i.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=a.render,i=i.displayName||i.name||"",a.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return bw(a);case 8:return a===CA?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function zh(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function KE(i){var a=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function PT(i){var a=KE(i)?"checked":"value",c=Object.getOwnPropertyDescriptor(i.constructor.prototype,a),v=""+i[a];if(!i.hasOwnProperty(a)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var E=c.get,D=c.set;return Object.defineProperty(i,a,{configurable:!0,get:function(){return E.call(this)},set:function(F){v=""+F,D.call(this,F)}}),Object.defineProperty(i,a,{enumerable:c.enumerable}),{getValue:function(){return v},setValue:function(F){v=""+F},stopTracking:function(){i._valueTracker=null,delete i[a]}}}}function a0(i){i._valueTracker||(i._valueTracker=PT(i))}function ZE(i){if(!i)return!1;var a=i._valueTracker;if(!a)return!0;var c=a.getValue(),v="";return i&&(v=KE(i)?i.checked?"true":"false":i.value),i=v,i!==c?(a.setValue(i),!0):!1}function U0(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function Cw(i,a){var c=a.checked;return $r({},a,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:c!=null?c:i._wrapperState.initialChecked})}function Gb(i,a){var c=a.defaultValue==null?"":a.defaultValue,v=a.checked!=null?a.checked:a.defaultChecked;c=zh(a.value!=null?a.value:c),i._wrapperState={initialChecked:v,initialValue:c,controlled:a.type==="checkbox"||a.type==="radio"?a.checked!=null:a.value!=null}}function JE(i,a){a=a.checked,a!=null&&bA(i,"checked",a,!1)}function Ew(i,a){JE(i,a);var c=zh(a.value),v=a.type;if(c!=null)v==="number"?(c===0&&i.value===""||i.value!=c)&&(i.value=""+c):i.value!==""+c&&(i.value=""+c);else if(v==="submit"||v==="reset"){i.removeAttribute("value");return}a.hasOwnProperty("value")?Bw(i,a.type,c):a.hasOwnProperty("defaultValue")&&Bw(i,a.type,zh(a.defaultValue)),a.checked==null&&a.defaultChecked!=null&&(i.defaultChecked=!!a.defaultChecked)}function Nb(i,a,c){if(a.hasOwnProperty("value")||a.hasOwnProperty("defaultValue")){var v=a.type;if(!(v!=="submit"&&v!=="reset"||a.value!==void 0&&a.value!==null))return;a=""+i._wrapperState.initialValue,c||a===i.value||(i.value=a),i.defaultValue=a}c=i.name,c!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,c!==""&&(i.name=c)}function Bw(i,a,c){(a!=="number"||U0(i.ownerDocument)!==i)&&(c==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+c&&(i.defaultValue=""+c))}var R_=Array.isArray;function Kp(i,a,c,v){if(i=i.options,a){a={};for(var E=0;E<c.length;E++)a["$"+c[E]]=!0;for(c=0;c<i.length;c++)E=a.hasOwnProperty("$"+i[c].value),i[c].selected!==E&&(i[c].selected=E),E&&v&&(i[c].defaultSelected=!0)}else{for(c=""+zh(c),a=null,E=0;E<i.length;E++){if(i[E].value===c){i[E].selected=!0,v&&(i[E].defaultSelected=!0);return}a!==null||i[E].disabled||(a=i[E])}a!==null&&(a.selected=!0)}}function Tw(i,a){if(a.dangerouslySetInnerHTML!=null)throw Error(_t(91));return $r({},a,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function Ub(i,a){var c=a.value;if(c==null){if(c=a.children,a=a.defaultValue,c!=null){if(a!=null)throw Error(_t(92));if(R_(c)){if(1<c.length)throw Error(_t(93));c=c[0]}a=c}a==null&&(a=""),c=a}i._wrapperState={initialValue:zh(c)}}function XE(i,a){var c=zh(a.value),v=zh(a.defaultValue);c!=null&&(c=""+c,c!==i.value&&(i.value=c),a.defaultValue==null&&i.defaultValue!==c&&(i.defaultValue=c)),v!=null&&(i.defaultValue=""+v)}function qb(i){var a=i.textContent;a===i._wrapperState.initialValue&&a!==""&&a!==null&&(i.value=a)}function QE(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Dw(i,a){return i==null||i==="http://www.w3.org/1999/xhtml"?QE(a):i==="http://www.w3.org/2000/svg"&&a==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var l0,YE=function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(a,c,v,E){MSApp.execUnsafeLocalFunction(function(){return i(a,c,v,E)})}:i}(function(i,a){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=a;else{for(l0=l0||document.createElement("div"),l0.innerHTML="<svg>"+a.valueOf().toString()+"</svg>",a=l0.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;a.firstChild;)i.appendChild(a.firstChild)}});function J_(i,a){if(a){var c=i.firstChild;if(c&&c===i.lastChild&&c.nodeType===3){c.nodeValue=a;return}}i.textContent=a}var N_={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},LT=["Webkit","ms","Moz","O"];Object.keys(N_).forEach(function(i){LT.forEach(function(a){a=a+i.charAt(0).toUpperCase()+i.substring(1),N_[a]=N_[i]})});function e2(i,a,c){return a==null||typeof a=="boolean"||a===""?"":c||typeof a!="number"||a===0||N_.hasOwnProperty(i)&&N_[i]?(""+a).trim():a+"px"}function t2(i,a){i=i.style;for(var c in a)if(a.hasOwnProperty(c)){var v=c.indexOf("--")===0,E=e2(c,a[c],v);c==="float"&&(c="cssFloat"),v?i.setProperty(c,E):i[c]=E}}var zT=$r({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Sw(i,a){if(a){if(zT[i]&&(a.children!=null||a.dangerouslySetInnerHTML!=null))throw Error(_t(137,i));if(a.dangerouslySetInnerHTML!=null){if(a.children!=null)throw Error(_t(60));if(typeof a.dangerouslySetInnerHTML!="object"||!("__html"in a.dangerouslySetInnerHTML))throw Error(_t(61))}if(a.style!=null&&typeof a.style!="object")throw Error(_t(62))}}function Iw(i,a){if(i.indexOf("-")===-1)return typeof a.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mw=null;function TA(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var kw=null,Zp=null,Jp=null;function jb(i){if(i=mg(i)){if(typeof kw!="function")throw Error(_t(280));var a=i.stateNode;a&&(a=mv(a),kw(i.stateNode,i.type,a))}}function n2(i){Zp?Jp?Jp.push(i):Jp=[i]:Zp=i}function r2(){if(Zp){var i=Zp,a=Jp;if(Jp=Zp=null,jb(i),a)for(i=0;i<a.length;i++)jb(a[i])}}function i2(i,a){return i(a)}function o2(){}var N1=!1;function s2(i,a,c){if(N1)return i(a,c);N1=!0;try{return i2(i,a,c)}finally{N1=!1,(Zp!==null||Jp!==null)&&(o2(),r2())}}function X_(i,a){var c=i.stateNode;if(c===null)return null;var v=mv(c);if(v===null)return null;c=v[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(i=i.type,v=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!v;break e;default:i=!1}if(i)return null;if(c&&typeof c!="function")throw Error(_t(231,a,typeof c));return c}var Pw=!1;if(lc)try{var D_={};Object.defineProperty(D_,"passive",{get:function(){Pw=!0}}),window.addEventListener("test",D_,D_),window.removeEventListener("test",D_,D_)}catch{Pw=!1}function FT(i,a,c,v,E,D,F,s,N){var pe=Array.prototype.slice.call(arguments,3);try{a.apply(c,pe)}catch(Re){this.onError(Re)}}var U_=!1,q0=null,j0=!1,Lw=null,RT={onError:function(i){U_=!0,q0=i}};function OT(i,a,c,v,E,D,F,s,N){U_=!1,q0=null,FT.apply(RT,arguments)}function GT(i,a,c,v,E,D,F,s,N){if(OT.apply(this,arguments),U_){if(U_){var pe=q0;U_=!1,q0=null}else throw Error(_t(198));j0||(j0=!0,Lw=pe)}}function sf(i){var a=i,c=i;if(i.alternate)for(;a.return;)a=a.return;else{i=a;do a=i,(a.flags&4098)!==0&&(c=a.return),i=a.return;while(i)}return a.tag===3?c:null}function a2(i){if(i.tag===13){var a=i.memoizedState;if(a===null&&(i=i.alternate,i!==null&&(a=i.memoizedState)),a!==null)return a.dehydrated}return null}function Vb(i){if(sf(i)!==i)throw Error(_t(188))}function NT(i){var a=i.alternate;if(!a){if(a=sf(i),a===null)throw Error(_t(188));return a!==i?null:i}for(var c=i,v=a;;){var E=c.return;if(E===null)break;var D=E.alternate;if(D===null){if(v=E.return,v!==null){c=v;continue}break}if(E.child===D.child){for(D=E.child;D;){if(D===c)return Vb(E),i;if(D===v)return Vb(E),a;D=D.sibling}throw Error(_t(188))}if(c.return!==v.return)c=E,v=D;else{for(var F=!1,s=E.child;s;){if(s===c){F=!0,c=E,v=D;break}if(s===v){F=!0,v=E,c=D;break}s=s.sibling}if(!F){for(s=D.child;s;){if(s===c){F=!0,c=D,v=E;break}if(s===v){F=!0,v=D,c=E;break}s=s.sibling}if(!F)throw Error(_t(189))}}if(c.alternate!==v)throw Error(_t(190))}if(c.tag!==3)throw Error(_t(188));return c.stateNode.current===c?i:a}function l2(i){return i=NT(i),i!==null?u2(i):null}function u2(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var a=u2(i);if(a!==null)return a;i=i.sibling}return null}var c2=$s.unstable_scheduleCallback,Hb=$s.unstable_cancelCallback,UT=$s.unstable_shouldYield,qT=$s.unstable_requestPaint,ni=$s.unstable_now,jT=$s.unstable_getCurrentPriorityLevel,DA=$s.unstable_ImmediatePriority,h2=$s.unstable_UserBlockingPriority,V0=$s.unstable_NormalPriority,VT=$s.unstable_LowPriority,d2=$s.unstable_IdlePriority,hv=null,mu=null;function HT(i){if(mu&&typeof mu.onCommitFiberRoot=="function")try{mu.onCommitFiberRoot(hv,i,void 0,(i.current.flags&128)===128)}catch{}}var pl=Math.clz32?Math.clz32:KT,$T=Math.log,WT=Math.LN2;function KT(i){return i>>>=0,i===0?32:31-($T(i)/WT|0)|0}var u0=64,c0=4194304;function O_(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function H0(i,a){var c=i.pendingLanes;if(c===0)return 0;var v=0,E=i.suspendedLanes,D=i.pingedLanes,F=c&268435455;if(F!==0){var s=F&~E;s!==0?v=O_(s):(D&=F,D!==0&&(v=O_(D)))}else F=c&~E,F!==0?v=O_(F):D!==0&&(v=O_(D));if(v===0)return 0;if(a!==0&&a!==v&&(a&E)===0&&(E=v&-v,D=a&-a,E>=D||E===16&&(D&4194240)!==0))return a;if((v&4)!==0&&(v|=c&16),a=i.entangledLanes,a!==0)for(i=i.entanglements,a&=v;0<a;)c=31-pl(a),E=1<<c,v|=i[c],a&=~E;return v}function ZT(i,a){switch(i){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function JT(i,a){for(var c=i.suspendedLanes,v=i.pingedLanes,E=i.expirationTimes,D=i.pendingLanes;0<D;){var F=31-pl(D),s=1<<F,N=E[F];N===-1?((s&c)===0||(s&v)!==0)&&(E[F]=ZT(s,a)):N<=a&&(i.expiredLanes|=s),D&=~s}}function zw(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function f2(){var i=u0;return u0<<=1,(u0&4194240)===0&&(u0=64),i}function U1(i){for(var a=[],c=0;31>c;c++)a.push(i);return a}function fg(i,a,c){i.pendingLanes|=a,a!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,a=31-pl(a),i[a]=c}function XT(i,a){var c=i.pendingLanes&~a;i.pendingLanes=a,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=a,i.mutableReadLanes&=a,i.entangledLanes&=a,a=i.entanglements;var v=i.eventTimes;for(i=i.expirationTimes;0<c;){var E=31-pl(c),D=1<<E;a[E]=0,v[E]=-1,i[E]=-1,c&=~D}}function SA(i,a){var c=i.entangledLanes|=a;for(i=i.entanglements;c;){var v=31-pl(c),E=1<<v;E&a|i[v]&a&&(i[v]|=a),c&=~E}}var hr=0;function p2(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var m2,IA,_2,g2,y2,Fw=!1,h0=[],Th=null,Dh=null,Sh=null,Q_=new Map,Y_=new Map,bh=[],QT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function $b(i,a){switch(i){case"focusin":case"focusout":Th=null;break;case"dragenter":case"dragleave":Dh=null;break;case"mouseover":case"mouseout":Sh=null;break;case"pointerover":case"pointerout":Q_.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Y_.delete(a.pointerId)}}function S_(i,a,c,v,E,D){return i===null||i.nativeEvent!==D?(i={blockedOn:a,domEventName:c,eventSystemFlags:v,nativeEvent:D,targetContainers:[E]},a!==null&&(a=mg(a),a!==null&&IA(a)),i):(i.eventSystemFlags|=v,a=i.targetContainers,E!==null&&a.indexOf(E)===-1&&a.push(E),i)}function YT(i,a,c,v,E){switch(a){case"focusin":return Th=S_(Th,i,a,c,v,E),!0;case"dragenter":return Dh=S_(Dh,i,a,c,v,E),!0;case"mouseover":return Sh=S_(Sh,i,a,c,v,E),!0;case"pointerover":var D=E.pointerId;return Q_.set(D,S_(Q_.get(D)||null,i,a,c,v,E)),!0;case"gotpointercapture":return D=E.pointerId,Y_.set(D,S_(Y_.get(D)||null,i,a,c,v,E)),!0}return!1}function v2(i){var a=Kd(i.target);if(a!==null){var c=sf(a);if(c!==null){if(a=c.tag,a===13){if(a=a2(c),a!==null){i.blockedOn=a,y2(i.priority,function(){_2(c)});return}}else if(a===3&&c.stateNode.current.memoizedState.isDehydrated){i.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}i.blockedOn=null}function I0(i){if(i.blockedOn!==null)return!1;for(var a=i.targetContainers;0<a.length;){var c=Rw(i.domEventName,i.eventSystemFlags,a[0],i.nativeEvent);if(c===null){c=i.nativeEvent;var v=new c.constructor(c.type,c);Mw=v,c.target.dispatchEvent(v),Mw=null}else return a=mg(c),a!==null&&IA(a),i.blockedOn=c,!1;a.shift()}return!0}function Wb(i,a,c){I0(i)&&c.delete(a)}function eD(){Fw=!1,Th!==null&&I0(Th)&&(Th=null),Dh!==null&&I0(Dh)&&(Dh=null),Sh!==null&&I0(Sh)&&(Sh=null),Q_.forEach(Wb),Y_.forEach(Wb)}function I_(i,a){i.blockedOn===a&&(i.blockedOn=null,Fw||(Fw=!0,$s.unstable_scheduleCallback($s.unstable_NormalPriority,eD)))}function eg(i){function a(E){return I_(E,i)}if(0<h0.length){I_(h0[0],i);for(var c=1;c<h0.length;c++){var v=h0[c];v.blockedOn===i&&(v.blockedOn=null)}}for(Th!==null&&I_(Th,i),Dh!==null&&I_(Dh,i),Sh!==null&&I_(Sh,i),Q_.forEach(a),Y_.forEach(a),c=0;c<bh.length;c++)v=bh[c],v.blockedOn===i&&(v.blockedOn=null);for(;0<bh.length&&(c=bh[0],c.blockedOn===null);)v2(c),c.blockedOn===null&&bh.shift()}var Xp=dc.ReactCurrentBatchConfig,$0=!0;function tD(i,a,c,v){var E=hr,D=Xp.transition;Xp.transition=null;try{hr=1,MA(i,a,c,v)}finally{hr=E,Xp.transition=D}}function nD(i,a,c,v){var E=hr,D=Xp.transition;Xp.transition=null;try{hr=4,MA(i,a,c,v)}finally{hr=E,Xp.transition=D}}function MA(i,a,c,v){if($0){var E=Rw(i,a,c,v);if(E===null)X1(i,a,v,W0,c),$b(i,v);else if(YT(E,i,a,c,v))v.stopPropagation();else if($b(i,v),a&4&&-1<QT.indexOf(i)){for(;E!==null;){var D=mg(E);if(D!==null&&m2(D),D=Rw(i,a,c,v),D===null&&X1(i,a,v,W0,c),D===E)break;E=D}E!==null&&v.stopPropagation()}else X1(i,a,v,null,c)}}var W0=null;function Rw(i,a,c,v){if(W0=null,i=TA(v),i=Kd(i),i!==null)if(a=sf(i),a===null)i=null;else if(c=a.tag,c===13){if(i=a2(a),i!==null)return i;i=null}else if(c===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;i=null}else a!==i&&(i=null);return W0=i,null}function x2(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(jT()){case DA:return 1;case h2:return 4;case V0:case VT:return 16;case d2:return 536870912;default:return 16}default:return 16}}var Eh=null,kA=null,M0=null;function w2(){if(M0)return M0;var i,a=kA,c=a.length,v,E="value"in Eh?Eh.value:Eh.textContent,D=E.length;for(i=0;i<c&&a[i]===E[i];i++);var F=c-i;for(v=1;v<=F&&a[c-v]===E[D-v];v++);return M0=E.slice(i,1<v?1-v:void 0)}function k0(i){var a=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&a===13&&(i=13)):i=a,i===10&&(i=13),32<=i||i===13?i:0}function d0(){return!0}function Kb(){return!1}function Ks(i){function a(c,v,E,D,F){this._reactName=c,this._targetInst=E,this.type=v,this.nativeEvent=D,this.target=F,this.currentTarget=null;for(var s in i)i.hasOwnProperty(s)&&(c=i[s],this[s]=c?c(D):D[s]);return this.isDefaultPrevented=(D.defaultPrevented!=null?D.defaultPrevented:D.returnValue===!1)?d0:Kb,this.isPropagationStopped=Kb,this}return $r(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=d0)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=d0)},persist:function(){},isPersistent:d0}),a}var cm={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},PA=Ks(cm),pg=$r({},cm,{view:0,detail:0}),rD=Ks(pg),q1,j1,M_,dv=$r({},pg,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:LA,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==M_&&(M_&&i.type==="mousemove"?(q1=i.screenX-M_.screenX,j1=i.screenY-M_.screenY):j1=q1=0,M_=i),q1)},movementY:function(i){return"movementY"in i?i.movementY:j1}}),Zb=Ks(dv),iD=$r({},dv,{dataTransfer:0}),oD=Ks(iD),sD=$r({},pg,{relatedTarget:0}),V1=Ks(sD),aD=$r({},cm,{animationName:0,elapsedTime:0,pseudoElement:0}),lD=Ks(aD),uD=$r({},cm,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),cD=Ks(uD),hD=$r({},cm,{data:0}),Jb=Ks(hD),dD={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fD={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pD={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function mD(i){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(i):(i=pD[i])?!!a[i]:!1}function LA(){return mD}var _D=$r({},pg,{key:function(i){if(i.key){var a=dD[i.key]||i.key;if(a!=="Unidentified")return a}return i.type==="keypress"?(i=k0(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?fD[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:LA,charCode:function(i){return i.type==="keypress"?k0(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?k0(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),gD=Ks(_D),yD=$r({},dv,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xb=Ks(yD),vD=$r({},pg,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:LA}),xD=Ks(vD),wD=$r({},cm,{propertyName:0,elapsedTime:0,pseudoElement:0}),AD=Ks(wD),bD=$r({},dv,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),CD=Ks(bD),ED=[9,13,27,32],zA=lc&&"CompositionEvent"in window,q_=null;lc&&"documentMode"in document&&(q_=document.documentMode);var BD=lc&&"TextEvent"in window&&!q_,A2=lc&&(!zA||q_&&8<q_&&11>=q_),Qb=String.fromCharCode(32),Yb=!1;function b2(i,a){switch(i){case"keyup":return ED.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function C2(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Rp=!1;function TD(i,a){switch(i){case"compositionend":return C2(a);case"keypress":return a.which!==32?null:(Yb=!0,Qb);case"textInput":return i=a.data,i===Qb&&Yb?null:i;default:return null}}function DD(i,a){if(Rp)return i==="compositionend"||!zA&&b2(i,a)?(i=w2(),M0=kA=Eh=null,Rp=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return A2&&a.locale!=="ko"?null:a.data;default:return null}}var SD={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function eC(i){var a=i&&i.nodeName&&i.nodeName.toLowerCase();return a==="input"?!!SD[i.type]:a==="textarea"}function E2(i,a,c,v){n2(v),a=K0(a,"onChange"),0<a.length&&(c=new PA("onChange","change",null,c,v),i.push({event:c,listeners:a}))}var j_=null,tg=null;function ID(i){F2(i,0)}function fv(i){var a=Np(i);if(ZE(a))return i}function MD(i,a){if(i==="change")return a}var B2=!1;if(lc){var H1;if(lc){var $1="oninput"in document;if(!$1){var tC=document.createElement("div");tC.setAttribute("oninput","return;"),$1=typeof tC.oninput=="function"}H1=$1}else H1=!1;B2=H1&&(!document.documentMode||9<document.documentMode)}function nC(){j_&&(j_.detachEvent("onpropertychange",T2),tg=j_=null)}function T2(i){if(i.propertyName==="value"&&fv(tg)){var a=[];E2(a,tg,i,TA(i)),s2(ID,a)}}function kD(i,a,c){i==="focusin"?(nC(),j_=a,tg=c,j_.attachEvent("onpropertychange",T2)):i==="focusout"&&nC()}function PD(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return fv(tg)}function LD(i,a){if(i==="click")return fv(a)}function zD(i,a){if(i==="input"||i==="change")return fv(a)}function FD(i,a){return i===a&&(i!==0||1/i===1/a)||i!==i&&a!==a}var _l=typeof Object.is=="function"?Object.is:FD;function ng(i,a){if(_l(i,a))return!0;if(typeof i!="object"||i===null||typeof a!="object"||a===null)return!1;var c=Object.keys(i),v=Object.keys(a);if(c.length!==v.length)return!1;for(v=0;v<c.length;v++){var E=c[v];if(!vw.call(a,E)||!_l(i[E],a[E]))return!1}return!0}function rC(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function iC(i,a){var c=rC(i);i=0;for(var v;c;){if(c.nodeType===3){if(v=i+c.textContent.length,i<=a&&v>=a)return{node:c,offset:a-i};i=v}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=rC(c)}}function D2(i,a){return i&&a?i===a?!0:i&&i.nodeType===3?!1:a&&a.nodeType===3?D2(i,a.parentNode):"contains"in i?i.contains(a):i.compareDocumentPosition?!!(i.compareDocumentPosition(a)&16):!1:!1}function S2(){for(var i=window,a=U0();a instanceof i.HTMLIFrameElement;){try{var c=typeof a.contentWindow.location.href=="string"}catch{c=!1}if(c)i=a.contentWindow;else break;a=U0(i.document)}return a}function FA(i){var a=i&&i.nodeName&&i.nodeName.toLowerCase();return a&&(a==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||a==="textarea"||i.contentEditable==="true")}function RD(i){var a=S2(),c=i.focusedElem,v=i.selectionRange;if(a!==c&&c&&c.ownerDocument&&D2(c.ownerDocument.documentElement,c)){if(v!==null&&FA(c)){if(a=v.start,i=v.end,i===void 0&&(i=a),"selectionStart"in c)c.selectionStart=a,c.selectionEnd=Math.min(i,c.value.length);else if(i=(a=c.ownerDocument||document)&&a.defaultView||window,i.getSelection){i=i.getSelection();var E=c.textContent.length,D=Math.min(v.start,E);v=v.end===void 0?D:Math.min(v.end,E),!i.extend&&D>v&&(E=v,v=D,D=E),E=iC(c,D);var F=iC(c,v);E&&F&&(i.rangeCount!==1||i.anchorNode!==E.node||i.anchorOffset!==E.offset||i.focusNode!==F.node||i.focusOffset!==F.offset)&&(a=a.createRange(),a.setStart(E.node,E.offset),i.removeAllRanges(),D>v?(i.addRange(a),i.extend(F.node,F.offset)):(a.setEnd(F.node,F.offset),i.addRange(a)))}}for(a=[],i=c;i=i.parentNode;)i.nodeType===1&&a.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof c.focus=="function"&&c.focus(),c=0;c<a.length;c++)i=a[c],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var OD=lc&&"documentMode"in document&&11>=document.documentMode,Op=null,Ow=null,V_=null,Gw=!1;function oC(i,a,c){var v=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Gw||Op==null||Op!==U0(v)||(v=Op,"selectionStart"in v&&FA(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),V_&&ng(V_,v)||(V_=v,v=K0(Ow,"onSelect"),0<v.length&&(a=new PA("onSelect","select",null,a,c),i.push({event:a,listeners:v}),a.target=Op)))}function f0(i,a){var c={};return c[i.toLowerCase()]=a.toLowerCase(),c["Webkit"+i]="webkit"+a,c["Moz"+i]="moz"+a,c}var Gp={animationend:f0("Animation","AnimationEnd"),animationiteration:f0("Animation","AnimationIteration"),animationstart:f0("Animation","AnimationStart"),transitionend:f0("Transition","TransitionEnd")},W1={},I2={};lc&&(I2=document.createElement("div").style,"AnimationEvent"in window||(delete Gp.animationend.animation,delete Gp.animationiteration.animation,delete Gp.animationstart.animation),"TransitionEvent"in window||delete Gp.transitionend.transition);function pv(i){if(W1[i])return W1[i];if(!Gp[i])return i;var a=Gp[i],c;for(c in a)if(a.hasOwnProperty(c)&&c in I2)return W1[i]=a[c];return i}var M2=pv("animationend"),k2=pv("animationiteration"),P2=pv("animationstart"),L2=pv("transitionend"),z2=new Map,sC="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rh(i,a){z2.set(i,a),of(a,[i])}for(var K1=0;K1<sC.length;K1++){var Z1=sC[K1],GD=Z1.toLowerCase(),ND=Z1[0].toUpperCase()+Z1.slice(1);Rh(GD,"on"+ND)}Rh(M2,"onAnimationEnd");Rh(k2,"onAnimationIteration");Rh(P2,"onAnimationStart");Rh("dblclick","onDoubleClick");Rh("focusin","onFocus");Rh("focusout","onBlur");Rh(L2,"onTransitionEnd");tm("onMouseEnter",["mouseout","mouseover"]);tm("onMouseLeave",["mouseout","mouseover"]);tm("onPointerEnter",["pointerout","pointerover"]);tm("onPointerLeave",["pointerout","pointerover"]);of("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));of("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));of("onBeforeInput",["compositionend","keypress","textInput","paste"]);of("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));of("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));of("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var G_="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),UD=new Set("cancel close invalid load scroll toggle".split(" ").concat(G_));function aC(i,a,c){var v=i.type||"unknown-event";i.currentTarget=c,GT(v,a,void 0,i),i.currentTarget=null}function F2(i,a){a=(a&4)!==0;for(var c=0;c<i.length;c++){var v=i[c],E=v.event;v=v.listeners;e:{var D=void 0;if(a)for(var F=v.length-1;0<=F;F--){var s=v[F],N=s.instance,pe=s.currentTarget;if(s=s.listener,N!==D&&E.isPropagationStopped())break e;aC(E,s,pe),D=N}else for(F=0;F<v.length;F++){if(s=v[F],N=s.instance,pe=s.currentTarget,s=s.listener,N!==D&&E.isPropagationStopped())break e;aC(E,s,pe),D=N}}}if(j0)throw i=Lw,j0=!1,Lw=null,i}function Br(i,a){var c=a[Vw];c===void 0&&(c=a[Vw]=new Set);var v=i+"__bubble";c.has(v)||(R2(a,i,2,!1),c.add(v))}function J1(i,a,c){var v=0;a&&(v|=4),R2(c,i,v,a)}var p0="_reactListening"+Math.random().toString(36).slice(2);function rg(i){if(!i[p0]){i[p0]=!0,VE.forEach(function(c){c!=="selectionchange"&&(UD.has(c)||J1(c,!1,i),J1(c,!0,i))});var a=i.nodeType===9?i:i.ownerDocument;a===null||a[p0]||(a[p0]=!0,J1("selectionchange",!1,a))}}function R2(i,a,c,v){switch(x2(a)){case 1:var E=tD;break;case 4:E=nD;break;default:E=MA}c=E.bind(null,a,c,i),E=void 0,!Pw||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(E=!0),v?E!==void 0?i.addEventListener(a,c,{capture:!0,passive:E}):i.addEventListener(a,c,!0):E!==void 0?i.addEventListener(a,c,{passive:E}):i.addEventListener(a,c,!1)}function X1(i,a,c,v,E){var D=v;if((a&1)===0&&(a&2)===0&&v!==null)e:for(;;){if(v===null)return;var F=v.tag;if(F===3||F===4){var s=v.stateNode.containerInfo;if(s===E||s.nodeType===8&&s.parentNode===E)break;if(F===4)for(F=v.return;F!==null;){var N=F.tag;if((N===3||N===4)&&(N=F.stateNode.containerInfo,N===E||N.nodeType===8&&N.parentNode===E))return;F=F.return}for(;s!==null;){if(F=Kd(s),F===null)return;if(N=F.tag,N===5||N===6){v=D=F;continue e}s=s.parentNode}}v=v.return}s2(function(){var pe=D,Re=TA(c),we=[];e:{var Ae=z2.get(i);if(Ae!==void 0){var $e=PA,Qe=i;switch(i){case"keypress":if(k0(c)===0)break e;case"keydown":case"keyup":$e=gD;break;case"focusin":Qe="focus",$e=V1;break;case"focusout":Qe="blur",$e=V1;break;case"beforeblur":case"afterblur":$e=V1;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":$e=Zb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":$e=oD;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":$e=xD;break;case M2:case k2:case P2:$e=lD;break;case L2:$e=AD;break;case"scroll":$e=rD;break;case"wheel":$e=CD;break;case"copy":case"cut":case"paste":$e=cD;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":$e=Xb}var ot=(a&4)!==0,Vt=!ot&&i==="scroll",be=ot?Ae!==null?Ae+"Capture":null:Ae;ot=[];for(var ge=pe,Be;ge!==null;){Be=ge;var Xe=Be.stateNode;if(Be.tag===5&&Xe!==null&&(Be=Xe,be!==null&&(Xe=X_(ge,be),Xe!=null&&ot.push(ig(ge,Xe,Be)))),Vt)break;ge=ge.return}0<ot.length&&(Ae=new $e(Ae,Qe,null,c,Re),we.push({event:Ae,listeners:ot}))}}if((a&7)===0){e:{if(Ae=i==="mouseover"||i==="pointerover",$e=i==="mouseout"||i==="pointerout",Ae&&c!==Mw&&(Qe=c.relatedTarget||c.fromElement)&&(Kd(Qe)||Qe[uc]))break e;if(($e||Ae)&&(Ae=Re.window===Re?Re:(Ae=Re.ownerDocument)?Ae.defaultView||Ae.parentWindow:window,$e?(Qe=c.relatedTarget||c.toElement,$e=pe,Qe=Qe?Kd(Qe):null,Qe!==null&&(Vt=sf(Qe),Qe!==Vt||Qe.tag!==5&&Qe.tag!==6)&&(Qe=null)):($e=null,Qe=pe),$e!==Qe)){if(ot=Zb,Xe="onMouseLeave",be="onMouseEnter",ge="mouse",(i==="pointerout"||i==="pointerover")&&(ot=Xb,Xe="onPointerLeave",be="onPointerEnter",ge="pointer"),Vt=$e==null?Ae:Np($e),Be=Qe==null?Ae:Np(Qe),Ae=new ot(Xe,ge+"leave",$e,c,Re),Ae.target=Vt,Ae.relatedTarget=Be,Xe=null,Kd(Re)===pe&&(ot=new ot(be,ge+"enter",Qe,c,Re),ot.target=Be,ot.relatedTarget=Vt,Xe=ot),Vt=Xe,$e&&Qe)t:{for(ot=$e,be=Qe,ge=0,Be=ot;Be;Be=Ip(Be))ge++;for(Be=0,Xe=be;Xe;Xe=Ip(Xe))Be++;for(;0<ge-Be;)ot=Ip(ot),ge--;for(;0<Be-ge;)be=Ip(be),Be--;for(;ge--;){if(ot===be||be!==null&&ot===be.alternate)break t;ot=Ip(ot),be=Ip(be)}ot=null}else ot=null;$e!==null&&lC(we,Ae,$e,ot,!1),Qe!==null&&Vt!==null&&lC(we,Vt,Qe,ot,!0)}}e:{if(Ae=pe?Np(pe):window,$e=Ae.nodeName&&Ae.nodeName.toLowerCase(),$e==="select"||$e==="input"&&Ae.type==="file")var Ie=MD;else if(eC(Ae))if(B2)Ie=zD;else{Ie=PD;var at=kD}else($e=Ae.nodeName)&&$e.toLowerCase()==="input"&&(Ae.type==="checkbox"||Ae.type==="radio")&&(Ie=LD);if(Ie&&(Ie=Ie(i,pe))){E2(we,Ie,c,Re);break e}at&&at(i,Ae,pe),i==="focusout"&&(at=Ae._wrapperState)&&at.controlled&&Ae.type==="number"&&Bw(Ae,"number",Ae.value)}switch(at=pe?Np(pe):window,i){case"focusin":(eC(at)||at.contentEditable==="true")&&(Op=at,Ow=pe,V_=null);break;case"focusout":V_=Ow=Op=null;break;case"mousedown":Gw=!0;break;case"contextmenu":case"mouseup":case"dragend":Gw=!1,oC(we,c,Re);break;case"selectionchange":if(OD)break;case"keydown":case"keyup":oC(we,c,Re)}var ft;if(zA)e:{switch(i){case"compositionstart":var Ct="onCompositionStart";break e;case"compositionend":Ct="onCompositionEnd";break e;case"compositionupdate":Ct="onCompositionUpdate";break e}Ct=void 0}else Rp?b2(i,c)&&(Ct="onCompositionEnd"):i==="keydown"&&c.keyCode===229&&(Ct="onCompositionStart");Ct&&(A2&&c.locale!=="ko"&&(Rp||Ct!=="onCompositionStart"?Ct==="onCompositionEnd"&&Rp&&(ft=w2()):(Eh=Re,kA="value"in Eh?Eh.value:Eh.textContent,Rp=!0)),at=K0(pe,Ct),0<at.length&&(Ct=new Jb(Ct,i,null,c,Re),we.push({event:Ct,listeners:at}),ft?Ct.data=ft:(ft=C2(c),ft!==null&&(Ct.data=ft)))),(ft=BD?TD(i,c):DD(i,c))&&(pe=K0(pe,"onBeforeInput"),0<pe.length&&(Re=new Jb("onBeforeInput","beforeinput",null,c,Re),we.push({event:Re,listeners:pe}),Re.data=ft))}F2(we,a)})}function ig(i,a,c){return{instance:i,listener:a,currentTarget:c}}function K0(i,a){for(var c=a+"Capture",v=[];i!==null;){var E=i,D=E.stateNode;E.tag===5&&D!==null&&(E=D,D=X_(i,c),D!=null&&v.unshift(ig(i,D,E)),D=X_(i,a),D!=null&&v.push(ig(i,D,E))),i=i.return}return v}function Ip(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function lC(i,a,c,v,E){for(var D=a._reactName,F=[];c!==null&&c!==v;){var s=c,N=s.alternate,pe=s.stateNode;if(N!==null&&N===v)break;s.tag===5&&pe!==null&&(s=pe,E?(N=X_(c,D),N!=null&&F.unshift(ig(c,N,s))):E||(N=X_(c,D),N!=null&&F.push(ig(c,N,s)))),c=c.return}F.length!==0&&i.push({event:a,listeners:F})}var qD=/\r\n?/g,jD=/\u0000|\uFFFD/g;function uC(i){return(typeof i=="string"?i:""+i).replace(qD,`
`).replace(jD,"")}function m0(i,a,c){if(a=uC(a),uC(i)!==a&&c)throw Error(_t(425))}function Z0(){}var Nw=null,Uw=null;function qw(i,a){return i==="textarea"||i==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var jw=typeof setTimeout=="function"?setTimeout:void 0,VD=typeof clearTimeout=="function"?clearTimeout:void 0,cC=typeof Promise=="function"?Promise:void 0,HD=typeof queueMicrotask=="function"?queueMicrotask:typeof cC<"u"?function(i){return cC.resolve(null).then(i).catch($D)}:jw;function $D(i){setTimeout(function(){throw i})}function Q1(i,a){var c=a,v=0;do{var E=c.nextSibling;if(i.removeChild(c),E&&E.nodeType===8)if(c=E.data,c==="/$"){if(v===0){i.removeChild(E),eg(a);return}v--}else c!=="$"&&c!=="$?"&&c!=="$!"||v++;c=E}while(c);eg(a)}function Ih(i){for(;i!=null;i=i.nextSibling){var a=i.nodeType;if(a===1||a===3)break;if(a===8){if(a=i.data,a==="$"||a==="$!"||a==="$?")break;if(a==="/$")return null}}return i}function hC(i){i=i.previousSibling;for(var a=0;i;){if(i.nodeType===8){var c=i.data;if(c==="$"||c==="$!"||c==="$?"){if(a===0)return i;a--}else c==="/$"&&a++}i=i.previousSibling}return null}var hm=Math.random().toString(36).slice(2),fu="__reactFiber$"+hm,og="__reactProps$"+hm,uc="__reactContainer$"+hm,Vw="__reactEvents$"+hm,WD="__reactListeners$"+hm,KD="__reactHandles$"+hm;function Kd(i){var a=i[fu];if(a)return a;for(var c=i.parentNode;c;){if(a=c[uc]||c[fu]){if(c=a.alternate,a.child!==null||c!==null&&c.child!==null)for(i=hC(i);i!==null;){if(c=i[fu])return c;i=hC(i)}return a}i=c,c=i.parentNode}return null}function mg(i){return i=i[fu]||i[uc],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function Np(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(_t(33))}function mv(i){return i[og]||null}var Hw=[],Up=-1;function Oh(i){return{current:i}}function Tr(i){0>Up||(i.current=Hw[Up],Hw[Up]=null,Up--)}function xr(i,a){Up++,Hw[Up]=i.current,i.current=a}var Fh={},Ao=Oh(Fh),_s=Oh(!1),Yd=Fh;function nm(i,a){var c=i.type.contextTypes;if(!c)return Fh;var v=i.stateNode;if(v&&v.__reactInternalMemoizedUnmaskedChildContext===a)return v.__reactInternalMemoizedMaskedChildContext;var E={},D;for(D in c)E[D]=a[D];return v&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=a,i.__reactInternalMemoizedMaskedChildContext=E),E}function gs(i){return i=i.childContextTypes,i!=null}function J0(){Tr(_s),Tr(Ao)}function dC(i,a,c){if(Ao.current!==Fh)throw Error(_t(168));xr(Ao,a),xr(_s,c)}function O2(i,a,c){var v=i.stateNode;if(a=a.childContextTypes,typeof v.getChildContext!="function")return c;v=v.getChildContext();for(var E in v)if(!(E in a))throw Error(_t(108,kT(i)||"Unknown",E));return $r({},c,v)}function X0(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||Fh,Yd=Ao.current,xr(Ao,i),xr(_s,_s.current),!0}function fC(i,a,c){var v=i.stateNode;if(!v)throw Error(_t(169));c?(i=O2(i,a,Yd),v.__reactInternalMemoizedMergedChildContext=i,Tr(_s),Tr(Ao),xr(Ao,i)):Tr(_s),xr(_s,c)}var ic=null,_v=!1,Y1=!1;function G2(i){ic===null?ic=[i]:ic.push(i)}function ZD(i){_v=!0,G2(i)}function Gh(){if(!Y1&&ic!==null){Y1=!0;var i=0,a=hr;try{var c=ic;for(hr=1;i<c.length;i++){var v=c[i];do v=v(!0);while(v!==null)}ic=null,_v=!1}catch(E){throw ic!==null&&(ic=ic.slice(i+1)),c2(DA,Gh),E}finally{hr=a,Y1=!1}}return null}var qp=[],jp=0,Q0=null,Y0=0,Sa=[],Ia=0,ef=null,oc=1,sc="";function $d(i,a){qp[jp++]=Y0,qp[jp++]=Q0,Q0=i,Y0=a}function N2(i,a,c){Sa[Ia++]=oc,Sa[Ia++]=sc,Sa[Ia++]=ef,ef=i;var v=oc;i=sc;var E=32-pl(v)-1;v&=~(1<<E),c+=1;var D=32-pl(a)+E;if(30<D){var F=E-E%5;D=(v&(1<<F)-1).toString(32),v>>=F,E-=F,oc=1<<32-pl(a)+E|c<<E|v,sc=D+i}else oc=1<<D|c<<E|v,sc=i}function RA(i){i.return!==null&&($d(i,1),N2(i,1,0))}function OA(i){for(;i===Q0;)Q0=qp[--jp],qp[jp]=null,Y0=qp[--jp],qp[jp]=null;for(;i===ef;)ef=Sa[--Ia],Sa[Ia]=null,sc=Sa[--Ia],Sa[Ia]=null,oc=Sa[--Ia],Sa[Ia]=null}var Hs=null,Vs=null,Rr=!1,fl=null;function U2(i,a){var c=Ma(5,null,null,0);c.elementType="DELETED",c.stateNode=a,c.return=i,a=i.deletions,a===null?(i.deletions=[c],i.flags|=16):a.push(c)}function pC(i,a){switch(i.tag){case 5:var c=i.type;return a=a.nodeType!==1||c.toLowerCase()!==a.nodeName.toLowerCase()?null:a,a!==null?(i.stateNode=a,Hs=i,Vs=Ih(a.firstChild),!0):!1;case 6:return a=i.pendingProps===""||a.nodeType!==3?null:a,a!==null?(i.stateNode=a,Hs=i,Vs=null,!0):!1;case 13:return a=a.nodeType!==8?null:a,a!==null?(c=ef!==null?{id:oc,overflow:sc}:null,i.memoizedState={dehydrated:a,treeContext:c,retryLane:1073741824},c=Ma(18,null,null,0),c.stateNode=a,c.return=i,i.child=c,Hs=i,Vs=null,!0):!1;default:return!1}}function $w(i){return(i.mode&1)!==0&&(i.flags&128)===0}function Ww(i){if(Rr){var a=Vs;if(a){var c=a;if(!pC(i,a)){if($w(i))throw Error(_t(418));a=Ih(c.nextSibling);var v=Hs;a&&pC(i,a)?U2(v,c):(i.flags=i.flags&-4097|2,Rr=!1,Hs=i)}}else{if($w(i))throw Error(_t(418));i.flags=i.flags&-4097|2,Rr=!1,Hs=i}}}function mC(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;Hs=i}function _0(i){if(i!==Hs)return!1;if(!Rr)return mC(i),Rr=!0,!1;var a;if((a=i.tag!==3)&&!(a=i.tag!==5)&&(a=i.type,a=a!=="head"&&a!=="body"&&!qw(i.type,i.memoizedProps)),a&&(a=Vs)){if($w(i))throw q2(),Error(_t(418));for(;a;)U2(i,a),a=Ih(a.nextSibling)}if(mC(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(_t(317));e:{for(i=i.nextSibling,a=0;i;){if(i.nodeType===8){var c=i.data;if(c==="/$"){if(a===0){Vs=Ih(i.nextSibling);break e}a--}else c!=="$"&&c!=="$!"&&c!=="$?"||a++}i=i.nextSibling}Vs=null}}else Vs=Hs?Ih(i.stateNode.nextSibling):null;return!0}function q2(){for(var i=Vs;i;)i=Ih(i.nextSibling)}function rm(){Vs=Hs=null,Rr=!1}function GA(i){fl===null?fl=[i]:fl.push(i)}var JD=dc.ReactCurrentBatchConfig;function hl(i,a){if(i&&i.defaultProps){a=$r({},a),i=i.defaultProps;for(var c in i)a[c]===void 0&&(a[c]=i[c]);return a}return a}var ev=Oh(null),tv=null,Vp=null,NA=null;function UA(){NA=Vp=tv=null}function qA(i){var a=ev.current;Tr(ev),i._currentValue=a}function Kw(i,a,c){for(;i!==null;){var v=i.alternate;if((i.childLanes&a)!==a?(i.childLanes|=a,v!==null&&(v.childLanes|=a)):v!==null&&(v.childLanes&a)!==a&&(v.childLanes|=a),i===c)break;i=i.return}}function Qp(i,a){tv=i,NA=Vp=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&a)!==0&&(ms=!0),i.firstContext=null)}function Pa(i){var a=i._currentValue;if(NA!==i)if(i={context:i,memoizedValue:a,next:null},Vp===null){if(tv===null)throw Error(_t(308));Vp=i,tv.dependencies={lanes:0,firstContext:i}}else Vp=Vp.next=i;return a}var Zd=null;function jA(i){Zd===null?Zd=[i]:Zd.push(i)}function j2(i,a,c,v){var E=a.interleaved;return E===null?(c.next=c,jA(a)):(c.next=E.next,E.next=c),a.interleaved=c,cc(i,v)}function cc(i,a){i.lanes|=a;var c=i.alternate;for(c!==null&&(c.lanes|=a),c=i,i=i.return;i!==null;)i.childLanes|=a,c=i.alternate,c!==null&&(c.childLanes|=a),c=i,i=i.return;return c.tag===3?c.stateNode:null}var Ah=!1;function VA(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function V2(i,a){i=i.updateQueue,a.updateQueue===i&&(a.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function ac(i,a){return{eventTime:i,lane:a,tag:0,payload:null,callback:null,next:null}}function Mh(i,a,c){var v=i.updateQueue;if(v===null)return null;if(v=v.shared,(Xn&2)!==0){var E=v.pending;return E===null?a.next=a:(a.next=E.next,E.next=a),v.pending=a,cc(i,c)}return E=v.interleaved,E===null?(a.next=a,jA(v)):(a.next=E.next,E.next=a),v.interleaved=a,cc(i,c)}function P0(i,a,c){if(a=a.updateQueue,a!==null&&(a=a.shared,(c&4194240)!==0)){var v=a.lanes;v&=i.pendingLanes,c|=v,a.lanes=c,SA(i,c)}}function _C(i,a){var c=i.updateQueue,v=i.alternate;if(v!==null&&(v=v.updateQueue,c===v)){var E=null,D=null;if(c=c.firstBaseUpdate,c!==null){do{var F={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};D===null?E=D=F:D=D.next=F,c=c.next}while(c!==null);D===null?E=D=a:D=D.next=a}else E=D=a;c={baseState:v.baseState,firstBaseUpdate:E,lastBaseUpdate:D,shared:v.shared,effects:v.effects},i.updateQueue=c;return}i=c.lastBaseUpdate,i===null?c.firstBaseUpdate=a:i.next=a,c.lastBaseUpdate=a}function nv(i,a,c,v){var E=i.updateQueue;Ah=!1;var D=E.firstBaseUpdate,F=E.lastBaseUpdate,s=E.shared.pending;if(s!==null){E.shared.pending=null;var N=s,pe=N.next;N.next=null,F===null?D=pe:F.next=pe,F=N;var Re=i.alternate;Re!==null&&(Re=Re.updateQueue,s=Re.lastBaseUpdate,s!==F&&(s===null?Re.firstBaseUpdate=pe:s.next=pe,Re.lastBaseUpdate=N))}if(D!==null){var we=E.baseState;F=0,Re=pe=N=null,s=D;do{var Ae=s.lane,$e=s.eventTime;if((v&Ae)===Ae){Re!==null&&(Re=Re.next={eventTime:$e,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var Qe=i,ot=s;switch(Ae=a,$e=c,ot.tag){case 1:if(Qe=ot.payload,typeof Qe=="function"){we=Qe.call($e,we,Ae);break e}we=Qe;break e;case 3:Qe.flags=Qe.flags&-65537|128;case 0:if(Qe=ot.payload,Ae=typeof Qe=="function"?Qe.call($e,we,Ae):Qe,Ae==null)break e;we=$r({},we,Ae);break e;case 2:Ah=!0}}s.callback!==null&&s.lane!==0&&(i.flags|=64,Ae=E.effects,Ae===null?E.effects=[s]:Ae.push(s))}else $e={eventTime:$e,lane:Ae,tag:s.tag,payload:s.payload,callback:s.callback,next:null},Re===null?(pe=Re=$e,N=we):Re=Re.next=$e,F|=Ae;if(s=s.next,s===null){if(s=E.shared.pending,s===null)break;Ae=s,s=Ae.next,Ae.next=null,E.lastBaseUpdate=Ae,E.shared.pending=null}}while(1);if(Re===null&&(N=we),E.baseState=N,E.firstBaseUpdate=pe,E.lastBaseUpdate=Re,a=E.shared.interleaved,a!==null){E=a;do F|=E.lane,E=E.next;while(E!==a)}else D===null&&(E.shared.lanes=0);nf|=F,i.lanes=F,i.memoizedState=we}}function gC(i,a,c){if(i=a.effects,a.effects=null,i!==null)for(a=0;a<i.length;a++){var v=i[a],E=v.callback;if(E!==null){if(v.callback=null,v=c,typeof E!="function")throw Error(_t(191,E));E.call(v)}}}var H2=new jE.Component().refs;function Zw(i,a,c,v){a=i.memoizedState,c=c(v,a),c=c==null?a:$r({},a,c),i.memoizedState=c,i.lanes===0&&(i.updateQueue.baseState=c)}var gv={isMounted:function(i){return(i=i._reactInternals)?sf(i)===i:!1},enqueueSetState:function(i,a,c){i=i._reactInternals;var v=Go(),E=Ph(i),D=ac(v,E);D.payload=a,c!=null&&(D.callback=c),a=Mh(i,D,E),a!==null&&(ml(a,i,E,v),P0(a,i,E))},enqueueReplaceState:function(i,a,c){i=i._reactInternals;var v=Go(),E=Ph(i),D=ac(v,E);D.tag=1,D.payload=a,c!=null&&(D.callback=c),a=Mh(i,D,E),a!==null&&(ml(a,i,E,v),P0(a,i,E))},enqueueForceUpdate:function(i,a){i=i._reactInternals;var c=Go(),v=Ph(i),E=ac(c,v);E.tag=2,a!=null&&(E.callback=a),a=Mh(i,E,v),a!==null&&(ml(a,i,v,c),P0(a,i,v))}};function yC(i,a,c,v,E,D,F){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(v,D,F):a.prototype&&a.prototype.isPureReactComponent?!ng(c,v)||!ng(E,D):!0}function $2(i,a,c){var v=!1,E=Fh,D=a.contextType;return typeof D=="object"&&D!==null?D=Pa(D):(E=gs(a)?Yd:Ao.current,v=a.contextTypes,D=(v=v!=null)?nm(i,E):Fh),a=new a(c,D),i.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=gv,i.stateNode=a,a._reactInternals=i,v&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=E,i.__reactInternalMemoizedMaskedChildContext=D),a}function vC(i,a,c,v){i=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(c,v),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(c,v),a.state!==i&&gv.enqueueReplaceState(a,a.state,null)}function Jw(i,a,c,v){var E=i.stateNode;E.props=c,E.state=i.memoizedState,E.refs=H2,VA(i);var D=a.contextType;typeof D=="object"&&D!==null?E.context=Pa(D):(D=gs(a)?Yd:Ao.current,E.context=nm(i,D)),E.state=i.memoizedState,D=a.getDerivedStateFromProps,typeof D=="function"&&(Zw(i,a,D,c),E.state=i.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(a=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),a!==E.state&&gv.enqueueReplaceState(E,E.state,null),nv(i,c,E,v),E.state=i.memoizedState),typeof E.componentDidMount=="function"&&(i.flags|=4194308)}function k_(i,a,c){if(i=c.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(c._owner){if(c=c._owner,c){if(c.tag!==1)throw Error(_t(309));var v=c.stateNode}if(!v)throw Error(_t(147,i));var E=v,D=""+i;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===D?a.ref:(a=function(F){var s=E.refs;s===H2&&(s=E.refs={}),F===null?delete s[D]:s[D]=F},a._stringRef=D,a)}if(typeof i!="string")throw Error(_t(284));if(!c._owner)throw Error(_t(290,i))}return i}function g0(i,a){throw i=Object.prototype.toString.call(a),Error(_t(31,i==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":i))}function xC(i){var a=i._init;return a(i._payload)}function W2(i){function a(be,ge){if(i){var Be=be.deletions;Be===null?(be.deletions=[ge],be.flags|=16):Be.push(ge)}}function c(be,ge){if(!i)return null;for(;ge!==null;)a(be,ge),ge=ge.sibling;return null}function v(be,ge){for(be=new Map;ge!==null;)ge.key!==null?be.set(ge.key,ge):be.set(ge.index,ge),ge=ge.sibling;return be}function E(be,ge){return be=Lh(be,ge),be.index=0,be.sibling=null,be}function D(be,ge,Be){return be.index=Be,i?(Be=be.alternate,Be!==null?(Be=Be.index,Be<ge?(be.flags|=2,ge):Be):(be.flags|=2,ge)):(be.flags|=1048576,ge)}function F(be){return i&&be.alternate===null&&(be.flags|=2),be}function s(be,ge,Be,Xe){return ge===null||ge.tag!==6?(ge=sw(Be,be.mode,Xe),ge.return=be,ge):(ge=E(ge,Be),ge.return=be,ge)}function N(be,ge,Be,Xe){var Ie=Be.type;return Ie===Fp?Re(be,ge,Be.props.children,Xe,Be.key):ge!==null&&(ge.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===wh&&xC(Ie)===ge.type)?(Xe=E(ge,Be.props),Xe.ref=k_(be,ge,Be),Xe.return=be,Xe):(Xe=G0(Be.type,Be.key,Be.props,null,be.mode,Xe),Xe.ref=k_(be,ge,Be),Xe.return=be,Xe)}function pe(be,ge,Be,Xe){return ge===null||ge.tag!==4||ge.stateNode.containerInfo!==Be.containerInfo||ge.stateNode.implementation!==Be.implementation?(ge=aw(Be,be.mode,Xe),ge.return=be,ge):(ge=E(ge,Be.children||[]),ge.return=be,ge)}function Re(be,ge,Be,Xe,Ie){return ge===null||ge.tag!==7?(ge=Qd(Be,be.mode,Xe,Ie),ge.return=be,ge):(ge=E(ge,Be),ge.return=be,ge)}function we(be,ge,Be){if(typeof ge=="string"&&ge!==""||typeof ge=="number")return ge=sw(""+ge,be.mode,Be),ge.return=be,ge;if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case s0:return Be=G0(ge.type,ge.key,ge.props,null,be.mode,Be),Be.ref=k_(be,null,ge),Be.return=be,Be;case zp:return ge=aw(ge,be.mode,Be),ge.return=be,ge;case wh:var Xe=ge._init;return we(be,Xe(ge._payload),Be)}if(R_(ge)||T_(ge))return ge=Qd(ge,be.mode,Be,null),ge.return=be,ge;g0(be,ge)}return null}function Ae(be,ge,Be,Xe){var Ie=ge!==null?ge.key:null;if(typeof Be=="string"&&Be!==""||typeof Be=="number")return Ie!==null?null:s(be,ge,""+Be,Xe);if(typeof Be=="object"&&Be!==null){switch(Be.$$typeof){case s0:return Be.key===Ie?N(be,ge,Be,Xe):null;case zp:return Be.key===Ie?pe(be,ge,Be,Xe):null;case wh:return Ie=Be._init,Ae(be,ge,Ie(Be._payload),Xe)}if(R_(Be)||T_(Be))return Ie!==null?null:Re(be,ge,Be,Xe,null);g0(be,Be)}return null}function $e(be,ge,Be,Xe,Ie){if(typeof Xe=="string"&&Xe!==""||typeof Xe=="number")return be=be.get(Be)||null,s(ge,be,""+Xe,Ie);if(typeof Xe=="object"&&Xe!==null){switch(Xe.$$typeof){case s0:return be=be.get(Xe.key===null?Be:Xe.key)||null,N(ge,be,Xe,Ie);case zp:return be=be.get(Xe.key===null?Be:Xe.key)||null,pe(ge,be,Xe,Ie);case wh:var at=Xe._init;return $e(be,ge,Be,at(Xe._payload),Ie)}if(R_(Xe)||T_(Xe))return be=be.get(Be)||null,Re(ge,be,Xe,Ie,null);g0(ge,Xe)}return null}function Qe(be,ge,Be,Xe){for(var Ie=null,at=null,ft=ge,Ct=ge=0,Et=null;ft!==null&&Ct<Be.length;Ct++){ft.index>Ct?(Et=ft,ft=null):Et=ft.sibling;var Ot=Ae(be,ft,Be[Ct],Xe);if(Ot===null){ft===null&&(ft=Et);break}i&&ft&&Ot.alternate===null&&a(be,ft),ge=D(Ot,ge,Ct),at===null?Ie=Ot:at.sibling=Ot,at=Ot,ft=Et}if(Ct===Be.length)return c(be,ft),Rr&&$d(be,Ct),Ie;if(ft===null){for(;Ct<Be.length;Ct++)ft=we(be,Be[Ct],Xe),ft!==null&&(ge=D(ft,ge,Ct),at===null?Ie=ft:at.sibling=ft,at=ft);return Rr&&$d(be,Ct),Ie}for(ft=v(be,ft);Ct<Be.length;Ct++)Et=$e(ft,be,Ct,Be[Ct],Xe),Et!==null&&(i&&Et.alternate!==null&&ft.delete(Et.key===null?Ct:Et.key),ge=D(Et,ge,Ct),at===null?Ie=Et:at.sibling=Et,at=Et);return i&&ft.forEach(function(dr){return a(be,dr)}),Rr&&$d(be,Ct),Ie}function ot(be,ge,Be,Xe){var Ie=T_(Be);if(typeof Ie!="function")throw Error(_t(150));if(Be=Ie.call(Be),Be==null)throw Error(_t(151));for(var at=Ie=null,ft=ge,Ct=ge=0,Et=null,Ot=Be.next();ft!==null&&!Ot.done;Ct++,Ot=Be.next()){ft.index>Ct?(Et=ft,ft=null):Et=ft.sibling;var dr=Ae(be,ft,Ot.value,Xe);if(dr===null){ft===null&&(ft=Et);break}i&&ft&&dr.alternate===null&&a(be,ft),ge=D(dr,ge,Ct),at===null?Ie=dr:at.sibling=dr,at=dr,ft=Et}if(Ot.done)return c(be,ft),Rr&&$d(be,Ct),Ie;if(ft===null){for(;!Ot.done;Ct++,Ot=Be.next())Ot=we(be,Ot.value,Xe),Ot!==null&&(ge=D(Ot,ge,Ct),at===null?Ie=Ot:at.sibling=Ot,at=Ot);return Rr&&$d(be,Ct),Ie}for(ft=v(be,ft);!Ot.done;Ct++,Ot=Be.next())Ot=$e(ft,be,Ct,Ot.value,Xe),Ot!==null&&(i&&Ot.alternate!==null&&ft.delete(Ot.key===null?Ct:Ot.key),ge=D(Ot,ge,Ct),at===null?Ie=Ot:at.sibling=Ot,at=Ot);return i&&ft.forEach(function(Wr){return a(be,Wr)}),Rr&&$d(be,Ct),Ie}function Vt(be,ge,Be,Xe){if(typeof Be=="object"&&Be!==null&&Be.type===Fp&&Be.key===null&&(Be=Be.props.children),typeof Be=="object"&&Be!==null){switch(Be.$$typeof){case s0:e:{for(var Ie=Be.key,at=ge;at!==null;){if(at.key===Ie){if(Ie=Be.type,Ie===Fp){if(at.tag===7){c(be,at.sibling),ge=E(at,Be.props.children),ge.return=be,be=ge;break e}}else if(at.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===wh&&xC(Ie)===at.type){c(be,at.sibling),ge=E(at,Be.props),ge.ref=k_(be,at,Be),ge.return=be,be=ge;break e}c(be,at);break}else a(be,at);at=at.sibling}Be.type===Fp?(ge=Qd(Be.props.children,be.mode,Xe,Be.key),ge.return=be,be=ge):(Xe=G0(Be.type,Be.key,Be.props,null,be.mode,Xe),Xe.ref=k_(be,ge,Be),Xe.return=be,be=Xe)}return F(be);case zp:e:{for(at=Be.key;ge!==null;){if(ge.key===at)if(ge.tag===4&&ge.stateNode.containerInfo===Be.containerInfo&&ge.stateNode.implementation===Be.implementation){c(be,ge.sibling),ge=E(ge,Be.children||[]),ge.return=be,be=ge;break e}else{c(be,ge);break}else a(be,ge);ge=ge.sibling}ge=aw(Be,be.mode,Xe),ge.return=be,be=ge}return F(be);case wh:return at=Be._init,Vt(be,ge,at(Be._payload),Xe)}if(R_(Be))return Qe(be,ge,Be,Xe);if(T_(Be))return ot(be,ge,Be,Xe);g0(be,Be)}return typeof Be=="string"&&Be!==""||typeof Be=="number"?(Be=""+Be,ge!==null&&ge.tag===6?(c(be,ge.sibling),ge=E(ge,Be),ge.return=be,be=ge):(c(be,ge),ge=sw(Be,be.mode,Xe),ge.return=be,be=ge),F(be)):c(be,ge)}return Vt}var im=W2(!0),K2=W2(!1),_g={},_u=Oh(_g),sg=Oh(_g),ag=Oh(_g);function Jd(i){if(i===_g)throw Error(_t(174));return i}function HA(i,a){switch(xr(ag,a),xr(sg,i),xr(_u,_g),i=a.nodeType,i){case 9:case 11:a=(a=a.documentElement)?a.namespaceURI:Dw(null,"");break;default:i=i===8?a.parentNode:a,a=i.namespaceURI||null,i=i.tagName,a=Dw(a,i)}Tr(_u),xr(_u,a)}function om(){Tr(_u),Tr(sg),Tr(ag)}function Z2(i){Jd(ag.current);var a=Jd(_u.current),c=Dw(a,i.type);a!==c&&(xr(sg,i),xr(_u,c))}function $A(i){sg.current===i&&(Tr(_u),Tr(sg))}var Vr=Oh(0);function rv(i){for(var a=i;a!==null;){if(a.tag===13){var c=a.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||c.data==="$!"))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var ew=[];function WA(){for(var i=0;i<ew.length;i++)ew[i]._workInProgressVersionPrimary=null;ew.length=0}var L0=dc.ReactCurrentDispatcher,tw=dc.ReactCurrentBatchConfig,tf=0,Hr=null,Di=null,Gi=null,iv=!1,H_=!1,lg=0,XD=0;function vo(){throw Error(_t(321))}function KA(i,a){if(a===null)return!1;for(var c=0;c<a.length&&c<i.length;c++)if(!_l(i[c],a[c]))return!1;return!0}function ZA(i,a,c,v,E,D){if(tf=D,Hr=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,L0.current=i===null||i.memoizedState===null?tS:nS,i=c(v,E),H_){D=0;do{if(H_=!1,lg=0,25<=D)throw Error(_t(301));D+=1,Gi=Di=null,a.updateQueue=null,L0.current=rS,i=c(v,E)}while(H_)}if(L0.current=ov,a=Di!==null&&Di.next!==null,tf=0,Gi=Di=Hr=null,iv=!1,a)throw Error(_t(300));return i}function JA(){var i=lg!==0;return lg=0,i}function hu(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Gi===null?Hr.memoizedState=Gi=i:Gi=Gi.next=i,Gi}function La(){if(Di===null){var i=Hr.alternate;i=i!==null?i.memoizedState:null}else i=Di.next;var a=Gi===null?Hr.memoizedState:Gi.next;if(a!==null)Gi=a,Di=i;else{if(i===null)throw Error(_t(310));Di=i,i={memoizedState:Di.memoizedState,baseState:Di.baseState,baseQueue:Di.baseQueue,queue:Di.queue,next:null},Gi===null?Hr.memoizedState=Gi=i:Gi=Gi.next=i}return Gi}function ug(i,a){return typeof a=="function"?a(i):a}function nw(i){var a=La(),c=a.queue;if(c===null)throw Error(_t(311));c.lastRenderedReducer=i;var v=Di,E=v.baseQueue,D=c.pending;if(D!==null){if(E!==null){var F=E.next;E.next=D.next,D.next=F}v.baseQueue=E=D,c.pending=null}if(E!==null){D=E.next,v=v.baseState;var s=F=null,N=null,pe=D;do{var Re=pe.lane;if((tf&Re)===Re)N!==null&&(N=N.next={lane:0,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null}),v=pe.hasEagerState?pe.eagerState:i(v,pe.action);else{var we={lane:Re,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null};N===null?(s=N=we,F=v):N=N.next=we,Hr.lanes|=Re,nf|=Re}pe=pe.next}while(pe!==null&&pe!==D);N===null?F=v:N.next=s,_l(v,a.memoizedState)||(ms=!0),a.memoizedState=v,a.baseState=F,a.baseQueue=N,c.lastRenderedState=v}if(i=c.interleaved,i!==null){E=i;do D=E.lane,Hr.lanes|=D,nf|=D,E=E.next;while(E!==i)}else E===null&&(c.lanes=0);return[a.memoizedState,c.dispatch]}function rw(i){var a=La(),c=a.queue;if(c===null)throw Error(_t(311));c.lastRenderedReducer=i;var v=c.dispatch,E=c.pending,D=a.memoizedState;if(E!==null){c.pending=null;var F=E=E.next;do D=i(D,F.action),F=F.next;while(F!==E);_l(D,a.memoizedState)||(ms=!0),a.memoizedState=D,a.baseQueue===null&&(a.baseState=D),c.lastRenderedState=D}return[D,v]}function J2(){}function X2(i,a){var c=Hr,v=La(),E=a(),D=!_l(v.memoizedState,E);if(D&&(v.memoizedState=E,ms=!0),v=v.queue,XA(eB.bind(null,c,v,i),[i]),v.getSnapshot!==a||D||Gi!==null&&Gi.memoizedState.tag&1){if(c.flags|=2048,cg(9,Y2.bind(null,c,v,E,a),void 0,null),Ni===null)throw Error(_t(349));(tf&30)!==0||Q2(c,a,E)}return E}function Q2(i,a,c){i.flags|=16384,i={getSnapshot:a,value:c},a=Hr.updateQueue,a===null?(a={lastEffect:null,stores:null},Hr.updateQueue=a,a.stores=[i]):(c=a.stores,c===null?a.stores=[i]:c.push(i))}function Y2(i,a,c,v){a.value=c,a.getSnapshot=v,tB(a)&&nB(i)}function eB(i,a,c){return c(function(){tB(a)&&nB(i)})}function tB(i){var a=i.getSnapshot;i=i.value;try{var c=a();return!_l(i,c)}catch{return!0}}function nB(i){var a=cc(i,1);a!==null&&ml(a,i,1,-1)}function wC(i){var a=hu();return typeof i=="function"&&(i=i()),a.memoizedState=a.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ug,lastRenderedState:i},a.queue=i,i=i.dispatch=eS.bind(null,Hr,i),[a.memoizedState,i]}function cg(i,a,c,v){return i={tag:i,create:a,destroy:c,deps:v,next:null},a=Hr.updateQueue,a===null?(a={lastEffect:null,stores:null},Hr.updateQueue=a,a.lastEffect=i.next=i):(c=a.lastEffect,c===null?a.lastEffect=i.next=i:(v=c.next,c.next=i,i.next=v,a.lastEffect=i)),i}function rB(){return La().memoizedState}function z0(i,a,c,v){var E=hu();Hr.flags|=i,E.memoizedState=cg(1|a,c,void 0,v===void 0?null:v)}function yv(i,a,c,v){var E=La();v=v===void 0?null:v;var D=void 0;if(Di!==null){var F=Di.memoizedState;if(D=F.destroy,v!==null&&KA(v,F.deps)){E.memoizedState=cg(a,c,D,v);return}}Hr.flags|=i,E.memoizedState=cg(1|a,c,D,v)}function AC(i,a){return z0(8390656,8,i,a)}function XA(i,a){return yv(2048,8,i,a)}function iB(i,a){return yv(4,2,i,a)}function oB(i,a){return yv(4,4,i,a)}function sB(i,a){if(typeof a=="function")return i=i(),a(i),function(){a(null)};if(a!=null)return i=i(),a.current=i,function(){a.current=null}}function aB(i,a,c){return c=c!=null?c.concat([i]):null,yv(4,4,sB.bind(null,a,i),c)}function QA(){}function lB(i,a){var c=La();a=a===void 0?null:a;var v=c.memoizedState;return v!==null&&a!==null&&KA(a,v[1])?v[0]:(c.memoizedState=[i,a],i)}function uB(i,a){var c=La();a=a===void 0?null:a;var v=c.memoizedState;return v!==null&&a!==null&&KA(a,v[1])?v[0]:(i=i(),c.memoizedState=[i,a],i)}function cB(i,a,c){return(tf&21)===0?(i.baseState&&(i.baseState=!1,ms=!0),i.memoizedState=c):(_l(c,a)||(c=f2(),Hr.lanes|=c,nf|=c,i.baseState=!0),a)}function QD(i,a){var c=hr;hr=c!==0&&4>c?c:4,i(!0);var v=tw.transition;tw.transition={};try{i(!1),a()}finally{hr=c,tw.transition=v}}function hB(){return La().memoizedState}function YD(i,a,c){var v=Ph(i);if(c={lane:v,action:c,hasEagerState:!1,eagerState:null,next:null},dB(i))fB(a,c);else if(c=j2(i,a,c,v),c!==null){var E=Go();ml(c,i,v,E),pB(c,a,v)}}function eS(i,a,c){var v=Ph(i),E={lane:v,action:c,hasEagerState:!1,eagerState:null,next:null};if(dB(i))fB(a,E);else{var D=i.alternate;if(i.lanes===0&&(D===null||D.lanes===0)&&(D=a.lastRenderedReducer,D!==null))try{var F=a.lastRenderedState,s=D(F,c);if(E.hasEagerState=!0,E.eagerState=s,_l(s,F)){var N=a.interleaved;N===null?(E.next=E,jA(a)):(E.next=N.next,N.next=E),a.interleaved=E;return}}catch{}finally{}c=j2(i,a,E,v),c!==null&&(E=Go(),ml(c,i,v,E),pB(c,a,v))}}function dB(i){var a=i.alternate;return i===Hr||a!==null&&a===Hr}function fB(i,a){H_=iv=!0;var c=i.pending;c===null?a.next=a:(a.next=c.next,c.next=a),i.pending=a}function pB(i,a,c){if((c&4194240)!==0){var v=a.lanes;v&=i.pendingLanes,c|=v,a.lanes=c,SA(i,c)}}var ov={readContext:Pa,useCallback:vo,useContext:vo,useEffect:vo,useImperativeHandle:vo,useInsertionEffect:vo,useLayoutEffect:vo,useMemo:vo,useReducer:vo,useRef:vo,useState:vo,useDebugValue:vo,useDeferredValue:vo,useTransition:vo,useMutableSource:vo,useSyncExternalStore:vo,useId:vo,unstable_isNewReconciler:!1},tS={readContext:Pa,useCallback:function(i,a){return hu().memoizedState=[i,a===void 0?null:a],i},useContext:Pa,useEffect:AC,useImperativeHandle:function(i,a,c){return c=c!=null?c.concat([i]):null,z0(4194308,4,sB.bind(null,a,i),c)},useLayoutEffect:function(i,a){return z0(4194308,4,i,a)},useInsertionEffect:function(i,a){return z0(4,2,i,a)},useMemo:function(i,a){var c=hu();return a=a===void 0?null:a,i=i(),c.memoizedState=[i,a],i},useReducer:function(i,a,c){var v=hu();return a=c!==void 0?c(a):a,v.memoizedState=v.baseState=a,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:a},v.queue=i,i=i.dispatch=YD.bind(null,Hr,i),[v.memoizedState,i]},useRef:function(i){var a=hu();return i={current:i},a.memoizedState=i},useState:wC,useDebugValue:QA,useDeferredValue:function(i){return hu().memoizedState=i},useTransition:function(){var i=wC(!1),a=i[0];return i=QD.bind(null,i[1]),hu().memoizedState=i,[a,i]},useMutableSource:function(){},useSyncExternalStore:function(i,a,c){var v=Hr,E=hu();if(Rr){if(c===void 0)throw Error(_t(407));c=c()}else{if(c=a(),Ni===null)throw Error(_t(349));(tf&30)!==0||Q2(v,a,c)}E.memoizedState=c;var D={value:c,getSnapshot:a};return E.queue=D,AC(eB.bind(null,v,D,i),[i]),v.flags|=2048,cg(9,Y2.bind(null,v,D,c,a),void 0,null),c},useId:function(){var i=hu(),a=Ni.identifierPrefix;if(Rr){var c=sc,v=oc;c=(v&~(1<<32-pl(v)-1)).toString(32)+c,a=":"+a+"R"+c,c=lg++,0<c&&(a+="H"+c.toString(32)),a+=":"}else c=XD++,a=":"+a+"r"+c.toString(32)+":";return i.memoizedState=a},unstable_isNewReconciler:!1},nS={readContext:Pa,useCallback:lB,useContext:Pa,useEffect:XA,useImperativeHandle:aB,useInsertionEffect:iB,useLayoutEffect:oB,useMemo:uB,useReducer:nw,useRef:rB,useState:function(){return nw(ug)},useDebugValue:QA,useDeferredValue:function(i){var a=La();return cB(a,Di.memoizedState,i)},useTransition:function(){var i=nw(ug)[0],a=La().memoizedState;return[i,a]},useMutableSource:J2,useSyncExternalStore:X2,useId:hB,unstable_isNewReconciler:!1},rS={readContext:Pa,useCallback:lB,useContext:Pa,useEffect:XA,useImperativeHandle:aB,useInsertionEffect:iB,useLayoutEffect:oB,useMemo:uB,useReducer:rw,useRef:rB,useState:function(){return rw(ug)},useDebugValue:QA,useDeferredValue:function(i){var a=La();return Di===null?a.memoizedState=i:cB(a,Di.memoizedState,i)},useTransition:function(){var i=rw(ug)[0],a=La().memoizedState;return[i,a]},useMutableSource:J2,useSyncExternalStore:X2,useId:hB,unstable_isNewReconciler:!1};function sm(i,a){try{var c="",v=a;do c+=MT(v),v=v.return;while(v);var E=c}catch(D){E=`
Error generating stack: `+D.message+`
`+D.stack}return{value:i,source:a,stack:E,digest:null}}function iw(i,a,c){return{value:i,source:null,stack:c!=null?c:null,digest:a!=null?a:null}}function Xw(i,a){try{console.error(a.value)}catch(c){setTimeout(function(){throw c})}}var iS=typeof WeakMap=="function"?WeakMap:Map;function mB(i,a,c){c=ac(-1,c),c.tag=3,c.payload={element:null};var v=a.value;return c.callback=function(){av||(av=!0,aA=v),Xw(i,a)},c}function _B(i,a,c){c=ac(-1,c),c.tag=3;var v=i.type.getDerivedStateFromError;if(typeof v=="function"){var E=a.value;c.payload=function(){return v(E)},c.callback=function(){Xw(i,a)}}var D=i.stateNode;return D!==null&&typeof D.componentDidCatch=="function"&&(c.callback=function(){Xw(i,a),typeof v!="function"&&(kh===null?kh=new Set([this]):kh.add(this));var F=a.stack;this.componentDidCatch(a.value,{componentStack:F!==null?F:""})}),c}function bC(i,a,c){var v=i.pingCache;if(v===null){v=i.pingCache=new iS;var E=new Set;v.set(a,E)}else E=v.get(a),E===void 0&&(E=new Set,v.set(a,E));E.has(c)||(E.add(c),i=yS.bind(null,i,a,c),a.then(i,i))}function CC(i){do{var a;if((a=i.tag===13)&&(a=i.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return i;i=i.return}while(i!==null);return null}function EC(i,a,c,v,E){return(i.mode&1)===0?(i===a?i.flags|=65536:(i.flags|=128,c.flags|=131072,c.flags&=-52805,c.tag===1&&(c.alternate===null?c.tag=17:(a=ac(-1,1),a.tag=2,Mh(c,a,1))),c.lanes|=1),i):(i.flags|=65536,i.lanes=E,i)}var oS=dc.ReactCurrentOwner,ms=!1;function Oo(i,a,c,v){a.child=i===null?K2(a,null,c,v):im(a,i.child,c,v)}function BC(i,a,c,v,E){c=c.render;var D=a.ref;return Qp(a,E),v=ZA(i,a,c,v,D,E),c=JA(),i!==null&&!ms?(a.updateQueue=i.updateQueue,a.flags&=-2053,i.lanes&=~E,hc(i,a,E)):(Rr&&c&&RA(a),a.flags|=1,Oo(i,a,v,E),a.child)}function TC(i,a,c,v,E){if(i===null){var D=c.type;return typeof D=="function"&&!sb(D)&&D.defaultProps===void 0&&c.compare===null&&c.defaultProps===void 0?(a.tag=15,a.type=D,gB(i,a,D,v,E)):(i=G0(c.type,null,v,a,a.mode,E),i.ref=a.ref,i.return=a,a.child=i)}if(D=i.child,(i.lanes&E)===0){var F=D.memoizedProps;if(c=c.compare,c=c!==null?c:ng,c(F,v)&&i.ref===a.ref)return hc(i,a,E)}return a.flags|=1,i=Lh(D,v),i.ref=a.ref,i.return=a,a.child=i}function gB(i,a,c,v,E){if(i!==null){var D=i.memoizedProps;if(ng(D,v)&&i.ref===a.ref)if(ms=!1,a.pendingProps=v=D,(i.lanes&E)!==0)(i.flags&131072)!==0&&(ms=!0);else return a.lanes=i.lanes,hc(i,a,E)}return Qw(i,a,c,v,E)}function yB(i,a,c){var v=a.pendingProps,E=v.children,D=i!==null?i.memoizedState:null;if(v.mode==="hidden")if((a.mode&1)===0)a.memoizedState={baseLanes:0,cachePool:null,transitions:null},xr($p,js),js|=c;else{if((c&1073741824)===0)return i=D!==null?D.baseLanes|c:c,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:i,cachePool:null,transitions:null},a.updateQueue=null,xr($p,js),js|=i,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},v=D!==null?D.baseLanes:c,xr($p,js),js|=v}else D!==null?(v=D.baseLanes|c,a.memoizedState=null):v=c,xr($p,js),js|=v;return Oo(i,a,E,c),a.child}function vB(i,a){var c=a.ref;(i===null&&c!==null||i!==null&&i.ref!==c)&&(a.flags|=512,a.flags|=2097152)}function Qw(i,a,c,v,E){var D=gs(c)?Yd:Ao.current;return D=nm(a,D),Qp(a,E),c=ZA(i,a,c,v,D,E),v=JA(),i!==null&&!ms?(a.updateQueue=i.updateQueue,a.flags&=-2053,i.lanes&=~E,hc(i,a,E)):(Rr&&v&&RA(a),a.flags|=1,Oo(i,a,c,E),a.child)}function DC(i,a,c,v,E){if(gs(c)){var D=!0;X0(a)}else D=!1;if(Qp(a,E),a.stateNode===null)F0(i,a),$2(a,c,v),Jw(a,c,v,E),v=!0;else if(i===null){var F=a.stateNode,s=a.memoizedProps;F.props=s;var N=F.context,pe=c.contextType;typeof pe=="object"&&pe!==null?pe=Pa(pe):(pe=gs(c)?Yd:Ao.current,pe=nm(a,pe));var Re=c.getDerivedStateFromProps,we=typeof Re=="function"||typeof F.getSnapshotBeforeUpdate=="function";we||typeof F.UNSAFE_componentWillReceiveProps!="function"&&typeof F.componentWillReceiveProps!="function"||(s!==v||N!==pe)&&vC(a,F,v,pe),Ah=!1;var Ae=a.memoizedState;F.state=Ae,nv(a,v,F,E),N=a.memoizedState,s!==v||Ae!==N||_s.current||Ah?(typeof Re=="function"&&(Zw(a,c,Re,v),N=a.memoizedState),(s=Ah||yC(a,c,s,v,Ae,N,pe))?(we||typeof F.UNSAFE_componentWillMount!="function"&&typeof F.componentWillMount!="function"||(typeof F.componentWillMount=="function"&&F.componentWillMount(),typeof F.UNSAFE_componentWillMount=="function"&&F.UNSAFE_componentWillMount()),typeof F.componentDidMount=="function"&&(a.flags|=4194308)):(typeof F.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=v,a.memoizedState=N),F.props=v,F.state=N,F.context=pe,v=s):(typeof F.componentDidMount=="function"&&(a.flags|=4194308),v=!1)}else{F=a.stateNode,V2(i,a),s=a.memoizedProps,pe=a.type===a.elementType?s:hl(a.type,s),F.props=pe,we=a.pendingProps,Ae=F.context,N=c.contextType,typeof N=="object"&&N!==null?N=Pa(N):(N=gs(c)?Yd:Ao.current,N=nm(a,N));var $e=c.getDerivedStateFromProps;(Re=typeof $e=="function"||typeof F.getSnapshotBeforeUpdate=="function")||typeof F.UNSAFE_componentWillReceiveProps!="function"&&typeof F.componentWillReceiveProps!="function"||(s!==we||Ae!==N)&&vC(a,F,v,N),Ah=!1,Ae=a.memoizedState,F.state=Ae,nv(a,v,F,E);var Qe=a.memoizedState;s!==we||Ae!==Qe||_s.current||Ah?(typeof $e=="function"&&(Zw(a,c,$e,v),Qe=a.memoizedState),(pe=Ah||yC(a,c,pe,v,Ae,Qe,N)||!1)?(Re||typeof F.UNSAFE_componentWillUpdate!="function"&&typeof F.componentWillUpdate!="function"||(typeof F.componentWillUpdate=="function"&&F.componentWillUpdate(v,Qe,N),typeof F.UNSAFE_componentWillUpdate=="function"&&F.UNSAFE_componentWillUpdate(v,Qe,N)),typeof F.componentDidUpdate=="function"&&(a.flags|=4),typeof F.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof F.componentDidUpdate!="function"||s===i.memoizedProps&&Ae===i.memoizedState||(a.flags|=4),typeof F.getSnapshotBeforeUpdate!="function"||s===i.memoizedProps&&Ae===i.memoizedState||(a.flags|=1024),a.memoizedProps=v,a.memoizedState=Qe),F.props=v,F.state=Qe,F.context=N,v=pe):(typeof F.componentDidUpdate!="function"||s===i.memoizedProps&&Ae===i.memoizedState||(a.flags|=4),typeof F.getSnapshotBeforeUpdate!="function"||s===i.memoizedProps&&Ae===i.memoizedState||(a.flags|=1024),v=!1)}return Yw(i,a,c,v,D,E)}function Yw(i,a,c,v,E,D){vB(i,a);var F=(a.flags&128)!==0;if(!v&&!F)return E&&fC(a,c,!1),hc(i,a,D);v=a.stateNode,oS.current=a;var s=F&&typeof c.getDerivedStateFromError!="function"?null:v.render();return a.flags|=1,i!==null&&F?(a.child=im(a,i.child,null,D),a.child=im(a,null,s,D)):Oo(i,a,s,D),a.memoizedState=v.state,E&&fC(a,c,!0),a.child}function xB(i){var a=i.stateNode;a.pendingContext?dC(i,a.pendingContext,a.pendingContext!==a.context):a.context&&dC(i,a.context,!1),HA(i,a.containerInfo)}function SC(i,a,c,v,E){return rm(),GA(E),a.flags|=256,Oo(i,a,c,v),a.child}var eA={dehydrated:null,treeContext:null,retryLane:0};function tA(i){return{baseLanes:i,cachePool:null,transitions:null}}function wB(i,a,c){var v=a.pendingProps,E=Vr.current,D=!1,F=(a.flags&128)!==0,s;if((s=F)||(s=i!==null&&i.memoizedState===null?!1:(E&2)!==0),s?(D=!0,a.flags&=-129):(i===null||i.memoizedState!==null)&&(E|=1),xr(Vr,E&1),i===null)return Ww(a),i=a.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((a.mode&1)===0?a.lanes=1:i.data==="$!"?a.lanes=8:a.lanes=1073741824,null):(F=v.children,i=v.fallback,D?(v=a.mode,D=a.child,F={mode:"hidden",children:F},(v&1)===0&&D!==null?(D.childLanes=0,D.pendingProps=F):D=wv(F,v,0,null),i=Qd(i,v,c,null),D.return=a,i.return=a,D.sibling=i,a.child=D,a.child.memoizedState=tA(c),a.memoizedState=eA,i):YA(a,F));if(E=i.memoizedState,E!==null&&(s=E.dehydrated,s!==null))return sS(i,a,F,v,s,E,c);if(D){D=v.fallback,F=a.mode,E=i.child,s=E.sibling;var N={mode:"hidden",children:v.children};return(F&1)===0&&a.child!==E?(v=a.child,v.childLanes=0,v.pendingProps=N,a.deletions=null):(v=Lh(E,N),v.subtreeFlags=E.subtreeFlags&14680064),s!==null?D=Lh(s,D):(D=Qd(D,F,c,null),D.flags|=2),D.return=a,v.return=a,v.sibling=D,a.child=v,v=D,D=a.child,F=i.child.memoizedState,F=F===null?tA(c):{baseLanes:F.baseLanes|c,cachePool:null,transitions:F.transitions},D.memoizedState=F,D.childLanes=i.childLanes&~c,a.memoizedState=eA,v}return D=i.child,i=D.sibling,v=Lh(D,{mode:"visible",children:v.children}),(a.mode&1)===0&&(v.lanes=c),v.return=a,v.sibling=null,i!==null&&(c=a.deletions,c===null?(a.deletions=[i],a.flags|=16):c.push(i)),a.child=v,a.memoizedState=null,v}function YA(i,a){return a=wv({mode:"visible",children:a},i.mode,0,null),a.return=i,i.child=a}function y0(i,a,c,v){return v!==null&&GA(v),im(a,i.child,null,c),i=YA(a,a.pendingProps.children),i.flags|=2,a.memoizedState=null,i}function sS(i,a,c,v,E,D,F){if(c)return a.flags&256?(a.flags&=-257,v=iw(Error(_t(422))),y0(i,a,F,v)):a.memoizedState!==null?(a.child=i.child,a.flags|=128,null):(D=v.fallback,E=a.mode,v=wv({mode:"visible",children:v.children},E,0,null),D=Qd(D,E,F,null),D.flags|=2,v.return=a,D.return=a,v.sibling=D,a.child=v,(a.mode&1)!==0&&im(a,i.child,null,F),a.child.memoizedState=tA(F),a.memoizedState=eA,D);if((a.mode&1)===0)return y0(i,a,F,null);if(E.data==="$!"){if(v=E.nextSibling&&E.nextSibling.dataset,v)var s=v.dgst;return v=s,D=Error(_t(419)),v=iw(D,v,void 0),y0(i,a,F,v)}if(s=(F&i.childLanes)!==0,ms||s){if(v=Ni,v!==null){switch(F&-F){case 4:E=2;break;case 16:E=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:E=32;break;case 536870912:E=268435456;break;default:E=0}E=(E&(v.suspendedLanes|F))!==0?0:E,E!==0&&E!==D.retryLane&&(D.retryLane=E,cc(i,E),ml(v,i,E,-1))}return ob(),v=iw(Error(_t(421))),y0(i,a,F,v)}return E.data==="$?"?(a.flags|=128,a.child=i.child,a=vS.bind(null,i),E._reactRetry=a,null):(i=D.treeContext,Vs=Ih(E.nextSibling),Hs=a,Rr=!0,fl=null,i!==null&&(Sa[Ia++]=oc,Sa[Ia++]=sc,Sa[Ia++]=ef,oc=i.id,sc=i.overflow,ef=a),a=YA(a,v.children),a.flags|=4096,a)}function IC(i,a,c){i.lanes|=a;var v=i.alternate;v!==null&&(v.lanes|=a),Kw(i.return,a,c)}function ow(i,a,c,v,E){var D=i.memoizedState;D===null?i.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:v,tail:c,tailMode:E}:(D.isBackwards=a,D.rendering=null,D.renderingStartTime=0,D.last=v,D.tail=c,D.tailMode=E)}function AB(i,a,c){var v=a.pendingProps,E=v.revealOrder,D=v.tail;if(Oo(i,a,v.children,c),v=Vr.current,(v&2)!==0)v=v&1|2,a.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=a.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&IC(i,c,a);else if(i.tag===19)IC(i,c,a);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===a)break e;for(;i.sibling===null;){if(i.return===null||i.return===a)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}v&=1}if(xr(Vr,v),(a.mode&1)===0)a.memoizedState=null;else switch(E){case"forwards":for(c=a.child,E=null;c!==null;)i=c.alternate,i!==null&&rv(i)===null&&(E=c),c=c.sibling;c=E,c===null?(E=a.child,a.child=null):(E=c.sibling,c.sibling=null),ow(a,!1,E,c,D);break;case"backwards":for(c=null,E=a.child,a.child=null;E!==null;){if(i=E.alternate,i!==null&&rv(i)===null){a.child=E;break}i=E.sibling,E.sibling=c,c=E,E=i}ow(a,!0,c,null,D);break;case"together":ow(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function F0(i,a){(a.mode&1)===0&&i!==null&&(i.alternate=null,a.alternate=null,a.flags|=2)}function hc(i,a,c){if(i!==null&&(a.dependencies=i.dependencies),nf|=a.lanes,(c&a.childLanes)===0)return null;if(i!==null&&a.child!==i.child)throw Error(_t(153));if(a.child!==null){for(i=a.child,c=Lh(i,i.pendingProps),a.child=c,c.return=a;i.sibling!==null;)i=i.sibling,c=c.sibling=Lh(i,i.pendingProps),c.return=a;c.sibling=null}return a.child}function aS(i,a,c){switch(a.tag){case 3:xB(a),rm();break;case 5:Z2(a);break;case 1:gs(a.type)&&X0(a);break;case 4:HA(a,a.stateNode.containerInfo);break;case 10:var v=a.type._context,E=a.memoizedProps.value;xr(ev,v._currentValue),v._currentValue=E;break;case 13:if(v=a.memoizedState,v!==null)return v.dehydrated!==null?(xr(Vr,Vr.current&1),a.flags|=128,null):(c&a.child.childLanes)!==0?wB(i,a,c):(xr(Vr,Vr.current&1),i=hc(i,a,c),i!==null?i.sibling:null);xr(Vr,Vr.current&1);break;case 19:if(v=(c&a.childLanes)!==0,(i.flags&128)!==0){if(v)return AB(i,a,c);a.flags|=128}if(E=a.memoizedState,E!==null&&(E.rendering=null,E.tail=null,E.lastEffect=null),xr(Vr,Vr.current),v)break;return null;case 22:case 23:return a.lanes=0,yB(i,a,c)}return hc(i,a,c)}var bB,nA,CB,EB;bB=function(i,a){for(var c=a.child;c!==null;){if(c.tag===5||c.tag===6)i.appendChild(c.stateNode);else if(c.tag!==4&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return;c=c.return}c.sibling.return=c.return,c=c.sibling}};nA=function(){};CB=function(i,a,c,v){var E=i.memoizedProps;if(E!==v){i=a.stateNode,Jd(_u.current);var D=null;switch(c){case"input":E=Cw(i,E),v=Cw(i,v),D=[];break;case"select":E=$r({},E,{value:void 0}),v=$r({},v,{value:void 0}),D=[];break;case"textarea":E=Tw(i,E),v=Tw(i,v),D=[];break;default:typeof E.onClick!="function"&&typeof v.onClick=="function"&&(i.onclick=Z0)}Sw(c,v);var F;c=null;for(pe in E)if(!v.hasOwnProperty(pe)&&E.hasOwnProperty(pe)&&E[pe]!=null)if(pe==="style"){var s=E[pe];for(F in s)s.hasOwnProperty(F)&&(c||(c={}),c[F]="")}else pe!=="dangerouslySetInnerHTML"&&pe!=="children"&&pe!=="suppressContentEditableWarning"&&pe!=="suppressHydrationWarning"&&pe!=="autoFocus"&&(Z_.hasOwnProperty(pe)?D||(D=[]):(D=D||[]).push(pe,null));for(pe in v){var N=v[pe];if(s=E!=null?E[pe]:void 0,v.hasOwnProperty(pe)&&N!==s&&(N!=null||s!=null))if(pe==="style")if(s){for(F in s)!s.hasOwnProperty(F)||N&&N.hasOwnProperty(F)||(c||(c={}),c[F]="");for(F in N)N.hasOwnProperty(F)&&s[F]!==N[F]&&(c||(c={}),c[F]=N[F])}else c||(D||(D=[]),D.push(pe,c)),c=N;else pe==="dangerouslySetInnerHTML"?(N=N?N.__html:void 0,s=s?s.__html:void 0,N!=null&&s!==N&&(D=D||[]).push(pe,N)):pe==="children"?typeof N!="string"&&typeof N!="number"||(D=D||[]).push(pe,""+N):pe!=="suppressContentEditableWarning"&&pe!=="suppressHydrationWarning"&&(Z_.hasOwnProperty(pe)?(N!=null&&pe==="onScroll"&&Br("scroll",i),D||s===N||(D=[])):(D=D||[]).push(pe,N))}c&&(D=D||[]).push("style",c);var pe=D;(a.updateQueue=pe)&&(a.flags|=4)}};EB=function(i,a,c,v){c!==v&&(a.flags|=4)};function P_(i,a){if(!Rr)switch(i.tailMode){case"hidden":a=i.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?i.tail=null:c.sibling=null;break;case"collapsed":c=i.tail;for(var v=null;c!==null;)c.alternate!==null&&(v=c),c=c.sibling;v===null?a||i.tail===null?i.tail=null:i.tail.sibling=null:v.sibling=null}}function xo(i){var a=i.alternate!==null&&i.alternate.child===i.child,c=0,v=0;if(a)for(var E=i.child;E!==null;)c|=E.lanes|E.childLanes,v|=E.subtreeFlags&14680064,v|=E.flags&14680064,E.return=i,E=E.sibling;else for(E=i.child;E!==null;)c|=E.lanes|E.childLanes,v|=E.subtreeFlags,v|=E.flags,E.return=i,E=E.sibling;return i.subtreeFlags|=v,i.childLanes=c,a}function lS(i,a,c){var v=a.pendingProps;switch(OA(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xo(a),null;case 1:return gs(a.type)&&J0(),xo(a),null;case 3:return v=a.stateNode,om(),Tr(_s),Tr(Ao),WA(),v.pendingContext&&(v.context=v.pendingContext,v.pendingContext=null),(i===null||i.child===null)&&(_0(a)?a.flags|=4:i===null||i.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,fl!==null&&(cA(fl),fl=null))),nA(i,a),xo(a),null;case 5:$A(a);var E=Jd(ag.current);if(c=a.type,i!==null&&a.stateNode!=null)CB(i,a,c,v,E),i.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!v){if(a.stateNode===null)throw Error(_t(166));return xo(a),null}if(i=Jd(_u.current),_0(a)){v=a.stateNode,c=a.type;var D=a.memoizedProps;switch(v[fu]=a,v[og]=D,i=(a.mode&1)!==0,c){case"dialog":Br("cancel",v),Br("close",v);break;case"iframe":case"object":case"embed":Br("load",v);break;case"video":case"audio":for(E=0;E<G_.length;E++)Br(G_[E],v);break;case"source":Br("error",v);break;case"img":case"image":case"link":Br("error",v),Br("load",v);break;case"details":Br("toggle",v);break;case"input":Gb(v,D),Br("invalid",v);break;case"select":v._wrapperState={wasMultiple:!!D.multiple},Br("invalid",v);break;case"textarea":Ub(v,D),Br("invalid",v)}Sw(c,D),E=null;for(var F in D)if(D.hasOwnProperty(F)){var s=D[F];F==="children"?typeof s=="string"?v.textContent!==s&&(D.suppressHydrationWarning!==!0&&m0(v.textContent,s,i),E=["children",s]):typeof s=="number"&&v.textContent!==""+s&&(D.suppressHydrationWarning!==!0&&m0(v.textContent,s,i),E=["children",""+s]):Z_.hasOwnProperty(F)&&s!=null&&F==="onScroll"&&Br("scroll",v)}switch(c){case"input":a0(v),Nb(v,D,!0);break;case"textarea":a0(v),qb(v);break;case"select":case"option":break;default:typeof D.onClick=="function"&&(v.onclick=Z0)}v=E,a.updateQueue=v,v!==null&&(a.flags|=4)}else{F=E.nodeType===9?E:E.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=QE(c)),i==="http://www.w3.org/1999/xhtml"?c==="script"?(i=F.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof v.is=="string"?i=F.createElement(c,{is:v.is}):(i=F.createElement(c),c==="select"&&(F=i,v.multiple?F.multiple=!0:v.size&&(F.size=v.size))):i=F.createElementNS(i,c),i[fu]=a,i[og]=v,bB(i,a,!1,!1),a.stateNode=i;e:{switch(F=Iw(c,v),c){case"dialog":Br("cancel",i),Br("close",i),E=v;break;case"iframe":case"object":case"embed":Br("load",i),E=v;break;case"video":case"audio":for(E=0;E<G_.length;E++)Br(G_[E],i);E=v;break;case"source":Br("error",i),E=v;break;case"img":case"image":case"link":Br("error",i),Br("load",i),E=v;break;case"details":Br("toggle",i),E=v;break;case"input":Gb(i,v),E=Cw(i,v),Br("invalid",i);break;case"option":E=v;break;case"select":i._wrapperState={wasMultiple:!!v.multiple},E=$r({},v,{value:void 0}),Br("invalid",i);break;case"textarea":Ub(i,v),E=Tw(i,v),Br("invalid",i);break;default:E=v}Sw(c,E),s=E;for(D in s)if(s.hasOwnProperty(D)){var N=s[D];D==="style"?t2(i,N):D==="dangerouslySetInnerHTML"?(N=N?N.__html:void 0,N!=null&&YE(i,N)):D==="children"?typeof N=="string"?(c!=="textarea"||N!=="")&&J_(i,N):typeof N=="number"&&J_(i,""+N):D!=="suppressContentEditableWarning"&&D!=="suppressHydrationWarning"&&D!=="autoFocus"&&(Z_.hasOwnProperty(D)?N!=null&&D==="onScroll"&&Br("scroll",i):N!=null&&bA(i,D,N,F))}switch(c){case"input":a0(i),Nb(i,v,!1);break;case"textarea":a0(i),qb(i);break;case"option":v.value!=null&&i.setAttribute("value",""+zh(v.value));break;case"select":i.multiple=!!v.multiple,D=v.value,D!=null?Kp(i,!!v.multiple,D,!1):v.defaultValue!=null&&Kp(i,!!v.multiple,v.defaultValue,!0);break;default:typeof E.onClick=="function"&&(i.onclick=Z0)}switch(c){case"button":case"input":case"select":case"textarea":v=!!v.autoFocus;break e;case"img":v=!0;break e;default:v=!1}}v&&(a.flags|=4)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return xo(a),null;case 6:if(i&&a.stateNode!=null)EB(i,a,i.memoizedProps,v);else{if(typeof v!="string"&&a.stateNode===null)throw Error(_t(166));if(c=Jd(ag.current),Jd(_u.current),_0(a)){if(v=a.stateNode,c=a.memoizedProps,v[fu]=a,(D=v.nodeValue!==c)&&(i=Hs,i!==null))switch(i.tag){case 3:m0(v.nodeValue,c,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&m0(v.nodeValue,c,(i.mode&1)!==0)}D&&(a.flags|=4)}else v=(c.nodeType===9?c:c.ownerDocument).createTextNode(v),v[fu]=a,a.stateNode=v}return xo(a),null;case 13:if(Tr(Vr),v=a.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(Rr&&Vs!==null&&(a.mode&1)!==0&&(a.flags&128)===0)q2(),rm(),a.flags|=98560,D=!1;else if(D=_0(a),v!==null&&v.dehydrated!==null){if(i===null){if(!D)throw Error(_t(318));if(D=a.memoizedState,D=D!==null?D.dehydrated:null,!D)throw Error(_t(317));D[fu]=a}else rm(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;xo(a),D=!1}else fl!==null&&(cA(fl),fl=null),D=!0;if(!D)return a.flags&65536?a:null}return(a.flags&128)!==0?(a.lanes=c,a):(v=v!==null,v!==(i!==null&&i.memoizedState!==null)&&v&&(a.child.flags|=8192,(a.mode&1)!==0&&(i===null||(Vr.current&1)!==0?Si===0&&(Si=3):ob())),a.updateQueue!==null&&(a.flags|=4),xo(a),null);case 4:return om(),nA(i,a),i===null&&rg(a.stateNode.containerInfo),xo(a),null;case 10:return qA(a.type._context),xo(a),null;case 17:return gs(a.type)&&J0(),xo(a),null;case 19:if(Tr(Vr),D=a.memoizedState,D===null)return xo(a),null;if(v=(a.flags&128)!==0,F=D.rendering,F===null)if(v)P_(D,!1);else{if(Si!==0||i!==null&&(i.flags&128)!==0)for(i=a.child;i!==null;){if(F=rv(i),F!==null){for(a.flags|=128,P_(D,!1),v=F.updateQueue,v!==null&&(a.updateQueue=v,a.flags|=4),a.subtreeFlags=0,v=c,c=a.child;c!==null;)D=c,i=v,D.flags&=14680066,F=D.alternate,F===null?(D.childLanes=0,D.lanes=i,D.child=null,D.subtreeFlags=0,D.memoizedProps=null,D.memoizedState=null,D.updateQueue=null,D.dependencies=null,D.stateNode=null):(D.childLanes=F.childLanes,D.lanes=F.lanes,D.child=F.child,D.subtreeFlags=0,D.deletions=null,D.memoizedProps=F.memoizedProps,D.memoizedState=F.memoizedState,D.updateQueue=F.updateQueue,D.type=F.type,i=F.dependencies,D.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),c=c.sibling;return xr(Vr,Vr.current&1|2),a.child}i=i.sibling}D.tail!==null&&ni()>am&&(a.flags|=128,v=!0,P_(D,!1),a.lanes=4194304)}else{if(!v)if(i=rv(F),i!==null){if(a.flags|=128,v=!0,c=i.updateQueue,c!==null&&(a.updateQueue=c,a.flags|=4),P_(D,!0),D.tail===null&&D.tailMode==="hidden"&&!F.alternate&&!Rr)return xo(a),null}else 2*ni()-D.renderingStartTime>am&&c!==1073741824&&(a.flags|=128,v=!0,P_(D,!1),a.lanes=4194304);D.isBackwards?(F.sibling=a.child,a.child=F):(c=D.last,c!==null?c.sibling=F:a.child=F,D.last=F)}return D.tail!==null?(a=D.tail,D.rendering=a,D.tail=a.sibling,D.renderingStartTime=ni(),a.sibling=null,c=Vr.current,xr(Vr,v?c&1|2:c&1),a):(xo(a),null);case 22:case 23:return ib(),v=a.memoizedState!==null,i!==null&&i.memoizedState!==null!==v&&(a.flags|=8192),v&&(a.mode&1)!==0?(js&1073741824)!==0&&(xo(a),a.subtreeFlags&6&&(a.flags|=8192)):xo(a),null;case 24:return null;case 25:return null}throw Error(_t(156,a.tag))}function uS(i,a){switch(OA(a),a.tag){case 1:return gs(a.type)&&J0(),i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 3:return om(),Tr(_s),Tr(Ao),WA(),i=a.flags,(i&65536)!==0&&(i&128)===0?(a.flags=i&-65537|128,a):null;case 5:return $A(a),null;case 13:if(Tr(Vr),i=a.memoizedState,i!==null&&i.dehydrated!==null){if(a.alternate===null)throw Error(_t(340));rm()}return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 19:return Tr(Vr),null;case 4:return om(),null;case 10:return qA(a.type._context),null;case 22:case 23:return ib(),null;case 24:return null;default:return null}}var v0=!1,wo=!1,cS=typeof WeakSet=="function"?WeakSet:Set,qt=null;function Hp(i,a){var c=i.ref;if(c!==null)if(typeof c=="function")try{c(null)}catch(v){Zr(i,a,v)}else c.current=null}function rA(i,a,c){try{c()}catch(v){Zr(i,a,v)}}var MC=!1;function hS(i,a){if(Nw=$0,i=S2(),FA(i)){if("selectionStart"in i)var c={start:i.selectionStart,end:i.selectionEnd};else e:{c=(c=i.ownerDocument)&&c.defaultView||window;var v=c.getSelection&&c.getSelection();if(v&&v.rangeCount!==0){c=v.anchorNode;var E=v.anchorOffset,D=v.focusNode;v=v.focusOffset;try{c.nodeType,D.nodeType}catch{c=null;break e}var F=0,s=-1,N=-1,pe=0,Re=0,we=i,Ae=null;t:for(;;){for(var $e;we!==c||E!==0&&we.nodeType!==3||(s=F+E),we!==D||v!==0&&we.nodeType!==3||(N=F+v),we.nodeType===3&&(F+=we.nodeValue.length),($e=we.firstChild)!==null;)Ae=we,we=$e;for(;;){if(we===i)break t;if(Ae===c&&++pe===E&&(s=F),Ae===D&&++Re===v&&(N=F),($e=we.nextSibling)!==null)break;we=Ae,Ae=we.parentNode}we=$e}c=s===-1||N===-1?null:{start:s,end:N}}else c=null}c=c||{start:0,end:0}}else c=null;for(Uw={focusedElem:i,selectionRange:c},$0=!1,qt=a;qt!==null;)if(a=qt,i=a.child,(a.subtreeFlags&1028)!==0&&i!==null)i.return=a,qt=i;else for(;qt!==null;){a=qt;try{var Qe=a.alternate;if((a.flags&1024)!==0)switch(a.tag){case 0:case 11:case 15:break;case 1:if(Qe!==null){var ot=Qe.memoizedProps,Vt=Qe.memoizedState,be=a.stateNode,ge=be.getSnapshotBeforeUpdate(a.elementType===a.type?ot:hl(a.type,ot),Vt);be.__reactInternalSnapshotBeforeUpdate=ge}break;case 3:var Be=a.stateNode.containerInfo;Be.nodeType===1?Be.textContent="":Be.nodeType===9&&Be.documentElement&&Be.removeChild(Be.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(_t(163))}}catch(Xe){Zr(a,a.return,Xe)}if(i=a.sibling,i!==null){i.return=a.return,qt=i;break}qt=a.return}return Qe=MC,MC=!1,Qe}function $_(i,a,c){var v=a.updateQueue;if(v=v!==null?v.lastEffect:null,v!==null){var E=v=v.next;do{if((E.tag&i)===i){var D=E.destroy;E.destroy=void 0,D!==void 0&&rA(a,c,D)}E=E.next}while(E!==v)}}function vv(i,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var c=a=a.next;do{if((c.tag&i)===i){var v=c.create;c.destroy=v()}c=c.next}while(c!==a)}}function iA(i){var a=i.ref;if(a!==null){var c=i.stateNode;switch(i.tag){case 5:i=c;break;default:i=c}typeof a=="function"?a(i):a.current=i}}function BB(i){var a=i.alternate;a!==null&&(i.alternate=null,BB(a)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(a=i.stateNode,a!==null&&(delete a[fu],delete a[og],delete a[Vw],delete a[WD],delete a[KD])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function TB(i){return i.tag===5||i.tag===3||i.tag===4}function kC(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||TB(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function oA(i,a,c){var v=i.tag;if(v===5||v===6)i=i.stateNode,a?c.nodeType===8?c.parentNode.insertBefore(i,a):c.insertBefore(i,a):(c.nodeType===8?(a=c.parentNode,a.insertBefore(i,c)):(a=c,a.appendChild(i)),c=c._reactRootContainer,c!=null||a.onclick!==null||(a.onclick=Z0));else if(v!==4&&(i=i.child,i!==null))for(oA(i,a,c),i=i.sibling;i!==null;)oA(i,a,c),i=i.sibling}function sA(i,a,c){var v=i.tag;if(v===5||v===6)i=i.stateNode,a?c.insertBefore(i,a):c.appendChild(i);else if(v!==4&&(i=i.child,i!==null))for(sA(i,a,c),i=i.sibling;i!==null;)sA(i,a,c),i=i.sibling}var Zi=null,dl=!1;function xh(i,a,c){for(c=c.child;c!==null;)DB(i,a,c),c=c.sibling}function DB(i,a,c){if(mu&&typeof mu.onCommitFiberUnmount=="function")try{mu.onCommitFiberUnmount(hv,c)}catch{}switch(c.tag){case 5:wo||Hp(c,a);case 6:var v=Zi,E=dl;Zi=null,xh(i,a,c),Zi=v,dl=E,Zi!==null&&(dl?(i=Zi,c=c.stateNode,i.nodeType===8?i.parentNode.removeChild(c):i.removeChild(c)):Zi.removeChild(c.stateNode));break;case 18:Zi!==null&&(dl?(i=Zi,c=c.stateNode,i.nodeType===8?Q1(i.parentNode,c):i.nodeType===1&&Q1(i,c),eg(i)):Q1(Zi,c.stateNode));break;case 4:v=Zi,E=dl,Zi=c.stateNode.containerInfo,dl=!0,xh(i,a,c),Zi=v,dl=E;break;case 0:case 11:case 14:case 15:if(!wo&&(v=c.updateQueue,v!==null&&(v=v.lastEffect,v!==null))){E=v=v.next;do{var D=E,F=D.destroy;D=D.tag,F!==void 0&&((D&2)!==0||(D&4)!==0)&&rA(c,a,F),E=E.next}while(E!==v)}xh(i,a,c);break;case 1:if(!wo&&(Hp(c,a),v=c.stateNode,typeof v.componentWillUnmount=="function"))try{v.props=c.memoizedProps,v.state=c.memoizedState,v.componentWillUnmount()}catch(s){Zr(c,a,s)}xh(i,a,c);break;case 21:xh(i,a,c);break;case 22:c.mode&1?(wo=(v=wo)||c.memoizedState!==null,xh(i,a,c),wo=v):xh(i,a,c);break;default:xh(i,a,c)}}function PC(i){var a=i.updateQueue;if(a!==null){i.updateQueue=null;var c=i.stateNode;c===null&&(c=i.stateNode=new cS),a.forEach(function(v){var E=xS.bind(null,i,v);c.has(v)||(c.add(v),v.then(E,E))})}}function cl(i,a){var c=a.deletions;if(c!==null)for(var v=0;v<c.length;v++){var E=c[v];try{var D=i,F=a,s=F;e:for(;s!==null;){switch(s.tag){case 5:Zi=s.stateNode,dl=!1;break e;case 3:Zi=s.stateNode.containerInfo,dl=!0;break e;case 4:Zi=s.stateNode.containerInfo,dl=!0;break e}s=s.return}if(Zi===null)throw Error(_t(160));DB(D,F,E),Zi=null,dl=!1;var N=E.alternate;N!==null&&(N.return=null),E.return=null}catch(pe){Zr(E,a,pe)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)SB(a,i),a=a.sibling}function SB(i,a){var c=i.alternate,v=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(cl(a,i),cu(i),v&4){try{$_(3,i,i.return),vv(3,i)}catch(ot){Zr(i,i.return,ot)}try{$_(5,i,i.return)}catch(ot){Zr(i,i.return,ot)}}break;case 1:cl(a,i),cu(i),v&512&&c!==null&&Hp(c,c.return);break;case 5:if(cl(a,i),cu(i),v&512&&c!==null&&Hp(c,c.return),i.flags&32){var E=i.stateNode;try{J_(E,"")}catch(ot){Zr(i,i.return,ot)}}if(v&4&&(E=i.stateNode,E!=null)){var D=i.memoizedProps,F=c!==null?c.memoizedProps:D,s=i.type,N=i.updateQueue;if(i.updateQueue=null,N!==null)try{s==="input"&&D.type==="radio"&&D.name!=null&&JE(E,D),Iw(s,F);var pe=Iw(s,D);for(F=0;F<N.length;F+=2){var Re=N[F],we=N[F+1];Re==="style"?t2(E,we):Re==="dangerouslySetInnerHTML"?YE(E,we):Re==="children"?J_(E,we):bA(E,Re,we,pe)}switch(s){case"input":Ew(E,D);break;case"textarea":XE(E,D);break;case"select":var Ae=E._wrapperState.wasMultiple;E._wrapperState.wasMultiple=!!D.multiple;var $e=D.value;$e!=null?Kp(E,!!D.multiple,$e,!1):Ae!==!!D.multiple&&(D.defaultValue!=null?Kp(E,!!D.multiple,D.defaultValue,!0):Kp(E,!!D.multiple,D.multiple?[]:"",!1))}E[og]=D}catch(ot){Zr(i,i.return,ot)}}break;case 6:if(cl(a,i),cu(i),v&4){if(i.stateNode===null)throw Error(_t(162));E=i.stateNode,D=i.memoizedProps;try{E.nodeValue=D}catch(ot){Zr(i,i.return,ot)}}break;case 3:if(cl(a,i),cu(i),v&4&&c!==null&&c.memoizedState.isDehydrated)try{eg(a.containerInfo)}catch(ot){Zr(i,i.return,ot)}break;case 4:cl(a,i),cu(i);break;case 13:cl(a,i),cu(i),E=i.child,E.flags&8192&&(D=E.memoizedState!==null,E.stateNode.isHidden=D,!D||E.alternate!==null&&E.alternate.memoizedState!==null||(nb=ni())),v&4&&PC(i);break;case 22:if(Re=c!==null&&c.memoizedState!==null,i.mode&1?(wo=(pe=wo)||Re,cl(a,i),wo=pe):cl(a,i),cu(i),v&8192){if(pe=i.memoizedState!==null,(i.stateNode.isHidden=pe)&&!Re&&(i.mode&1)!==0)for(qt=i,Re=i.child;Re!==null;){for(we=qt=Re;qt!==null;){switch(Ae=qt,$e=Ae.child,Ae.tag){case 0:case 11:case 14:case 15:$_(4,Ae,Ae.return);break;case 1:Hp(Ae,Ae.return);var Qe=Ae.stateNode;if(typeof Qe.componentWillUnmount=="function"){v=Ae,c=Ae.return;try{a=v,Qe.props=a.memoizedProps,Qe.state=a.memoizedState,Qe.componentWillUnmount()}catch(ot){Zr(v,c,ot)}}break;case 5:Hp(Ae,Ae.return);break;case 22:if(Ae.memoizedState!==null){zC(we);continue}}$e!==null?($e.return=Ae,qt=$e):zC(we)}Re=Re.sibling}e:for(Re=null,we=i;;){if(we.tag===5){if(Re===null){Re=we;try{E=we.stateNode,pe?(D=E.style,typeof D.setProperty=="function"?D.setProperty("display","none","important"):D.display="none"):(s=we.stateNode,N=we.memoizedProps.style,F=N!=null&&N.hasOwnProperty("display")?N.display:null,s.style.display=e2("display",F))}catch(ot){Zr(i,i.return,ot)}}}else if(we.tag===6){if(Re===null)try{we.stateNode.nodeValue=pe?"":we.memoizedProps}catch(ot){Zr(i,i.return,ot)}}else if((we.tag!==22&&we.tag!==23||we.memoizedState===null||we===i)&&we.child!==null){we.child.return=we,we=we.child;continue}if(we===i)break e;for(;we.sibling===null;){if(we.return===null||we.return===i)break e;Re===we&&(Re=null),we=we.return}Re===we&&(Re=null),we.sibling.return=we.return,we=we.sibling}}break;case 19:cl(a,i),cu(i),v&4&&PC(i);break;case 21:break;default:cl(a,i),cu(i)}}function cu(i){var a=i.flags;if(a&2){try{e:{for(var c=i.return;c!==null;){if(TB(c)){var v=c;break e}c=c.return}throw Error(_t(160))}switch(v.tag){case 5:var E=v.stateNode;v.flags&32&&(J_(E,""),v.flags&=-33);var D=kC(i);sA(i,D,E);break;case 3:case 4:var F=v.stateNode.containerInfo,s=kC(i);oA(i,s,F);break;default:throw Error(_t(161))}}catch(N){Zr(i,i.return,N)}i.flags&=-3}a&4096&&(i.flags&=-4097)}function dS(i,a,c){qt=i,IB(i)}function IB(i,a,c){for(var v=(i.mode&1)!==0;qt!==null;){var E=qt,D=E.child;if(E.tag===22&&v){var F=E.memoizedState!==null||v0;if(!F){var s=E.alternate,N=s!==null&&s.memoizedState!==null||wo;s=v0;var pe=wo;if(v0=F,(wo=N)&&!pe)for(qt=E;qt!==null;)F=qt,N=F.child,F.tag===22&&F.memoizedState!==null?FC(E):N!==null?(N.return=F,qt=N):FC(E);for(;D!==null;)qt=D,IB(D),D=D.sibling;qt=E,v0=s,wo=pe}LC(i)}else(E.subtreeFlags&8772)!==0&&D!==null?(D.return=E,qt=D):LC(i)}}function LC(i){for(;qt!==null;){var a=qt;if((a.flags&8772)!==0){var c=a.alternate;try{if((a.flags&8772)!==0)switch(a.tag){case 0:case 11:case 15:wo||vv(5,a);break;case 1:var v=a.stateNode;if(a.flags&4&&!wo)if(c===null)v.componentDidMount();else{var E=a.elementType===a.type?c.memoizedProps:hl(a.type,c.memoizedProps);v.componentDidUpdate(E,c.memoizedState,v.__reactInternalSnapshotBeforeUpdate)}var D=a.updateQueue;D!==null&&gC(a,D,v);break;case 3:var F=a.updateQueue;if(F!==null){if(c=null,a.child!==null)switch(a.child.tag){case 5:c=a.child.stateNode;break;case 1:c=a.child.stateNode}gC(a,F,c)}break;case 5:var s=a.stateNode;if(c===null&&a.flags&4){c=s;var N=a.memoizedProps;switch(a.type){case"button":case"input":case"select":case"textarea":N.autoFocus&&c.focus();break;case"img":N.src&&(c.src=N.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(a.memoizedState===null){var pe=a.alternate;if(pe!==null){var Re=pe.memoizedState;if(Re!==null){var we=Re.dehydrated;we!==null&&eg(we)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(_t(163))}wo||a.flags&512&&iA(a)}catch(Ae){Zr(a,a.return,Ae)}}if(a===i){qt=null;break}if(c=a.sibling,c!==null){c.return=a.return,qt=c;break}qt=a.return}}function zC(i){for(;qt!==null;){var a=qt;if(a===i){qt=null;break}var c=a.sibling;if(c!==null){c.return=a.return,qt=c;break}qt=a.return}}function FC(i){for(;qt!==null;){var a=qt;try{switch(a.tag){case 0:case 11:case 15:var c=a.return;try{vv(4,a)}catch(N){Zr(a,c,N)}break;case 1:var v=a.stateNode;if(typeof v.componentDidMount=="function"){var E=a.return;try{v.componentDidMount()}catch(N){Zr(a,E,N)}}var D=a.return;try{iA(a)}catch(N){Zr(a,D,N)}break;case 5:var F=a.return;try{iA(a)}catch(N){Zr(a,F,N)}}}catch(N){Zr(a,a.return,N)}if(a===i){qt=null;break}var s=a.sibling;if(s!==null){s.return=a.return,qt=s;break}qt=a.return}}var fS=Math.ceil,sv=dc.ReactCurrentDispatcher,eb=dc.ReactCurrentOwner,ka=dc.ReactCurrentBatchConfig,Xn=0,Ni=null,ci=null,Ji=0,js=0,$p=Oh(0),Si=0,hg=null,nf=0,xv=0,tb=0,W_=null,ps=null,nb=0,am=1/0,rc=null,av=!1,aA=null,kh=null,x0=!1,Bh=null,lv=0,K_=0,lA=null,R0=-1,O0=0;function Go(){return(Xn&6)!==0?ni():R0!==-1?R0:R0=ni()}function Ph(i){return(i.mode&1)===0?1:(Xn&2)!==0&&Ji!==0?Ji&-Ji:JD.transition!==null?(O0===0&&(O0=f2()),O0):(i=hr,i!==0||(i=window.event,i=i===void 0?16:x2(i.type)),i)}function ml(i,a,c,v){if(50<K_)throw K_=0,lA=null,Error(_t(185));fg(i,c,v),((Xn&2)===0||i!==Ni)&&(i===Ni&&((Xn&2)===0&&(xv|=c),Si===4&&Ch(i,Ji)),ys(i,v),c===1&&Xn===0&&(a.mode&1)===0&&(am=ni()+500,_v&&Gh()))}function ys(i,a){var c=i.callbackNode;JT(i,a);var v=H0(i,i===Ni?Ji:0);if(v===0)c!==null&&Hb(c),i.callbackNode=null,i.callbackPriority=0;else if(a=v&-v,i.callbackPriority!==a){if(c!=null&&Hb(c),a===1)i.tag===0?ZD(RC.bind(null,i)):G2(RC.bind(null,i)),HD(function(){(Xn&6)===0&&Gh()}),c=null;else{switch(p2(v)){case 1:c=DA;break;case 4:c=h2;break;case 16:c=V0;break;case 536870912:c=d2;break;default:c=V0}c=OB(c,MB.bind(null,i))}i.callbackPriority=a,i.callbackNode=c}}function MB(i,a){if(R0=-1,O0=0,(Xn&6)!==0)throw Error(_t(327));var c=i.callbackNode;if(Yp()&&i.callbackNode!==c)return null;var v=H0(i,i===Ni?Ji:0);if(v===0)return null;if((v&30)!==0||(v&i.expiredLanes)!==0||a)a=uv(i,v);else{a=v;var E=Xn;Xn|=2;var D=PB();(Ni!==i||Ji!==a)&&(rc=null,am=ni()+500,Xd(i,a));do try{_S();break}catch(s){kB(i,s)}while(1);UA(),sv.current=D,Xn=E,ci!==null?a=0:(Ni=null,Ji=0,a=Si)}if(a!==0){if(a===2&&(E=zw(i),E!==0&&(v=E,a=uA(i,E))),a===1)throw c=hg,Xd(i,0),Ch(i,v),ys(i,ni()),c;if(a===6)Ch(i,v);else{if(E=i.current.alternate,(v&30)===0&&!pS(E)&&(a=uv(i,v),a===2&&(D=zw(i),D!==0&&(v=D,a=uA(i,D))),a===1))throw c=hg,Xd(i,0),Ch(i,v),ys(i,ni()),c;switch(i.finishedWork=E,i.finishedLanes=v,a){case 0:case 1:throw Error(_t(345));case 2:Wd(i,ps,rc);break;case 3:if(Ch(i,v),(v&130023424)===v&&(a=nb+500-ni(),10<a)){if(H0(i,0)!==0)break;if(E=i.suspendedLanes,(E&v)!==v){Go(),i.pingedLanes|=i.suspendedLanes&E;break}i.timeoutHandle=jw(Wd.bind(null,i,ps,rc),a);break}Wd(i,ps,rc);break;case 4:if(Ch(i,v),(v&4194240)===v)break;for(a=i.eventTimes,E=-1;0<v;){var F=31-pl(v);D=1<<F,F=a[F],F>E&&(E=F),v&=~D}if(v=E,v=ni()-v,v=(120>v?120:480>v?480:1080>v?1080:1920>v?1920:3e3>v?3e3:4320>v?4320:1960*fS(v/1960))-v,10<v){i.timeoutHandle=jw(Wd.bind(null,i,ps,rc),v);break}Wd(i,ps,rc);break;case 5:Wd(i,ps,rc);break;default:throw Error(_t(329))}}}return ys(i,ni()),i.callbackNode===c?MB.bind(null,i):null}function uA(i,a){var c=W_;return i.current.memoizedState.isDehydrated&&(Xd(i,a).flags|=256),i=uv(i,a),i!==2&&(a=ps,ps=c,a!==null&&cA(a)),i}function cA(i){ps===null?ps=i:ps.push.apply(ps,i)}function pS(i){for(var a=i;;){if(a.flags&16384){var c=a.updateQueue;if(c!==null&&(c=c.stores,c!==null))for(var v=0;v<c.length;v++){var E=c[v],D=E.getSnapshot;E=E.value;try{if(!_l(D(),E))return!1}catch{return!1}}}if(c=a.child,a.subtreeFlags&16384&&c!==null)c.return=a,a=c;else{if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Ch(i,a){for(a&=~tb,a&=~xv,i.suspendedLanes|=a,i.pingedLanes&=~a,i=i.expirationTimes;0<a;){var c=31-pl(a),v=1<<c;i[c]=-1,a&=~v}}function RC(i){if((Xn&6)!==0)throw Error(_t(327));Yp();var a=H0(i,0);if((a&1)===0)return ys(i,ni()),null;var c=uv(i,a);if(i.tag!==0&&c===2){var v=zw(i);v!==0&&(a=v,c=uA(i,v))}if(c===1)throw c=hg,Xd(i,0),Ch(i,a),ys(i,ni()),c;if(c===6)throw Error(_t(345));return i.finishedWork=i.current.alternate,i.finishedLanes=a,Wd(i,ps,rc),ys(i,ni()),null}function rb(i,a){var c=Xn;Xn|=1;try{return i(a)}finally{Xn=c,Xn===0&&(am=ni()+500,_v&&Gh())}}function rf(i){Bh!==null&&Bh.tag===0&&(Xn&6)===0&&Yp();var a=Xn;Xn|=1;var c=ka.transition,v=hr;try{if(ka.transition=null,hr=1,i)return i()}finally{hr=v,ka.transition=c,Xn=a,(Xn&6)===0&&Gh()}}function ib(){js=$p.current,Tr($p)}function Xd(i,a){i.finishedWork=null,i.finishedLanes=0;var c=i.timeoutHandle;if(c!==-1&&(i.timeoutHandle=-1,VD(c)),ci!==null)for(c=ci.return;c!==null;){var v=c;switch(OA(v),v.tag){case 1:v=v.type.childContextTypes,v!=null&&J0();break;case 3:om(),Tr(_s),Tr(Ao),WA();break;case 5:$A(v);break;case 4:om();break;case 13:Tr(Vr);break;case 19:Tr(Vr);break;case 10:qA(v.type._context);break;case 22:case 23:ib()}c=c.return}if(Ni=i,ci=i=Lh(i.current,null),Ji=js=a,Si=0,hg=null,tb=xv=nf=0,ps=W_=null,Zd!==null){for(a=0;a<Zd.length;a++)if(c=Zd[a],v=c.interleaved,v!==null){c.interleaved=null;var E=v.next,D=c.pending;if(D!==null){var F=D.next;D.next=E,v.next=F}c.pending=v}Zd=null}return i}function kB(i,a){do{var c=ci;try{if(UA(),L0.current=ov,iv){for(var v=Hr.memoizedState;v!==null;){var E=v.queue;E!==null&&(E.pending=null),v=v.next}iv=!1}if(tf=0,Gi=Di=Hr=null,H_=!1,lg=0,eb.current=null,c===null||c.return===null){Si=1,hg=a,ci=null;break}e:{var D=i,F=c.return,s=c,N=a;if(a=Ji,s.flags|=32768,N!==null&&typeof N=="object"&&typeof N.then=="function"){var pe=N,Re=s,we=Re.tag;if((Re.mode&1)===0&&(we===0||we===11||we===15)){var Ae=Re.alternate;Ae?(Re.updateQueue=Ae.updateQueue,Re.memoizedState=Ae.memoizedState,Re.lanes=Ae.lanes):(Re.updateQueue=null,Re.memoizedState=null)}var $e=CC(F);if($e!==null){$e.flags&=-257,EC($e,F,s,D,a),$e.mode&1&&bC(D,pe,a),a=$e,N=pe;var Qe=a.updateQueue;if(Qe===null){var ot=new Set;ot.add(N),a.updateQueue=ot}else Qe.add(N);break e}else{if((a&1)===0){bC(D,pe,a),ob();break e}N=Error(_t(426))}}else if(Rr&&s.mode&1){var Vt=CC(F);if(Vt!==null){(Vt.flags&65536)===0&&(Vt.flags|=256),EC(Vt,F,s,D,a),GA(sm(N,s));break e}}D=N=sm(N,s),Si!==4&&(Si=2),W_===null?W_=[D]:W_.push(D),D=F;do{switch(D.tag){case 3:D.flags|=65536,a&=-a,D.lanes|=a;var be=mB(D,N,a);_C(D,be);break e;case 1:s=N;var ge=D.type,Be=D.stateNode;if((D.flags&128)===0&&(typeof ge.getDerivedStateFromError=="function"||Be!==null&&typeof Be.componentDidCatch=="function"&&(kh===null||!kh.has(Be)))){D.flags|=65536,a&=-a,D.lanes|=a;var Xe=_B(D,s,a);_C(D,Xe);break e}}D=D.return}while(D!==null)}zB(c)}catch(Ie){a=Ie,ci===c&&c!==null&&(ci=c=c.return);continue}break}while(1)}function PB(){var i=sv.current;return sv.current=ov,i===null?ov:i}function ob(){(Si===0||Si===3||Si===2)&&(Si=4),Ni===null||(nf&268435455)===0&&(xv&268435455)===0||Ch(Ni,Ji)}function uv(i,a){var c=Xn;Xn|=2;var v=PB();(Ni!==i||Ji!==a)&&(rc=null,Xd(i,a));do try{mS();break}catch(E){kB(i,E)}while(1);if(UA(),Xn=c,sv.current=v,ci!==null)throw Error(_t(261));return Ni=null,Ji=0,Si}function mS(){for(;ci!==null;)LB(ci)}function _S(){for(;ci!==null&&!UT();)LB(ci)}function LB(i){var a=RB(i.alternate,i,js);i.memoizedProps=i.pendingProps,a===null?zB(i):ci=a,eb.current=null}function zB(i){var a=i;do{var c=a.alternate;if(i=a.return,(a.flags&32768)===0){if(c=lS(c,a,js),c!==null){ci=c;return}}else{if(c=uS(c,a),c!==null){c.flags&=32767,ci=c;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Si=6,ci=null;return}}if(a=a.sibling,a!==null){ci=a;return}ci=a=i}while(a!==null);Si===0&&(Si=5)}function Wd(i,a,c){var v=hr,E=ka.transition;try{ka.transition=null,hr=1,gS(i,a,c,v)}finally{ka.transition=E,hr=v}return null}function gS(i,a,c,v){do Yp();while(Bh!==null);if((Xn&6)!==0)throw Error(_t(327));c=i.finishedWork;var E=i.finishedLanes;if(c===null)return null;if(i.finishedWork=null,i.finishedLanes=0,c===i.current)throw Error(_t(177));i.callbackNode=null,i.callbackPriority=0;var D=c.lanes|c.childLanes;if(XT(i,D),i===Ni&&(ci=Ni=null,Ji=0),(c.subtreeFlags&2064)===0&&(c.flags&2064)===0||x0||(x0=!0,OB(V0,function(){return Yp(),null})),D=(c.flags&15990)!==0,(c.subtreeFlags&15990)!==0||D){D=ka.transition,ka.transition=null;var F=hr;hr=1;var s=Xn;Xn|=4,eb.current=null,hS(i,c),SB(c,i),RD(Uw),$0=!!Nw,Uw=Nw=null,i.current=c,dS(c),qT(),Xn=s,hr=F,ka.transition=D}else i.current=c;if(x0&&(x0=!1,Bh=i,lv=E),D=i.pendingLanes,D===0&&(kh=null),HT(c.stateNode),ys(i,ni()),a!==null)for(v=i.onRecoverableError,c=0;c<a.length;c++)E=a[c],v(E.value,{componentStack:E.stack,digest:E.digest});if(av)throw av=!1,i=aA,aA=null,i;return(lv&1)!==0&&i.tag!==0&&Yp(),D=i.pendingLanes,(D&1)!==0?i===lA?K_++:(K_=0,lA=i):K_=0,Gh(),null}function Yp(){if(Bh!==null){var i=p2(lv),a=ka.transition,c=hr;try{if(ka.transition=null,hr=16>i?16:i,Bh===null)var v=!1;else{if(i=Bh,Bh=null,lv=0,(Xn&6)!==0)throw Error(_t(331));var E=Xn;for(Xn|=4,qt=i.current;qt!==null;){var D=qt,F=D.child;if((qt.flags&16)!==0){var s=D.deletions;if(s!==null){for(var N=0;N<s.length;N++){var pe=s[N];for(qt=pe;qt!==null;){var Re=qt;switch(Re.tag){case 0:case 11:case 15:$_(8,Re,D)}var we=Re.child;if(we!==null)we.return=Re,qt=we;else for(;qt!==null;){Re=qt;var Ae=Re.sibling,$e=Re.return;if(BB(Re),Re===pe){qt=null;break}if(Ae!==null){Ae.return=$e,qt=Ae;break}qt=$e}}}var Qe=D.alternate;if(Qe!==null){var ot=Qe.child;if(ot!==null){Qe.child=null;do{var Vt=ot.sibling;ot.sibling=null,ot=Vt}while(ot!==null)}}qt=D}}if((D.subtreeFlags&2064)!==0&&F!==null)F.return=D,qt=F;else e:for(;qt!==null;){if(D=qt,(D.flags&2048)!==0)switch(D.tag){case 0:case 11:case 15:$_(9,D,D.return)}var be=D.sibling;if(be!==null){be.return=D.return,qt=be;break e}qt=D.return}}var ge=i.current;for(qt=ge;qt!==null;){F=qt;var Be=F.child;if((F.subtreeFlags&2064)!==0&&Be!==null)Be.return=F,qt=Be;else e:for(F=ge;qt!==null;){if(s=qt,(s.flags&2048)!==0)try{switch(s.tag){case 0:case 11:case 15:vv(9,s)}}catch(Ie){Zr(s,s.return,Ie)}if(s===F){qt=null;break e}var Xe=s.sibling;if(Xe!==null){Xe.return=s.return,qt=Xe;break e}qt=s.return}}if(Xn=E,Gh(),mu&&typeof mu.onPostCommitFiberRoot=="function")try{mu.onPostCommitFiberRoot(hv,i)}catch{}v=!0}return v}finally{hr=c,ka.transition=a}}return!1}function OC(i,a,c){a=sm(c,a),a=mB(i,a,1),i=Mh(i,a,1),a=Go(),i!==null&&(fg(i,1,a),ys(i,a))}function Zr(i,a,c){if(i.tag===3)OC(i,i,c);else for(;a!==null;){if(a.tag===3){OC(a,i,c);break}else if(a.tag===1){var v=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(kh===null||!kh.has(v))){i=sm(c,i),i=_B(a,i,1),a=Mh(a,i,1),i=Go(),a!==null&&(fg(a,1,i),ys(a,i));break}}a=a.return}}function yS(i,a,c){var v=i.pingCache;v!==null&&v.delete(a),a=Go(),i.pingedLanes|=i.suspendedLanes&c,Ni===i&&(Ji&c)===c&&(Si===4||Si===3&&(Ji&130023424)===Ji&&500>ni()-nb?Xd(i,0):tb|=c),ys(i,a)}function FB(i,a){a===0&&((i.mode&1)===0?a=1:(a=c0,c0<<=1,(c0&130023424)===0&&(c0=4194304)));var c=Go();i=cc(i,a),i!==null&&(fg(i,a,c),ys(i,c))}function vS(i){var a=i.memoizedState,c=0;a!==null&&(c=a.retryLane),FB(i,c)}function xS(i,a){var c=0;switch(i.tag){case 13:var v=i.stateNode,E=i.memoizedState;E!==null&&(c=E.retryLane);break;case 19:v=i.stateNode;break;default:throw Error(_t(314))}v!==null&&v.delete(a),FB(i,c)}var RB;RB=function(i,a,c){if(i!==null)if(i.memoizedProps!==a.pendingProps||_s.current)ms=!0;else{if((i.lanes&c)===0&&(a.flags&128)===0)return ms=!1,aS(i,a,c);ms=(i.flags&131072)!==0}else ms=!1,Rr&&(a.flags&1048576)!==0&&N2(a,Y0,a.index);switch(a.lanes=0,a.tag){case 2:var v=a.type;F0(i,a),i=a.pendingProps;var E=nm(a,Ao.current);Qp(a,c),E=ZA(null,a,v,i,E,c);var D=JA();return a.flags|=1,typeof E=="object"&&E!==null&&typeof E.render=="function"&&E.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,gs(v)?(D=!0,X0(a)):D=!1,a.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,VA(a),E.updater=gv,a.stateNode=E,E._reactInternals=a,Jw(a,v,i,c),a=Yw(null,a,v,!0,D,c)):(a.tag=0,Rr&&D&&RA(a),Oo(null,a,E,c),a=a.child),a;case 16:v=a.elementType;e:{switch(F0(i,a),i=a.pendingProps,E=v._init,v=E(v._payload),a.type=v,E=a.tag=AS(v),i=hl(v,i),E){case 0:a=Qw(null,a,v,i,c);break e;case 1:a=DC(null,a,v,i,c);break e;case 11:a=BC(null,a,v,i,c);break e;case 14:a=TC(null,a,v,hl(v.type,i),c);break e}throw Error(_t(306,v,""))}return a;case 0:return v=a.type,E=a.pendingProps,E=a.elementType===v?E:hl(v,E),Qw(i,a,v,E,c);case 1:return v=a.type,E=a.pendingProps,E=a.elementType===v?E:hl(v,E),DC(i,a,v,E,c);case 3:e:{if(xB(a),i===null)throw Error(_t(387));v=a.pendingProps,D=a.memoizedState,E=D.element,V2(i,a),nv(a,v,null,c);var F=a.memoizedState;if(v=F.element,D.isDehydrated)if(D={element:v,isDehydrated:!1,cache:F.cache,pendingSuspenseBoundaries:F.pendingSuspenseBoundaries,transitions:F.transitions},a.updateQueue.baseState=D,a.memoizedState=D,a.flags&256){E=sm(Error(_t(423)),a),a=SC(i,a,v,c,E);break e}else if(v!==E){E=sm(Error(_t(424)),a),a=SC(i,a,v,c,E);break e}else for(Vs=Ih(a.stateNode.containerInfo.firstChild),Hs=a,Rr=!0,fl=null,c=K2(a,null,v,c),a.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(rm(),v===E){a=hc(i,a,c);break e}Oo(i,a,v,c)}a=a.child}return a;case 5:return Z2(a),i===null&&Ww(a),v=a.type,E=a.pendingProps,D=i!==null?i.memoizedProps:null,F=E.children,qw(v,E)?F=null:D!==null&&qw(v,D)&&(a.flags|=32),vB(i,a),Oo(i,a,F,c),a.child;case 6:return i===null&&Ww(a),null;case 13:return wB(i,a,c);case 4:return HA(a,a.stateNode.containerInfo),v=a.pendingProps,i===null?a.child=im(a,null,v,c):Oo(i,a,v,c),a.child;case 11:return v=a.type,E=a.pendingProps,E=a.elementType===v?E:hl(v,E),BC(i,a,v,E,c);case 7:return Oo(i,a,a.pendingProps,c),a.child;case 8:return Oo(i,a,a.pendingProps.children,c),a.child;case 12:return Oo(i,a,a.pendingProps.children,c),a.child;case 10:e:{if(v=a.type._context,E=a.pendingProps,D=a.memoizedProps,F=E.value,xr(ev,v._currentValue),v._currentValue=F,D!==null)if(_l(D.value,F)){if(D.children===E.children&&!_s.current){a=hc(i,a,c);break e}}else for(D=a.child,D!==null&&(D.return=a);D!==null;){var s=D.dependencies;if(s!==null){F=D.child;for(var N=s.firstContext;N!==null;){if(N.context===v){if(D.tag===1){N=ac(-1,c&-c),N.tag=2;var pe=D.updateQueue;if(pe!==null){pe=pe.shared;var Re=pe.pending;Re===null?N.next=N:(N.next=Re.next,Re.next=N),pe.pending=N}}D.lanes|=c,N=D.alternate,N!==null&&(N.lanes|=c),Kw(D.return,c,a),s.lanes|=c;break}N=N.next}}else if(D.tag===10)F=D.type===a.type?null:D.child;else if(D.tag===18){if(F=D.return,F===null)throw Error(_t(341));F.lanes|=c,s=F.alternate,s!==null&&(s.lanes|=c),Kw(F,c,a),F=D.sibling}else F=D.child;if(F!==null)F.return=D;else for(F=D;F!==null;){if(F===a){F=null;break}if(D=F.sibling,D!==null){D.return=F.return,F=D;break}F=F.return}D=F}Oo(i,a,E.children,c),a=a.child}return a;case 9:return E=a.type,v=a.pendingProps.children,Qp(a,c),E=Pa(E),v=v(E),a.flags|=1,Oo(i,a,v,c),a.child;case 14:return v=a.type,E=hl(v,a.pendingProps),E=hl(v.type,E),TC(i,a,v,E,c);case 15:return gB(i,a,a.type,a.pendingProps,c);case 17:return v=a.type,E=a.pendingProps,E=a.elementType===v?E:hl(v,E),F0(i,a),a.tag=1,gs(v)?(i=!0,X0(a)):i=!1,Qp(a,c),$2(a,v,E),Jw(a,v,E,c),Yw(null,a,v,!0,i,c);case 19:return AB(i,a,c);case 22:return yB(i,a,c)}throw Error(_t(156,a.tag))};function OB(i,a){return c2(i,a)}function wS(i,a,c,v){this.tag=i,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ma(i,a,c,v){return new wS(i,a,c,v)}function sb(i){return i=i.prototype,!(!i||!i.isReactComponent)}function AS(i){if(typeof i=="function")return sb(i)?1:0;if(i!=null){if(i=i.$$typeof,i===EA)return 11;if(i===BA)return 14}return 2}function Lh(i,a){var c=i.alternate;return c===null?(c=Ma(i.tag,a,i.key,i.mode),c.elementType=i.elementType,c.type=i.type,c.stateNode=i.stateNode,c.alternate=i,i.alternate=c):(c.pendingProps=a,c.type=i.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=i.flags&14680064,c.childLanes=i.childLanes,c.lanes=i.lanes,c.child=i.child,c.memoizedProps=i.memoizedProps,c.memoizedState=i.memoizedState,c.updateQueue=i.updateQueue,a=i.dependencies,c.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},c.sibling=i.sibling,c.index=i.index,c.ref=i.ref,c}function G0(i,a,c,v,E,D){var F=2;if(v=i,typeof i=="function")sb(i)&&(F=1);else if(typeof i=="string")F=5;else e:switch(i){case Fp:return Qd(c.children,E,D,a);case CA:F=8,E|=8;break;case xw:return i=Ma(12,c,a,E|2),i.elementType=xw,i.lanes=D,i;case ww:return i=Ma(13,c,a,E),i.elementType=ww,i.lanes=D,i;case Aw:return i=Ma(19,c,a,E),i.elementType=Aw,i.lanes=D,i;case WE:return wv(c,E,D,a);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case HE:F=10;break e;case $E:F=9;break e;case EA:F=11;break e;case BA:F=14;break e;case wh:F=16,v=null;break e}throw Error(_t(130,i==null?i:typeof i,""))}return a=Ma(F,c,a,E),a.elementType=i,a.type=v,a.lanes=D,a}function Qd(i,a,c,v){return i=Ma(7,i,v,a),i.lanes=c,i}function wv(i,a,c,v){return i=Ma(22,i,v,a),i.elementType=WE,i.lanes=c,i.stateNode={isHidden:!1},i}function sw(i,a,c){return i=Ma(6,i,null,a),i.lanes=c,i}function aw(i,a,c){return a=Ma(4,i.children!==null?i.children:[],i.key,a),a.lanes=c,a.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},a}function bS(i,a,c,v,E){this.tag=a,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=U1(0),this.expirationTimes=U1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=U1(0),this.identifierPrefix=v,this.onRecoverableError=E,this.mutableSourceEagerHydrationData=null}function ab(i,a,c,v,E,D,F,s,N){return i=new bS(i,a,c,s,N),a===1?(a=1,D===!0&&(a|=8)):a=0,D=Ma(3,null,null,a),i.current=D,D.stateNode=i,D.memoizedState={element:v,isDehydrated:c,cache:null,transitions:null,pendingSuspenseBoundaries:null},VA(D),i}function CS(i,a,c){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:zp,key:v==null?null:""+v,children:i,containerInfo:a,implementation:c}}function GB(i){if(!i)return Fh;i=i._reactInternals;e:{if(sf(i)!==i||i.tag!==1)throw Error(_t(170));var a=i;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(gs(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(_t(171))}if(i.tag===1){var c=i.type;if(gs(c))return O2(i,c,a)}return a}function NB(i,a,c,v,E,D,F,s,N){return i=ab(c,v,!0,i,E,D,F,s,N),i.context=GB(null),c=i.current,v=Go(),E=Ph(c),D=ac(v,E),D.callback=a!=null?a:null,Mh(c,D,E),i.current.lanes=E,fg(i,E,v),ys(i,v),i}function Av(i,a,c,v){var E=a.current,D=Go(),F=Ph(E);return c=GB(c),a.context===null?a.context=c:a.pendingContext=c,a=ac(D,F),a.payload={element:i},v=v===void 0?null:v,v!==null&&(a.callback=v),i=Mh(E,a,F),i!==null&&(ml(i,E,F,D),P0(i,E,F)),F}function cv(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function GC(i,a){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var c=i.retryLane;i.retryLane=c!==0&&c<a?c:a}}function lb(i,a){GC(i,a),(i=i.alternate)&&GC(i,a)}function ES(){return null}var UB=typeof reportError=="function"?reportError:function(i){console.error(i)};function ub(i){this._internalRoot=i}bv.prototype.render=ub.prototype.render=function(i){var a=this._internalRoot;if(a===null)throw Error(_t(409));Av(i,a,null,null)};bv.prototype.unmount=ub.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var a=i.containerInfo;rf(function(){Av(null,i,null,null)}),a[uc]=null}};function bv(i){this._internalRoot=i}bv.prototype.unstable_scheduleHydration=function(i){if(i){var a=g2();i={blockedOn:null,target:i,priority:a};for(var c=0;c<bh.length&&a!==0&&a<bh[c].priority;c++);bh.splice(c,0,i),c===0&&v2(i)}};function cb(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function Cv(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function NC(){}function BS(i,a,c,v,E){if(E){if(typeof v=="function"){var D=v;v=function(){var pe=cv(F);D.call(pe)}}var F=NB(a,v,i,0,null,!1,!1,"",NC);return i._reactRootContainer=F,i[uc]=F.current,rg(i.nodeType===8?i.parentNode:i),rf(),F}for(;E=i.lastChild;)i.removeChild(E);if(typeof v=="function"){var s=v;v=function(){var pe=cv(N);s.call(pe)}}var N=ab(i,0,!1,null,null,!1,!1,"",NC);return i._reactRootContainer=N,i[uc]=N.current,rg(i.nodeType===8?i.parentNode:i),rf(function(){Av(a,N,c,v)}),N}function Ev(i,a,c,v,E){var D=c._reactRootContainer;if(D){var F=D;if(typeof E=="function"){var s=E;E=function(){var N=cv(F);s.call(N)}}Av(a,F,i,E)}else F=BS(c,a,i,E,v);return cv(F)}m2=function(i){switch(i.tag){case 3:var a=i.stateNode;if(a.current.memoizedState.isDehydrated){var c=O_(a.pendingLanes);c!==0&&(SA(a,c|1),ys(a,ni()),(Xn&6)===0&&(am=ni()+500,Gh()))}break;case 13:rf(function(){var v=cc(i,1);if(v!==null){var E=Go();ml(v,i,1,E)}}),lb(i,1)}};IA=function(i){if(i.tag===13){var a=cc(i,134217728);if(a!==null){var c=Go();ml(a,i,134217728,c)}lb(i,134217728)}};_2=function(i){if(i.tag===13){var a=Ph(i),c=cc(i,a);if(c!==null){var v=Go();ml(c,i,a,v)}lb(i,a)}};g2=function(){return hr};y2=function(i,a){var c=hr;try{return hr=i,a()}finally{hr=c}};kw=function(i,a,c){switch(a){case"input":if(Ew(i,c),a=c.name,c.type==="radio"&&a!=null){for(c=i;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll("input[name="+JSON.stringify(""+a)+'][type="radio"]'),a=0;a<c.length;a++){var v=c[a];if(v!==i&&v.form===i.form){var E=mv(v);if(!E)throw Error(_t(90));ZE(v),Ew(v,E)}}}break;case"textarea":XE(i,c);break;case"select":a=c.value,a!=null&&Kp(i,!!c.multiple,a,!1)}};i2=rb;o2=rf;var TS={usingClientEntryPoint:!1,Events:[mg,Np,mv,n2,r2,rb]},L_={findFiberByHostInstance:Kd,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},DS={bundleType:L_.bundleType,version:L_.version,rendererPackageName:L_.rendererPackageName,rendererConfig:L_.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:dc.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=l2(i),i===null?null:i.stateNode},findFiberByHostInstance:L_.findFiberByHostInstance||ES,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var w0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!w0.isDisabled&&w0.supportsFiber)try{hv=w0.inject(DS),mu=w0}catch{}}Ws.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=TS;Ws.createPortal=function(i,a){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!cb(a))throw Error(_t(200));return CS(i,a,null,c)};Ws.createRoot=function(i,a){if(!cb(i))throw Error(_t(299));var c=!1,v="",E=UB;return a!=null&&(a.unstable_strictMode===!0&&(c=!0),a.identifierPrefix!==void 0&&(v=a.identifierPrefix),a.onRecoverableError!==void 0&&(E=a.onRecoverableError)),a=ab(i,1,!1,null,null,c,!1,v,E),i[uc]=a.current,rg(i.nodeType===8?i.parentNode:i),new ub(a)};Ws.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var a=i._reactInternals;if(a===void 0)throw typeof i.render=="function"?Error(_t(188)):(i=Object.keys(i).join(","),Error(_t(268,i)));return i=l2(a),i=i===null?null:i.stateNode,i};Ws.flushSync=function(i){return rf(i)};Ws.hydrate=function(i,a,c){if(!Cv(a))throw Error(_t(200));return Ev(null,i,a,!0,c)};Ws.hydrateRoot=function(i,a,c){if(!cb(i))throw Error(_t(405));var v=c!=null&&c.hydratedSources||null,E=!1,D="",F=UB;if(c!=null&&(c.unstable_strictMode===!0&&(E=!0),c.identifierPrefix!==void 0&&(D=c.identifierPrefix),c.onRecoverableError!==void 0&&(F=c.onRecoverableError)),a=NB(a,null,i,1,c!=null?c:null,E,!1,D,F),i[uc]=a.current,rg(i),v)for(i=0;i<v.length;i++)c=v[i],E=c._getVersion,E=E(c._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[c,E]:a.mutableSourceEagerHydrationData.push(c,E);return new bv(a)};Ws.render=function(i,a,c){if(!Cv(a))throw Error(_t(200));return Ev(null,i,a,!1,c)};Ws.unmountComponentAtNode=function(i){if(!Cv(i))throw Error(_t(40));return i._reactRootContainer?(rf(function(){Ev(null,null,i,!1,function(){i._reactRootContainer=null,i[uc]=null})}),!0):!1};Ws.unstable_batchedUpdates=rb;Ws.unstable_renderSubtreeIntoContainer=function(i,a,c,v){if(!Cv(c))throw Error(_t(200));if(i==null||i._reactInternals===void 0)throw Error(_t(38));return Ev(i,a,c,!1,v)};Ws.version="18.2.0-next-9e3b772b8-20220608";(function(i){function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(c){console.error(c)}}a(),i.exports=Ws})(NE);var qB,UC=NE.exports;qB=UC.createRoot,UC.hydrateRoot;var jB={exports:{}};(function(i,a){(function(c,v){i.exports=v()})(du,function(){var c,v,E;function D(s,N){if(!c)c=N;else if(!v)v=N;else{var pe="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+c+")(sharedChunk); ("+v+")(sharedChunk); self.onerror = null;",Re={};c(Re),E=N(Re),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(E.workerUrl=window.URL.createObjectURL(new Blob([pe],{type:"text/javascript"})))}}D(["exports"],function(s){var N=typeof self<"u"?self:{},pe="2.11.0";let Re;const we={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(Re==null){const t=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{Re=process.env.API_URL_REGEX!=null?new RegExp(process.env.API_URL_REGEX):t}catch{Re=t}}return Re},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Ae={supported:!1,testSupport:function(t){!ot&&Qe&&(Vt?be(t):$e=t)}};let $e,Qe,ot=!1,Vt=!1;function be(t){const e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,Qe),t.isContextLost())return;Ae.supported=!0}catch{}t.deleteTexture(e),ot=!0}N.document&&(Qe=N.document.createElement("img"),Qe.onload=function(){$e&&be($e),$e=null,Vt=!0},Qe.onerror=function(){ot=!0,$e=null},Qe.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const ge="01";var Be=Xe;function Xe(t,e,n,o){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(o-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=e,this.p2x=n,this.p2y=o}Xe.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,e){if(e===void 0&&(e=1e-6),t<0)return 0;if(t>1)return 1;for(var n=t,o=0;o<8;o++){var u=this.sampleCurveX(n)-t;if(Math.abs(u)<e)return n;var f=this.sampleCurveDerivativeX(n);if(Math.abs(f)<1e-6)break;n-=u/f}var m=0,y=1;for(n=t,o=0;o<20&&(u=this.sampleCurveX(n),!(Math.abs(u-t)<e));o++)t>u?m=n:y=n,n=.5*(y-m)+m;return n},solve:function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}};var Ie=at;function at(t,e){this.x=t,this.y=e}at.prototype={clone:function(){return new at(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),o=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=o,this},_rotateAround:function(t,e){var n=Math.cos(t),o=Math.sin(t),u=e.y+o*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-o*(this.y-e.y),this.y=u,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},at.convert=function(t){return t instanceof at?t:Array.isArray(t)?new at(t[0],t[1]):t};const ft=Math.PI/180,Ct=180/Math.PI;function Et(t){return t*ft}function Ot(t){return t*Ct}const dr=[[0,0],[1,0],[1,1],[0,1]];function Wr(t){if(t<=0)return 0;if(t>=1)return 1;const e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}function ir(t,e,n,o){const u=new Be(t,e,n,o);return function(f){return u.solve(f)}}const hi=ir(.25,.1,.25,1);function en(t,e,n){return Math.min(n,Math.max(e,t))}function di(t,e,n){return(n=en((n-t)/(e-t),0,1))*n*(3-2*n)}function fr(t,e,n){const o=n-e,u=((t-e)%o+o)%o+e;return u===e?n:u}function xt(t,e,n){if(!t.length)return n(null,[]);let o=t.length;const u=new Array(t.length);let f=null;t.forEach((m,y)=>{e(m,(w,A)=>{w&&(f=w),u[y]=A,--o==0&&n(f,u)})})}function Qt(t){const e=[];for(const n in t)e.push(t[n]);return e}function Mt(t,...e){for(const n of e)for(const o in n)t[o]=n[o];return t}let _n=1;function Ln(){return _n++}function Or(){return function t(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function Qn(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function wr(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function jt(t,e){t.forEach(n=>{e[n]&&(e[n]=e[n].bind(e))})}function St(t,e){return t.indexOf(e,t.length-e.length)!==-1}function ar(t,e,n){const o={};for(const u in t)o[u]=e.call(n||this,t[u],u,t);return o}function pr(t,e,n){const o={};for(const u in t)e.call(n||this,t[u],u,t)&&(o[u]=t[u]);return o}function Ui(t){return Array.isArray(t)?t.map(Ui):typeof t=="object"&&t?ar(t,Ui):t}const Fa={};function er(t){Fa[t]||(typeof console<"u"&&console.warn(t),Fa[t]=!0)}function Qi(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}function sn(t){let e=0;for(let n,o,u=0,f=t.length,m=f-1;u<f;m=u++)n=t[u],o=t[m],e+=(o.x-n.x)*(n.y+o.y);return e}function fi(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function yu(t){const e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(n,o,u,f)=>{const m=u||f;return e[o]=!m||m.toLowerCase(),""}),e["max-age"]){const n=parseInt(e["max-age"],10);isNaN(n)?delete e["max-age"]:e["max-age"]=n}return e}let Jr=null;function Ra(t){if(Jr==null){const e=t.navigator?t.navigator.userAgent:null;Jr=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Jr}function vu(t){try{const e=N[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function Yi(t,e){return[t[4*e],t[4*e+1],t[4*e+2],t[4*e+3]]}const Ii="mapbox-tiles";let Gr,bo,yl=500,ws=50;function vl(){try{return N.caches}catch{}}function eo(){vl()&&!Gr&&(Gr=N.caches.open(Ii))}function qo(t){const e=t.indexOf("?");if(e<0)return t;const n=function(u){const f=u.indexOf("?");return f>0?u.slice(f+1).split("&"):[]}(t),o=n.filter(u=>{const f=u.split("=");return f[0]==="language"||f[0]==="worldview"});return o.length?`${t.slice(0,e)}?${o.join("&")}`:t.slice(0,e)}let Zs=1/0;const pi={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(pi);class Oa extends Error{constructor(e,n,o){n===401&&Na(o)&&(e+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),super(e),this.status=n,this.url=o}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Js=fi()?()=>self.worker&&self.worker.referrer:()=>(N.location.protocol==="blob:"?N.parent:N).location.href,jo=function(t,e){if(!(/^file:/.test(n=t.url)||/^file:/.test(Js())&&!/^\w+:/.test(n))){if(N.fetch&&N.Request&&N.AbortController&&N.Request.prototype.hasOwnProperty("signal"))return function(o,u){const f=new N.AbortController,m=new N.Request(o.url,{method:o.method||"GET",body:o.body,credentials:o.credentials,headers:o.headers,referrer:Js(),signal:f.signal});let y=!1,w=!1;const A=(B=m.url).indexOf("sku=")>0&&Na(B);var B;o.type==="json"&&m.headers.set("Accept","application/json");const I=(z,R,U)=>{if(w)return;if(z&&z.message!=="SecurityError"&&er(z),R&&U)return M(R);const H=Date.now();N.fetch(m).then(ie=>{if(ie.ok){const ce=A?ie.clone():null;return M(ie,ce,H)}return u(new Oa(ie.statusText,ie.status,o.url))}).catch(ie=>{ie.code!==20&&u(new Error(ie.message))})},M=(z,R,U)=>{(o.type==="arrayBuffer"?z.arrayBuffer():o.type==="json"?z.json():z.text()).then(H=>{w||(R&&U&&function(ie,ce,re){if(eo(),!Gr)return;const ae={status:ce.status,statusText:ce.statusText,headers:new N.Headers};ce.headers.forEach((Fe,ze)=>ae.headers.set(ze,Fe));const _e=yu(ce.headers.get("Cache-Control")||"");if(_e["no-store"])return;_e["max-age"]&&ae.headers.set("Expires",new Date(re+1e3*_e["max-age"]).toUTCString());const de=ae.headers.get("Expires");de&&(new Date(de).getTime()-re<42e4||function(Fe,ze){if(bo===void 0)try{new Response(new ReadableStream),bo=!0}catch{bo=!1}bo?ze(Fe.body):Fe.blob().then(ze)}(ce,Fe=>{const ze=new N.Response(Fe,ae);eo(),Gr&&Gr.then(qe=>qe.put(qo(ie.url),ze)).catch(qe=>er(qe.message))}))}(m,R,U),y=!0,u(null,H,z.headers.get("Cache-Control"),z.headers.get("Expires")))}).catch(H=>{w||u(new Error(H.message))})};return A?function(z,R){if(eo(),!Gr)return R(null);const U=qo(z.url);Gr.then(H=>{H.match(U).then(ie=>{const ce=function(re){if(!re)return!1;const ae=new Date(re.headers.get("Expires")||0),_e=yu(re.headers.get("Cache-Control")||"");return ae>Date.now()&&!_e["no-cache"]}(ie);H.delete(U),ce&&H.put(U,ie.clone()),R(null,ie,ce)}).catch(R)}).catch(R)}(m,I):I(null,null),{cancel:()=>{w=!0,y||f.abort()}}}(t,e);if(fi()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var n;return function(o,u){const f=new N.XMLHttpRequest;f.open(o.method||"GET",o.url,!0),o.type==="arrayBuffer"&&(f.responseType="arraybuffer");for(const m in o.headers)f.setRequestHeader(m,o.headers[m]);return o.type==="json"&&(f.responseType="text",f.setRequestHeader("Accept","application/json")),f.withCredentials=o.credentials==="include",f.onerror=()=>{u(new Error(f.statusText))},f.onload=()=>{if((f.status>=200&&f.status<300||f.status===0)&&f.response!==null){let m=f.response;if(o.type==="json")try{m=JSON.parse(f.response)}catch(y){return u(y)}u(null,m,f.getResponseHeader("Cache-Control"),f.getResponseHeader("Expires"))}else u(new Oa(f.statusText,f.status,o.url))},f.send(o.body),{cancel:()=>f.abort()}}(t,e)},Vo=function(t,e){return jo(Mt(t,{type:"arrayBuffer"}),e)};function Ga(t){const e=N.document.createElement("a");return e.href=t,e.protocol===N.document.location.protocol&&e.host===N.document.location.host}const xl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Xs,Qs;Xs=[],Qs=0;const wl=function(t,e){if(Ae.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),Qs>=we.MAX_PARALLEL_IMAGE_REQUESTS){const f={requestParameters:t,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return Xs.push(f),f}Qs++;let n=!1;const o=()=>{if(!n)for(n=!0,Qs--;Xs.length&&Qs<we.MAX_PARALLEL_IMAGE_REQUESTS;){const f=Xs.shift(),{requestParameters:m,callback:y,cancelled:w}=f;w||(f.cancel=wl(m,y).cancel)}},u=Vo(t,(f,m,y,w)=>{o(),f?e(f):m&&(N.createImageBitmap?function(A,B){const I=new N.Blob([new Uint8Array(A)],{type:"image/png"});N.createImageBitmap(I).then(M=>{B(null,M)}).catch(M=>{B(new Error(`Could not load image because of ${M.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(m,(A,B)=>e(A,B,y,w)):function(A,B){const I=new N.Image,M=N.URL;I.onload=()=>{B(null,I),M.revokeObjectURL(I.src),I.onload=null,N.requestAnimationFrame(()=>{I.src=xl})},I.onerror=()=>B(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const z=new N.Blob([new Uint8Array(A)],{type:"image/png"});I.src=A.byteLength?M.createObjectURL(z):xl}(m,(A,B)=>e(A,B,y,w)))});return{cancel:()=>{u.cancel(),o()}}},Al="NO_ACCESS_TOKEN";function to(t){return t.indexOf("mapbox:")===0}function Na(t){return we.API_URL_REGEX.test(t)}function pc(t){return we.API_STYLE_REGEX.test(t)&&!bl(t)}function bl(t){return we.API_SPRITE_REGEX.test(t)}const Cl=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Mi(t){const e=t.match(Cl);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function Ys(t){const e=t.params.length?`?${t.params.join("&")}`:"";return`${t.protocol}://${t.authority}${t.path}${e}`}function xu(t){if(!t)return null;const e=t.split(".");if(!e||e.length!==3)return null;try{return JSON.parse(decodeURIComponent(N.atob(e[1]).split("").map(n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Ua{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const n=xu(we.ACCESS_TOKEN);let o="";return o=n&&n.u?N.btoa(encodeURIComponent(n.u).replace(/%([0-9A-F]{2})/g,(u,f)=>String.fromCharCode(Number("0x"+f)))):we.ACCESS_TOKEN||"",e?`mapbox.eventData.${e}:${o}`:`mapbox.eventData:${o}`}fetchEventData(){const e=vu("localStorage"),n=this.getStorageKey(),o=this.getStorageKey("uuid");if(e)try{const u=N.localStorage.getItem(n);u&&(this.eventData=JSON.parse(u));const f=N.localStorage.getItem(o);f&&(this.anonId=f)}catch{er("Unable to read from LocalStorage")}}saveEventData(){const e=vu("localStorage"),n=this.getStorageKey(),o=this.getStorageKey("uuid");if(e)try{N.localStorage.setItem(o,this.anonId),Object.keys(this.eventData).length>=1&&N.localStorage.setItem(n,JSON.stringify(this.eventData))}catch{er("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,n,o,u){if(!we.EVENTS_URL)return;const f=Mi(we.EVENTS_URL);f.params.push(`access_token=${u||we.ACCESS_TOKEN||""}`);const m={event:this.type,created:new Date(e).toISOString()},y=n?Mt(m,n):m,w={url:Ys(f),headers:{"Content-Type":"text/plain"},body:JSON.stringify([y])};this.pendingRequest=function(A,B){return jo(Mt(A,{method:"POST"}),B)}(w,A=>{this.pendingRequest=null,o(A),this.saveEventData(),this.processRequests(u)})}queueRequest(e,n){this.queue.push(e),this.processRequests(n)}}const ne=new class extends Ua{constructor(t){super("appUserTurnstile"),this._customAccessToken=t}postTurnstileEvent(t,e){we.EVENTS_URL&&we.ACCESS_TOKEN&&Array.isArray(t)&&t.some(n=>to(n)||Na(n))&&this.queueRequest(Date.now(),e)}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=xu(we.ACCESS_TOKEN),n=e?e.u:we.ACCESS_TOKEN;let o=n!==this.eventData.tokenU;wr(this.anonId)||(this.anonId=Or(),o=!0);const u=this.queue.shift();if(this.eventData.lastSuccess){const f=new Date(this.eventData.lastSuccess),m=new Date(u),y=(u-this.eventData.lastSuccess)/864e5;o=o||y>=1||y<-1||f.getDate()!==m.getDate()}else o=!0;o?this.postEvent(u,{sdkIdentifier:"mapbox-gl-js",sdkVersion:pe,skuId:ge,"enabled.telemetry":!1,userId:this.anonId},f=>{f||(this.eventData.lastSuccess=u,this.eventData.tokenU=n)},t):this.processRequests()}},O=ne.postTurnstileEvent.bind(ne),j=new class extends Ua{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(t,e,n,o){this.skuToken=e,this.errorCb=o,we.EVENTS_URL&&(n||we.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},n):this.errorCb(new Error(Al)))}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),wr(this.anonId)||(this.anonId=Or()),this.postEvent(n,{sdkIdentifier:"mapbox-gl-js",sdkVersion:pe,skuId:ge,skuToken:this.skuToken,userId:this.anonId},o=>{o?this.errorCb(o):e&&(this.success[e]=!0)},t))}},ee=j.postMapLoadEvent.bind(j),se=new class extends Ua{constructor(){super("gljs.performance")}postPerformanceEvent(t,e){we.EVENTS_URL&&(t||we.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},t)}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:e,performanceData:n}=this.queue.shift(),o=function(u){const f=N.performance.getEntriesByType("resource"),m=N.performance.getEntriesByType("mark"),y=function(M){const z={};if(M){for(const R in M)if(R!=="other")for(const U of M[R]){const H=`${R}RequestCount`,ie=`${R}ResolveRangeMin`,ce=`${R}ResolveRangeMax`;z[ie]=Math.min(z[ie]||1/0,U.startTime),z[ce]=Math.max(z[ce]||-1/0,U.responseEnd),z[H]===void 0&&(z[H]=0),++z[H]}}return z}(function(M,z){const R={};if(M)for(const U of M){const H=z(U);R[H]===void 0&&(R[H]=[]),R[H].push(U)}return R}(f,yt)),w=N.devicePixelRatio,A=N.navigator.connection||N.navigator.mozConnection||N.navigator.webkitConnection,B={counters:[],metadata:[],attributes:[]},I=(M,z,R)=>{R!=null&&M.push({name:z,value:R.toString()})};for(const M in y)I(B.counters,M,y[M]);if(u.interactionRange[0]!==1/0&&u.interactionRange[1]!==-1/0&&(I(B.counters,"interactionRangeMin",u.interactionRange[0]),I(B.counters,"interactionRangeMax",u.interactionRange[1])),m)for(const M of Object.keys(Pe)){const z=Pe[M],R=m.find(U=>U.name===z);R&&I(B.counters,z,R.startTime)}return I(B.attributes,"style",function(M){if(M)for(const z of M){const R=z.name.split("?")[0];if(pc(R)){const U=R.split("/").slice(-2);if(U.length===2)return`mapbox://styles/${U[0]}/${U[1]}`}}}(f)),I(B.attributes,"terrainEnabled",u.terrainEnabled?"true":"false"),I(B.attributes,"fogEnabled",u.fogEnabled?"true":"false"),I(B.attributes,"projection",u.projection.name),I(B.attributes,"zoom",u.zoom),I(B.metadata,"devicePixelRatio",w),I(B.metadata,"connectionEffectiveType",A?A.effectiveType:void 0),I(B.metadata,"navigatorUserAgent",N.navigator.userAgent),I(B.metadata,"screenWidth",N.screen.width),I(B.metadata,"screenHeight",N.screen.height),I(B.metadata,"windowWidth",N.innerWidth),I(B.metadata,"windowHeight",N.innerHeight),I(B.metadata,"mapWidth",u.width/w),I(B.metadata,"mapHeight",u.height/w),I(B.metadata,"webglRenderer",u.renderer),I(B.metadata,"webglVendor",u.vendor),I(B.metadata,"sdkVersion",pe),I(B.metadata,"sdkIdentifier","mapbox-gl-js"),B}(n);for(const u of o.metadata);for(const u of o.counters);for(const u of o.attributes);this.postEvent(e,o,()=>{},t)}},me=se.postPerformanceEvent.bind(se),De=new class extends Ua{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(t,e,n,o){if(!we.API_URL||!we.SESSION_PATH)return;const u=Mi(we.API_URL+we.SESSION_PATH);u.params.push(`sku=${e||""}`),u.params.push(`access_token=${o||we.ACCESS_TOKEN||""}`);const f={url:Ys(u),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(m,y){return jo(Mt(m,{method:"GET"}),y)}(f,m=>{this.pendingRequest=null,n(m),this.saveEventData(),this.processRequests(o)})}getSessionAPI(t,e,n,o){this.skuToken=e,this.errorCb=o,we.SESSION_PATH&&we.API_URL&&(n||we.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},n):this.errorCb(new Error(Al)))}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||this.getSession(n,this.skuToken,o=>{o?this.errorCb(o):e&&(this.success[e]=!0)},t)}},Te=De.getSessionAPI.bind(De),ye=new Set,Pe={create:"create",load:"load",fullLoad:"fullLoad"},Je={mark(t){N.performance.mark(t)},measure(t,e,n){N.performance.measure(t,e,n)}};function yt(t){const e=t.name.split("?")[0];return e.includes("mapbox-gl.js")?"javascript":e.includes("mapbox-gl.css")?"css":function(n){return we.API_FONTS_REGEX.test(n)}(e)?"fontRange":bl(e)?"sprite":pc(e)?"style":function(n){return we.API_TILEJSON_REGEX.test(n)}(e)?"tilejson":"other"}const et=N.performance;function Nt(t){const e=t?t.url.toString():void 0;return et.getEntriesByName(e)}let Ft,zt,Wt,dn;const Tn={now:()=>Wt!==void 0?Wt:N.performance.now(),setNow(t){Wt=t},restoreNow(){Wt=void 0},frame(t){const e=N.requestAnimationFrame(t);return{cancel:()=>N.cancelAnimationFrame(e)}},getImageData(t,e=0){const{width:n,height:o}=t;dn||(dn=N.document.createElement("canvas"));const u=dn.getContext("2d");if(!u)throw new Error("failed to create canvas 2d context");return(n>dn.width||o>dn.height)&&(dn.width=n,dn.height=o),u.clearRect(-e,-e,n+2*e,o+2*e),u.drawImage(t,0,0,n,o),u.getImageData(-e,-e,n+2*e,o+2*e)},resolveURL:t=>(Ft||(Ft=N.document.createElement("a")),Ft.href=t,Ft.href),get devicePixelRatio(){return N.devicePixelRatio},get prefersReducedMotion(){return!!N.matchMedia&&(zt==null&&(zt=N.matchMedia("(prefers-reduced-motion: reduce)")),zt.matches)}};function Ut(t,e,n){n[t]&&n[t].indexOf(e)!==-1||(n[t]=n[t]||[],n[t].push(e))}function Gn(t,e,n){if(n&&n[t]){const o=n[t].indexOf(e);o!==-1&&n[t].splice(o,1)}}class In{constructor(e,n={}){Mt(this,n),this.type=e}}class ea extends In{constructor(e,n={}){super("error",Mt({error:e},n))}}class As{on(e,n){return this._listeners=this._listeners||{},Ut(e,n,this._listeners),this}off(e,n){return Gn(e,n,this._listeners),Gn(e,n,this._oneTimeListeners),this}once(e,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},Ut(e,n,this._oneTimeListeners),this):new Promise(o=>this.once(e,o))}fire(e,n){typeof e=="string"&&(e=new In(e,n||{}));const o=e.type;if(this.listens(o)){e.target=this;const u=this._listeners&&this._listeners[o]?this._listeners[o].slice():[];for(const y of u)y.call(this,e);const f=this._oneTimeListeners&&this._oneTimeListeners[o]?this._oneTimeListeners[o].slice():[];for(const y of f)Gn(o,y,this._oneTimeListeners),y.call(this,e);const m=this._eventedParent;m&&(Mt(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),m.fire(e))}else e instanceof ea&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,n){return this._eventedParent=e,this._eventedParentData=n,this}}var Ne=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":true,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"cross-faded"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"cross-faded":{"type":"property-type"},"cross-faded-data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Ho(t,...e){for(const n of e)for(const o in n)t[o]=n[o];return t}function yr(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function bs(t){if(Array.isArray(t))return t.map(bs);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const e={};for(const n in t)e[n]=bs(t[n]);return e}return yr(t)}class hf extends Error{constructor(e,n){super(n),this.message=n,this.key=e}}var $o=hf;class El{constructor(e,n=[]){this.parent=e,this.bindings={};for(const[o,u]of n)this.bindings[o]=u}concat(e){return new El(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var df=El;const qa={kind:"null"},mt={kind:"number"},un={kind:"string"},fn={kind:"boolean"},Wo={kind:"color"},ja={kind:"object"},cn={kind:"value"},Bl={kind:"collator"},Tl={kind:"formatted"},Va={kind:"resolvedImage"};function ki(t,e){return{kind:"array",itemType:t,N:e}}function Hn(t){if(t.kind==="array"){const e=Hn(t.itemType);return typeof t.N=="number"?`array<${e}, ${t.N}>`:t.itemType.kind==="value"?"array":`array<${e}>`}return t.kind}const pm=[qa,mt,un,fn,Wo,Tl,ja,ki(cn),Va];function no(t,e){if(e.kind==="error")return null;if(t.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!no(t.itemType,e.itemType))&&(typeof t.N!="number"||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if(t.kind==="value"){for(const n of pm)if(!no(n,e))return null}}return`Expected ${Hn(t)} but found ${Hn(e)} instead.`}function Dl(t,e){return e.some(n=>n.kind===t.kind)}function ri(t,e){return e.some(n=>n==="null"?t===null:n==="array"?Array.isArray(t):n==="object"?t&&!Array.isArray(t)&&typeof t=="object":n===typeof t)}var ta,wu={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Au(t){return(t=Math.round(t))<0?0:t>255?255:t}function bu(t){return Au(t[t.length-1]==="%"?parseFloat(t)/100*255:parseInt(t))}function Sl(t){return(e=t[t.length-1]==="%"?parseFloat(t)/100:parseFloat(t))<0?0:e>1?1:e;var e}function na(t,e,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}try{ta={}.parseCSSColor=function(t){var e,n=t.replace(/ /g,"").toLowerCase();if(n in wu)return wu[n].slice();if(n[0]==="#")return n.length===4?(e=parseInt(n.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:n.length===7&&(e=parseInt(n.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var o=n.indexOf("("),u=n.indexOf(")");if(o!==-1&&u+1===n.length){var f=n.substr(0,o),m=n.substr(o+1,u-(o+1)).split(","),y=1;switch(f){case"rgba":if(m.length!==4)return null;y=Sl(m.pop());case"rgb":return m.length!==3?null:[bu(m[0]),bu(m[1]),bu(m[2]),y];case"hsla":if(m.length!==4)return null;y=Sl(m.pop());case"hsl":if(m.length!==3)return null;var w=(parseFloat(m[0])%360+360)%360/360,A=Sl(m[1]),B=Sl(m[2]),I=B<=.5?B*(A+1):B+A-B*A,M=2*B-I;return[Au(255*na(M,I,w+1/3)),Au(255*na(M,I,w)),Au(255*na(M,I,w-1/3)),y];default:return null}}return null}}catch{}class Xr{constructor(e,n,o,u=1){this.r=e,this.g=n,this.b=o,this.a=u}static parse(e){if(!e)return;if(e instanceof Xr)return e;if(typeof e!="string")return;const n=ta(e);return n?new Xr(n[0]/255*n[3],n[1]/255*n[3],n[2]/255*n[3],n[3]):void 0}toString(){const[e,n,o,u]=this.toArray();return`rgba(${Math.round(e)},${Math.round(n)},${Math.round(o)},${u})`}toArray(){const{r:e,g:n,b:o,a:u}=this;return u===0?[0,0,0,0]:[255*e/u,255*n/u,255*o/u,u]}toArray01(){const{r:e,g:n,b:o,a:u}=this;return u===0?[0,0,0,0]:[e/u,n/u,o/u,u]}toArray01PremultipliedAlpha(){const{r:e,g:n,b:o,a:u}=this;return[e,n,o,u]}}Xr.black=new Xr(0,0,0,1),Xr.white=new Xr(1,1,1,1),Xr.transparent=new Xr(0,0,0,0),Xr.red=new Xr(1,0,0,1),Xr.blue=new Xr(0,0,1,1);var _r=Xr;class Nh{constructor(e,n,o){this.sensitivity=e?n?"variant":"case":n?"accent":"base",this.locale=o,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,n){return this.collator.compare(e,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Uh{constructor(e,n,o,u,f){this.text=e.normalize?e.normalize():e,this.image=n,this.scale=o,this.fontStack=u,this.textColor=f}}class mi{constructor(e){this.sections=e}static fromString(e){return new mi([new Uh(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof mi?e:mi.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const n of this.sections){if(n.image){e.push(["image",n.image.name]);continue}e.push(n.text);const o={};n.fontStack&&(o["text-font"]=["literal",n.fontStack.split(",")]),n.scale&&(o["font-scale"]=n.scale),n.textColor&&(o["text-color"]=["rgba"].concat(n.textColor.toArray())),e.push(o)}return e}}class _i{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new _i({name:e,available:!1}):null}serialize(){return["image",this.name]}}function ff(t,e,n,o){return typeof t=="number"&&t>=0&&t<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof n=="number"&&n>=0&&n<=255?o===void 0||typeof o=="number"&&o>=0&&o<=1?null:`Invalid rgba value [${[t,e,n,o].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof o=="number"?[t,e,n,o]:[t,e,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ha(t){if(t===null||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||t instanceof _r||t instanceof Nh||t instanceof mi||t instanceof _i)return!0;if(Array.isArray(t)){for(const e of t)if(!Ha(e))return!1;return!0}if(typeof t=="object"){for(const e in t)if(!Ha(t[e]))return!1;return!0}return!1}function Dr(t){if(t===null)return qa;if(typeof t=="string")return un;if(typeof t=="boolean")return fn;if(typeof t=="number")return mt;if(t instanceof _r)return Wo;if(t instanceof Nh)return Bl;if(t instanceof mi)return Tl;if(t instanceof _i)return Va;if(Array.isArray(t)){const e=t.length;let n;for(const o of t){const u=Dr(o);if(n){if(n===u)continue;n=cn;break}n=u}return ki(n||cn,e)}return ja}function Cu(t){const e=typeof t;return t===null?"":e==="string"||e==="number"||e==="boolean"?String(t):t instanceof _r||t instanceof mi||t instanceof _i?t.toString():JSON.stringify(t)}class Eu{constructor(e,n){this.type=e,this.value=n}static parse(e,n){if(e.length!==2)return n.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Ha(e[1]))return n.error("invalid value");const o=e[1];let u=Dr(o);const f=n.expectedType;return u.kind!=="array"||u.N!==0||!f||f.kind!=="array"||typeof f.N=="number"&&f.N!==0||(u=f),new Eu(u,o)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof _r?["rgba"].concat(this.value.toArray()):this.value instanceof mi?this.value.serialize():this.value}}var Bu=Eu,Qr=class{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}};const qh={string:un,number:mt,boolean:fn,object:ja};class jh{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");let o,u=1;const f=e[0];if(f==="array"){let y,w;if(e.length>2){const A=e[1];if(typeof A!="string"||!(A in qh)||A==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);y=qh[A],u++}else y=cn;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return n.error('The length argument to "array" must be a positive integer literal',2);w=e[2],u++}o=ki(y,w)}else o=qh[f];const m=[];for(;u<e.length;u++){const y=n.parse(e[u],u,cn);if(!y)return null;m.push(y)}return new jh(o,m)}evaluate(e){for(let n=0;n<this.args.length;n++){const o=this.args[n].evaluate(e);if(!no(this.type,Dr(o)))return o;if(n===this.args.length-1)throw new Qr(`Expected value to be of type ${Hn(this.type)}, but found ${Hn(Dr(o))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,n=[e.kind];if(e.kind==="array"){const o=e.itemType;if(o.kind==="string"||o.kind==="number"||o.kind==="boolean"){n.push(o.kind);const u=e.N;(typeof u=="number"||this.args.length>1)&&n.push(u)}}return n.concat(this.args.map(o=>o.serialize()))}}var Ko=jh;class Rn{constructor(e){this.type=Tl,this.sections=e}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const o=e[1];if(!Array.isArray(o)&&typeof o=="object")return n.error("First argument must be an image or text section.");const u=[];let f=!1;for(let m=1;m<=e.length-1;++m){const y=e[m];if(f&&typeof y=="object"&&!Array.isArray(y)){f=!1;let w=null;if(y["font-scale"]&&(w=n.parse(y["font-scale"],1,mt),!w))return null;let A=null;if(y["text-font"]&&(A=n.parse(y["text-font"],1,ki(un)),!A))return null;let B=null;if(y["text-color"]&&(B=n.parse(y["text-color"],1,Wo),!B))return null;const I=u[u.length-1];I.scale=w,I.font=A,I.textColor=B}else{const w=n.parse(e[m],1,cn);if(!w)return null;const A=w.type.kind;if(A!=="string"&&A!=="value"&&A!=="null"&&A!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,u.push({content:w,scale:null,font:null,textColor:null})}}return new Rn(u)}evaluate(e){return new mi(this.sections.map(n=>{const o=n.content.evaluate(e);return Dr(o)===Va?new Uh("",o,null,null,null):new Uh(Cu(o),null,n.scale?n.scale.evaluate(e):null,n.font?n.font.evaluate(e).join(","):null,n.textColor?n.textColor.evaluate(e):null)}))}eachChild(e){for(const n of this.sections)e(n.content),n.scale&&e(n.scale),n.font&&e(n.font),n.textColor&&e(n.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const n of this.sections){e.push(n.content.serialize());const o={};n.scale&&(o["font-scale"]=n.scale.serialize()),n.font&&(o["text-font"]=n.font.serialize()),n.textColor&&(o["text-color"]=n.textColor.serialize()),e.push(o)}return e}}class $n{constructor(e){this.type=Va,this.input=e}static parse(e,n){if(e.length!==2)return n.error("Expected two arguments.");const o=n.parse(e[1],1,un);return o?new $n(o):n.error("No image name provided.")}evaluate(e){const n=this.input.evaluate(e),o=_i.fromString(n);return o&&e.availableImages&&(o.available=e.availableImages.indexOf(n)>-1),o}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const mm={"to-boolean":fn,"to-color":Wo,"to-number":mt,"to-string":un};class Vh{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const o=e[0];if((o==="to-boolean"||o==="to-string")&&e.length!==2)return n.error("Expected one argument.");const u=mm[o],f=[];for(let m=1;m<e.length;m++){const y=n.parse(e[m],m,cn);if(!y)return null;f.push(y)}return new Vh(u,f)}evaluate(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){let n,o;for(const u of this.args){if(n=u.evaluate(e),o=null,n instanceof _r)return n;if(typeof n=="string"){const f=e.parseColor(n);if(f)return f}else if(Array.isArray(n)&&(o=n.length<3||n.length>4?`Invalid rbga value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:ff(n[0],n[1],n[2],n[3]),!o))return new _r(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new Qr(o||`Could not parse color from value '${typeof n=="string"?n:String(JSON.stringify(n))}'`)}if(this.type.kind==="number"){let n=null;for(const o of this.args){if(n=o.evaluate(e),n===null)return 0;const u=Number(n);if(!isNaN(u))return u}throw new Qr(`Could not convert ${JSON.stringify(n)} to number.`)}return this.type.kind==="formatted"?mi.fromString(Cu(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?_i.fromString(Cu(this.args[0].evaluate(e))):Cu(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Rn([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new $n(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(n=>{e.push(n.serialize())}),e}}var Il=Vh;const _m=["Unknown","Point","LineString","Polygon"];var pf=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?_m[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const t=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:n,y:o}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(n*e-t[0])+this.featureDistanceData.bearing[1]*(o*e-t[1])}return 0}parseColor(t){let e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=_r.parse(t)),e}};class $a{constructor(e,n,o,u){this.name=e,this.type=n,this._evaluate=o,this.args=u}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,n){const o=e[0],u=$a.definitions[o];if(!u)return n.error(`Unknown expression "${o}". If you wanted a literal array, use ["literal", [...]].`,0);const f=Array.isArray(u)?u[0]:u.type,m=Array.isArray(u)?[[u[1],u[2]]]:u.overloads,y=m.filter(([A])=>!Array.isArray(A)||A.length===e.length-1);let w=null;for(const[A,B]of y){w=new Du(n.registry,n.path,null,n.scope);const I=[];let M=!1;for(let z=1;z<e.length;z++){const R=e[z],U=Array.isArray(A)?A[z-1]:A.type,H=w.parse(R,1+I.length,U);if(!H){M=!0;break}I.push(H)}if(!M)if(Array.isArray(A)&&A.length!==I.length)w.error(`Expected ${A.length} arguments, but found ${I.length} instead.`);else{for(let z=0;z<I.length;z++){const R=Array.isArray(A)?A[z]:A.type,U=I[z];w.concat(z+1).checkSubtype(R,U.type)}if(w.errors.length===0)return new $a(o,f,B,I)}}if(y.length===1)n.errors.push(...w.errors);else{const A=(y.length?y:m).map(([I])=>{return M=I,Array.isArray(M)?`(${M.map(Hn).join(", ")})`:`(${Hn(M.type)}...)`;var M}).join(" | "),B=[];for(let I=1;I<e.length;I++){const M=n.parse(e[I],1+B.length);if(!M)return null;B.push(Hn(M.type))}n.error(`Expected arguments of type ${A}, but found (${B.join(", ")}) instead.`)}return null}static register(e,n){$a.definitions=n;for(const o in n)e[o]=$a}}var ro=$a;class mc{constructor(e,n,o){this.type=Bl,this.locale=o,this.caseSensitive=e,this.diacriticSensitive=n}static parse(e,n){if(e.length!==2)return n.error("Expected one argument.");const o=e[1];if(typeof o!="object"||Array.isArray(o))return n.error("Collator options argument must be an object.");const u=n.parse(o["case-sensitive"]!==void 0&&o["case-sensitive"],1,fn);if(!u)return null;const f=n.parse(o["diacritic-sensitive"]!==void 0&&o["diacritic-sensitive"],1,fn);if(!f)return null;let m=null;return o.locale&&(m=n.parse(o.locale,1,un),!m)?null:new mc(u,f,m)}evaluate(e){return new Nh(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const mr=8192;function Tu(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function Zo(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function Co(t,e){const n=(180+t[0])/360,o=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,u=Math.pow(2,e.z);return[Math.round(n*u*mr),Math.round(o*u*mr)]}function _c(t,e,n){const o=t[0]-e[0],u=t[1]-e[1],f=t[0]-n[0],m=t[1]-n[1];return o*m-f*u==0&&o*f<=0&&u*m<=0}function gi(t,e){let n=!1;for(let m=0,y=e.length;m<y;m++){const w=e[m];for(let A=0,B=w.length;A<B-1;A++){if(_c(t,w[A],w[A+1]))return!1;(u=w[A])[1]>(o=t)[1]!=(f=w[A+1])[1]>o[1]&&o[0]<(f[0]-u[0])*(o[1]-u[1])/(f[1]-u[1])+u[0]&&(n=!n)}}var o,u,f;return n}function Hh(t,e){for(let n=0;n<e.length;n++)if(gi(t,e[n]))return!0;return!1}function gc(t,e,n,o){const u=o[0]-n[0],f=o[1]-n[1],m=(t[0]-n[0])*f-u*(t[1]-n[1]),y=(e[0]-n[0])*f-u*(e[1]-n[1]);return m>0&&y<0||m<0&&y>0}function $h(t,e,n){for(const A of n)for(let B=0;B<A.length-1;++B)if((y=[(m=A[B+1])[0]-(f=A[B])[0],m[1]-f[1]])[0]*(w=[(u=e)[0]-(o=t)[0],u[1]-o[1]])[1]-y[1]*w[0]!=0&&gc(o,u,f,m)&&gc(f,m,o,u))return!0;var o,u,f,m,y,w;return!1}function yc(t,e){for(let n=0;n<t.length;++n)if(!gi(t[n],e))return!1;for(let n=0;n<t.length-1;++n)if($h(t[n],t[n+1],e))return!1;return!0}function vc(t,e){for(let n=0;n<e.length;n++)if(yc(t,e[n]))return!0;return!1}function ra(t,e,n){const o=[];for(let u=0;u<t.length;u++){const f=[];for(let m=0;m<t[u].length;m++){const y=Co(t[u][m],n);Tu(e,y),f.push(y)}o.push(f)}return o}function yi(t,e,n){const o=[];for(let u=0;u<t.length;u++){const f=ra(t[u],e,n);o.push(f)}return o}function Wh(t,e,n,o){if(t[0]<n[0]||t[0]>n[2]){const u=.5*o;let f=t[0]-n[0]>u?-o:n[0]-t[0]>u?o:0;f===0&&(f=t[0]-n[2]>u?-o:n[2]-t[0]>u?o:0),t[0]+=f}Tu(e,t)}function vi(t,e,n,o){const u=Math.pow(2,o.z)*mr,f=[o.x*mr,o.y*mr],m=[];if(!t)return m;for(const y of t)for(const w of y){const A=[w.x+f[0],w.y+f[1]];Wh(A,e,n,u),m.push(A)}return m}function Kh(t,e,n,o){const u=Math.pow(2,o.z)*mr,f=[o.x*mr,o.y*mr],m=[];if(!t)return m;for(const w of t){const A=[];for(const B of w){const I=[B.x+f[0],B.y+f[1]];Tu(e,I),A.push(I)}m.push(A)}if(e[2]-e[0]<=u/2){(y=e)[0]=y[1]=1/0,y[2]=y[3]=-1/0;for(const w of m)for(const A of w)Wh(A,e,n,u)}var y;return m}class Eo{constructor(e,n){this.type=fn,this.geojson=e,this.geometries=n}static parse(e,n){if(e.length!==2)return n.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Ha(e[1])){const o=e[1];if(o.type==="FeatureCollection")for(let u=0;u<o.features.length;++u){const f=o.features[u].geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new Eo(o,o.features[u].geometry)}else if(o.type==="Feature"){const u=o.geometry.type;if(u==="Polygon"||u==="MultiPolygon")return new Eo(o,o.geometry)}else if(o.type==="Polygon"||o.type==="MultiPolygon")return new Eo(o,o)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(n,o){const u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],m=n.canonicalID();if(!m)return!1;if(o.type==="Polygon"){const y=ra(o.coordinates,f,m),w=vi(n.geometry(),u,f,m);if(!Zo(u,f))return!1;for(const A of w)if(!gi(A,y))return!1}if(o.type==="MultiPolygon"){const y=yi(o.coordinates,f,m),w=vi(n.geometry(),u,f,m);if(!Zo(u,f))return!1;for(const A of w)if(!Hh(A,y))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(n,o){const u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],m=n.canonicalID();if(!m)return!1;if(o.type==="Polygon"){const y=ra(o.coordinates,f,m),w=Kh(n.geometry(),u,f,m);if(!Zo(u,f))return!1;for(const A of w)if(!yc(A,y))return!1}if(o.type==="MultiPolygon"){const y=yi(o.coordinates,f,m),w=Kh(n.geometry(),u,f,m);if(!Zo(u,f))return!1;for(const A of w)if(!vc(A,y))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var gn=Eo;function ia(t){if(t instanceof ro&&(t.name==="get"&&t.args.length===1||t.name==="feature-state"||t.name==="has"&&t.args.length===1||t.name==="properties"||t.name==="geometry-type"||t.name==="id"||/^filter-/.test(t.name))||t instanceof gn)return!1;let e=!0;return t.eachChild(n=>{e&&!ia(n)&&(e=!1)}),e}function Ml(t){if(t instanceof ro&&t.name==="feature-state")return!1;let e=!0;return t.eachChild(n=>{e&&!Ml(n)&&(e=!1)}),e}function tr(t,e){if(t instanceof ro&&e.indexOf(t.name)>=0)return!1;let n=!0;return t.eachChild(o=>{n&&!tr(o,e)&&(n=!1)}),n}class Bo{constructor(e,n){this.type=n.type,this.name=e,this.boundExpression=n}static parse(e,n){if(e.length!==2||typeof e[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");const o=e[1];return n.scope.has(o)?new Bo(o,n.scope.get(o)):n.error(`Unknown variable "${o}". Make sure "${o}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var xc=Bo;class wc{constructor(e,n=[],o,u=new df,f=[]){this.registry=e,this.path=n,this.key=n.map(m=>`[${m}]`).join(""),this.scope=u,this.errors=f,this.expectedType=o}parse(e,n,o,u,f={}){return n?this.concat(n,o,u)._parse(e,f):this._parse(e,f)}_parse(e,n){function o(u,f,m){return m==="assert"?new Ko(f,[u]):m==="coerce"?new Il(f,[u]):u}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const u=e[0];if(typeof u!="string")return this.error(`Expression name must be a string, but found ${typeof u} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const f=this.registry[u];if(f){let m=f.parse(e,this);if(!m)return null;if(this.expectedType){const y=this.expectedType,w=m.type;if(y.kind!=="string"&&y.kind!=="number"&&y.kind!=="boolean"&&y.kind!=="object"&&y.kind!=="array"||w.kind!=="value")if(y.kind!=="color"&&y.kind!=="formatted"&&y.kind!=="resolvedImage"||w.kind!=="value"&&w.kind!=="string"){if(this.checkSubtype(y,w))return null}else m=o(m,y,n.typeAnnotation||"coerce");else m=o(m,y,n.typeAnnotation||"assert")}if(!(m instanceof Bu)&&m.type.kind!=="resolvedImage"&&Ac(m)){const y=new pf;try{m=new Bu(m.type,m.evaluate(y))}catch(w){return this.error(w.message),null}}return m}return this.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,n,o){const u=typeof e=="number"?this.path.concat(e):this.path,f=o?this.scope.concat(o):this.scope;return new wc(this.registry,u,n||null,f,this.errors)}error(e,...n){const o=`${this.key}${n.map(u=>`[${u}]`).join("")}`;this.errors.push(new $o(o,e))}checkSubtype(e,n){const o=no(e,n);return o&&this.error(o),o}}var Du=wc;function Ac(t){if(t instanceof xc)return Ac(t.boundExpression);if(t instanceof ro&&t.name==="error"||t instanceof mc||t instanceof gn)return!1;const e=t instanceof Il||t instanceof Ko;let n=!0;return t.eachChild(o=>{n=e?n&&Ac(o):n&&o instanceof Bu}),!!n&&ia(t)&&tr(t,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Su(t,e){const n=t.length-1;let o,u,f=0,m=n,y=0;for(;f<=m;)if(y=Math.floor((f+m)/2),o=t[y],u=t[y+1],o<=e){if(y===n||e<u)return y;f=y+1}else{if(!(o>e))throw new Qr("Input is not a number.");m=y-1}return 0}class oa{constructor(e,n,o){this.type=e,this.input=n,this.labels=[],this.outputs=[];for(const[u,f]of o)this.labels.push(u),this.outputs.push(f)}static parse(e,n){if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");const o=n.parse(e[1],1,mt);if(!o)return null;const u=[];let f=null;n.expectedType&&n.expectedType.kind!=="value"&&(f=n.expectedType);for(let m=1;m<e.length;m+=2){const y=m===1?-1/0:e[m],w=e[m+1],A=m,B=m+1;if(typeof y!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',A);if(u.length&&u[u.length-1][0]>=y)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',A);const I=n.parse(w,B,f);if(!I)return null;f=f||I.type,u.push([y,I])}return new oa(f,o,u)}evaluate(e){const n=this.labels,o=this.outputs;if(n.length===1)return o[0].evaluate(e);const u=this.input.evaluate(e);if(u<=n[0])return o[0].evaluate(e);const f=n.length;return u>=n[f-1]?o[f-1].evaluate(e):o[Su(n,u)].evaluate(e)}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let n=0;n<this.labels.length;n++)n>0&&e.push(this.labels[n]),e.push(this.outputs[n].serialize());return e}}var Wa=oa;function xn(t,e,n){return t*(1-n)+e*n}var To=Object.freeze({__proto__:null,number:xn,color:function(t,e,n){return new _r(xn(t.r,e.r,n),xn(t.g,e.g,n),xn(t.b,e.b,n),xn(t.a,e.a,n))},array:function(t,e,n){return t.map((o,u)=>xn(o,e[u],n))}});const Zh=.95047,Jh=1.08883,Xh=4/29,kl=6/29,bc=3*kl*kl,Qh=Math.PI/180,mf=180/Math.PI;function Iu(t){return t>.008856451679035631?Math.pow(t,1/3):t/bc+Xh}function Pl(t){return t>kl?t*t*t:bc*(t-Xh)}function Yh(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Mu(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function xi(t){const e=Mu(t.r),n=Mu(t.g),o=Mu(t.b),u=Iu((.4124564*e+.3575761*n+.1804375*o)/Zh),f=Iu((.2126729*e+.7151522*n+.072175*o)/1);return{l:116*f-16,a:500*(u-f),b:200*(f-Iu((.0193339*e+.119192*n+.9503041*o)/Jh)),alpha:t.a}}function Cc(t){let e=(t.l+16)/116,n=isNaN(t.a)?e:e+t.a/500,o=isNaN(t.b)?e:e-t.b/200;return e=1*Pl(e),n=Zh*Pl(n),o=Jh*Pl(o),new _r(Yh(3.2404542*n-1.5371385*e-.4985314*o),Yh(-.969266*n+1.8760108*e+.041556*o),Yh(.0556434*n-.2040259*e+1.0572252*o),t.alpha)}function ku(t,e,n){const o=e-t;return t+n*(o>180||o<-180?o-360*Math.round(o/360):o)}const Ll={forward:xi,reverse:Cc,interpolate:function(t,e,n){return{l:xn(t.l,e.l,n),a:xn(t.a,e.a,n),b:xn(t.b,e.b,n),alpha:xn(t.alpha,e.alpha,n)}}},zl={forward:function(t){const{l:e,a:n,b:o}=xi(t),u=Math.atan2(o,n)*mf;return{h:u<0?u+360:u,c:Math.sqrt(n*n+o*o),l:e,alpha:t.a}},reverse:function(t){const e=t.h*Qh,n=t.c;return Cc({l:t.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:t.alpha})},interpolate:function(t,e,n){return{h:ku(t.h,e.h,n),c:xn(t.c,e.c,n),l:xn(t.l,e.l,n),alpha:xn(t.alpha,e.alpha,n)}}};var _f=Object.freeze({__proto__:null,lab:Ll,hcl:zl});class Ec{constructor(e,n,o,u,f){this.type=e,this.operator=n,this.interpolation=o,this.input=u,this.labels=[],this.outputs=[];for(const[m,y]of f)this.labels.push(m),this.outputs.push(y)}static interpolationFactor(e,n,o,u){let f=0;if(e.name==="exponential")f=Bc(n,e.base,o,u);else if(e.name==="linear")f=Bc(n,1,o,u);else if(e.name==="cubic-bezier"){const m=e.controlPoints;f=new Be(m[0],m[1],m[2],m[3]).solve(Bc(n,1,o,u))}return f}static parse(e,n){let[o,u,f,...m]=e;if(!Array.isArray(u)||u.length===0)return n.error("Expected an interpolation type expression.",1);if(u[0]==="linear")u={name:"linear"};else if(u[0]==="exponential"){const A=u[1];if(typeof A!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:A}}else{if(u[0]!=="cubic-bezier")return n.error(`Unknown interpolation type ${String(u[0])}`,1,0);{const A=u.slice(1);if(A.length!==4||A.some(B=>typeof B!="number"||B<0||B>1))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:A}}}if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(f=n.parse(f,2,mt),!f)return null;const y=[];let w=null;o==="interpolate-hcl"||o==="interpolate-lab"?w=Wo:n.expectedType&&n.expectedType.kind!=="value"&&(w=n.expectedType);for(let A=0;A<m.length;A+=2){const B=m[A],I=m[A+1],M=A+3,z=A+4;if(typeof B!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(y.length&&y[y.length-1][0]>=B)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',M);const R=n.parse(I,z,w);if(!R)return null;w=w||R.type,y.push([B,R])}return w.kind==="number"||w.kind==="color"||w.kind==="array"&&w.itemType.kind==="number"&&typeof w.N=="number"?new Ec(w,o,u,f,y):n.error(`Type ${Hn(w)} is not interpolatable.`)}evaluate(e){const n=this.labels,o=this.outputs;if(n.length===1)return o[0].evaluate(e);const u=this.input.evaluate(e);if(u<=n[0])return o[0].evaluate(e);const f=n.length;if(u>=n[f-1])return o[f-1].evaluate(e);const m=Su(n,u),y=Ec.interpolationFactor(this.interpolation,u,n[m],n[m+1]),w=o[m].evaluate(e),A=o[m+1].evaluate(e);return this.operator==="interpolate"?To[this.type.kind.toLowerCase()](w,A,y):this.operator==="interpolate-hcl"?zl.reverse(zl.interpolate(zl.forward(w),zl.forward(A),y)):Ll.reverse(Ll.interpolate(Ll.forward(w),Ll.forward(A),y))}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const n=[this.operator,e,this.input.serialize()];for(let o=0;o<this.labels.length;o++)n.push(this.labels[o],this.outputs[o].serialize());return n}}function Bc(t,e,n,o){const u=o-n,f=t-n;return u===0?0:e===1?f/u:(Math.pow(e,f)-1)/(Math.pow(e,u)-1)}var Jo=Ec;class ed{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expectected at least one argument.");let o=null;const u=n.expectedType;u&&u.kind!=="value"&&(o=u);const f=[];for(const y of e.slice(1)){const w=n.parse(y,1+f.length,o,void 0,{typeAnnotation:"omit"});if(!w)return null;o=o||w.type,f.push(w)}const m=u&&f.some(y=>no(u,y.type));return new ed(m?cn:o,f)}evaluate(e){let n,o=null,u=0;for(const f of this.args){if(u++,o=f.evaluate(e),o&&o instanceof _i&&!o.available&&(n||(n=o),o=null,u===this.args.length))return n;if(o!==null)break}return o}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(n=>{e.push(n.serialize())}),e}}var Ka=ed;class td{constructor(e,n){this.type=n.type,this.bindings=[].concat(e),this.result=n}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const n of this.bindings)e(n[1]);e(this.result)}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const o=[];for(let f=1;f<e.length-1;f+=2){const m=e[f];if(typeof m!="string")return n.error(`Expected string, but found ${typeof m} instead.`,f);if(/[^a-zA-Z0-9_]/.test(m))return n.error("Variable names must contain only alphanumeric characters or '_'.",f);const y=n.parse(e[f+1],f+1);if(!y)return null;o.push([m,y])}const u=n.parse(e[e.length-1],e.length-1,n.expectedType,o);return u?new td(o,u):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[n,o]of this.bindings)e.push(n,o.serialize());return e.push(this.result.serialize()),e}}var nd=td;class Fl{constructor(e,n,o){this.type=e,this.index=n,this.input=o}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const o=n.parse(e[1],1,mt),u=n.parse(e[2],2,ki(n.expectedType||cn));return o&&u?new Fl(u.type.itemType,o,u):null}evaluate(e){const n=this.index.evaluate(e),o=this.input.evaluate(e);if(n<0)throw new Qr(`Array index out of bounds: ${n} < 0.`);if(n>=o.length)throw new Qr(`Array index out of bounds: ${n} > ${o.length-1}.`);if(n!==Math.floor(n))throw new Qr(`Array index must be an integer, but found ${n} instead.`);return o[n]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var rd=Fl;class Xo{constructor(e,n){this.type=fn,this.needle=e,this.haystack=n}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const o=n.parse(e[1],1,cn),u=n.parse(e[2],2,cn);return o&&u?Dl(o.type,[fn,un,mt,qa,cn])?new Xo(o,u):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Hn(o.type)} instead`):null}evaluate(e){const n=this.needle.evaluate(e),o=this.haystack.evaluate(e);if(o==null)return!1;if(!ri(n,["boolean","string","number","null"]))throw new Qr(`Expected first argument to be of type boolean, string, number or null, but found ${Hn(Dr(n))} instead.`);if(!ri(o,["string","array"]))throw new Qr(`Expected second argument to be of type array or string, but found ${Hn(Dr(o))} instead.`);return o.indexOf(n)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Tc=Xo;class Pu{constructor(e,n,o){this.type=mt,this.needle=e,this.haystack=n,this.fromIndex=o}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const o=n.parse(e[1],1,cn),u=n.parse(e[2],2,cn);if(!o||!u)return null;if(!Dl(o.type,[fn,un,mt,qa,cn]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Hn(o.type)} instead`);if(e.length===4){const f=n.parse(e[3],3,mt);return f?new Pu(o,u,f):null}return new Pu(o,u)}evaluate(e){const n=this.needle.evaluate(e),o=this.haystack.evaluate(e);if(!ri(n,["boolean","string","number","null"]))throw new Qr(`Expected first argument to be of type boolean, string, number or null, but found ${Hn(Dr(n))} instead.`);if(!ri(o,["string","array"]))throw new Qr(`Expected second argument to be of type array or string, but found ${Hn(Dr(o))} instead.`);if(this.fromIndex){const u=this.fromIndex.evaluate(e);return o.indexOf(n,u)}return o.indexOf(n)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var gf=Pu;class Dc{constructor(e,n,o,u,f,m){this.inputType=e,this.type=n,this.input=o,this.cases=u,this.outputs=f,this.otherwise=m}static parse(e,n){if(e.length<5)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return n.error("Expected an even number of arguments.");let o,u;n.expectedType&&n.expectedType.kind!=="value"&&(u=n.expectedType);const f={},m=[];for(let A=2;A<e.length-1;A+=2){let B=e[A];const I=e[A+1];Array.isArray(B)||(B=[B]);const M=n.concat(A);if(B.length===0)return M.error("Expected at least one branch label.");for(const R of B){if(typeof R!="number"&&typeof R!="string")return M.error("Branch labels must be numbers or strings.");if(typeof R=="number"&&Math.abs(R)>Number.MAX_SAFE_INTEGER)return M.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof R=="number"&&Math.floor(R)!==R)return M.error("Numeric branch labels must be integer values.");if(o){if(M.checkSubtype(o,Dr(R)))return null}else o=Dr(R);if(f[String(R)]!==void 0)return M.error("Branch labels must be unique.");f[String(R)]=m.length}const z=n.parse(I,A,u);if(!z)return null;u=u||z.type,m.push(z)}const y=n.parse(e[1],1,cn);if(!y)return null;const w=n.parse(e[e.length-1],e.length-1,u);return w?y.type.kind!=="value"&&n.concat(1).checkSubtype(o,y.type)?null:new Dc(o,u,y,f,m,w):null}evaluate(e){const n=this.input.evaluate(e);return(Dr(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],n=Object.keys(this.cases).sort(),o=[],u={};for(const m of n){const y=u[this.cases[m]];y===void 0?(u[this.cases[m]]=o.length,o.push([this.cases[m],[m]])):o[y][1].push(m)}const f=m=>this.inputType.kind==="number"?Number(m):m;for(const[m,y]of o)e.push(y.length===1?f(y[0]):y.map(f)),e.push(this.outputs[m].serialize());return e.push(this.otherwise.serialize()),e}}var Rl=Dc;class qi{constructor(e,n,o){this.type=e,this.branches=n,this.otherwise=o}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return n.error("Expected an odd number of arguments.");let o;n.expectedType&&n.expectedType.kind!=="value"&&(o=n.expectedType);const u=[];for(let m=1;m<e.length-1;m+=2){const y=n.parse(e[m],m,fn);if(!y)return null;const w=n.parse(e[m+1],m+1,o);if(!w)return null;u.push([y,w]),o=o||w.type}const f=n.parse(e[e.length-1],e.length-1,o);return f?new qi(o,u,f):null}evaluate(e){for(const[n,o]of this.branches)if(n.evaluate(e))return o.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[n,o]of this.branches)e(n),e(o);e(this.otherwise)}outputDefined(){return this.branches.every(([e,n])=>n.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(n=>{e.push(n.serialize())}),e}}var yf=qi;class Sc{constructor(e,n,o,u){this.type=e,this.input=n,this.beginIndex=o,this.endIndex=u}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const o=n.parse(e[1],1,cn),u=n.parse(e[2],2,mt);if(!o||!u)return null;if(!Dl(o.type,[ki(cn),un,cn]))return n.error(`Expected first argument to be of type array or string, but found ${Hn(o.type)} instead`);if(e.length===4){const f=n.parse(e[3],3,mt);return f?new Sc(o.type,o,u,f):null}return new Sc(o.type,o,u)}evaluate(e){const n=this.input.evaluate(e),o=this.beginIndex.evaluate(e);if(!ri(n,["string","array"]))throw new Qr(`Expected first argument to be of type array or string, but found ${Hn(Dr(n))} instead.`);if(this.endIndex){const u=this.endIndex.evaluate(e);return n.slice(o,u)}return n.slice(o)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var Ic=Sc;function id(t,e){return t==="=="||t==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function od(t,e,n,o){return o.compare(e,n)===0}function Ol(t,e,n){const o=t!=="=="&&t!=="!=";return class VB{constructor(f,m,y){this.type=fn,this.lhs=f,this.rhs=m,this.collator=y,this.hasUntypedArgument=f.type.kind==="value"||m.type.kind==="value"}static parse(f,m){if(f.length!==3&&f.length!==4)return m.error("Expected two or three arguments.");const y=f[0];let w=m.parse(f[1],1,cn);if(!w)return null;if(!id(y,w.type))return m.concat(1).error(`"${y}" comparisons are not supported for type '${Hn(w.type)}'.`);let A=m.parse(f[2],2,cn);if(!A)return null;if(!id(y,A.type))return m.concat(2).error(`"${y}" comparisons are not supported for type '${Hn(A.type)}'.`);if(w.type.kind!==A.type.kind&&w.type.kind!=="value"&&A.type.kind!=="value")return m.error(`Cannot compare types '${Hn(w.type)}' and '${Hn(A.type)}'.`);o&&(w.type.kind==="value"&&A.type.kind!=="value"?w=new Ko(A.type,[w]):w.type.kind!=="value"&&A.type.kind==="value"&&(A=new Ko(w.type,[A])));let B=null;if(f.length===4){if(w.type.kind!=="string"&&A.type.kind!=="string"&&w.type.kind!=="value"&&A.type.kind!=="value")return m.error("Cannot use collator to compare non-string types.");if(B=m.parse(f[3],3,Bl),!B)return null}return new VB(w,A,B)}evaluate(f){const m=this.lhs.evaluate(f),y=this.rhs.evaluate(f);if(o&&this.hasUntypedArgument){const w=Dr(m),A=Dr(y);if(w.kind!==A.kind||w.kind!=="string"&&w.kind!=="number")throw new Qr(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${w.kind}, ${A.kind}) instead.`)}if(this.collator&&!o&&this.hasUntypedArgument){const w=Dr(m),A=Dr(y);if(w.kind!=="string"||A.kind!=="string")return e(f,m,y)}return this.collator?n(f,m,y,this.collator.evaluate(f)):e(f,m,y)}eachChild(f){f(this.lhs),f(this.rhs),this.collator&&f(this.collator)}outputDefined(){return!0}serialize(){const f=[t];return this.eachChild(m=>{f.push(m.serialize())}),f}}}const Gl=Ol("==",function(t,e,n){return e===n},od),Se=Ol("!=",function(t,e,n){return e!==n},function(t,e,n,o){return!od(0,e,n,o)}),Ke=Ol("<",function(t,e,n){return e<n},function(t,e,n,o){return o.compare(e,n)<0}),Ue=Ol(">",function(t,e,n){return e>n},function(t,e,n,o){return o.compare(e,n)>0}),Pt=Ol("<=",function(t,e,n){return e<=n},function(t,e,n,o){return o.compare(e,n)<=0}),hn=Ol(">=",function(t,e,n){return e>=n},function(t,e,n,o){return o.compare(e,n)>=0});class zn{constructor(e,n,o,u,f,m){this.type=un,this.number=e,this.locale=n,this.currency=o,this.unit=u,this.minFractionDigits=f,this.maxFractionDigits=m}static parse(e,n){if(e.length!==3)return n.error("Expected two arguments.");const o=n.parse(e[1],1,mt);if(!o)return null;const u=e[2];if(typeof u!="object"||Array.isArray(u))return n.error("NumberFormat options argument must be an object.");let f=null;if(u.locale&&(f=n.parse(u.locale,1,un),!f))return null;let m=null;if(u.currency&&(m=n.parse(u.currency,1,un),!m))return null;let y=null;if(u.unit&&(y=n.parse(u.unit,1,un),!y))return null;let w=null;if(u["min-fraction-digits"]&&(w=n.parse(u["min-fraction-digits"],1,mt),!w))return null;let A=null;return u["max-fraction-digits"]&&(A=n.parse(u["max-fraction-digits"],1,mt),!A)?null:new zn(o,f,m,y,w,A)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class Ar{constructor(e){this.type=mt,this.input=e}static parse(e,n){if(e.length!==2)return n.error(`Expected 1 argument, but found ${e.length-1} instead.`);const o=n.parse(e[1],1);return o?o.type.kind!=="array"&&o.type.kind!=="string"&&o.type.kind!=="value"?n.error(`Expected argument of type string or array, but found ${Hn(o.type)} instead.`):new Ar(o):null}evaluate(e){const n=this.input.evaluate(e);if(typeof n=="string"||Array.isArray(n))return n.length;throw new Qr(`Expected value to be of type string or array, but found ${Hn(Dr(n))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(n=>{e.push(n.serialize())}),e}}const Yn={"==":Gl,"!=":Se,">":Ue,"<":Ke,">=":hn,"<=":Pt,array:Ko,at:rd,boolean:Ko,case:yf,coalesce:Ka,collator:mc,format:Rn,image:$n,in:Tc,"index-of":gf,interpolate:Jo,"interpolate-hcl":Jo,"interpolate-lab":Jo,length:Ar,let:nd,literal:Bu,match:Rl,number:Ko,"number-format":zn,object:Ko,slice:Ic,step:Wa,string:Ko,"to-boolean":Il,"to-color":Il,"to-number":Il,"to-string":Il,var:xc,within:gn};function Mc(t,[e,n,o,u]){e=e.evaluate(t),n=n.evaluate(t),o=o.evaluate(t);const f=u?u.evaluate(t):1,m=ff(e,n,o,f);if(m)throw new Qr(m);return new _r(e/255*f,n/255*f,o/255*f,f)}function vf(t,e){return t in e}function Pi(t,e){const n=e[t];return n===void 0?null:n}function Qo(t){return{type:t}}ro.register(Yn,{error:[{kind:"error"},[un],(t,[e])=>{throw new Qr(e.evaluate(t))}],typeof:[un,[cn],(t,[e])=>Hn(Dr(e.evaluate(t)))],"to-rgba":[ki(mt,4),[Wo],(t,[e])=>e.evaluate(t).toArray()],rgb:[Wo,[mt,mt,mt],Mc],rgba:[Wo,[mt,mt,mt,mt],Mc],has:{type:fn,overloads:[[[un],(t,[e])=>vf(e.evaluate(t),t.properties())],[[un,ja],(t,[e,n])=>vf(e.evaluate(t),n.evaluate(t))]]},get:{type:cn,overloads:[[[un],(t,[e])=>Pi(e.evaluate(t),t.properties())],[[un,ja],(t,[e,n])=>Pi(e.evaluate(t),n.evaluate(t))]]},"feature-state":[cn,[un],(t,[e])=>Pi(e.evaluate(t),t.featureState||{})],properties:[ja,[],t=>t.properties()],"geometry-type":[un,[],t=>t.geometryType()],id:[cn,[],t=>t.id()],zoom:[mt,[],t=>t.globals.zoom],pitch:[mt,[],t=>t.globals.pitch||0],"distance-from-center":[mt,[],t=>t.distanceFromCenter()],"heatmap-density":[mt,[],t=>t.globals.heatmapDensity||0],"line-progress":[mt,[],t=>t.globals.lineProgress||0],"sky-radial-progress":[mt,[],t=>t.globals.skyRadialProgress||0],accumulated:[cn,[],t=>t.globals.accumulated===void 0?null:t.globals.accumulated],"+":[mt,Qo(mt),(t,e)=>{let n=0;for(const o of e)n+=o.evaluate(t);return n}],"*":[mt,Qo(mt),(t,e)=>{let n=1;for(const o of e)n*=o.evaluate(t);return n}],"-":{type:mt,overloads:[[[mt,mt],(t,[e,n])=>e.evaluate(t)-n.evaluate(t)],[[mt],(t,[e])=>-e.evaluate(t)]]},"/":[mt,[mt,mt],(t,[e,n])=>e.evaluate(t)/n.evaluate(t)],"%":[mt,[mt,mt],(t,[e,n])=>e.evaluate(t)%n.evaluate(t)],ln2:[mt,[],()=>Math.LN2],pi:[mt,[],()=>Math.PI],e:[mt,[],()=>Math.E],"^":[mt,[mt,mt],(t,[e,n])=>Math.pow(e.evaluate(t),n.evaluate(t))],sqrt:[mt,[mt],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[mt,[mt],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[mt,[mt],(t,[e])=>Math.log(e.evaluate(t))],log2:[mt,[mt],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[mt,[mt],(t,[e])=>Math.sin(e.evaluate(t))],cos:[mt,[mt],(t,[e])=>Math.cos(e.evaluate(t))],tan:[mt,[mt],(t,[e])=>Math.tan(e.evaluate(t))],asin:[mt,[mt],(t,[e])=>Math.asin(e.evaluate(t))],acos:[mt,[mt],(t,[e])=>Math.acos(e.evaluate(t))],atan:[mt,[mt],(t,[e])=>Math.atan(e.evaluate(t))],min:[mt,Qo(mt),(t,e)=>Math.min(...e.map(n=>n.evaluate(t)))],max:[mt,Qo(mt),(t,e)=>Math.max(...e.map(n=>n.evaluate(t)))],abs:[mt,[mt],(t,[e])=>Math.abs(e.evaluate(t))],round:[mt,[mt],(t,[e])=>{const n=e.evaluate(t);return n<0?-Math.round(-n):Math.round(n)}],floor:[mt,[mt],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[mt,[mt],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[fn,[un,cn],(t,[e,n])=>t.properties()[e.value]===n.value],"filter-id-==":[fn,[cn],(t,[e])=>t.id()===e.value],"filter-type-==":[fn,[un],(t,[e])=>t.geometryType()===e.value],"filter-<":[fn,[un,cn],(t,[e,n])=>{const o=t.properties()[e.value],u=n.value;return typeof o==typeof u&&o<u}],"filter-id-<":[fn,[cn],(t,[e])=>{const n=t.id(),o=e.value;return typeof n==typeof o&&n<o}],"filter->":[fn,[un,cn],(t,[e,n])=>{const o=t.properties()[e.value],u=n.value;return typeof o==typeof u&&o>u}],"filter-id->":[fn,[cn],(t,[e])=>{const n=t.id(),o=e.value;return typeof n==typeof o&&n>o}],"filter-<=":[fn,[un,cn],(t,[e,n])=>{const o=t.properties()[e.value],u=n.value;return typeof o==typeof u&&o<=u}],"filter-id-<=":[fn,[cn],(t,[e])=>{const n=t.id(),o=e.value;return typeof n==typeof o&&n<=o}],"filter->=":[fn,[un,cn],(t,[e,n])=>{const o=t.properties()[e.value],u=n.value;return typeof o==typeof u&&o>=u}],"filter-id->=":[fn,[cn],(t,[e])=>{const n=t.id(),o=e.value;return typeof n==typeof o&&n>=o}],"filter-has":[fn,[cn],(t,[e])=>e.value in t.properties()],"filter-has-id":[fn,[],t=>t.id()!==null&&t.id()!==void 0],"filter-type-in":[fn,[ki(un)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[fn,[ki(cn)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[fn,[un,ki(cn)],(t,[e,n])=>n.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[fn,[un,ki(cn)],(t,[e,n])=>function(o,u,f,m){for(;f<=m;){const y=f+m>>1;if(u[y]===o)return!0;u[y]>o?m=y-1:f=y+1}return!1}(t.properties()[e.value],n.value,0,n.value.length-1)],all:{type:fn,overloads:[[[fn,fn],(t,[e,n])=>e.evaluate(t)&&n.evaluate(t)],[Qo(fn),(t,e)=>{for(const n of e)if(!n.evaluate(t))return!1;return!0}]]},any:{type:fn,overloads:[[[fn,fn],(t,[e,n])=>e.evaluate(t)||n.evaluate(t)],[Qo(fn),(t,e)=>{for(const n of e)if(n.evaluate(t))return!0;return!1}]]},"!":[fn,[fn],(t,[e])=>!e.evaluate(t)],"is-supported-script":[fn,[un],(t,[e])=>{const n=t.globals&&t.globals.isSupportedScript;return!n||n(e.evaluate(t))}],upcase:[un,[un],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[un,[un],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[un,Qo(cn),(t,e)=>e.map(n=>Cu(n.evaluate(t))).join("")],"resolved-locale":[un,[Bl],(t,[e])=>e.evaluate(t).resolvedLocale()]});var Nl=Yn;function sa(t){return{result:"success",value:t}}function io(t){return{result:"error",value:t}}function Cs(t){return t["property-type"]==="data-driven"||t["property-type"]==="cross-faded-data-driven"}function qn(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function Yo(t){return!!t.expression&&t.expression.interpolated}function En(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":t===null?"null":typeof t}function oo(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function gm(t){return t}function xf(t,e){const n=e.type==="color",o=t.stops&&typeof t.stops[0][0]=="object",u=o||!(o||t.property!==void 0),f=t.type||(Yo(e)?"exponential":"interval");if(n&&((t=Ho({},t)).stops&&(t.stops=t.stops.map(A=>[A[0],_r.parse(A[1])])),t.default=_r.parse(t.default?t.default:e.default)),t.colorSpace&&t.colorSpace!=="rgb"&&!_f[t.colorSpace])throw new Error(`Unknown color space: ${t.colorSpace}`);let m,y,w;if(f==="exponential")m=ql;else if(f==="interval")m=es;else if(f==="categorical"){m=kc,y=Object.create(null);for(const A of t.stops)y[A[0]]=A[1];w=typeof t.stops[0][0]}else{if(f!=="identity")throw new Error(`Unknown function type "${f}"`);m=Pc}if(o){const A={},B=[];for(let z=0;z<t.stops.length;z++){const R=t.stops[z],U=R[0].zoom;A[U]===void 0&&(A[U]={zoom:U,type:t.type,property:t.property,default:t.default,stops:[]},B.push(U)),A[U].stops.push([R[0].value,R[1]])}const I=[];for(const z of B)I.push([A[z].zoom,xf(A[z],e)]);const M={name:"linear"};return{kind:"composite",interpolationType:M,interpolationFactor:Jo.interpolationFactor.bind(void 0,M),zoomStops:I.map(z=>z[0]),evaluate:({zoom:z},R)=>ql({stops:I,base:t.base},e,z).evaluate(z,R)}}if(u){const A=f==="exponential"?{name:"exponential",base:t.base!==void 0?t.base:1}:null;return{kind:"camera",interpolationType:A,interpolationFactor:Jo.interpolationFactor.bind(void 0,A),zoomStops:t.stops.map(B=>B[0]),evaluate:({zoom:B})=>m(t,e,B,y,w)}}return{kind:"source",evaluate(A,B){const I=B&&B.properties?B.properties[t.property]:void 0;return I===void 0?Ul(t.default,e.default):m(t,e,I,y,w)}}}function Ul(t,e,n){return t!==void 0?t:e!==void 0?e:n!==void 0?n:void 0}function kc(t,e,n,o,u){return Ul(typeof n===u?o[n]:void 0,t.default,e.default)}function es(t,e,n){if(En(n)!=="number")return Ul(t.default,e.default);const o=t.stops.length;if(o===1||n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[o-1][0])return t.stops[o-1][1];const u=Su(t.stops.map(f=>f[0]),n);return t.stops[u][1]}function ql(t,e,n){const o=t.base!==void 0?t.base:1;if(En(n)!=="number")return Ul(t.default,e.default);const u=t.stops.length;if(u===1||n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[u-1][0])return t.stops[u-1][1];const f=Su(t.stops.map(B=>B[0]),n),m=function(B,I,M,z){const R=z-M,U=B-M;return R===0?0:I===1?U/R:(Math.pow(I,U)-1)/(Math.pow(I,R)-1)}(n,o,t.stops[f][0],t.stops[f+1][0]),y=t.stops[f][1],w=t.stops[f+1][1];let A=To[e.type]||gm;if(t.colorSpace&&t.colorSpace!=="rgb"){const B=_f[t.colorSpace];A=(I,M)=>B.reverse(B.interpolate(B.forward(I),B.forward(M),m))}return typeof y.evaluate=="function"?{evaluate(...B){const I=y.evaluate.apply(void 0,B),M=w.evaluate.apply(void 0,B);if(I!==void 0&&M!==void 0)return A(I,M,m)}}:A(y,w,m)}function Pc(t,e,n){return e.type==="color"?n=_r.parse(n):e.type==="formatted"?n=mi.fromString(n.toString()):e.type==="resolvedImage"?n=_i.fromString(n.toString()):En(n)===e.type||e.type==="enum"&&e.values[n]||(n=void 0),Ul(n,t.default,e.default)}class aa{constructor(e,n){this.expression=e,this._warningHistory={},this._evaluator=new pf,this._defaultValue=n?function(o){return o.type==="color"&&(oo(o.default)||Array.isArray(o.default))?new _r(0,0,0,0):o.type==="color"?_r.parse(o.default)||null:o.default===void 0?null:o.default}(n):null,this._enumValues=n&&n.type==="enum"?n.values:null}evaluateWithoutErrorHandling(e,n,o,u,f,m,y,w){return this._evaluator.globals=e,this._evaluator.feature=n,this._evaluator.featureState=o,this._evaluator.canonical=u||null,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=m,this._evaluator.featureTileCoord=y||null,this._evaluator.featureDistanceData=w||null,this.expression.evaluate(this._evaluator)}evaluate(e,n,o,u,f,m,y,w){this._evaluator.globals=e,this._evaluator.feature=n||null,this._evaluator.featureState=o||null,this._evaluator.canonical=u||null,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=m||null,this._evaluator.featureTileCoord=y||null,this._evaluator.featureDistanceData=w||null;try{const A=this.expression.evaluate(this._evaluator);if(A==null||typeof A=="number"&&A!=A)return this._defaultValue;if(this._enumValues&&!(A in this._enumValues))throw new Qr(`Expected value to be one of ${Object.keys(this._enumValues).map(B=>JSON.stringify(B)).join(", ")}, but found ${JSON.stringify(A)} instead.`);return A}catch(A){return this._warningHistory[A.message]||(this._warningHistory[A.message]=!0,typeof console<"u"&&console.warn(A.message)),this._defaultValue}}}function jl(t){return Array.isArray(t)&&t.length>0&&typeof t[0]=="string"&&t[0]in Nl}function la(t,e){const n=new Du(Nl,[],e?function(u){const f={color:Wo,string:un,number:mt,enum:un,boolean:fn,formatted:Tl,resolvedImage:Va};return u.type==="array"?ki(f[u.value]||cn,u.length):f[u.type]}(e):void 0),o=n.parse(t,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return o?sa(new aa(o,e)):io(n.errors)}class Za{constructor(e,n){this.kind=e,this._styleExpression=n,this.isStateDependent=e!=="constant"&&!Ml(n.expression)}evaluateWithoutErrorHandling(e,n,o,u,f,m){return this._styleExpression.evaluateWithoutErrorHandling(e,n,o,u,f,m)}evaluate(e,n,o,u,f,m){return this._styleExpression.evaluate(e,n,o,u,f,m)}}class Lu{constructor(e,n,o,u){this.kind=e,this.zoomStops=o,this._styleExpression=n,this.isStateDependent=e!=="camera"&&!Ml(n.expression),this.interpolationType=u}evaluateWithoutErrorHandling(e,n,o,u,f,m){return this._styleExpression.evaluateWithoutErrorHandling(e,n,o,u,f,m)}evaluate(e,n,o,u,f,m){return this._styleExpression.evaluate(e,n,o,u,f,m)}interpolationFactor(e,n,o){return this.interpolationType?Jo.interpolationFactor(this.interpolationType,e,n,o):0}}function Es(t,e){if((t=la(t,e)).result==="error")return t;const n=t.value.expression,o=ia(n);if(!o&&!Cs(e))return io([new $o("","data expressions not supported")]);const u=tr(n,["zoom","pitch","distance-from-center"]);if(!u&&!qn(e))return io([new $o("","zoom expressions not supported")]);const f=ua(n);return f||u?f instanceof $o?io([f]):f instanceof Jo&&!Yo(e)?io([new $o("",'"interpolate" expressions cannot be used with this property')]):sa(f?new Lu(o?"camera":"composite",t.value,f.labels,f instanceof Jo?f.interpolation:void 0):new Za(o?"constant":"source",t.value)):io([new $o("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class wi{constructor(e,n){this._parameters=e,this._specification=n,Ho(this,xf(this._parameters,this._specification))}static deserialize(e){return new wi(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function ua(t){let e=null;if(t instanceof nd)e=ua(t.result);else if(t instanceof Ka){for(const n of t.args)if(e=ua(n),e)break}else(t instanceof Wa||t instanceof Jo)&&t.input instanceof ro&&t.input.name==="zoom"&&(e=t);return e instanceof $o||t.eachChild(n=>{const o=ua(n);o instanceof $o?e=o:!e&&o?e=new $o("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&o&&e!==o&&(e=new $o("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}class vt{constructor(e,n,o,u){this.message=(e?`${e}: `:"")+o,u&&(this.identifier=u),n!=null&&n.__line__&&(this.line=n.__line__)}}function ji(t){const e=t.key,n=t.value,o=t.valueSpec||{},u=t.objectElementValidators||{},f=t.style,m=t.styleSpec;let y=[];const w=En(n);if(w!=="object")return[new vt(e,n,`object expected, ${w} found`)];for(const A in n){const B=A.split(".")[0],I=o[B]||o["*"];let M;u[B]?M=u[B]:o[B]?M=Nr:u["*"]?M=u["*"]:o["*"]&&(M=Nr),M?y=y.concat(M({key:(e&&`${e}.`)+A,value:n[A],valueSpec:I,style:f,styleSpec:m,object:n,objectKey:A},n)):y.push(new vt(e,n[A],`unknown property "${A}"`))}for(const A in o)u[A]||o[A].required&&o[A].default===void 0&&n[A]===void 0&&y.push(new vt(e,n,`missing required property "${A}"`));return y}function sd(t){const e=t.value,n=t.valueSpec,o=t.style,u=t.styleSpec,f=t.key,m=t.arrayElementValidator||Nr;if(En(e)!=="array")return[new vt(f,e,`array expected, ${En(e)} found`)];if(n.length&&e.length!==n.length)return[new vt(f,e,`array length ${n.length} expected, length ${e.length} found`)];if(n["min-length"]&&e.length<n["min-length"])return[new vt(f,e,`array length at least ${n["min-length"]} expected, length ${e.length} found`)];let y={type:n.value,values:n.values,minimum:n.minimum,maximum:n.maximum,function:void 0};u.$version<7&&(y.function=n.function),En(n.value)==="object"&&(y=n.value);let w=[];for(let A=0;A<e.length;A++)w=w.concat(m({array:e,arrayIndex:A,value:e[A],valueSpec:y,style:o,styleSpec:u,key:`${f}[${A}]`}));return w}function zu(t){const e=t.key,n=t.value,o=t.valueSpec;let u=En(n);if(u==="number"&&n!=n&&(u="NaN"),u!=="number")return[new vt(e,n,`number expected, ${u} found`)];if("minimum"in o){let f=o.minimum;if(En(o.minimum)==="array"&&(f=o.minimum[t.arrayIndex]),n<f)return[new vt(e,n,`${n} is less than the minimum value ${f}`)]}if("maximum"in o){let f=o.maximum;if(En(o.maximum)==="array"&&(f=o.maximum[t.arrayIndex]),n>f)return[new vt(e,n,`${n} is greater than the maximum value ${f}`)]}return[]}function Vl(t){const e=t.valueSpec,n=yr(t.value.type);let o,u,f,m={};const y=n!=="categorical"&&t.value.property===void 0,w=!y,A=En(t.value.stops)==="array"&&En(t.value.stops[0])==="array"&&En(t.value.stops[0][0])==="object",B=ji({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(z){if(n==="identity")return[new vt(z.key,z.value,'identity function may not have a "stops" property')];let R=[];const U=z.value;return R=R.concat(sd({key:z.key,value:U,valueSpec:z.valueSpec,style:z.style,styleSpec:z.styleSpec,arrayElementValidator:I})),En(U)==="array"&&U.length===0&&R.push(new vt(z.key,U,"array must have at least one stop")),R},default:function(z){return Nr({key:z.key,value:z.value,valueSpec:e,style:z.style,styleSpec:z.styleSpec})}}});return n==="identity"&&y&&B.push(new vt(t.key,t.value,'missing required property "property"')),n==="identity"||t.value.stops||B.push(new vt(t.key,t.value,'missing required property "stops"')),n==="exponential"&&t.valueSpec.expression&&!Yo(t.valueSpec)&&B.push(new vt(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(w&&!Cs(t.valueSpec)?B.push(new vt(t.key,t.value,"property functions not supported")):y&&!qn(t.valueSpec)&&B.push(new vt(t.key,t.value,"zoom functions not supported"))),n!=="categorical"&&!A||t.value.property!==void 0||B.push(new vt(t.key,t.value,'"property" property is required')),B;function I(z){let R=[];const U=z.value,H=z.key;if(En(U)!=="array")return[new vt(H,U,`array expected, ${En(U)} found`)];if(U.length!==2)return[new vt(H,U,`array length 2 expected, length ${U.length} found`)];if(A){if(En(U[0])!=="object")return[new vt(H,U,`object expected, ${En(U[0])} found`)];if(U[0].zoom===void 0)return[new vt(H,U,"object stop key must have zoom")];if(U[0].value===void 0)return[new vt(H,U,"object stop key must have value")];const ie=yr(U[0].zoom);if(typeof ie!="number")return[new vt(H,U[0].zoom,"stop zoom values must be numbers")];if(f&&f>ie)return[new vt(H,U[0].zoom,"stop zoom values must appear in ascending order")];ie!==f&&(f=ie,u=void 0,m={}),R=R.concat(ji({key:`${H}[0]`,value:U[0],valueSpec:{zoom:{}},style:z.style,styleSpec:z.styleSpec,objectElementValidators:{zoom:zu,value:M}}))}else R=R.concat(M({key:`${H}[0]`,value:U[0],valueSpec:{},style:z.style,styleSpec:z.styleSpec},U));return jl(bs(U[1]))?R.concat([new vt(`${H}[1]`,U[1],"expressions are not allowed in function stops.")]):R.concat(Nr({key:`${H}[1]`,value:U[1],valueSpec:e,style:z.style,styleSpec:z.styleSpec}))}function M(z,R){const U=En(z.value),H=yr(z.value),ie=z.value!==null?z.value:R;if(o){if(U!==o)return[new vt(z.key,ie,`${U} stop domain type must match previous stop domain type ${o}`)]}else o=U;if(U!=="number"&&U!=="string"&&U!=="boolean"&&typeof H!="number"&&typeof H!="string"&&typeof H!="boolean")return[new vt(z.key,ie,"stop domain value must be a number, string, or boolean")];if(U!=="number"&&n!=="categorical"){let ce=`number expected, ${U} found`;return Cs(e)&&n===void 0&&(ce+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new vt(z.key,ie,ce)]}return n!=="categorical"||U!=="number"||typeof H=="number"&&isFinite(H)&&Math.floor(H)===H?n!=="categorical"&&U==="number"&&typeof H=="number"&&typeof u=="number"&&u!==void 0&&H<u?[new vt(z.key,ie,"stop domain values must appear in ascending order")]:(u=H,n==="categorical"&&H in m?[new vt(z.key,ie,"stop domain values must be unique")]:(m[H]=!0,[])):[new vt(z.key,ie,`integer expected, found ${String(H)}`)]}}function Do(t){const e=(t.expressionContext==="property"?Es:la)(bs(t.value),t.valueSpec);if(e.result==="error")return e.value.map(o=>new vt(`${t.key}${o.key}`,t.value,o.message));const n=e.value.expression||e.value._styleExpression.expression;if(t.expressionContext==="property"&&t.propertyKey==="text-font"&&!n.outputDefined())return[new vt(t.key,t.value,`Invalid data expression for "${t.propertyKey}". Output values must be contained as literals within the expression.`)];if(t.expressionContext==="property"&&t.propertyType==="layout"&&!Ml(n))return[new vt(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if(t.expressionContext==="filter")return wf(n,t);if(t.expressionContext&&t.expressionContext.indexOf("cluster")===0){if(!tr(n,["zoom","feature-state"]))return[new vt(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(t.expressionContext==="cluster-initial"&&!ia(n))return[new vt(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function wf(t,e){const n=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(e.valueSpec&&e.valueSpec.expression)for(const u of e.valueSpec.expression.parameters)n.delete(u);if(n.size===0)return[];const o=[];return t instanceof ro&&n.has(t.name)?[new vt(e.key,e.value,`["${t.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(t.eachChild(u=>{o.push(...wf(u,e))}),o)}function Fu(t){const e=t.key,n=t.value,o=t.valueSpec,u=[];return Array.isArray(o.values)?o.values.indexOf(yr(n))===-1&&u.push(new vt(e,n,`expected one of [${o.values.join(", ")}], ${JSON.stringify(n)} found`)):Object.keys(o.values).indexOf(yr(n))===-1&&u.push(new vt(e,n,`expected one of [${Object.keys(o.values).join(", ")}], ${JSON.stringify(n)} found`)),u}function ad(t){if(t===!0||t===!1)return!0;if(!Array.isArray(t)||t.length===0)return!1;switch(t[0]){case"has":return t.length>=2&&t[1]!=="$id"&&t[1]!=="$type";case"in":return t.length>=3&&(typeof t[1]!="string"||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return t.length!==3||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(const e of t.slice(1))if(!ad(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function Lc(t,e="fill"){if(t==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};ad(t)||(t=Hl(t));const n=t;let o=!0;try{o=function(A){if(!Bs(A))return A;let B=bs(A);return Ir(B),B=Sr(B),B}(n)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(n,null,2)}
        `)}const u=Ne[`filter_${e}`],f=la(o,u);let m=null;if(f.result==="error")throw new Error(f.value.map(A=>`${A.key}: ${A.message}`).join(", "));m=(A,B,I)=>f.value.evaluate(A,B,{},I);let y=null,w=null;if(o!==n){const A=la(n,u);if(A.result==="error")throw new Error(A.value.map(B=>`${B.key}: ${B.message}`).join(", "));y=(B,I,M,z,R)=>A.value.evaluate(B,I,{},M,void 0,void 0,z,R),w=!ia(A.value.expression)}return{filter:m,dynamicFilter:y||void 0,needGeometry:Af(o),needFeature:!!w}}function Sr(t){if(!Array.isArray(t))return t;const e=function(n){if(Vi.has(n[0])){for(let o=1;o<n.length;o++)if(Bs(n[o]))return!0}return n}(t);return e===!0?e:e.map(n=>Sr(n))}function Ir(t){let e=!1;const n=[];if(t[0]==="case"){for(let o=1;o<t.length-1;o+=2)e=e||Bs(t[o]),n.push(t[o+1]);n.push(t[t.length-1])}else if(t[0]==="match"){e=e||Bs(t[1]);for(let o=2;o<t.length-1;o+=2)n.push(t[o+1]);n.push(t[t.length-1])}else if(t[0]==="step"){e=e||Bs(t[1]);for(let o=1;o<t.length-1;o+=2)n.push(t[o+1])}e&&(t.length=0,t.push("any",...n));for(let o=1;o<t.length;o++)Ir(t[o])}function Bs(t){if(!Array.isArray(t))return!1;if((e=t[0])==="pitch"||e==="distance-from-center")return!0;var e;for(let n=1;n<t.length;n++)if(Bs(t[n]))return!0;return!1}const Vi=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Ru(t,e){return t<e?-1:t>e?1:0}function Af(t){if(!Array.isArray(t))return!1;if(t[0]==="within")return!0;for(let e=1;e<t.length;e++)if(Af(t[e]))return!0;return!1}function Hl(t){if(!t)return!0;const e=t[0];return t.length<=1?e!=="any":e==="=="?Ja(t[1],t[2],"=="):e==="!="?ca(Ja(t[1],t[2],"==")):e==="<"||e===">"||e==="<="||e===">="?Ja(t[1],t[2],e):e==="any"?(n=t.slice(1),["any"].concat(n.map(Hl))):e==="all"?["all"].concat(t.slice(1).map(Hl)):e==="none"?["all"].concat(t.slice(1).map(Hl).map(ca)):e==="in"?zc(t[1],t.slice(2)):e==="!in"?ca(zc(t[1],t.slice(2))):e==="has"?Ts(t[1]):e==="!has"?ca(Ts(t[1])):e!=="within"||t;var n}function Ja(t,e,n){switch(t){case"$type":return[`filter-type-${n}`,e];case"$id":return[`filter-id-${n}`,e];default:return[`filter-${n}`,t,e]}}function zc(t,e){if(e.length===0)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(n=>typeof n!=typeof e[0])?["filter-in-large",t,["literal",e.sort(Ru)]]:["filter-in-small",t,["literal",e]]}}function Ts(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function ca(t){return["!",t]}function Ds(t){return ad(bs(t.value))?Do(Ho({},t,{expressionContext:"filter",valueSpec:t.styleSpec[`filter_${t.layerType||"fill"}`]})):Ou(t)}function Ou(t){const e=t.value,n=t.key;if(En(e)!=="array")return[new vt(n,e,`array expected, ${En(e)} found`)];const o=t.styleSpec;let u,f=[];if(e.length<1)return[new vt(n,e,"filter array must have at least 1 element")];switch(f=f.concat(Fu({key:`${n}[0]`,value:e[0],valueSpec:o.filter_operator,style:t.style,styleSpec:t.styleSpec})),yr(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&yr(e[1])==="$type"&&f.push(new vt(n,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&f.push(new vt(n,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(u=En(e[1]),u!=="string"&&f.push(new vt(`${n}[1]`,e[1],`string expected, ${u} found`)));for(let m=2;m<e.length;m++)u=En(e[m]),yr(e[1])==="$type"?f=f.concat(Fu({key:`${n}[${m}]`,value:e[m],valueSpec:o.geometry_type,style:t.style,styleSpec:t.styleSpec})):u!=="string"&&u!=="number"&&u!=="boolean"&&f.push(new vt(`${n}[${m}]`,e[m],`string, number, or boolean expected, ${u} found`));break;case"any":case"all":case"none":for(let m=1;m<e.length;m++)f=f.concat(Ou({key:`${n}[${m}]`,value:e[m],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":u=En(e[1]),e.length!==2?f.push(new vt(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):u!=="string"&&f.push(new vt(`${n}[1]`,e[1],`string expected, ${u} found`));break;case"within":u=En(e[1]),e.length!==2?f.push(new vt(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):u!=="object"&&f.push(new vt(`${n}[1]`,e[1],`object expected, ${u} found`))}return f}function Xa(t,e){const n=t.key,o=t.style,u=t.styleSpec,f=t.value,m=t.objectKey,y=u[`${e}_${t.layerType}`];if(!y)return[];const w=m.match(/^(.*)-transition$/);if(e==="paint"&&w&&y[w[1]]&&y[w[1]].transition)return Nr({key:n,value:f,valueSpec:u.transition,style:o,styleSpec:u});const A=t.valueSpec||y[m];if(!A)return[new vt(n,f,`unknown property "${m}"`)];let B;if(En(f)==="string"&&Cs(A)&&!A.tokens&&(B=/^{([^}]+)}$/.exec(f)))return[new vt(n,f,`"${m}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(B[1])} }\`.`)];const I=[];return t.layerType==="symbol"&&(m==="text-field"&&o&&!o.glyphs&&I.push(new vt(n,f,'use of "text-field" requires a style "glyphs" property')),m==="text-font"&&oo(bs(f))&&yr(f.type)==="identity"&&I.push(new vt(n,f,'"text-font" does not support identity functions'))),I.concat(Nr({key:t.key,value:f,valueSpec:A,style:o,styleSpec:u,expressionContext:"property",propertyType:e,propertyKey:m}))}function Fc(t){return Xa(t,"paint")}function bf(t){return Xa(t,"layout")}function ld(t){let e=[];const n=t.value,o=t.key,u=t.style,f=t.styleSpec;n.type||n.ref||e.push(new vt(o,n,'either "type" or "ref" is required'));let m=yr(n.type);const y=yr(n.ref);if(n.id){const w=yr(n.id);for(let A=0;A<t.arrayIndex;A++){const B=u.layers[A];yr(B.id)===w&&e.push(new vt(o,n.id,`duplicate layer id "${n.id}", previously used at line ${B.id.__line__}`))}}if("ref"in n){let w;["type","source","source-layer","filter","layout"].forEach(A=>{A in n&&e.push(new vt(o,n[A],`"${A}" is prohibited for ref layers`))}),u.layers.forEach(A=>{yr(A.id)===y&&(w=A)}),w?w.ref?e.push(new vt(o,n.ref,"ref cannot reference another ref layer")):m=yr(w.type):typeof y=="string"&&e.push(new vt(o,n.ref,`ref layer "${y}" not found`))}else if(m!=="background"&&m!=="sky")if(n.source){const w=u.sources&&u.sources[n.source],A=w&&yr(w.type);w?A==="vector"&&m==="raster"?e.push(new vt(o,n.source,`layer "${n.id}" requires a raster source`)):A==="raster"&&m!=="raster"?e.push(new vt(o,n.source,`layer "${n.id}" requires a vector source`)):A!=="vector"||n["source-layer"]?A==="raster-dem"&&m!=="hillshade"?e.push(new vt(o,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):m!=="line"||!n.paint||!n.paint["line-gradient"]&&!n.paint["line-trim-offset"]||A==="geojson"&&w.lineMetrics||e.push(new vt(o,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new vt(o,n,`layer "${n.id}" must specify a "source-layer"`)):e.push(new vt(o,n.source,`source "${n.source}" not found`))}else e.push(new vt(o,n,'missing required property "source"'));return e=e.concat(ji({key:o,value:n,valueSpec:f.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Nr({key:`${o}.type`,value:n.type,valueSpec:f.layer.type,style:t.style,styleSpec:t.styleSpec,object:n,objectKey:"type"}),filter:w=>Ds(Ho({layerType:m},w)),layout:w=>ji({layer:n,key:w.key,value:w.value,valueSpec:{},style:w.style,styleSpec:w.styleSpec,objectElementValidators:{"*":A=>bf(Ho({layerType:m},A))}}),paint:w=>ji({layer:n,key:w.key,value:w.value,valueSpec:{},style:w.style,styleSpec:w.styleSpec,objectElementValidators:{"*":A=>Fc(Ho({layerType:m},A))}})}})),e}function Qa(t){const e=t.value,n=t.key,o=En(e);return o!=="string"?[new vt(n,e,`string expected, ${o} found`)]:[]}const Cf={promoteId:function({key:t,value:e}){if(En(e)==="string")return Qa({key:t,value:e});{const n=[];for(const o in e)n.push(...Qa({key:`${t}.${o}`,value:e[o]}));return n}}};function Ya(t){const e=t.value,n=t.key,o=t.styleSpec,u=t.style;if(!e.type)return[new vt(n,e,'"type" is required')];const f=yr(e.type);let m;switch(f){case"vector":case"raster":case"raster-dem":return m=ji({key:n,value:e,valueSpec:o[`source_${f.replace("-","_")}`],style:t.style,styleSpec:o,objectElementValidators:Cf}),m;case"geojson":if(m=ji({key:n,value:e,valueSpec:o.source_geojson,style:u,styleSpec:o,objectElementValidators:Cf}),e.cluster)for(const y in e.clusterProperties){const[w,A]=e.clusterProperties[y],B=typeof w=="string"?[w,["accumulated"],["get",y]]:w;m.push(...Do({key:`${n}.${y}.map`,value:A,expressionContext:"cluster-map"})),m.push(...Do({key:`${n}.${y}.reduce`,value:B,expressionContext:"cluster-reduce"}))}return m;case"video":return ji({key:n,value:e,valueSpec:o.source_video,style:u,styleSpec:o});case"image":return ji({key:n,value:e,valueSpec:o.source_image,style:u,styleSpec:o});case"canvas":return[new vt(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Fu({key:`${n}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:u,styleSpec:o})}}function Ss(t){const e=t.value,n=t.styleSpec,o=n.light,u=t.style;let f=[];const m=En(e);if(e===void 0)return f;if(m!=="object")return f=f.concat([new vt("light",e,`object expected, ${m} found`)]),f;for(const y in e){const w=y.match(/^(.*)-transition$/);f=f.concat(w&&o[w[1]]&&o[w[1]].transition?Nr({key:y,value:e[y],valueSpec:n.transition,style:u,styleSpec:n}):o[y]?Nr({key:y,value:e[y],valueSpec:o[y],style:u,styleSpec:n}):[new vt(y,e[y],`unknown property "${y}"`)])}return f}function Rc(t){const e=t.value,n=t.key,o=t.style,u=t.styleSpec,f=u.terrain;let m=[];const y=En(e);if(e===void 0)return m;if(y!=="object")return m=m.concat([new vt("terrain",e,`object expected, ${y} found`)]),m;for(const w in e){const A=w.match(/^(.*)-transition$/);m=m.concat(A&&f[A[1]]&&f[A[1]].transition?Nr({key:w,value:e[w],valueSpec:u.transition,style:o,styleSpec:u}):f[w]?Nr({key:w,value:e[w],valueSpec:f[w],style:o,styleSpec:u}):[new vt(w,e[w],`unknown property "${w}"`)])}if(e.source){const w=o.sources&&o.sources[e.source],A=w&&yr(w.type);w?A!=="raster-dem"&&m.push(new vt(n,e.source,`terrain cannot be used with a source of type ${String(A)}, it only be used with a "raster-dem" source type`)):m.push(new vt(n,e.source,`source "${e.source}" not found`))}else m.push(new vt(n,e,'terrain is missing required property "source"'));return m}function K(t){const e=t.value,n=t.style,o=t.styleSpec,u=o.fog;let f=[];const m=En(e);if(e===void 0)return f;if(m!=="object")return f=f.concat([new vt("fog",e,`object expected, ${m} found`)]),f;for(const y in e){const w=y.match(/^(.*)-transition$/);f=f.concat(w&&u[w[1]]&&u[w[1]].transition?Nr({key:y,value:e[y],valueSpec:o.transition,style:n,styleSpec:o}):u[y]?Nr({key:y,value:e[y],valueSpec:u[y],style:n,styleSpec:o}):[new vt(y,e[y],`unknown property "${y}"`)])}return f}const ha={"*":()=>[],array:sd,boolean:function(t){const e=t.value,n=t.key,o=En(e);return o!=="boolean"?[new vt(n,e,`boolean expected, ${o} found`)]:[]},number:zu,color:function(t){const e=t.key,n=t.value,o=En(n);return o!=="string"?[new vt(e,n,`color expected, ${o} found`)]:ta(n)===null?[new vt(e,n,`color expected, "${n}" found`)]:[]},enum:Fu,filter:Ds,function:Vl,layer:ld,object:ji,source:Ya,light:Ss,terrain:Rc,fog:K,string:Qa,formatted:function(t){return Qa(t).length===0?[]:Do(t)},resolvedImage:function(t){return Qa(t).length===0?[]:Do(t)},projection:function(t){const e=t.value,n=t.styleSpec,o=n.projection,u=t.style;let f=[];const m=En(e);if(m==="object")for(const y in e)f=f.concat(Nr({key:y,value:e[y],valueSpec:o[y],style:u,styleSpec:n}));else m!=="string"&&(f=f.concat([new vt("projection",e,`object or string expected, ${m} found`)]));return f}};function Nr(t){const e=t.value,n=t.valueSpec,o=t.styleSpec;return n.expression&&oo(yr(e))?Vl(t):n.expression&&jl(bs(e))?Do(t):n.type&&ha[n.type]?ha[n.type](t):ji(Ho({},t,{valueSpec:n.type?o[n.type]:n}))}function Li(t){const e=t.value,n=t.key,o=Qa(t);return o.length||(e.indexOf("{fontstack}")===-1&&o.push(new vt(n,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&o.push(new vt(n,e,'"glyphs" url must include a "{range}" token'))),o}function An(t,e=Ne){return Is(Nr({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:Li,"*":()=>[]}}))}const ym=t=>Is(Fc(t)),vm=t=>Is(bf(t));function Is(t){return t.slice().sort((e,n)=>e.line&&n.line?e.line-n.line:0)}function Ms(t,e){let n=!1;if(e&&e.length)for(const o of e)t.fire(new ea(new Error(o.message))),n=!0;return n}var $l=ts;function ts(t,e,n){var o=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var u=new Int32Array(this.arrayBuffer);t=u[0],this.d=(e=u[1])+2*(n=u[2]);for(var f=0;f<this.d*this.d;f++){var m=u[3+f],y=u[3+f+1];o.push(m===y?null:u.subarray(m,y))}var w=u[3+o.length+1];this.keys=u.subarray(u[3+o.length],w),this.bboxes=u.subarray(w),this.insert=this._insertReadonly}else{this.d=e+2*n;for(var A=0;A<this.d*this.d;A++)o.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=n,this.scale=e/t,this.uid=0;var B=n/e*t;this.min=-B,this.max=t+B}ts.prototype.insert=function(t,e,n,o,u){this._forEachCell(e,n,o,u,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(o),this.bboxes.push(u)},ts.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},ts.prototype._insertCell=function(t,e,n,o,u,f){this.cells[u].push(f)},ts.prototype.query=function(t,e,n,o,u){var f=this.min,m=this.max;if(t<=f&&e<=f&&m<=n&&m<=o&&!u)return Array.prototype.slice.call(this.keys);var y=[];return this._forEachCell(t,e,n,o,this._queryCell,y,{},u),y},ts.prototype._queryCell=function(t,e,n,o,u,f,m,y){var w=this.cells[u];if(w!==null)for(var A=this.keys,B=this.bboxes,I=0;I<w.length;I++){var M=w[I];if(m[M]===void 0){var z=4*M;(y?y(B[z+0],B[z+1],B[z+2],B[z+3]):t<=B[z+2]&&e<=B[z+3]&&n>=B[z+0]&&o>=B[z+1])?(m[M]=!0,f.push(A[M])):m[M]=!1}}},ts.prototype._forEachCell=function(t,e,n,o,u,f,m,y){for(var w=this._convertToCellCoord(t),A=this._convertToCellCoord(e),B=this._convertToCellCoord(n),I=this._convertToCellCoord(o),M=w;M<=B;M++)for(var z=A;z<=I;z++){var R=this.d*z+M;if((!y||y(this._convertFromCellCoord(M),this._convertFromCellCoord(z),this._convertFromCellCoord(M+1),this._convertFromCellCoord(z+1)))&&u.call(this,t,e,n,o,R,f,m,y))return}},ts.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},ts.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},ts.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=3+this.cells.length+1+1,n=0,o=0;o<this.cells.length;o++)n+=this.cells[o].length;var u=new Int32Array(e+n+this.keys.length+this.bboxes.length);u[0]=this.extent,u[1]=this.n,u[2]=this.padding;for(var f=e,m=0;m<t.length;m++){var y=t[m];u[3+m]=f,u.set(y,f),f+=y.length}return u[3+t.length]=f,u.set(this.keys,f),u[3+t.length+1]=f+=this.keys.length,u.set(this.bboxes,f),f+=this.bboxes.length,u.buffer};const Oc={};function wt(t,e,n={}){Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),Oc[e]={klass:t,omit:n.omit||[]}}wt(Object,"Object"),$l.serialize=function(t,e){const n=t.toArrayBuffer();return e&&e.push(n),{buffer:n}},$l.deserialize=function(t){return new $l(t.buffer)},Object.defineProperty($l,"name",{value:"Grid"}),wt($l,"Grid"),wt(_r,"Color"),wt(Error,"Error"),wt(Oa,"AJAXError"),wt(_i,"ResolvedImage"),wt(wi,"StylePropertyFunction"),wt(aa,"StyleExpression",{omit:["_evaluator"]}),wt(Lu,"ZoomDependentExpression"),wt(Za,"ZoomConstantExpression"),wt(ro,"CompoundExpression",{omit:["_evaluate"]});for(const t in Nl)Oc[Nl[t]._classRegistryKey]||wt(Nl[t],`Expression${t}`);function Ef(t){return t&&typeof ArrayBuffer<"u"&&(t instanceof ArrayBuffer||t.constructor&&t.constructor.name==="ArrayBuffer")}function ns(t){return N.ImageBitmap&&t instanceof N.ImageBitmap}function Gu(t,e){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(Ef(t)||ns(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){const n=t;return e&&e.push(n.buffer),n}if(t instanceof N.ImageData)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){const n=[];for(const o of t)n.push(Gu(o,e));return n}if(typeof t=="object"){const n=t.constructor,o=n._classRegistryKey;if(!o)throw new Error(`can't serialize object of unregistered class ${o}`);const u=n.serialize?n.serialize(t,e):{};if(!n.serialize){for(const f in t)t.hasOwnProperty(f)&&(Oc[o].omit.indexOf(f)>=0||(u[f]=Gu(t[f],e)));t instanceof Error&&(u.message=t.message)}if(u.$name)throw new Error("$name property is reserved for worker serialization logic.");return o!=="Object"&&(u.$name=o),u}throw new Error("can't serialize object of type "+typeof t)}function da(t){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||Ef(t)||ns(t)||ArrayBuffer.isView(t)||t instanceof N.ImageData)return t;if(Array.isArray(t))return t.map(da);if(typeof t=="object"){const e=t.$name||"Object",{klass:n}=Oc[e];if(!n)throw new Error(`can't deserialize unregistered class ${e}`);if(n.deserialize)return n.deserialize(t);const o=Object.create(n.prototype);for(const u of Object.keys(t))u!=="$name"&&(o[u]=da(t[u]));return o}throw new Error("can't deserialize object of type "+typeof t)}class Bf{constructor(){this.first=!0}update(e,n){const o=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=o,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=o,!0):(this.lastFloorZoom>o?(this.lastIntegerZoom=o+1,this.lastIntegerZoomTime=n):this.lastFloorZoom<o&&(this.lastIntegerZoom=o,this.lastIntegerZoomTime=n),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=o,!0))}}const Tf=t=>t>=1536&&t<=1791,Nu=t=>t>=1872&&t<=1919,rs=t=>t>=2208&&t<=2303,ud=t=>t>=11904&&t<=12031,Df=t=>t>=12032&&t<=12255,cd=t=>t>=12272&&t<=12287,Uu=t=>t>=12288&&t<=12351,Gc=t=>t>=12352&&t<=12447,So=t=>t>=12448&&t<=12543,Nc=t=>t>=12544&&t<=12591,Uc=t=>t>=12704&&t<=12735,so=t=>t>=12736&&t<=12783,Sf=t=>t>=12784&&t<=12799,hd=t=>t>=12800&&t<=13055,If=t=>t>=13056&&t<=13311,Mf=t=>t>=13312&&t<=19903,dd=t=>t>=19968&&t<=40959,qu=t=>t>=40960&&t<=42127,fd=t=>t>=42128&&t<=42191,kf=t=>t>=44032&&t<=55215,Pf=t=>t>=63744&&t<=64255,ju=t=>t>=64336&&t<=65023,Wl=t=>t>=65040&&t<=65055,el=t=>t>=65072&&t<=65103,Vu=t=>t>=65104&&t<=65135,h=t=>t>=65136&&t<=65279,r=t=>t>=65280&&t<=65519;function l(t){for(const e of t)if(x(e.charCodeAt(0)))return!0;return!1}function p(t){for(const e of t)if(!g(e.charCodeAt(0)))return!1;return!0}function g(t){return!(Tf(t)||Nu(t)||rs(t)||ju(t)||h(t))}function x(t){return!(t!==746&&t!==747&&(t<4352||!(Uc(t)||Nc(t)||el(t)&&!(t>=65097&&t<=65103)||Pf(t)||If(t)||ud(t)||so(t)||!(!Uu(t)||t>=12296&&t<=12305||t>=12308&&t<=12319||t===12336)||Mf(t)||dd(t)||hd(t)||(e=>e>=12592&&e<=12687)(t)||(e=>e>=43360&&e<=43391)(t)||(e=>e>=55216&&e<=55295)(t)||(e=>e>=4352&&e<=4607)(t)||kf(t)||Gc(t)||cd(t)||(e=>e>=12688&&e<=12703)(t)||Df(t)||Sf(t)||So(t)&&t!==12540||!(!r(t)||t===65288||t===65289||t===65293||t>=65306&&t<=65310||t===65339||t===65341||t===65343||t>=65371&&t<=65503||t===65507||t>=65512&&t<=65519)||!(!Vu(t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||(e=>e>=5120&&e<=5759)(t)||(e=>e>=6320&&e<=6399)(t)||Wl(t)||(e=>e>=19904&&e<=19967)(t)||qu(t)||fd(t))))}function b(t){return!(x(t)||function(e){return!!((n=>n>=128&&n<=255)(e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||(n=>n>=8192&&n<=8303)(e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||(n=>n>=8448&&n<=8527)(e)||(n=>n>=8528&&n<=8591)(e)||(n=>n>=8960&&n<=9215)(e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||(n=>n>=9216&&n<=9279)(e)&&e!==9251||(n=>n>=9280&&n<=9311)(e)||(n=>n>=9312&&n<=9471)(e)||(n=>n>=9632&&n<=9727)(e)||(n=>n>=9728&&n<=9983)(e)&&!(e>=9754&&e<=9759)||(n=>n>=11008&&n<=11263)(e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Uu(e)||So(e)||(n=>n>=57344&&n<=63743)(e)||el(e)||Vu(e)||r(e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(t))}function T(t){return t>=1424&&t<=2303||ju(t)||h(t)}function S(t,e){return!(!e&&T(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||(n=>n>=6016&&n<=6143)(t))}function k(t){for(const e of t)if(T(e.charCodeAt(0)))return!0;return!1}const L="deferred",G="loading",V="loaded";let X=null,Z="unavailable",Y=null;const W=function(t){t&&typeof t=="string"&&t.indexOf("NetworkError")>-1&&(Z="error"),X&&X(t)};function $(){te.fire(new In("pluginStateChange",{pluginStatus:Z,pluginURL:Y}))}const te=new As,J=function(){return Z},le=function(){if(Z!==L||!Y)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Z=G,$(),Y&&Vo({url:Y},t=>{t?W(t):(Z=V,$())})},ue={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Z===V||ue.applyArabicShaping!=null,isLoading:()=>Z===G,setState(t){Z=t.pluginStatus,Y=t.pluginURL},isParsed:()=>ue.applyArabicShaping!=null&&ue.processBidirectionalText!=null&&ue.processStyledBidirectionalText!=null,getPluginURL:()=>Y};class oe{constructor(e,n){this.zoom=e,n?(this.now=n.now,this.fadeDuration=n.fadeDuration,this.zoomHistory=n.zoomHistory,this.transition=n.transition,this.pitch=n.pitch):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Bf,this.transition={},this.pitch=0)}isSupportedScript(e){return function(n,o){for(const u of n)if(!S(u.charCodeAt(0),o))return!1;return!0}(e,ue.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,n=e-Math.floor(e),o=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:n+(1-n)*o}:{fromScale:.5,toScale:1,t:1-(1-o)*n}}}class fe{constructor(e,n){this.property=e,this.value=n,this.expression=function(o,u){if(oo(o))return new wi(o,u);if(jl(o)){const f=Es(o,u);if(f.result==="error")throw new Error(f.value.map(m=>`${m.key}: ${m.message}`).join(", "));return f.value}{let f=o;return typeof o=="string"&&u.type==="color"&&(f=_r.parse(o)),{kind:"constant",evaluate:()=>f}}}(n===void 0?e.specification.default:n,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,n,o){return this.property.possiblyEvaluate(this,e,n,o)}}class Ee{constructor(e){this.property=e,this.value=new fe(e,void 0)}transitioned(e,n){return new Le(this.property,this.value,n,Mt({},e.transition,this.transition),e.now)}untransitioned(){return new Le(this.property,this.value,null,{},0)}}class Oe{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return Ui(this._values[e].value.value)}setValue(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new Ee(this._values[e].property)),this._values[e].value=new fe(this._values[e].property,n===null?void 0:Ui(n))}getTransition(e){return Ui(this._values[e].transition)}setTransition(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new Ee(this._values[e].property)),this._values[e].transition=Ui(n)||void 0}serialize(){const e={};for(const n of Object.keys(this._values)){const o=this.getValue(n);o!==void 0&&(e[n]=o);const u=this.getTransition(n);u!==void 0&&(e[`${n}-transition`]=u)}return e}transitioned(e,n){const o=new tt(this._properties);for(const u of Object.keys(this._values))o._values[u]=this._values[u].transitioned(e,n._values[u]);return o}untransitioned(){const e=new tt(this._properties);for(const n of Object.keys(this._values))e._values[n]=this._values[n].untransitioned();return e}}class Le{constructor(e,n,o,u,f){const m=u.delay||0,y=u.duration||0;f=f||0,this.property=e,this.value=n,this.begin=f+m,this.end=this.begin+y,e.specification.transition&&(u.delay||u.duration)&&(this.prior=o)}possiblyEvaluate(e,n,o){const u=e.now||0,f=this.value.possiblyEvaluate(e,n,o),m=this.prior;if(m){if(u>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(u<this.begin)return m.possiblyEvaluate(e,n,o);{const y=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(m.possiblyEvaluate(e,n,o),f,Wr(y))}}return f}}class tt{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,n,o){const u=new He(this._properties);for(const f of Object.keys(this._values))u._values[f]=this._values[f].possiblyEvaluate(e,n,o);return u}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Ce{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return Ui(this._values[e].value)}setValue(e,n){this._values[e]=new fe(this._values[e].property,n===null?void 0:Ui(n))}serialize(){const e={};for(const n of Object.keys(this._values)){const o=this.getValue(n);o!==void 0&&(e[n]=o)}return e}possiblyEvaluate(e,n,o){const u=new He(this._properties);for(const f of Object.keys(this._values))u._values[f]=this._values[f].possiblyEvaluate(e,n,o);return u}}class Ve{constructor(e,n,o){this.property=e,this.value=n,this.parameters=o}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,n,o,u){return this.property.evaluate(this.value,this.parameters,e,n,o,u)}}class He{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Me{constructor(e){this.specification=e}possiblyEvaluate(e,n){return e.expression.evaluate(n)}interpolate(e,n,o){const u=To[this.specification.type];return u?u(e,n,o):e}}class ve{constructor(e,n){this.specification=e,this.overrides=n}possiblyEvaluate(e,n,o,u){return new Ve(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(n,null,{},o,u)}:e.expression,n)}interpolate(e,n,o){if(e.value.kind!=="constant"||n.value.kind!=="constant")return e;if(e.value.value===void 0||n.value.value===void 0)return new Ve(this,{kind:"constant",value:void 0},e.parameters);const u=To[this.specification.type];return u?new Ve(this,{kind:"constant",value:u(e.value.value,n.value.value,o)},e.parameters):e}evaluate(e,n,o,u,f,m){return e.kind==="constant"?e.value:e.evaluate(n,o,u,f,m)}}class pt extends ve{possiblyEvaluate(e,n,o,u){if(e.value===void 0)return new Ve(this,{kind:"constant",value:void 0},n);if(e.expression.kind==="constant"){const f=e.expression.evaluate(n,null,{},o,u),m=e.property.specification.type==="resolvedImage"&&typeof f!="string"?f.name:f,y=this._calculate(m,m,m,n);return new Ve(this,{kind:"constant",value:y},n)}if(e.expression.kind==="camera"){const f=this._calculate(e.expression.evaluate({zoom:n.zoom-1}),e.expression.evaluate({zoom:n.zoom}),e.expression.evaluate({zoom:n.zoom+1}),n);return new Ve(this,{kind:"constant",value:f},n)}return new Ve(this,e.expression,n)}evaluate(e,n,o,u,f,m){if(e.kind==="source"){const y=e.evaluate(n,o,u,f,m);return this._calculate(y,y,y,n)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(n.zoom)-1},o,u),e.evaluate({zoom:Math.floor(n.zoom)},o,u),e.evaluate({zoom:Math.floor(n.zoom)+1},o,u),n):e.value}_calculate(e,n,o,u){return u.zoom>u.zoomHistory.lastIntegerZoom?{from:e,to:n,other:o}:{from:o,to:n,other:e}}interpolate(e){return e}}class ut{constructor(e){this.specification=e}possiblyEvaluate(e,n,o,u){if(e.value!==void 0){if(e.expression.kind==="constant"){const f=e.expression.evaluate(n,null,{},o,u);return this._calculate(f,f,f,n)}return this._calculate(e.expression.evaluate(new oe(Math.floor(n.zoom-1),n)),e.expression.evaluate(new oe(Math.floor(n.zoom),n)),e.expression.evaluate(new oe(Math.floor(n.zoom+1),n)),n)}}_calculate(e,n,o,u){return u.zoom>u.zoomHistory.lastIntegerZoom?{from:e,to:n}:{from:o,to:n}}interpolate(e){return e}}class dt{constructor(e){this.specification=e}possiblyEvaluate(e,n,o,u){return!!e.expression.evaluate(n,null,{},o,u)}interpolate(){return!1}}class ct{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const n=new oe(0,{});for(const o in e){const u=e[o];u.specification.overridable&&this.overridableProperties.push(o);const f=this.defaultPropertyValues[o]=new fe(u,void 0),m=this.defaultTransitionablePropertyValues[o]=new Ee(u);this.defaultTransitioningPropertyValues[o]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[o]=f.possiblyEvaluate(n)}}}function Tt(t,e){return 256*(t=en(Math.floor(t),0,255))+en(Math.floor(e),0,255)}wt(ve,"DataDrivenProperty"),wt(Me,"DataConstantProperty"),wt(pt,"CrossFadedDataDrivenProperty"),wt(ut,"CrossFadedProperty"),wt(dt,"ColorRampProperty");const Ht={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Gt{constructor(e,n){this._structArray=e,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class kt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,n){return e._trim(),n&&(e.isTransferred=!0,n.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const n=Object.create(this.prototype);return n.arrayBuffer=e.arrayBuffer,n.length=e.length,n.capacity=e.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function ht(t,e=1){let n=0,o=0;return{members:t.map(u=>{const f=Ht[u.type].BYTES_PER_ELEMENT,m=n=Yt(n,Math.max(e,f)),y=u.components||1;return o=Math.max(o,f),n+=f*y,{name:u.name,type:u.type,components:y,offset:m}}),size:Yt(n,Math.max(o,e)),alignment:e}}function Yt(t,e){return Math.ceil(t/e)*e}class on extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n){const o=this.length;return this.resize(o+1),this.emplace(o,e,n)}emplace(e,n,o){const u=2*e;return this.int16[u+0]=n,this.int16[u+1]=o,e}}on.prototype.bytesPerElement=4,wt(on,"StructArrayLayout2i4");class Fn extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,o){const u=this.length;return this.resize(u+1),this.emplace(u,e,n,o)}emplace(e,n,o,u){const f=3*e;return this.int16[f+0]=n,this.int16[f+1]=o,this.int16[f+2]=u,e}}Fn.prototype.bytesPerElement=6,wt(Fn,"StructArrayLayout3i6");class Nn extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,o,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,n,o,u)}emplace(e,n,o,u,f){const m=4*e;return this.int16[m+0]=n,this.int16[m+1]=o,this.int16[m+2]=u,this.int16[m+3]=f,e}}Nn.prototype.bytesPerElement=8,wt(Nn,"StructArrayLayout4i8");class Dn extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,u,f,m,y){const w=this.length;return this.resize(w+1),this.emplace(w,e,n,o,u,f,m,y)}emplace(e,n,o,u,f,m,y,w){const A=6*e,B=12*e,I=3*e;return this.int16[A+0]=n,this.int16[A+1]=o,this.uint8[B+4]=u,this.uint8[B+5]=f,this.uint8[B+6]=m,this.uint8[B+7]=y,this.float32[I+2]=w,e}}Dn.prototype.bytesPerElement=12,wt(Dn,"StructArrayLayout2i4ub1f12");class Mr extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,n,o,u)}emplace(e,n,o,u,f){const m=4*e;return this.float32[m+0]=n,this.float32[m+1]=o,this.float32[m+2]=u,this.float32[m+3]=f,e}}Mr.prototype.bytesPerElement=16,wt(Mr,"StructArrayLayout4f16");class ii extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,o,u,f,m,y,w,A,B){const I=this.length;return this.resize(I+1),this.emplace(I,e,n,o,u,f,m,y,w,A,B)}emplace(e,n,o,u,f,m,y,w,A,B,I){const M=10*e;return this.uint16[M+0]=n,this.uint16[M+1]=o,this.uint16[M+2]=u,this.uint16[M+3]=f,this.uint16[M+4]=m,this.uint16[M+5]=y,this.uint16[M+6]=w,this.uint16[M+7]=A,this.uint16[M+8]=B,this.uint16[M+9]=I,e}}ii.prototype.bytesPerElement=20,wt(ii,"StructArrayLayout10ui20");class Io extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,o,u,f,m,y,w){const A=this.length;return this.resize(A+1),this.emplace(A,e,n,o,u,f,m,y,w)}emplace(e,n,o,u,f,m,y,w,A){const B=8*e;return this.uint16[B+0]=n,this.uint16[B+1]=o,this.uint16[B+2]=u,this.uint16[B+3]=f,this.uint16[B+4]=m,this.uint16[B+5]=y,this.uint16[B+6]=w,this.uint16[B+7]=A,e}}Io.prototype.bytesPerElement=16,wt(Io,"StructArrayLayout8ui16");class Un extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,o,u,f,m){const y=this.length;return this.resize(y+1),this.emplace(y,e,n,o,u,f,m)}emplace(e,n,o,u,f,m,y){const w=6*e;return this.int16[w+0]=n,this.int16[w+1]=o,this.int16[w+2]=u,this.int16[w+3]=f,this.int16[w+4]=m,this.int16[w+5]=y,e}}Un.prototype.bytesPerElement=12,wt(Un,"StructArrayLayout6i12");class lr extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,o,u,f,m,y,w,A,B,I,M){const z=this.length;return this.resize(z+1),this.emplace(z,e,n,o,u,f,m,y,w,A,B,I,M)}emplace(e,n,o,u,f,m,y,w,A,B,I,M,z){const R=12*e;return this.int16[R+0]=n,this.int16[R+1]=o,this.int16[R+2]=u,this.int16[R+3]=f,this.uint16[R+4]=m,this.uint16[R+5]=y,this.uint16[R+6]=w,this.uint16[R+7]=A,this.int16[R+8]=B,this.int16[R+9]=I,this.int16[R+10]=M,this.int16[R+11]=z,e}}lr.prototype.bytesPerElement=24,wt(lr,"StructArrayLayout4i4ui4i24");class Sn extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,u,f,m){const y=this.length;return this.resize(y+1),this.emplace(y,e,n,o,u,f,m)}emplace(e,n,o,u,f,m,y){const w=10*e,A=5*e;return this.int16[w+0]=n,this.int16[w+1]=o,this.int16[w+2]=u,this.float32[A+2]=f,this.float32[A+3]=m,this.float32[A+4]=y,e}}Sn.prototype.bytesPerElement=20,wt(Sn,"StructArrayLayout3i3f20");class vr extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint32[1*e+0]=n,e}}vr.prototype.bytesPerElement=4,wt(vr,"StructArrayLayout1ul4");class oi extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,o,u,f,m,y,w,A,B,I,M,z){const R=this.length;return this.resize(R+1),this.emplace(R,e,n,o,u,f,m,y,w,A,B,I,M,z)}emplace(e,n,o,u,f,m,y,w,A,B,I,M,z,R){const U=20*e,H=10*e;return this.int16[U+0]=n,this.int16[U+1]=o,this.int16[U+2]=u,this.int16[U+3]=f,this.int16[U+4]=m,this.float32[H+3]=y,this.float32[H+4]=w,this.float32[H+5]=A,this.float32[H+6]=B,this.int16[U+14]=I,this.uint32[H+8]=M,this.uint16[U+18]=z,this.uint16[U+19]=R,e}}oi.prototype.bytesPerElement=40,wt(oi,"StructArrayLayout5i4f1i1ul2ui40");class jn extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,o,u,f,m,y){const w=this.length;return this.resize(w+1),this.emplace(w,e,n,o,u,f,m,y)}emplace(e,n,o,u,f,m,y,w){const A=8*e;return this.int16[A+0]=n,this.int16[A+1]=o,this.int16[A+2]=u,this.int16[A+4]=f,this.int16[A+5]=m,this.int16[A+6]=y,this.int16[A+7]=w,e}}jn.prototype.bytesPerElement=16,wt(jn,"StructArrayLayout3i2i2i16");class zi extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,o,u,f){const m=this.length;return this.resize(m+1),this.emplace(m,e,n,o,u,f)}emplace(e,n,o,u,f,m){const y=4*e,w=8*e;return this.float32[y+0]=n,this.float32[y+1]=o,this.float32[y+2]=u,this.int16[w+6]=f,this.int16[w+7]=m,e}}zi.prototype.bytesPerElement=16,wt(zi,"StructArrayLayout2f1f2i16");class ks extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,n,o,u)}emplace(e,n,o,u,f){const m=12*e,y=3*e;return this.uint8[m+0]=n,this.uint8[m+1]=o,this.float32[y+1]=u,this.float32[y+2]=f,e}}ks.prototype.bytesPerElement=12,wt(ks,"StructArrayLayout2ub2f12");class ao extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o){const u=this.length;return this.resize(u+1),this.emplace(u,e,n,o)}emplace(e,n,o,u){const f=3*e;return this.float32[f+0]=n,this.float32[f+1]=o,this.float32[f+2]=u,e}}ao.prototype.bytesPerElement=12,wt(ao,"StructArrayLayout3f12");class Yr extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,o){const u=this.length;return this.resize(u+1),this.emplace(u,e,n,o)}emplace(e,n,o,u){const f=3*e;return this.uint16[f+0]=n,this.uint16[f+1]=o,this.uint16[f+2]=u,e}}Yr.prototype.bytesPerElement=6,wt(Yr,"StructArrayLayout3ui6");class Kl extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,n,o,u,f,m,y,w,A,B,I,M,z,R,U,H,ie,ce,re,ae,_e){const de=this.length;return this.resize(de+1),this.emplace(de,e,n,o,u,f,m,y,w,A,B,I,M,z,R,U,H,ie,ce,re,ae,_e)}emplace(e,n,o,u,f,m,y,w,A,B,I,M,z,R,U,H,ie,ce,re,ae,_e,de){const Fe=30*e,ze=15*e,qe=60*e;return this.int16[Fe+0]=n,this.int16[Fe+1]=o,this.int16[Fe+2]=u,this.float32[ze+2]=f,this.float32[ze+3]=m,this.uint16[Fe+8]=y,this.uint16[Fe+9]=w,this.uint32[ze+5]=A,this.uint32[ze+6]=B,this.uint32[ze+7]=I,this.uint16[Fe+16]=M,this.uint16[Fe+17]=z,this.uint16[Fe+18]=R,this.float32[ze+10]=U,this.float32[ze+11]=H,this.uint8[qe+48]=ie,this.uint8[qe+49]=ce,this.uint8[qe+50]=re,this.uint32[ze+13]=ae,this.int16[Fe+28]=_e,this.uint8[qe+58]=de,e}}Kl.prototype.bytesPerElement=60,wt(Kl,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class is extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,n,o,u,f,m,y,w,A,B,I,M,z,R,U,H,ie,ce,re,ae,_e,de,Fe,ze,qe,st,Ge,We,Ze,Ye){const lt=this.length;return this.resize(lt+1),this.emplace(lt,e,n,o,u,f,m,y,w,A,B,I,M,z,R,U,H,ie,ce,re,ae,_e,de,Fe,ze,qe,st,Ge,We,Ze,Ye)}emplace(e,n,o,u,f,m,y,w,A,B,I,M,z,R,U,H,ie,ce,re,ae,_e,de,Fe,ze,qe,st,Ge,We,Ze,Ye,lt){const je=38*e,bt=19*e;return this.int16[je+0]=n,this.int16[je+1]=o,this.int16[je+2]=u,this.float32[bt+2]=f,this.float32[bt+3]=m,this.int16[je+8]=y,this.int16[je+9]=w,this.int16[je+10]=A,this.int16[je+11]=B,this.int16[je+12]=I,this.int16[je+13]=M,this.uint16[je+14]=z,this.uint16[je+15]=R,this.uint16[je+16]=U,this.uint16[je+17]=H,this.uint16[je+18]=ie,this.uint16[je+19]=ce,this.uint16[je+20]=re,this.uint16[je+21]=ae,this.uint16[je+22]=_e,this.uint16[je+23]=de,this.uint16[je+24]=Fe,this.uint16[je+25]=ze,this.uint16[je+26]=qe,this.uint16[je+27]=st,this.uint16[je+28]=Ge,this.uint32[bt+15]=We,this.float32[bt+16]=Ze,this.float32[bt+17]=Ye,this.float32[bt+18]=lt,e}}is.prototype.bytesPerElement=76,wt(is,"StructArrayLayout3i2f6i15ui1ul3f76");class Jt extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.float32[1*e+0]=n,e}}Jt.prototype.bytesPerElement=4,wt(Jt,"StructArrayLayout1f4");class os extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,u,f){const m=this.length;return this.resize(m+1),this.emplace(m,e,n,o,u,f)}emplace(e,n,o,u,f,m){const y=5*e;return this.float32[y+0]=n,this.float32[y+1]=o,this.float32[y+2]=u,this.float32[y+3]=f,this.float32[y+4]=m,e}}os.prototype.bytesPerElement=20,wt(os,"StructArrayLayout5f20");class fa extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,o,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,n,o,u)}emplace(e,n,o,u,f){const m=6*e;return this.uint32[3*e+0]=n,this.uint16[m+2]=o,this.uint16[m+3]=u,this.uint16[m+4]=f,e}}fa.prototype.bytesPerElement=12,wt(fa,"StructArrayLayout1ul3ui12");class Ai extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n){const o=this.length;return this.resize(o+1),this.emplace(o,e,n)}emplace(e,n,o){const u=2*e;return this.uint16[u+0]=n,this.uint16[u+1]=o,e}}Ai.prototype.bytesPerElement=4,wt(Ai,"StructArrayLayout2ui4");class qc extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint16[1*e+0]=n,e}}qc.prototype.bytesPerElement=2,wt(qc,"StructArrayLayout1ui2");class Lf extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n){const o=this.length;return this.resize(o+1),this.emplace(o,e,n)}emplace(e,n,o){const u=2*e;return this.float32[u+0]=n,this.float32[u+1]=o,e}}Lf.prototype.bytesPerElement=8,wt(Lf,"StructArrayLayout2f8");class Bg extends Gt{get a_pos_30(){return this._structArray.int16[this._pos2+0]}get a_pos_31(){return this._structArray.int16[this._pos2+1]}get a_pos_32(){return this._structArray.int16[this._pos2+2]}get a_pos_normal_30(){return this._structArray.int16[this._pos2+3]}get a_pos_normal_31(){return this._structArray.int16[this._pos2+4]}get a_pos_normal_32(){return this._structArray.int16[this._pos2+5]}}Bg.prototype.size=12;class Mo extends Un{get(e){return new Bg(this,e)}}wt(Mo,"FillExtrusionExtArray");class Tg extends Gt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Tg.prototype.size=40;class jc extends oi{get(e){return new Tg(this,e)}}wt(jc,"CollisionBoxArray");class zf extends Gt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}zf.prototype.size=60;class xm extends Kl{get(e){return new zf(this,e)}}wt(xm,"PlacedSymbolArray");class wm extends Gt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}wm.prototype.size=76;class lo extends is{get(e){return new wm(this,e)}}wt(lo,"SymbolInstanceArray");class tl extends Jt{getoffsetX(e){return this.float32[1*e+0]}}wt(tl,"GlyphOffsetArray");class Ff extends Fn{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}wt(Ff,"SymbolLineVertexArray");class Am extends Gt{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Am.prototype.size=12;class pd extends fa{get(e){return new Am(this,e)}}wt(pd,"FeatureIndexArray");class bm extends Gt{get a_centroid_pos0(){return this._structArray.uint16[this._pos2+0]}get a_centroid_pos1(){return this._structArray.uint16[this._pos2+1]}}bm.prototype.size=4;class Rf extends Ai{get(e){return new bm(this,e)}}wt(Rf,"FillExtrusionCentroidArray");class Cm extends Gt{get a_pos_30(){return this._structArray.int16[this._pos2+0]}get a_pos_31(){return this._structArray.int16[this._pos2+1]}get a_pos_32(){return this._structArray.int16[this._pos2+2]}get a_pos_normal_30(){return this._structArray.int16[this._pos2+3]}get a_pos_normal_31(){return this._structArray.int16[this._pos2+4]}get a_pos_normal_32(){return this._structArray.int16[this._pos2+5]}}Cm.prototype.size=12;class Of extends Un{get(e){return new Cm(this,e)}}wt(Of,"CircleGlobeExtArray");const Em=ht([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),Zl=ht([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]);var Vc={exports:{}},nl={exports:{}};nl.exports=function(t,e){var n,o,u,f,m,y,w,A;for(o=t.length-(n=3&t.length),u=e,m=3432918353,y=461845907,A=0;A<o;)w=255&t.charCodeAt(A)|(255&t.charCodeAt(++A))<<8|(255&t.charCodeAt(++A))<<16|(255&t.charCodeAt(++A))<<24,++A,u=27492+(65535&(f=5*(65535&(u=(u^=w=(65535&(w=(w=(65535&w)*m+(((w>>>16)*m&65535)<<16)&4294967295)<<15|w>>>17))*y+(((w>>>16)*y&65535)<<16)&4294967295)<<13|u>>>19))+((5*(u>>>16)&65535)<<16)&4294967295))+((58964+(f>>>16)&65535)<<16);switch(w=0,n){case 3:w^=(255&t.charCodeAt(A+2))<<16;case 2:w^=(255&t.charCodeAt(A+1))<<8;case 1:u^=w=(65535&(w=(w=(65535&(w^=255&t.charCodeAt(A)))*m+(((w>>>16)*m&65535)<<16)&4294967295)<<15|w>>>17))*y+(((w>>>16)*y&65535)<<16)&4294967295}return u^=t.length,u=2246822507*(65535&(u^=u>>>16))+((2246822507*(u>>>16)&65535)<<16)&4294967295,u=3266489909*(65535&(u^=u>>>13))+((3266489909*(u>>>16)&65535)<<16)&4294967295,(u^=u>>>16)>>>0};var Bm={exports:{}};Bm.exports=function(t,e){for(var n,o=t.length,u=e^o,f=0;o>=4;)n=1540483477*(65535&(n=255&t.charCodeAt(f)|(255&t.charCodeAt(++f))<<8|(255&t.charCodeAt(++f))<<16|(255&t.charCodeAt(++f))<<24))+((1540483477*(n>>>16)&65535)<<16),u=1540483477*(65535&u)+((1540483477*(u>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),o-=4,++f;switch(o){case 3:u^=(255&t.charCodeAt(f+2))<<16;case 2:u^=(255&t.charCodeAt(f+1))<<8;case 1:u=1540483477*(65535&(u^=255&t.charCodeAt(f)))+((1540483477*(u>>>16)&65535)<<16)}return u=1540483477*(65535&(u^=u>>>13))+((1540483477*(u>>>16)&65535)<<16),(u^=u>>>15)>>>0};var Tm=nl.exports,Dm=Bm.exports;Vc.exports=Tm,Vc.exports.murmur3=Tm,Vc.exports.murmur2=Dm;class Gf{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,n,o,u){this.ids.push(Dg(e)),this.positions.push(n,o,u)}getPositions(e){const n=Dg(e);let o=0,u=this.ids.length-1;for(;o<u;){const m=o+u>>1;this.ids[m]>=n?u=m:o=m+1}const f=[];for(;this.ids[o]===n;)f.push({index:this.positions[3*o],start:this.positions[3*o+1],end:this.positions[3*o+2]}),o++;return f}static serialize(e,n){const o=new Float64Array(e.ids),u=new Uint32Array(e.positions);return Sm(o,u,0,o.length-1),n&&n.push(o.buffer,u.buffer),{ids:o,positions:u}}static deserialize(e){const n=new Gf;return n.ids=e.ids,n.positions=e.positions,n.indexed=!0,n}}function Dg(t){const e=+t;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:Vc.exports(String(t))}function Sm(t,e,n,o){for(;n<o;){const u=t[n+o>>1];let f=n-1,m=o+1;for(;;){do f++;while(t[f]<u);do m--;while(t[m]>u);if(f>=m)break;md(t,f,m),md(e,3*f,3*m),md(e,3*f+1,3*m+1),md(e,3*f+2,3*m+2)}m-n<o-m?(Sm(t,e,n,m),n=m+1):(Sm(t,e,m+1,o),o=m)}}function md(t,e,n){const o=t[e];t[e]=t[n],t[n]=o}wt(Gf,"FeaturePositionMap");class pa{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,n){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,n),this.initialized=!0),!!this.location}}class Nf extends pa{constructor(e){super(e),this.current=0}set(e,n,o){this.fetchUniformLocation(e,n)&&this.current!==o&&(this.current=o,this.gl.uniform1f(this.location,o))}}class Im extends pa{constructor(e){super(e),this.current=[0,0,0,0]}set(e,n,o){this.fetchUniformLocation(e,n)&&(o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]&&o[3]===this.current[3]||(this.current=o,this.gl.uniform4f(this.location,o[0],o[1],o[2],o[3])))}}class Mm extends pa{constructor(e){super(e),this.current=_r.transparent}set(e,n,o){this.fetchUniformLocation(e,n)&&(o.r===this.current.r&&o.g===this.current.g&&o.b===this.current.b&&o.a===this.current.a||(this.current=o,this.gl.uniform4f(this.location,o.r,o.g,o.b,o.a)))}}const uo=new Float32Array(16),ma=new Float32Array(9),ex=new Float32Array(4);function km(t){return[Tt(255*t.r,255*t.g),Tt(255*t.b,255*t.a)]}class Jl{constructor(e,n,o){this.value=e,this.uniformNames=n.map(u=>`u_${u}`),this.type=o}setUniform(e,n,o,u,f){n.set(e,f,u.constantOr(this.value))}getBinding(e,n){return this.type==="color"?new Mm(e):new Nf(e)}}class Ps{constructor(e,n){this.uniformNames=n.map(o=>`u_${o}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,n){this.pixelRatioFrom=n.pixelRatio||1,this.pixelRatioTo=e.pixelRatio||1,this.patternFrom=n.tl.concat(n.br),this.patternTo=e.tl.concat(e.br)}setUniform(e,n,o,u,f){const m=f==="u_pattern_to"||f==="u_dash_to"?this.patternTo:f==="u_pattern_from"||f==="u_dash_from"?this.patternFrom:f==="u_pixel_ratio_to"?this.pixelRatioTo:f==="u_pixel_ratio_from"?this.pixelRatioFrom:null;m&&n.set(e,f,m)}getBinding(e,n){return n==="u_pattern_from"||n==="u_pattern_to"||n==="u_dash_from"||n==="u_dash_to"?new Im(e):new Nf(e)}}class _a{constructor(e,n,o,u){this.expression=e,this.type=o,this.maxValue=0,this.paintVertexAttributes=n.map(f=>({name:`a_${f}`,type:"Float32",components:o==="color"?2:1,offset:0})),this.paintVertexArray=new u}populatePaintArray(e,n,o,u,f,m){const y=this.paintVertexArray.length,w=this.expression.evaluate(new oe(0),n,{},f,u,m);this.paintVertexArray.resize(e),this._setPaintValue(y,e,w)}updatePaintArray(e,n,o,u,f){const m=this.expression.evaluate({zoom:0},o,u,void 0,f);this._setPaintValue(e,n,m)}_setPaintValue(e,n,o){if(this.type==="color"){const u=km(o);for(let f=e;f<n;f++)this.paintVertexArray.emplace(f,u[0],u[1])}else{for(let u=e;u<n;u++)this.paintVertexArray.emplace(u,o);this.maxValue=Math.max(this.maxValue,Math.abs(o))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ss{constructor(e,n,o,u,f,m){this.expression=e,this.uniformNames=n.map(y=>`u_${y}_t`),this.type=o,this.useIntegerZoom=u,this.zoom=f,this.maxValue=0,this.paintVertexAttributes=n.map(y=>({name:`a_${y}`,type:"Float32",components:o==="color"?4:2,offset:0})),this.paintVertexArray=new m}populatePaintArray(e,n,o,u,f,m){const y=this.expression.evaluate(new oe(this.zoom),n,{},f,u,m),w=this.expression.evaluate(new oe(this.zoom+1),n,{},f,u,m),A=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(A,e,y,w)}updatePaintArray(e,n,o,u,f){const m=this.expression.evaluate({zoom:this.zoom},o,u,void 0,f),y=this.expression.evaluate({zoom:this.zoom+1},o,u,void 0,f);this._setPaintValue(e,n,m,y)}_setPaintValue(e,n,o,u){if(this.type==="color"){const f=km(o),m=km(u);for(let y=e;y<n;y++)this.paintVertexArray.emplace(y,f[0],f[1],m[0],m[1])}else{for(let f=e;f<n;f++)this.paintVertexArray.emplace(f,o,u);this.maxValue=Math.max(this.maxValue,Math.abs(o),Math.abs(u))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,n,o,u,f){const m=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,y=en(this.expression.interpolationFactor(m,this.zoom,this.zoom+1),0,1);n.set(e,f,y)}getBinding(e,n){return new Nf(e)}}class Xl{constructor(e,n,o,u,f,m,y){this.expression=e,this.type=o,this.useIntegerZoom=u,this.zoom=f,this.layerId=y,this.paintVertexAttributes=(o==="array"?Zl:Em).members;for(let w=0;w<n.length;++w);this.zoomInPaintVertexArray=new m,this.zoomOutPaintVertexArray=new m}populatePaintArray(e,n,o){const u=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(u,e,n.patterns&&n.patterns[this.layerId],o)}updatePaintArray(e,n,o,u,f,m){this._setPaintValues(e,n,o.patterns&&o.patterns[this.layerId],m)}_setPaintValues(e,n,o,u){if(!u||!o)return;const{min:f,mid:m,max:y}=o,w=u[f],A=u[m],B=u[y];if(w&&A&&B)for(let I=e;I<n;I++)this._setPaintValue(this.zoomInPaintVertexArray,I,A,w),this._setPaintValue(this.zoomOutPaintVertexArray,I,A,B)}_setPaintValue(e,n,o,u){e.emplace(n,o.tl[0],o.tl[1],o.br[0],o.br[1],u.tl[0],u.tl[1],u.br[0],u.br[1],o.pixelRatio,u.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class rl{constructor(e,n,o=()=>!0){this.binders={},this._buffers=[];const u=[];for(const f in e.paint._values){if(!o(f))continue;const m=e.paint.get(f);if(!(m instanceof Ve&&Cs(m.property.specification)))continue;const y=tx(f,e.type),w=m.value,A=m.property.specification.type,B=m.property.useIntegerZoom,I=m.property.specification["property-type"],M=I==="cross-faded"||I==="cross-faded-data-driven",z=String(f)==="line-dasharray"&&e.layout.get("line-cap").value.kind!=="constant";if(w.kind!=="constant"||z)if(w.kind==="source"||z||M){const R=gd(f,A,"source");this.binders[f]=M?new Xl(w,y,A,B,n,R,e.id):new _a(w,y,A,R),u.push(`/a_${f}`)}else{const R=gd(f,A,"composite");this.binders[f]=new ss(w,y,A,B,n,R),u.push(`/z_${f}`)}else this.binders[f]=M?new Ps(w.value,y):new Jl(w.value,y,A),u.push(`/u_${f}`)}this.cacheKey=u.sort().join("")}getMaxValue(e){const n=this.binders[e];return n instanceof _a||n instanceof ss?n.maxValue:0}populatePaintArrays(e,n,o,u,f,m){for(const y in this.binders){const w=this.binders[y];(w instanceof _a||w instanceof ss||w instanceof Xl)&&w.populatePaintArray(e,n,o,u,f,m)}}setConstantPatternPositions(e,n){for(const o in this.binders){const u=this.binders[o];u instanceof Ps&&u.setConstantPatternPositions(e,n)}}updatePaintArrays(e,n,o,u,f,m){let y=!1;for(const w in e){const A=n.getPositions(w);for(const B of A){const I=o.feature(B.index);for(const M in this.binders){const z=this.binders[M];if((z instanceof _a||z instanceof ss||z instanceof Xl)&&z.expression.isStateDependent===!0){const R=u.paint.get(M);z.expression=R.value,z.updatePaintArray(B.start,B.end,I,e[w],f,m),y=!0}}}}return y}defines(){const e=[];for(const n in this.binders){const o=this.binders[n];(o instanceof Jl||o instanceof Ps)&&e.push(...o.uniformNames.map(u=>`#define HAS_UNIFORM_${u}`))}return e}getBinderAttributes(){const e=[];for(const n in this.binders){const o=this.binders[n];if(o instanceof _a||o instanceof ss||o instanceof Xl)for(let u=0;u<o.paintVertexAttributes.length;u++)e.push(o.paintVertexAttributes[u].name)}return e}getBinderUniforms(){const e=[];for(const n in this.binders){const o=this.binders[n];if(o instanceof Jl||o instanceof Ps||o instanceof ss)for(const u of o.uniformNames)e.push(u)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const n=[];for(const o in this.binders){const u=this.binders[o];if(u instanceof Jl||u instanceof Ps||u instanceof ss)for(const f of u.uniformNames)n.push({name:f,property:o,binding:u.getBinding(e,f)})}return n}setUniforms(e,n,o,u,f){for(const{name:m,property:y,binding:w}of o)this.binders[y].setUniform(e,w,f,u.get(y),m)}updatePaintBuffers(e){this._buffers=[];for(const n in this.binders){const o=this.binders[n];if(e&&o instanceof Xl){const u=e.fromScale===2?o.zoomInPaintVertexBuffer:o.zoomOutPaintVertexBuffer;u&&this._buffers.push(u)}else(o instanceof _a||o instanceof ss)&&o.paintVertexBuffer&&this._buffers.push(o.paintVertexBuffer)}}upload(e){for(const n in this.binders){const o=this.binders[n];(o instanceof _a||o instanceof ss||o instanceof Xl)&&o.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const n=this.binders[e];(n instanceof _a||n instanceof ss||n instanceof Xl)&&n.destroy()}}}class as{constructor(e,n,o=()=>!0){this.programConfigurations={};for(const u of e)this.programConfigurations[u.id]=new rl(u,n,o);this.needsUpload=!1,this._featureMap=new Gf,this._bufferOffset=0}populatePaintArrays(e,n,o,u,f,m,y){for(const w in this.programConfigurations)this.programConfigurations[w].populatePaintArrays(e,n,u,f,m,y);n.id!==void 0&&this._featureMap.add(n.id,o,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,n,o,u,f){for(const m of o)this.needsUpload=this.programConfigurations[m.id].updatePaintArrays(e,this._featureMap,n,m,u,f)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const _d={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function tx(t,e){return _d[t]||[t.replace(`${e}-`,"").replace(/-/g,"_")]}const Sg={"line-pattern":{source:ii,composite:ii},"fill-pattern":{source:ii,composite:ii},"fill-extrusion-pattern":{source:ii,composite:ii},"line-dasharray":{source:Io,composite:Io}},Ig={color:{source:Lf,composite:Mr},number:{source:Jt,composite:Lf}};function gd(t,e,n){const o=Sg[t];return o&&o[n]||Ig[e][n]}wt(Jl,"ConstantBinder"),wt(Ps,"CrossFadedConstantBinder"),wt(_a,"SourceExpressionBinder"),wt(Xl,"CrossFadedCompositeBinder"),wt(ss,"CompositeExpressionBinder"),wt(rl,"ProgramConfiguration",{omit:["_buffers"]}),wt(as,"ProgramConfigurationSet");const yd="-transition";class co extends As{constructor(e,n){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&e.type!=="sky"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),n.layout&&(this._unevaluatedLayout=new Ce(n.layout)),n.paint)){this._transitionablePaint=new Oe(n.paint);for(const o in e.paint)this.setPaintProperty(o,e.paint[o],{validate:!1});for(const o in e.layout)this.setLayoutProperty(o,e.layout[o],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new He(n.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,n,o={}){n!=null&&this._validate(vm,`layers.${this.id}.layout.${e}`,e,n,o)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,n):this.visibility=n)}getPaintProperty(e){return St(e,yd)?this._transitionablePaint.getTransition(e.slice(0,-yd.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,n,o={}){if(n!=null&&this._validate(ym,`layers.${this.id}.paint.${e}`,e,n,o))return!1;if(St(e,yd))return this._transitionablePaint.setTransition(e.slice(0,-yd.length),n||void 0),!1;{const u=this._transitionablePaint._values[e],f=u.property.specification["property-type"]==="cross-faded-data-driven",m=u.value.isDataDriven(),y=u.value;this._transitionablePaint.setValue(e,n),this._handleSpecialPaintPropertyUpdate(e);const w=this._transitionablePaint._values[e].value;return w.isDataDriven()||m||f||this._handleOverridablePaintPropertyUpdate(e,y,w)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,n,o){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,n){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,n)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),pr(e,(n,o)=>!(n===void 0||o==="layout"&&!Object.keys(n).length||o==="paint"&&!Object.keys(n).length))}_validate(e,n,o,u,f={}){return(!f||f.validate!==!1)&&Ms(this,e.call(An,{key:n,layerType:this.type,objectKey:o,value:u,styleSpec:Ne,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const n=this.paint.get(e);if(n instanceof Ve&&Cs(n.property.specification)&&(n.value.kind==="source"||n.value.kind==="composite")&&n.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Lc(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const Pm=ht([{name:"a_pos",components:2,type:"Int16"}],4),Uf=ht([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class kr{constructor(e=[]){this.segments=e}prepareSegment(e,n,o,u){let f=this.segments[this.segments.length-1];return e>kr.MAX_VERTEX_ARRAY_LENGTH&&er(`Max vertices per segment is ${kr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!f||f.vertexLength+e>kr.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==u)&&(f={vertexOffset:n.length,primitiveOffset:o.length,vertexLength:0,primitiveLength:0},u!==void 0&&(f.sortKey=u),this.segments.push(f)),f}get(){return this.segments}destroy(){for(const e of this.segments)for(const n in e.vaos)e.vaos[n].destroy()}static simpleSegment(e,n,o,u){return new kr([{vertexOffset:e,primitiveOffset:n,vertexLength:o,primitiveLength:u,vaos:{},sortKey:0}])}}kr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,wt(kr,"SegmentVector");var $t=8192;class Ls{constructor(e,n){e&&(n?this.setSouthWest(e).setNorthEast(n):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof bn?new bn(e.lng,e.lat):bn.convert(e),this}setSouthWest(e){return this._sw=e instanceof bn?new bn(e.lng,e.lat):bn.convert(e),this}extend(e){const n=this._sw,o=this._ne;let u,f;if(e instanceof bn)u=e,f=e;else{if(!(e instanceof Ls))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Ls.convert(e)):this.extend(bn.convert(e)):typeof e=="object"&&e!==null&&e.hasOwnProperty("lat")&&e.hasOwnProperty("lon")?this.extend(bn.convert(e)):this;if(u=e._sw,f=e._ne,!u||!f)return this}return n||o?(n.lng=Math.min(u.lng,n.lng),n.lat=Math.min(u.lat,n.lat),o.lng=Math.max(f.lng,o.lng),o.lat=Math.max(f.lat,o.lat)):(this._sw=new bn(u.lng,u.lat),this._ne=new bn(f.lng,f.lat)),this}getCenter(){return new bn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new bn(this.getWest(),this.getNorth())}getSouthEast(){return new bn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:n,lat:o}=bn.convert(e);let u=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(u=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=o&&o<=this._ne.lat&&u}static convert(e){return!e||e instanceof Ls?e:new Ls(e)}}const vd=63710088e-1;class bn{constructor(e,n){if(isNaN(e)||isNaN(n))throw new Error(`Invalid LngLat object: (${e}, ${n})`);if(this.lng=+e,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new bn(fr(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const n=Math.PI/180,o=this.lat*n,u=e.lat*n,f=Math.sin(o)*Math.sin(u)+Math.cos(o)*Math.cos(u)*Math.cos((e.lng-this.lng)*n);return vd*Math.acos(Math.min(f,1))}toBounds(e=0){const n=360*e/40075017,o=n/Math.cos(Math.PI/180*this.lat);return new Ls(new bn(this.lng-o,this.lat-n),new bn(this.lng+o,this.lat+n))}static convert(e){if(e instanceof bn)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new bn(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new bn(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Mg=2*Math.PI*vd;function qf(t){return Mg*Math.cos(t*Math.PI/180)}function si(t){return(180+t)/360}function zs(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function ko(t,e){return t/qf(e)}function Po(t){return 360*t-180}function ei(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function kg(t,e){return t*qf(ei(e))}const ga=85.051129;function ya(t){return 1/Math.cos(t*Math.PI/180)}class Ql{constructor(e,n,o=0){this.x=+e,this.y=+n,this.z=+o}static fromLngLat(e,n=0){const o=bn.convert(e);return new Ql(si(o.lng),zs(o.lat),ko(n,o.lat))}toLngLat(){return new bn(Po(this.x),ei(this.y))}toAltitude(){return kg(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Mg*ya(ei(this.y))}}function xd(t,e,n,o,u,f,m,y,w){const A=(e+o)/2,B=(n+u)/2,I=new Ie(A,B);y(I),function(M,z,R,U,H,ie){const ce=R-H,re=U-ie;return Math.abs((U-z)*ce-(R-M)*re)/Math.hypot(ce,re)}(I.x,I.y,f.x,f.y,m.x,m.y)>=w?(xd(t,e,n,A,B,f,I,y,w),xd(t,A,B,o,u,I,m,y,w)):t.push(m)}function jf(t,e,n){let o=t[0],u=o.x,f=o.y;e(o);const m=[o];for(let y=1;y<t.length;y++){const w=t[y],{x:A,y:B}=w;e(w),xd(m,u,f,A,B,o,w,e,n),u=A,f=B,o=w}return m}function Hc(t,e,n,o){if(o(e,n)){const u=e.add(n)._mult(.5);Hc(t,e,u,o),Hc(t,u,n,o)}else t.push(n)}function $c(t,e){let n=t[0];const o=[n];for(let u=1;u<t.length;u++){const f=t[u];Hc(o,n,f,e),n=f}return o}const tn=Math.pow(2,14)-1,wd=-tn-1;function Lm(t,e){const n=Math.round(t.x*e),o=Math.round(t.y*e);return t.x=en(n,wd,tn),t.y=en(o,wd,tn),(n<t.x||n>t.x+1||o<t.y||o>t.y+1)&&er("Geometry exceeds allowed extent, reduce your vector tile buffer size"),t}function Hi(t,e,n){const o=t.loadGeometry(),u=t.extent,f=$t/u;if(e&&n&&n.projection.isReprojectedInTileSpace){const m=1<<e.z,{scale:y,x:w,y:A,projection:B}=n,I=M=>{const z=Po((e.x+M.x/u)/m),R=ei((e.y+M.y/u)/m),U=B.project(z,R);M.x=(U.x*y-w)*u,M.y=(U.y*y-A)*u};for(let M=0;M<o.length;M++)if(t.type!==1)o[M]=jf(o[M],I,1);else{const z=[];for(const R of o[M])R.x<0||R.x>=u||R.y<0||R.y>=u||(I(R),z.push(R));o[M]=z}}for(const m of o)for(const y of m)Lm(y,f);return o}function Hu(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?Hi(t):[]}}function Wc(t,e,n,o,u){t.emplaceBack(2*e+(o+1)/2,2*n+(u+1)/2)}function Ad(t,e,n){t.emplaceBack(e.x,e.y,e.z,n[0]*16384,n[1]*16384,n[2]*16384)}class ai{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new on,this.indexArray=new Yr,this.segments=new kr,this.programConfigurations=new as(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,o,u){const f=this.layers[0],m=[];let y=null;f.type==="circle"&&(y=f.layout.get("circle-sort-key"));for(const{feature:A,id:B,index:I,sourceLayerIndex:M}of e){const z=this.layers[0]._featureFilter.needGeometry,R=Hu(A,z);if(!this.layers[0]._featureFilter.filter(new oe(this.zoom),R,o))continue;const U=y?y.evaluate(R,{},o):void 0,H={id:B,properties:A.properties,type:A.type,sourceLayerIndex:M,index:I,geometry:z?R.geometry:Hi(A,o,u),patterns:{},sortKey:U};m.push(H)}y&&m.sort((A,B)=>A.sortKey-B.sortKey);let w=null;u.projection.name==="globe"&&(this.globeExtVertexArray=new Of,w=u.projection);for(const A of m){const{geometry:B,index:I,sourceLayerIndex:M}=A,z=e[I].feature;this.addFeature(A,B,I,n.availableImages,o,w),n.featureIndex.insert(z,B,I,M,this.index)}}update(e,n,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,o,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Pm.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Uf.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,n,o,u,f,m){for(const y of n)for(const w of y){const A=w.x,B=w.y;if(A<0||A>=$t||B<0||B>=$t)continue;if(m){const z=m.projectTilePoint(A,B,f),R=m.upVector(f,A,B),U=this.globeExtVertexArray;Ad(U,z,R),Ad(U,z,R),Ad(U,z,R),Ad(U,z,R)}const I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),M=I.vertexLength;Wc(this.layoutVertexArray,A,B,-1,-1),Wc(this.layoutVertexArray,A,B,1,-1),Wc(this.layoutVertexArray,A,B,1,1),Wc(this.layoutVertexArray,A,B,-1,1),this.indexArray.emplaceBack(M,M+1,M+2),this.indexArray.emplaceBack(M,M+2,M+3),I.vertexLength+=4,I.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,{},u,f)}}function Pg(t,e){for(let n=0;n<t.length;n++)if(Ur(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(Ur(t,e[n]))return!0;return!!Vf(t,e)}function nx(t,e,n){return!!Ur(t,e)||!!Fm(e,t,n)}function zm(t,e){if(t.length===1)return va(e,t[0]);for(let n=0;n<e.length;n++){const o=e[n];for(let u=0;u<o.length;u++)if(Ur(t,o[u]))return!0}for(let n=0;n<t.length;n++)if(va(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(Vf(t,e[n]))return!0;return!1}function rx(t,e,n){if(t.length>1){if(Vf(t,e))return!0;for(let o=0;o<e.length;o++)if(Fm(e[o],t,n))return!0}for(let o=0;o<t.length;o++)if(Fm(t[o],e,n))return!0;return!1}function Vf(t,e){if(t.length===0||e.length===0)return!1;for(let n=0;n<t.length-1;n++){const o=t[n],u=t[n+1];for(let f=0;f<e.length-1;f++)if(ix(o,u,e[f],e[f+1]))return!0}return!1}function ix(t,e,n,o){return Qi(t,n,o)!==Qi(e,n,o)&&Qi(t,e,n)!==Qi(t,e,o)}function Fm(t,e,n){const o=n*n;if(e.length===1)return t.distSqr(e[0])<o;for(let u=1;u<e.length;u++)if(Lg(t,e[u-1],e[u])<o)return!0;return!1}function Lg(t,e,n){const o=e.distSqr(n);if(o===0)return t.distSqr(e);const u=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/o;return t.distSqr(u<0?e:u>1?n:n.sub(e)._mult(u)._add(e))}function va(t,e){let n,o,u,f=!1;for(let m=0;m<t.length;m++){n=t[m];for(let y=0,w=n.length-1;y<n.length;w=y++)o=n[y],u=n[w],o.y>e.y!=u.y>e.y&&e.x<(u.x-o.x)*(e.y-o.y)/(u.y-o.y)+o.x&&(f=!f)}return f}function Ur(t,e){let n=!1;for(let o=0,u=t.length-1;o<t.length;u=o++){const f=t[o],m=t[u];f.y>e.y!=m.y>e.y&&e.x<(m.x-f.x)*(e.y-f.y)/(m.y-f.y)+f.x&&(n=!n)}return n}function Hf(t,e,n,o,u){for(const m of t)if(e<=m.x&&n<=m.y&&o>=m.x&&u>=m.y)return!0;const f=[new Ie(e,n),new Ie(e,u),new Ie(o,u),new Ie(o,n)];if(t.length>2){for(const m of f)if(Ur(t,m))return!0}for(let m=0;m<t.length-1;m++)if(ox(t[m],t[m+1],f))return!0;return!1}function ox(t,e,n){const o=n[0],u=n[2];if(t.x<o.x&&e.x<o.x||t.x>u.x&&e.x>u.x||t.y<o.y&&e.y<o.y||t.y>u.y&&e.y>u.y)return!1;const f=Qi(t,e,n[0]);return f!==Qi(t,e,n[1])||f!==Qi(t,e,n[2])||f!==Qi(t,e,n[3])}function Yl(t,e,n){const o=e.paint.get(t).value;return o.kind==="constant"?o.value:n.programConfigurations.get(e.id).getMaxValue(t)}function $f(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function zg(t,e,n,o,u){if(!e[0]&&!e[1])return t;const f=Ie.convert(e)._mult(u);n==="viewport"&&f._rotate(-o);const m=[];for(let y=0;y<t.length;y++)m.push(t[y].sub(f));return m}function Kc(t,e,n,o){const u=Ie.convert(t)._mult(o);return e==="viewport"&&u._rotate(-n),u}wt(ai,"CircleBucket",{omit:["layers"]});const Fg=new ct({"circle-sort-key":new ve(Ne.layout_circle["circle-sort-key"])});var Rg={paint:new ct({"circle-radius":new ve(Ne.paint_circle["circle-radius"]),"circle-color":new ve(Ne.paint_circle["circle-color"]),"circle-blur":new ve(Ne.paint_circle["circle-blur"]),"circle-opacity":new ve(Ne.paint_circle["circle-opacity"]),"circle-translate":new Me(Ne.paint_circle["circle-translate"]),"circle-translate-anchor":new Me(Ne.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Me(Ne.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Me(Ne.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ve(Ne.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ve(Ne.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ve(Ne.paint_circle["circle-stroke-opacity"])}),layout:Fg},Wf=1e-6,ho=typeof Float32Array<"u"?Float32Array:Array;function Og(){var t=new ho(9);return ho!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Gg(t,e,n){var o=e[0],u=e[1],f=e[2],m=e[3],y=e[4],w=e[5],A=e[6],B=e[7],I=e[8],M=n[0],z=n[1],R=n[2],U=n[3],H=n[4],ie=n[5],ce=n[6],re=n[7],ae=n[8];return t[0]=M*o+z*m+R*A,t[1]=M*u+z*y+R*B,t[2]=M*f+z*w+R*I,t[3]=U*o+H*m+ie*A,t[4]=U*u+H*y+ie*B,t[5]=U*f+H*w+ie*I,t[6]=ce*o+re*m+ae*A,t[7]=ce*u+re*y+ae*B,t[8]=ce*f+re*w+ae*I,t}function Fs(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Kf(t,e){var n=e[0],o=e[1],u=e[2],f=e[3],m=e[4],y=e[5],w=e[6],A=e[7],B=e[8],I=e[9],M=e[10],z=e[11],R=e[12],U=e[13],H=e[14],ie=e[15],ce=n*y-o*m,re=n*w-u*m,ae=n*A-f*m,_e=o*w-u*y,de=o*A-f*y,Fe=u*A-f*w,ze=B*U-I*R,qe=B*H-M*R,st=B*ie-z*R,Ge=I*H-M*U,We=I*ie-z*U,Ze=M*ie-z*H,Ye=ce*Ze-re*We+ae*Ge+_e*st-de*qe+Fe*ze;return Ye?(t[0]=(y*Ze-w*We+A*Ge)*(Ye=1/Ye),t[1]=(u*We-o*Ze-f*Ge)*Ye,t[2]=(U*Fe-H*de+ie*_e)*Ye,t[3]=(M*de-I*Fe-z*_e)*Ye,t[4]=(w*st-m*Ze-A*qe)*Ye,t[5]=(n*Ze-u*st+f*qe)*Ye,t[6]=(H*ae-R*Fe-ie*re)*Ye,t[7]=(B*Fe-M*ae+z*re)*Ye,t[8]=(m*We-y*st+A*ze)*Ye,t[9]=(o*st-n*We-f*ze)*Ye,t[10]=(R*de-U*ae+ie*ce)*Ye,t[11]=(I*ae-B*de-z*ce)*Ye,t[12]=(y*qe-m*Ge-w*ze)*Ye,t[13]=(n*Ge-o*qe+u*ze)*Ye,t[14]=(U*re-R*_e-H*ce)*Ye,t[15]=(B*_e-I*re+M*ce)*Ye,t):null}function Zc(t,e,n){var o=e[0],u=e[1],f=e[2],m=e[3],y=e[4],w=e[5],A=e[6],B=e[7],I=e[8],M=e[9],z=e[10],R=e[11],U=e[12],H=e[13],ie=e[14],ce=e[15],re=n[0],ae=n[1],_e=n[2],de=n[3];return t[0]=re*o+ae*y+_e*I+de*U,t[1]=re*u+ae*w+_e*M+de*H,t[2]=re*f+ae*A+_e*z+de*ie,t[3]=re*m+ae*B+_e*R+de*ce,t[4]=(re=n[4])*o+(ae=n[5])*y+(_e=n[6])*I+(de=n[7])*U,t[5]=re*u+ae*w+_e*M+de*H,t[6]=re*f+ae*A+_e*z+de*ie,t[7]=re*m+ae*B+_e*R+de*ce,t[8]=(re=n[8])*o+(ae=n[9])*y+(_e=n[10])*I+(de=n[11])*U,t[9]=re*u+ae*w+_e*M+de*H,t[10]=re*f+ae*A+_e*z+de*ie,t[11]=re*m+ae*B+_e*R+de*ce,t[12]=(re=n[12])*o+(ae=n[13])*y+(_e=n[14])*I+(de=n[15])*U,t[13]=re*u+ae*w+_e*M+de*H,t[14]=re*f+ae*A+_e*z+de*ie,t[15]=re*m+ae*B+_e*R+de*ce,t}function $u(t,e,n){var o,u,f,m,y,w,A,B,I,M,z,R,U=n[0],H=n[1],ie=n[2];return e===t?(t[12]=e[0]*U+e[4]*H+e[8]*ie+e[12],t[13]=e[1]*U+e[5]*H+e[9]*ie+e[13],t[14]=e[2]*U+e[6]*H+e[10]*ie+e[14],t[15]=e[3]*U+e[7]*H+e[11]*ie+e[15]):(u=e[1],f=e[2],m=e[3],y=e[4],w=e[5],A=e[6],B=e[7],I=e[8],M=e[9],z=e[10],R=e[11],t[0]=o=e[0],t[1]=u,t[2]=f,t[3]=m,t[4]=y,t[5]=w,t[6]=A,t[7]=B,t[8]=I,t[9]=M,t[10]=z,t[11]=R,t[12]=o*U+y*H+I*ie+e[12],t[13]=u*U+w*H+M*ie+e[13],t[14]=f*U+A*H+z*ie+e[14],t[15]=m*U+B*H+R*ie+e[15]),t}function eu(t,e,n){var o=n[0],u=n[1],f=n[2];return t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t[3]=e[3]*o,t[4]=e[4]*u,t[5]=e[5]*u,t[6]=e[6]*u,t[7]=e[7]*u,t[8]=e[8]*f,t[9]=e[9]*f,t[10]=e[10]*f,t[11]=e[11]*f,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Wu(t,e,n){var o=Math.sin(n),u=Math.cos(n),f=e[4],m=e[5],y=e[6],w=e[7],A=e[8],B=e[9],I=e[10],M=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=f*u+A*o,t[5]=m*u+B*o,t[6]=y*u+I*o,t[7]=w*u+M*o,t[8]=A*u-f*o,t[9]=B*u-m*o,t[10]=I*u-y*o,t[11]=M*u-w*o,t}function Jc(t,e,n){var o=Math.sin(n),u=Math.cos(n),f=e[0],m=e[1],y=e[2],w=e[3],A=e[8],B=e[9],I=e[10],M=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=f*u-A*o,t[1]=m*u-B*o,t[2]=y*u-I*o,t[3]=w*u-M*o,t[8]=f*o+A*u,t[9]=m*o+B*u,t[10]=y*o+I*u,t[11]=w*o+M*u,t}function Rm(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Om(t,e,n){var o,u,f,m=n[0],y=n[1],w=n[2],A=Math.hypot(m,y,w);return A<Wf?null:(m*=A=1/A,y*=A,w*=A,o=Math.sin(e),u=Math.cos(e),t[0]=m*m*(f=1-u)+u,t[1]=y*m*f+w*o,t[2]=w*m*f-y*o,t[3]=0,t[4]=m*y*f-w*o,t[5]=y*y*f+u,t[6]=w*y*f+m*o,t[7]=0,t[8]=m*w*f+y*o,t[9]=y*w*f-m*o,t[10]=w*w*f+u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Zf=Zc;function Jf(){var t=new ho(3);return ho!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Rs(t){var e=new ho(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Os(t){return Math.hypot(t[0],t[1],t[2])}function Xc(t,e,n){var o=new ho(3);return o[0]=t,o[1]=e,o[2]=n,o}function xa(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Gm(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Ng(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function bd(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function Cd(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function Lo(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function Ed(t,e,n,o){return t[0]=e[0]+n[0]*o,t[1]=e[1]+n[1]*o,t[2]=e[2]+n[2]*o,t}function Fi(t,e){var n=e[0],o=e[1],u=e[2],f=n*n+o*o+u*u;return f>0&&(f=1/Math.sqrt(f)),t[0]=e[0]*f,t[1]=e[1]*f,t[2]=e[2]*f,t}function ls(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Nm(t,e,n){var o=e[0],u=e[1],f=e[2],m=n[0],y=n[1],w=n[2];return t[0]=u*w-f*y,t[1]=f*m-o*w,t[2]=o*y-u*m,t}function Pr(t,e,n){var o=e[0],u=e[1],f=e[2],m=n[3]*o+n[7]*u+n[11]*f+n[15];return t[0]=(n[0]*o+n[4]*u+n[8]*f+n[12])/(m=m||1),t[1]=(n[1]*o+n[5]*u+n[9]*f+n[13])/m,t[2]=(n[2]*o+n[6]*u+n[10]*f+n[14])/m,t}function Ug(t,e,n){var o=n[0],u=n[1],f=n[2],m=e[0],y=e[1],w=e[2],A=u*w-f*y,B=f*m-o*w,I=o*y-u*m,M=u*I-f*B,z=f*A-o*I,R=o*B-u*A,U=2*n[3];return B*=U,I*=U,z*=2,R*=2,t[0]=m+(A*=U)+(M*=2),t[1]=y+B+z,t[2]=w+I+R,t}var Qc,us=Gm,qg=Ng,sx=Os;function jg(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function Vg(t,e){var n=e[0],o=e[1],u=e[2],f=e[3],m=n*n+o*o+u*u+f*f;return m>0&&(m=1/Math.sqrt(m)),t[0]=n*m,t[1]=o*m,t[2]=u*m,t[3]=f*m,t}function tu(t,e,n){var o=e[0],u=e[1],f=e[2],m=e[3];return t[0]=n[0]*o+n[4]*u+n[8]*f+n[12]*m,t[1]=n[1]*o+n[5]*u+n[9]*f+n[13]*m,t[2]=n[2]*o+n[6]*u+n[10]*f+n[14]*m,t[3]=n[3]*o+n[7]*u+n[11]*f+n[15]*m,t}function Hg(){var t=new ho(4);return ho!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function $g(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Wg(t,e,n){n*=.5;var o=e[0],u=e[1],f=e[2],m=e[3],y=Math.sin(n),w=Math.cos(n);return t[0]=o*w+m*y,t[1]=u*w+f*y,t[2]=f*w-u*y,t[3]=m*w-o*y,t}function Kg(t,e,n){n*=.5;var o=e[0],u=e[1],f=e[2],m=e[3],y=Math.sin(n),w=Math.cos(n);return t[0]=o*w-f*y,t[1]=u*w+m*y,t[2]=f*w+o*y,t[3]=m*w-u*y,t}Jf(),Qc=new ho(4),ho!=Float32Array&&(Qc[0]=0,Qc[1]=0,Qc[2]=0,Qc[3]=0);var ax=Vg;Jf(),Xc(1,0,0),Xc(0,1,0),Hg(),Hg(),Og();class Um{constructor(e,n){this.pos=e,this.dir=n}intersectsPlane(e,n,o){const u=ls(n,this.dir);if(Math.abs(u)<1e-6)return!1;const f=((e[0]-this.pos[0])*n[0]+(e[1]-this.pos[1])*n[1]+(e[2]-this.pos[2])*n[2])/u;return o[0]=this.pos[0]+this.dir[0]*f,o[1]=this.pos[1]+this.dir[1]*f,o[2]=this.pos[2]+this.dir[2]*f,!0}closestPointOnSphere(e,n,o){if(function(z,R){var U=z[0],H=z[1],ie=z[2],ce=R[0],re=R[1],ae=R[2];return Math.abs(U-ce)<=Wf*Math.max(1,Math.abs(U),Math.abs(ce))&&Math.abs(H-re)<=Wf*Math.max(1,Math.abs(H),Math.abs(re))&&Math.abs(ie-ae)<=Wf*Math.max(1,Math.abs(ie),Math.abs(ae))}(this.pos,e)||n===0)return o[0]=o[1]=o[2]=0,!1;const[u,f,m]=this.dir,y=this.pos[0]-e[0],w=this.pos[1]-e[1],A=this.pos[2]-e[2],B=u*u+f*f+m*m,I=2*(y*u+w*f+A*m),M=I*I-4*B*(y*y+w*w+A*A-n*n);if(M<0){const z=Math.max(-I/2,0),R=y+u*z,U=w+f*z,H=A+m*z,ie=Math.hypot(R,U,H);return o[0]=R*n/ie,o[1]=U*n/ie,o[2]=H*n/ie,!1}{const z=(-I-Math.sqrt(M))/(2*B);if(z<0){const R=Math.hypot(y,w,A);return o[0]=y*n/R,o[1]=w*n/R,o[2]=A*n/R,!1}return o[0]=y+u*z,o[1]=w+f*z,o[2]=A+m*z,!0}}}class fo{constructor(e,n,o,u,f){this.TL=e,this.TR=n,this.BR=o,this.BL=u,this.horizon=f}static fromInvProjectionMatrix(e,n,o){const u=[-1,1,1],f=[1,1,1],m=[1,-1,1],y=[-1,-1,1],w=Pr(u,u,e),A=Pr(f,f,e),B=Pr(m,m,e),I=Pr(y,y,e);return new fo(w,A,B,I,n/o)}}class qm{constructor(e,n){this.points=e,this.planes=n}static fromInvProjectionMatrix(e,n,o,u){const f=Math.pow(2,o),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(w=>{const A=tu([],w,e),B=1/A[3]/n*f;return function(I,M,z){return I[0]=M[0]*z[0],I[1]=M[1]*z[1],I[2]=M[2]*z[2],I[3]=M[3]*z[3],I}(A,A,[B,B,u?1/A[3]:B,B])}),y=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(w=>{const A=Fi([],Nm([],us([],m[w[0]],m[w[1]]),us([],m[w[2]],m[w[1]]))),B=-ls(A,m[w[1]]);return A.concat(B)});return new qm(m,y)}}class Ri{static fromPoints(e){const n=[1/0,1/0,1/0],o=[-1/0,-1/0,-1/0];for(const u of e)bd(n,n,u),Cd(o,o,u);return new Ri(n,o)}static applyTransform(e,n){const o=e.getCorners();for(let u=0;u<o.length;++u)Pr(o[u],o[u],n);return Ri.fromPoints(o)}constructor(e,n){this.min=e,this.max=n,this.center=Lo([],xa([],this.min,this.max),.5)}quadrant(e){const n=[e%2==0,e<2],o=Rs(this.min),u=Rs(this.max);for(let f=0;f<n.length;f++)o[f]=n[f]?this.min[f]:this.center[f],u[f]=n[f]?this.center[f]:this.max[f];return u[2]=this.max[2],new Ri(o,u)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,n=this.max;return[[e[0],e[1],e[2]],[n[0],e[1],e[2]],[n[0],n[1],e[2]],[e[0],n[1],e[2]],[e[0],e[1],n[2]],[n[0],e[1],n[2]],[n[0],n[1],n[2]],[e[0],n[1],n[2]]]}intersects(e){const n=this.getCorners();let o=!0;for(let u=0;u<e.planes.length;u++){const f=e.planes[u];let m=0;for(let y=0;y<n.length;y++)m+=ls(f,n[y])+f[3]>=0;if(m===0)return 0;m!==n.length&&(o=!1)}if(o)return 2;for(let u=0;u<3;u++){let f=Number.MAX_VALUE,m=-Number.MAX_VALUE;for(let y=0;y<e.points.length;y++){const w=e.points[y][u]-this.min[u];f=Math.min(f,w),m=Math.max(m,w)}if(m<0||f>this.max[u]-this.min[u])return 0}return 1}}function Zg(t,e,n,o,u,f,m,y,w){if(f&&t.queryGeometry.isAboveHorizon)return!1;f&&(w*=t.pixelToTileUnitsFactor);const A=t.tileID.canonical,B=n.projection.upVectorScale(A,n.center.lat,n.worldSize).metersToTile;for(const I of e)for(const M of I){const z=M.add(y),R=u&&n.elevation?n.elevation.exaggeration()*u.getElevationAt(z.x,z.y,!0):0,U=n.projection.projectTilePoint(z.x,z.y,A);if(R>0){const re=n.projection.upVector(A,z.x,z.y);U.x+=re[0]*B*R,U.y+=re[1]*B*R,U.z+=re[2]*B*R}const H=f?z:Jg(U.x,U.y,U.z,o),ie=f?t.tilespaceRays.map(re=>ux(re,R)):t.queryGeometry.screenGeometry,ce=tu([],[U.x,U.y,U.z,1],o);if(!m&&f?w*=ce[3]/n.cameraToCenterDistance:m&&!f&&(w*=n.cameraToCenterDistance/ce[3]),f){const re=ei((M.y/$t+A.y)/(1<<A.z));w/=n.projection.pixelsPerMeter(re,1)/ko(1,re)}if(nx(ie,H,w))return!0}return!1}function Jg(t,e,n,o){const u=tu([],[t,e,n,1],o);return new Ie(u[0]/u[3],u[1]/u[3])}const Xg=Xc(0,0,0),lx=Xc(0,0,1);function ux(t,e){const n=Jf();return Xg[2]=e,t.intersectsPlane(Xg,lx,n),new Ie(n[0],n[1])}class Qg extends ai{}function Xf(t,{width:e,height:n},o,u){if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==e*n*o)throw new RangeError("mismatched image size")}else u=new Uint8Array(e*n*o);return t.width=e,t.height=n,t.data=u,t}function Yg(t,e,n){const{width:o,height:u}=e;o===t.width&&u===t.height||(jm(t,e,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,o),height:Math.min(t.height,u)},n),t.width=o,t.height=u,t.data=e.data)}function jm(t,e,n,o,u,f){if(u.width===0||u.height===0)return e;if(u.width>t.width||u.height>t.height||n.x>t.width-u.width||n.y>t.height-u.height)throw new RangeError("out of range source coordinates for image copy");if(u.width>e.width||u.height>e.height||o.x>e.width-u.width||o.y>e.height-u.height)throw new RangeError("out of range destination coordinates for image copy");const m=t.data,y=e.data;for(let w=0;w<u.height;w++){const A=((n.y+w)*t.width+n.x)*f,B=((o.y+w)*e.width+o.x)*f;for(let I=0;I<u.width*f;I++)y[B+I]=m[A+I]}return e}wt(Qg,"HeatmapBucket",{omit:["layers"]});class il{constructor(e,n){Xf(this,e,1,n)}resize(e){Yg(this,new il(e),1)}clone(){return new il({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,o,u,f){jm(e,n,o,u,f,1)}}class po{constructor(e,n){Xf(this,e,4,n)}resize(e){Yg(this,new po(e),4)}replace(e,n){n?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new po({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,o,u,f){jm(e,n,o,u,f,4)}}wt(il,"AlphaImage"),wt(po,"RGBAImage");var cx={paint:new ct({"heatmap-radius":new ve(Ne.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ve(Ne.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Me(Ne.paint_heatmap["heatmap-intensity"]),"heatmap-color":new dt(Ne.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Me(Ne.paint_heatmap["heatmap-opacity"])})};function Vm(t){const e={},n=t.resolution||256,o=t.clips?t.clips.length:1,u=t.image||new po({width:n,height:o}),f=(m,y,w)=>{e[t.evaluationKey]=w;const A=t.expression.evaluate(e);u.data[m+y+0]=Math.floor(255*A.r/A.a),u.data[m+y+1]=Math.floor(255*A.g/A.a),u.data[m+y+2]=Math.floor(255*A.b/A.a),u.data[m+y+3]=Math.floor(255*A.a)};if(t.clips)for(let m=0,y=0;m<o;++m,y+=4*n)for(let w=0,A=0;w<n;w++,A+=4){const B=w/(n-1),{start:I,end:M}=t.clips[m];f(y,A,I*(1-B)+M*B)}else for(let m=0,y=0;m<n;m++,y+=4)f(0,y,m/(n-1));return u}var hx={paint:new ct({"hillshade-illumination-direction":new Me(Ne.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Me(Ne.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Me(Ne.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Me(Ne.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Me(Ne.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Me(Ne.paint_hillshade["hillshade-accent-color"])})};const dx=ht([{name:"a_pos",components:2,type:"Int16"}],4),{members:fx}=dx;var Bd={exports:{}};function Qf(t,e,n){n=n||2;var o,u,f,m,y,w,A,B=e&&e.length,I=B?e[0]*n:t.length,M=ey(t,0,I,n,!0),z=[];if(!M||M.next===M.prev)return z;if(B&&(M=function(U,H,ie,ce){var re,ae,_e,de=[];for(re=0,ae=H.length;re<ae;re++)(_e=ey(U,H[re]*ce,re<ae-1?H[re+1]*ce:U.length,ce,!1))===_e.next&&(_e.steiner=!0),de.push(xx(_e));for(de.sort(yx),re=0;re<de.length;re++)ie=vx(de[re],ie);return ie}(t,e,M,n)),t.length>80*n){o=f=t[0],u=m=t[1];for(var R=n;R<I;R+=n)(y=t[R])<o&&(o=y),(w=t[R+1])<u&&(u=w),y>f&&(f=y),w>m&&(m=w);A=(A=Math.max(f-o,m-u))!==0?32767/A:0}return Td(M,z,n,o,u,A,0),z}function ey(t,e,n,o,u){var f,m;if(u===Wm(t,e,n,o)>0)for(f=e;f<n;f+=o)m=Dd(f,t[f],t[f+1],m);else for(f=n-o;f>=e;f-=o)m=Dd(f,t[f],t[f+1],m);return m&&ep(m,m.next)&&(Sd(m),m=m.next),m}function Ku(t,e){if(!t)return t;e||(e=t);var n,o=t;do if(n=!1,o.steiner||!ep(o,o.next)&&br(o.prev,o,o.next)!==0)o=o.next;else{if(Sd(o),(o=e=o.prev)===o.next)break;n=!0}while(n||o!==e);return e}function Td(t,e,n,o,u,f,m){if(t){!m&&f&&function(B,I,M,z){var R=B;do R.z===0&&(R.z=Yf(R.x,R.y,I,M,z)),R.prevZ=R.prev,R.nextZ=R.next,R=R.next;while(R!==B);R.prevZ.nextZ=null,R.prevZ=null,function(U){var H,ie,ce,re,ae,_e,de,Fe,ze=1;do{for(ie=U,U=null,ae=null,_e=0;ie;){for(_e++,ce=ie,de=0,H=0;H<ze&&(de++,ce=ce.nextZ);H++);for(Fe=ze;de>0||Fe>0&&ce;)de!==0&&(Fe===0||!ce||ie.z<=ce.z)?(re=ie,ie=ie.nextZ,de--):(re=ce,ce=ce.nextZ,Fe--),ae?ae.nextZ=re:U=re,re.prevZ=ae,ae=re;ie=ce}ae.nextZ=null,ze*=2}while(_e>1)}(R)}(t,o,u,f);for(var y,w,A=t;t.prev!==t.next;)if(y=t.prev,w=t.next,f?mx(t,o,u,f):px(t))e.push(y.i/n|0),e.push(t.i/n|0),e.push(w.i/n|0),Sd(t),t=w.next,A=w.next;else if((t=w)===A){m?m===1?Td(t=_x(Ku(t),e,n),e,n,o,u,f,2):m===2&&gx(t,e,n,o,u,f):Td(Ku(t),e,n,o,u,f,1);break}}}function px(t){var e=t.prev,n=t,o=t.next;if(br(e,n,o)>=0)return!1;for(var u=e.x,f=n.x,m=o.x,y=e.y,w=n.y,A=o.y,B=u<f?u<m?u:m:f<m?f:m,I=y<w?y<A?y:A:w<A?w:A,M=u>f?u>m?u:m:f>m?f:m,z=y>w?y>A?y:A:w>A?w:A,R=o.next;R!==e;){if(R.x>=B&&R.x<=M&&R.y>=I&&R.y<=z&&Yc(u,y,f,w,m,A,R.x,R.y)&&br(R.prev,R,R.next)>=0)return!1;R=R.next}return!0}function mx(t,e,n,o){var u=t.prev,f=t,m=t.next;if(br(u,f,m)>=0)return!1;for(var y=u.x,w=f.x,A=m.x,B=u.y,I=f.y,M=m.y,z=y<w?y<A?y:A:w<A?w:A,R=B<I?B<M?B:M:I<M?I:M,U=y>w?y>A?y:A:w>A?w:A,H=B>I?B>M?B:M:I>M?I:M,ie=Yf(z,R,e,n,o),ce=Yf(U,H,e,n,o),re=t.prevZ,ae=t.nextZ;re&&re.z>=ie&&ae&&ae.z<=ce;){if(re.x>=z&&re.x<=U&&re.y>=R&&re.y<=H&&re!==u&&re!==m&&Yc(y,B,w,I,A,M,re.x,re.y)&&br(re.prev,re,re.next)>=0||(re=re.prevZ,ae.x>=z&&ae.x<=U&&ae.y>=R&&ae.y<=H&&ae!==u&&ae!==m&&Yc(y,B,w,I,A,M,ae.x,ae.y)&&br(ae.prev,ae,ae.next)>=0))return!1;ae=ae.nextZ}for(;re&&re.z>=ie;){if(re.x>=z&&re.x<=U&&re.y>=R&&re.y<=H&&re!==u&&re!==m&&Yc(y,B,w,I,A,M,re.x,re.y)&&br(re.prev,re,re.next)>=0)return!1;re=re.prevZ}for(;ae&&ae.z<=ce;){if(ae.x>=z&&ae.x<=U&&ae.y>=R&&ae.y<=H&&ae!==u&&ae!==m&&Yc(y,B,w,I,A,M,ae.x,ae.y)&&br(ae.prev,ae,ae.next)>=0)return!1;ae=ae.nextZ}return!0}function _x(t,e,n){var o=t;do{var u=o.prev,f=o.next.next;!ep(u,f)&&ty(u,o,o.next,f)&&eh(u,f)&&eh(f,u)&&(e.push(u.i/n|0),e.push(o.i/n|0),e.push(f.i/n|0),Sd(o),Sd(o.next),o=t=f),o=o.next}while(o!==t);return Ku(o)}function gx(t,e,n,o,u,f){var m=t;do{for(var y=m.next.next;y!==m.prev;){if(m.i!==y.i&&wx(m,y)){var w=ny(m,y);return m=Ku(m,m.next),w=Ku(w,w.next),Td(m,e,n,o,u,f,0),void Td(w,e,n,o,u,f,0)}y=y.next}m=m.next}while(m!==t)}function yx(t,e){return t.x-e.x}function vx(t,e){var n=function(u,f){var m,y=f,w=u.x,A=u.y,B=-1/0;do{if(A<=y.y&&A>=y.next.y&&y.next.y!==y.y){var I=y.x+(A-y.y)*(y.next.x-y.x)/(y.next.y-y.y);if(I<=w&&I>B&&(B=I,m=y.x<y.next.x?y:y.next,I===w))return m}y=y.next}while(y!==f);if(!m)return null;var M,z=m,R=m.x,U=m.y,H=1/0;y=m;do w>=y.x&&y.x>=R&&w!==y.x&&Yc(A<U?w:B,A,R,U,A<U?B:w,A,y.x,y.y)&&(M=Math.abs(A-y.y)/(w-y.x),eh(y,u)&&(M<H||M===H&&(y.x>m.x||y.x===m.x&&Hm(m,y)))&&(m=y,H=M)),y=y.next;while(y!==z);return m}(t,e);if(!n)return e;var o=ny(n,t);return Ku(o,o.next),Ku(n,n.next)}function Hm(t,e){return br(t.prev,t,e.prev)<0&&br(e.next,t,t.next)<0}function Yf(t,e,n,o,u){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*u|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-o)*u|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function xx(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function Yc(t,e,n,o,u,f,m,y){return(u-m)*(e-y)>=(t-m)*(f-y)&&(t-m)*(o-y)>=(n-m)*(e-y)&&(n-m)*(f-y)>=(u-m)*(o-y)}function wx(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(n,o){var u=n;do{if(u.i!==n.i&&u.next.i!==n.i&&u.i!==o.i&&u.next.i!==o.i&&ty(u,u.next,n,o))return!0;u=u.next}while(u!==n);return!1}(t,e)&&(eh(t,e)&&eh(e,t)&&function(n,o){var u=n,f=!1,m=(n.x+o.x)/2,y=(n.y+o.y)/2;do u.y>y!=u.next.y>y&&u.next.y!==u.y&&m<(u.next.x-u.x)*(y-u.y)/(u.next.y-u.y)+u.x&&(f=!f),u=u.next;while(u!==n);return f}(t,e)&&(br(t.prev,t,e.prev)||br(t,e.prev,e))||ep(t,e)&&br(t.prev,t,t.next)>0&&br(e.prev,e,e.next)>0)}function br(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function ep(t,e){return t.x===e.x&&t.y===e.y}function ty(t,e,n,o){var u=np(br(t,e,n)),f=np(br(t,e,o)),m=np(br(n,o,t)),y=np(br(n,o,e));return u!==f&&m!==y||!(u!==0||!tp(t,n,e))||!(f!==0||!tp(t,o,e))||!(m!==0||!tp(n,t,o))||!(y!==0||!tp(n,e,o))}function tp(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function np(t){return t>0?1:t<0?-1:0}function eh(t,e){return br(t.prev,t,t.next)<0?br(t,e,t.next)>=0&&br(t,t.prev,e)>=0:br(t,e,t.prev)<0||br(t,t.next,e)<0}function ny(t,e){var n=new $m(t.i,t.x,t.y),o=new $m(e.i,e.x,e.y),u=t.next,f=e.prev;return t.next=e,e.prev=t,n.next=u,u.prev=n,o.next=n,n.prev=o,f.next=o,o.prev=f,o}function Dd(t,e,n,o){var u=new $m(t,e,n);return o?(u.next=o.next,u.prev=o,o.next.prev=u,o.next=u):(u.prev=u,u.next=u),u}function Sd(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function $m(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Wm(t,e,n,o){for(var u=0,f=e,m=n-o;f<n;f+=o)u+=(t[m]-t[f])*(t[f+1]+t[m+1]),m=f;return u}function Ax(t,e,n,o,u){ry(t,e,n||0,o||t.length-1,u||bx)}function ry(t,e,n,o,u){for(;o>n;){if(o-n>600){var f=o-n+1,m=e-n+1,y=Math.log(f),w=.5*Math.exp(2*y/3),A=.5*Math.sqrt(y*w*(f-w)/f)*(m-f/2<0?-1:1);ry(t,e,Math.max(n,Math.floor(e-m*w/f+A)),Math.min(o,Math.floor(e+(f-m)*w/f+A)),u)}var B=t[e],I=n,M=o;for(Id(t,n,e),u(t[o],B)>0&&Id(t,n,o);I<M;){for(Id(t,I,M),I++,M--;u(t[I],B)<0;)I++;for(;u(t[M],B)>0;)M--}u(t[n],B)===0?Id(t,n,M):Id(t,++M,o),M<=e&&(n=M+1),e<=M&&(o=M-1)}}function Id(t,e,n){var o=t[e];t[e]=t[n],t[n]=o}function bx(t,e){return t<e?-1:t>e?1:0}function Km(t,e){const n=t.length;if(n<=1)return[t];const o=[];let u,f;for(let m=0;m<n;m++){const y=sn(t[m]);y!==0&&(t[m].area=Math.abs(y),f===void 0&&(f=y<0),f===y<0?(u&&o.push(u),u=[t[m]]):u.push(t[m]))}if(u&&o.push(u),e>1)for(let m=0;m<o.length;m++)o[m].length<=e||(Ax(o[m],e,1,o[m].length-1,Cx),o[m]=o[m].slice(0,e));return o}function Cx(t,e){return e.area-t.area}function Zm(t,e,n){const o=n.patternDependencies;let u=!1;for(const f of e){const m=f.paint.get(`${t}-pattern`);m.isConstant()||(u=!0);const y=m.constantOr(null);y&&(u=!0,o[y.to]=!0,o[y.from]=!0)}return u}function Jm(t,e,n,o,u){const f=u.patternDependencies;for(const m of e){const y=m.paint.get(`${t}-pattern`).value;if(y.kind!=="constant"){let w=y.evaluate({zoom:o-1},n,{},u.availableImages),A=y.evaluate({zoom:o},n,{},u.availableImages),B=y.evaluate({zoom:o+1},n,{},u.availableImages);w=w&&w.name?w.name:w,A=A&&A.name?A.name:A,B=B&&B.name?B.name:B,f[w]=!0,f[A]=!0,f[B]=!0,n.patterns[m.id]={min:w,mid:A,max:B}}}return n}Bd.exports=Qf,Bd.exports.default=Qf,Qf.deviation=function(t,e,n,o){var u=e&&e.length,f=Math.abs(Wm(t,0,u?e[0]*n:t.length,n));if(u)for(var m=0,y=e.length;m<y;m++)f-=Math.abs(Wm(t,e[m]*n,m<y-1?e[m+1]*n:t.length,n));var w=0;for(m=0;m<o.length;m+=3){var A=o[m]*n,B=o[m+1]*n,I=o[m+2]*n;w+=Math.abs((t[A]-t[I])*(t[B+1]-t[A+1])-(t[A]-t[B])*(t[I+1]-t[A+1]))}return f===0&&w===0?0:Math.abs((w-f)/f)},Qf.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},o=0,u=0;u<t.length;u++){for(var f=0;f<t[u].length;f++)for(var m=0;m<e;m++)n.vertices.push(t[u][f][m]);u>0&&n.holes.push(o+=t[u-1].length)}return n};class rp{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new on,this.indexArray=new Yr,this.indexArray2=new Ai,this.programConfigurations=new as(e.layers,e.zoom),this.segments=new kr,this.segments2=new kr,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.projection=e.projection}populate(e,n,o,u){this.hasPattern=Zm("fill",this.layers,n);const f=this.layers[0].layout.get("fill-sort-key"),m=[];for(const{feature:y,id:w,index:A,sourceLayerIndex:B}of e){const I=this.layers[0]._featureFilter.needGeometry,M=Hu(y,I);if(!this.layers[0]._featureFilter.filter(new oe(this.zoom),M,o))continue;const z=f?f.evaluate(M,{},o,n.availableImages):void 0,R={id:w,properties:y.properties,type:y.type,sourceLayerIndex:B,index:A,geometry:I?M.geometry:Hi(y,o,u),patterns:{},sortKey:z};m.push(R)}f&&m.sort((y,w)=>y.sortKey-w.sortKey);for(const y of m){const{geometry:w,index:A,sourceLayerIndex:B}=y;if(this.hasPattern){const I=Jm("fill",this.layers,y,this.zoom,n);this.patternFeatures.push(I)}else this.addFeature(y,w,A,o,{},n.availableImages);n.featureIndex.insert(e[A].feature,w,A,B,this.index)}}update(e,n,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,o,u)}addFeatures(e,n,o,u,f){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,n,o,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,fx),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,n,o,u,f,m=[]){for(const y of Km(n,500)){let w=0;for(const R of y)w+=R.length;const A=this.segments.prepareSegment(w,this.layoutVertexArray,this.indexArray),B=A.vertexLength,I=[],M=[];for(const R of y){if(R.length===0)continue;R!==y[0]&&M.push(I.length/2);const U=this.segments2.prepareSegment(R.length,this.layoutVertexArray,this.indexArray2),H=U.vertexLength;this.layoutVertexArray.emplaceBack(R[0].x,R[0].y),this.indexArray2.emplaceBack(H+R.length-1,H),I.push(R[0].x),I.push(R[0].y);for(let ie=1;ie<R.length;ie++)this.layoutVertexArray.emplaceBack(R[ie].x,R[ie].y),this.indexArray2.emplaceBack(H+ie-1,H+ie),I.push(R[ie].x),I.push(R[ie].y);U.vertexLength+=R.length,U.primitiveLength+=R.length}const z=Bd.exports(I,M);for(let R=0;R<z.length;R+=3)this.indexArray.emplaceBack(B+z[R],B+z[R+1],B+z[R+2]);A.vertexLength+=w,A.primitiveLength+=z.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,f,m,u)}}wt(rp,"FillBucket",{omit:["layers","patternFeatures"]});const Ex=new ct({"fill-sort-key":new ve(Ne.layout_fill["fill-sort-key"])});var Bx={paint:new ct({"fill-antialias":new Me(Ne.paint_fill["fill-antialias"]),"fill-opacity":new ve(Ne.paint_fill["fill-opacity"]),"fill-color":new ve(Ne.paint_fill["fill-color"]),"fill-outline-color":new ve(Ne.paint_fill["fill-outline-color"]),"fill-translate":new Me(Ne.paint_fill["fill-translate"]),"fill-translate-anchor":new Me(Ne.paint_fill["fill-translate-anchor"]),"fill-pattern":new pt(Ne.paint_fill["fill-pattern"])}),layout:Ex};const Tx=ht([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Dx=ht([{name:"a_centroid_pos",components:2,type:"Uint16"}]),iy=ht([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:oy}=Tx;var ip={},Sx=Ie,sy=th;function th(t,e,n,o,u){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=o,this._values=u,t.readFields(op,this,e)}function op(t,e,n){t==1?e.id=n.readVarint():t==2?function(o,u){for(var f=o.readVarint()+o.pos;o.pos<f;){var m=u._keys[o.readVarint()],y=u._values[o.readVarint()];u.properties[m]=y}}(n,e):t==3?e.type=n.readVarint():t==4&&(e._geometry=n.pos)}function Ix(t){for(var e,n,o=0,u=0,f=t.length,m=f-1;u<f;m=u++)o+=((n=t[m]).x-(e=t[u]).x)*(e.y+n.y);return o}th.types=["Unknown","Point","LineString","Polygon"],th.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,o=1,u=0,f=0,m=0,y=[];t.pos<n;){if(u<=0){var w=t.readVarint();o=7&w,u=w>>3}if(u--,o===1||o===2)f+=t.readSVarint(),m+=t.readSVarint(),o===1&&(e&&y.push(e),e=[]),e.push(new Sx(f,m));else{if(o!==7)throw new Error("unknown command "+o);e&&e.push(e[0].clone())}}return e&&y.push(e),y},th.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,o=0,u=0,f=0,m=1/0,y=-1/0,w=1/0,A=-1/0;t.pos<e;){if(o<=0){var B=t.readVarint();n=7&B,o=B>>3}if(o--,n===1||n===2)(u+=t.readSVarint())<m&&(m=u),u>y&&(y=u),(f+=t.readSVarint())<w&&(w=f),f>A&&(A=f);else if(n!==7)throw new Error("unknown command "+n)}return[m,w,y,A]},th.prototype.toGeoJSON=function(t,e,n){var o,u,f=this.extent*Math.pow(2,n),m=this.extent*t,y=this.extent*e,w=this.loadGeometry(),A=th.types[this.type];function B(z){for(var R=0;R<z.length;R++){var U=z[R];z[R]=[360*(U.x+m)/f-180,360/Math.PI*Math.atan(Math.exp((180-360*(U.y+y)/f)*Math.PI/180))-90]}}switch(this.type){case 1:var I=[];for(o=0;o<w.length;o++)I[o]=w[o][0];B(w=I);break;case 2:for(o=0;o<w.length;o++)B(w[o]);break;case 3:for(w=function(z){var R=z.length;if(R<=1)return[z];for(var U,H,ie=[],ce=0;ce<R;ce++){var re=Ix(z[ce]);re!==0&&(H===void 0&&(H=re<0),H===re<0?(U&&ie.push(U),U=[z[ce]]):U.push(z[ce]))}return U&&ie.push(U),ie}(w),o=0;o<w.length;o++)for(u=0;u<w[o].length;u++)B(w[o][u])}w.length===1?w=w[0]:A="Multi"+A;var M={type:"Feature",geometry:{type:A,coordinates:w},properties:this.properties};return"id"in this&&(M.id=this.id),M};var Mx=sy,ay=ly;function ly(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(kx,this,e),this.length=this._features.length}function kx(t,e,n){t===15?e.version=n.readVarint():t===1?e.name=n.readString():t===5?e.extent=n.readVarint():t===2?e._features.push(n.pos):t===3?e._keys.push(n.readString()):t===4&&e._values.push(function(o){for(var u=null,f=o.readVarint()+o.pos;o.pos<f;){var m=o.readVarint()>>3;u=m===1?o.readString():m===2?o.readFloat():m===3?o.readDouble():m===4?o.readVarint64():m===5?o.readVarint():m===6?o.readSVarint():m===7?o.readBoolean():null}return u}(n))}ly.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new Mx(this._pbf,e,this.extent,this._keys,this._values)};var Px=ay;function Lx(t,e,n){if(t===3){var o=new Px(n,n.readVarint()+n.pos);o.length&&(e[o.name]=o)}}var Xm=ip.VectorTile=function(t,e){this.layers=t.readFields(Lx,{},e)},sp=ip.VectorTileFeature=sy;function ap(t,e,n,o){const u=[],f=o===0?(m,y,w,A,B,I)=>{m.push(new Ie(I,w+(I-y)/(A-y)*(B-w)))}:(m,y,w,A,B,I)=>{m.push(new Ie(y+(I-w)/(B-w)*(A-y),I))};for(const m of t){const y=[];for(const w of m){if(w.length<=2)continue;const A=[];for(let M=0;M<w.length-1;M++){const z=w[M].x,R=w[M].y,U=w[M+1].x,H=w[M+1].y,ie=o===0?z:R,ce=o===0?U:H;ie<e?ce>e&&f(A,z,R,U,H,e):ie>n?ce<n&&f(A,z,R,U,H,n):A.push(w[M]),ce<e&&ie>=e&&f(A,z,R,U,H,e),ce>n&&ie<=n&&f(A,z,R,U,H,n)}let B=w[w.length-1];const I=o===0?B.x:B.y;I>=e&&I<=n&&A.push(B),A.length&&(B=A[A.length-1],A[0].x===B.x&&A[0].y===B.y||A.push(A[0]),y.push(A))}y.length&&u.push(y)}return u}ip.VectorTileLayer=ay;const zx=sp.types,lp=Math.pow(2,13);function Md(t,e,n,o,u,f,m,y){t.emplaceBack((e<<1)+m,(n<<1)+f,(Math.floor(o*lp)<<1)+u,Math.round(y))}function nh(t,e,n){t.emplaceBack(e.x,e.y,e.z,n[0]*16384,n[1]*16384,n[2]*16384)}class Qm{constructor(){this.acc=new Ie(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new Ie(e.x,e.y),this.max=new Ie(e.x,e.y))}append(e,n){this.currentPolyCount.edges++,this.acc._add(e);const o=this.min,u=this.max;e.x<o.x?o.x=e.x:e.x>u.x&&(u.x=e.x),e.y<o.y?o.y=e.y:e.y>u.y&&(u.y=e.y),((e.x===0||e.x===$t)&&e.x===n.x)!=((e.y===0||e.y===$t)&&e.y===n.y)&&this.processBorderOverlap(e,n),n.x<0!=e.x<0&&this.addBorderIntersection(0,xn(n.y,e.y,(0-n.x)/(e.x-n.x))),n.x>$t!=e.x>$t&&this.addBorderIntersection(1,xn(n.y,e.y,($t-n.x)/(e.x-n.x))),n.y<0!=e.y<0&&this.addBorderIntersection(2,xn(n.x,e.x,(0-n.y)/(e.y-n.y))),n.y>$t!=e.y>$t&&this.addBorderIntersection(3,xn(n.x,e.x,($t-n.y)/(e.y-n.y)))}addBorderIntersection(e,n){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const o=this.borders[e];n<o[0]&&(o[0]=n),n>o[1]&&(o[1]=n)}processBorderOverlap(e,n){if(e.x===n.x){if(e.y===n.y)return;const o=e.x===0?0:1;this.addBorderIntersection(o,n.y),this.addBorderIntersection(o,e.y)}else{const o=e.y===0?2:3;this.addBorderIntersection(o,n.x),this.addBorderIntersection(o,e.x)}}centroid(){const e=this.polyCount.reduce((n,o)=>n+o.edges,0);return e!==0?this.acc.div(e)._round():new Ie(0,0)}span(){return new Ie(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,n)=>e+ +(n[0]!==Number.MAX_VALUE),0)}}class Zu{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.layoutVertexArray=new Nn,this.centroidVertexArray=new Rf,this.indexArray=new Yr,this.programConfigurations=new as(e.layers,e.zoom),this.segments=new kr,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.enableTerrain=e.enableTerrain}populate(e,n,o,u){this.features=[],this.hasPattern=Zm("fill-extrusion",this.layers,n),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(f){const m=Math.exp(Math.PI*(1-f.y/(1<<f.z)*2));return 80150034*m/(m*m+1)/$t/(1<<f.z)}(o),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:f,id:m,index:y,sourceLayerIndex:w}of e){const A=this.layers[0]._featureFilter.needGeometry,B=Hu(f,A);if(!this.layers[0]._featureFilter.filter(new oe(this.zoom),B,o))continue;const I={id:m,sourceLayerIndex:w,index:y,geometry:A?B.geometry:Hi(f,o,u),properties:f.properties,type:f.type,patterns:{}},M=this.layoutVertexArray.length;this.hasPattern?this.features.push(Jm("fill-extrusion",this.layers,I,this.zoom,n)):this.addFeature(I,I.geometry,y,o,{},n.availableImages,u),n.featureIndex.insert(f,I.geometry,y,w,this.index,M)}this.sortBorders()}addFeatures(e,n,o,u,f){for(const m of this.features){const{geometry:y}=m;this.addFeature(m,y,m.index,n,o,u,f)}this.sortBorders()}update(e,n,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,o,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,oy),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,iy.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Dx.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,n,o,u,f,m,y){const w=[new Ie(0,0),new Ie($t,$t)],A=y.projection,B=A.name==="globe",I=this.enableTerrain&&!B?new Qm:null,M=zx[e.type]==="Polygon";B&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Mo);const z=Km(n,500);for(let ie=z.length-1;ie>=0;ie--){const ce=z[ie];(ce.length===0||(R=ce[0]).every(re=>re.x<=0)||R.every(re=>re.x>=$t)||R.every(re=>re.y<=0)||R.every(re=>re.y>=$t))&&z.splice(ie,1)}var R;let U;if(B)U=kd(z,w,u);else{U=[];for(const ie of z)U.push({polygon:ie,bounds:w})}const H=M?this.edgeRadius:0;for(const{polygon:ie,bounds:ce}of U){let re=0,ae=0;for(const de of ie)M&&!de[0].equals(de[de.length-1])&&de.push(de[0]),ae+=M?de.length-1:de.length;const _e=this.segments.prepareSegment((M?5:4)*ae,this.layoutVertexArray,this.indexArray);if(M){const de=[],Fe=[];re=_e.vertexLength;for(const qe of ie){let st,Ge;qe.length&&qe!==ie[0]&&Fe.push(de.length/2),st=qe[1].sub(qe[0])._perp()._unit();for(let We=1;We<qe.length;We++){const Ze=qe[We],Ye=qe[We===qe.length-1?1:We+1];let{x:lt,y:je}=Ze;if(H){Ge=Ye.sub(Ze)._perp()._unit();const bt=st.add(Ge)._unit(),Xt=H*Math.min(4,1/(st.x*bt.x+st.y*bt.y));lt+=Xt*bt.x,je+=Xt*bt.y,st=Ge}Md(this.layoutVertexArray,lt,je,0,0,1,1,0),_e.vertexLength++,de.push(Ze.x,Ze.y),B&&nh(this.layoutVertexExtArray,A.projectTilePoint(lt,je,u),A.upVector(u,lt,je))}}const ze=Bd.exports(de,Fe);for(let qe=0;qe<ze.length;qe+=3)this.indexArray.emplaceBack(re+ze[qe],re+ze[qe+2],re+ze[qe+1]),_e.primitiveLength++}for(const de of ie){I&&de.length&&I.startRing(de[0]);let Fe,ze,qe,st=de.length>4&&cy(de[de.length-2],de[0],de[1]),Ge=H?uy(de[de.length-2],de[0],de[1],H):0;ze=de[1].sub(de[0])._perp()._unit();let We=!0;for(let Ze=1,Ye=0;Ze<de.length;Ze++){let lt=de[Ze-1],je=de[Ze];const bt=de[Ze===de.length-1?1:Ze+1];if(I&&M&&I.currentPolyCount.top++,t_(je,lt,ce)){H&&(ze=bt.sub(je)._perp()._unit(),We=!We);continue}I&&I.append(je,lt);const Xt=je.sub(lt)._perp(),It=Xt.x/(Math.abs(Xt.x)+Math.abs(Xt.y)),Dt=Xt.y>0?1:0,gt=lt.dist(je);if(Ye+gt>32768&&(Ye=0),H){qe=bt.sub(je)._perp()._unit();let kn=e_(lt,je,bt,Ym(ze,qe),H);isNaN(kn)&&(kn=0);const rn=je.sub(lt)._unit();lt=lt.add(rn.mult(Ge))._round(),je=je.add(rn.mult(-kn))._round(),Ge=kn,ze=qe}const Zt=_e.vertexLength,an=de.length>4&&cy(lt,je,bt);let ln=hy(Ye,st,We);if(Md(this.layoutVertexArray,lt.x,lt.y,It,Dt,0,0,ln),Md(this.layoutVertexArray,lt.x,lt.y,It,Dt,0,1,ln),Ye+=gt,ln=hy(Ye,an,!We),st=an,Md(this.layoutVertexArray,je.x,je.y,It,Dt,0,0,ln),Md(this.layoutVertexArray,je.x,je.y,It,Dt,0,1,ln),_e.vertexLength+=4,this.indexArray.emplaceBack(Zt+0,Zt+1,Zt+2),this.indexArray.emplaceBack(Zt+1,Zt+3,Zt+2),_e.primitiveLength+=2,H){const kn=re+(Ze===1?de.length-2:Ze-2),rn=Ze===1?re:kn+1;if(this.indexArray.emplaceBack(Zt+1,kn,Zt+3),this.indexArray.emplaceBack(kn,rn,Zt+3),_e.primitiveLength+=2,Fe===void 0&&(Fe=Zt),!t_(bt,de[Ze],ce)){const ur=Ze===de.length-1?Fe:_e.vertexLength;this.indexArray.emplaceBack(Zt+2,Zt+3,ur),this.indexArray.emplaceBack(Zt+3,ur+1,ur),this.indexArray.emplaceBack(Zt+3,rn,ur+1),_e.primitiveLength+=3}We=!We}if(B){const kn=this.layoutVertexExtArray,rn=A.projectTilePoint(lt.x,lt.y,u),ur=A.projectTilePoint(je.x,je.y,u),mn=A.upVector(u,lt.x,lt.y),vn=A.upVector(u,je.x,je.y);nh(kn,rn,mn),nh(kn,rn,mn),nh(kn,ur,vn),nh(kn,ur,vn)}}M&&(re+=de.length-1)}}if(I&&I.polyCount.length>0){if(I.borders){I.vertexArrayOffset=this.centroidVertexArray.length;const ie=I.borders,ce=this.featuresOnBorder.push(I)-1;for(let re=0;re<4;re++)ie[re][0]!==Number.MAX_VALUE&&this.borders[re].push(ce)}this.encodeCentroid(I.borders?void 0:I.centroid(),I)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,f,m,u)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((n,o)=>this.featuresOnBorder[n].borders[e][0]-this.featuresOnBorder[o].borders[e][0])}encodeCentroid(e,n,o=!0){let u,f;if(e)if(e.y!==0){const y=n.span()._mult(this.tileToMeter);u=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(y.x/10)),f=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(y.y/10))}else u=Math.ceil(7*(e.x+450)),f=0;else u=0,f=+o;let m=o?this.centroidVertexArray.length:n.vertexArrayOffset;for(const y of n.polyCount){o&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*y.edges+y.top);for(let w=0;w<y.top;w++)this.centroidVertexArray.emplace(m++,u,f);for(let w=0;w<2*y.edges;w++)this.centroidVertexArray.emplace(m++,0,f),this.centroidVertexArray.emplace(m++,u,f)}}}function Ym(t,e){const n=t.add(e)._unit();return t.x*n.x+t.y*n.y}function uy(t,e,n,o){const u=e.sub(t)._perp()._unit(),f=n.sub(e)._perp()._unit();return e_(t,e,n,Ym(u,f),o)}function e_(t,e,n,o,u){const f=Math.sqrt(1-o*o);return Math.min(t.dist(e)/3,e.dist(n)/3,u*f/o)}function t_(t,e,n){return t.x<n[0].x&&e.x<n[0].x||t.x>n[1].x&&e.x>n[1].x||t.y<n[0].y&&e.y<n[0].y||t.y>n[1].y&&e.y>n[1].y}function cy(t,e,n){if(t.x<0||t.x>=$t||e.x<0||e.x>=$t||n.x<0||n.x>=$t)return!1;const o=n.sub(e),u=o.perp(),f=t.sub(e);return(o.x*f.x+o.y*f.y)/Math.sqrt((o.x*o.x+o.y*o.y)*(f.x*f.x+f.y*f.y))>-.866&&u.x*f.x+u.y*f.y<0}function hy(t,e,n){const o=e?2|t:-3&t;return n?1|o:-2&o}function dy(){const t=Math.PI/32,e=Math.tan(t),n=vd;return n*Math.sqrt(1+2*e*e)-n}function kd(t,e,n){const o=1<<n.z,u=Po(n.x/o),f=Po((n.x+1)/o),m=ei(n.y/o),y=ei((n.y+1)/o);return function(w,A,B,I,M=0,z){const R=[];if(!w.length||!B||!I)return R;const U=(de,Fe)=>{for(const ze of de)R.push({polygon:ze,bounds:Fe})},H=Math.ceil(Math.log2(B)),ie=Math.ceil(Math.log2(I)),ce=H-ie,re=[];for(let de=0;de<Math.abs(ce);de++)re.push(ce>0?0:1);for(let de=0;de<Math.min(H,ie);de++)re.push(0),re.push(1);let ae=w;if(ae=ap(ae,A[0].y-M,A[1].y+M,1),ae=ap(ae,A[0].x-M,A[1].x+M,0),!ae.length)return R;const _e=[];for(re.length?_e.push({polygons:ae,bounds:A,depth:0}):U(ae,A);_e.length;){const de=_e.pop(),Fe=de.depth,ze=re[Fe],qe=de.bounds[0],st=de.bounds[1],Ge=ze===0?qe.x:qe.y,We=ze===0?st.x:st.y,Ze=z?z(ze,Ge,We):.5*(Ge+We),Ye=ap(de.polygons,Ge-M,Ze+M,ze),lt=ap(de.polygons,Ze-M,We+M,ze);if(Ye.length){const je=[qe,new Ie(ze===0?Ze:st.x,ze===1?Ze:st.y)];re.length>Fe+1?_e.push({polygons:Ye,bounds:je,depth:Fe+1}):U(Ye,je)}if(lt.length){const je=[new Ie(ze===0?Ze:qe.x,ze===1?Ze:qe.y),st];re.length>Fe+1?_e.push({polygons:lt,bounds:je,depth:Fe+1}):U(lt,je)}}return R}(t,e,Math.ceil((f-u)/11.25),Math.ceil((m-y)/11.25),1,(w,A,B)=>{if(w===0)return .5*(A+B);{const I=ei((n.y+A/$t)/o);return(zs(.5*(ei((n.y+B/$t)/o)+I))*o-n.y)*$t}})}wt(Zu,"FillExtrusionBucket",{omit:["layers","features"]}),wt(Qm,"PartMetadata");const up=new ct({"fill-extrusion-edge-radius":new Me(Ne["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var Fx={paint:new ct({"fill-extrusion-opacity":new Me(Ne["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ve(Ne["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Me(Ne["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Me(Ne["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new pt(Ne["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ve(Ne["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ve(Ne["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Me(Ne["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Me(Ne["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Me(Ne["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"])}),layout:up};function fy(t,e,n){var o=2*Math.PI*6378137/256/Math.pow(2,n);return[t*o-2*Math.PI*6378137/2,e*o-2*Math.PI*6378137/2]}class rh{constructor(e,n,o){this.z=e,this.x=n,this.y=o,this.key=Pd(0,e,e,n,o)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,n){const o=function(f,m,y){var w=fy(256*f,256*(m=Math.pow(2,y)-m-1),y),A=fy(256*(f+1),256*(m+1),y);return w[0]+","+w[1]+","+A[0]+","+A[1]}(this.x,this.y,this.z),u=function(f,m,y){let w,A="";for(let B=f;B>0;B--)w=1<<B-1,A+=(m&w?1:0)+(y&w?2:0);return A}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(n==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",u).replace("{bbox-epsg-3857}",o)}toString(){return`${this.z}/${this.x}/${this.y}`}}class n_{constructor(e,n){this.wrap=e,this.canonical=n,this.key=Pd(e,n.z,n.z,n.x,n.y)}}class Oi{constructor(e,n,o,u,f){this.overscaledZ=e,this.wrap=n,this.canonical=new rh(o,+u,+f),this.key=n===0&&e===o?this.canonical.key:Pd(n,e,o,u,f)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const n=this.canonical.z-e;return e>this.canonical.z?new Oi(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Oi(e,this.wrap,e,this.canonical.x>>n,this.canonical.y>>n)}calculateScaledKey(e,n=!0){if(this.overscaledZ===e&&n)return this.key;if(e>this.canonical.z)return Pd(this.wrap*+n,e,this.canonical.z,this.canonical.x,this.canonical.y);{const o=this.canonical.z-e;return Pd(this.wrap*+n,e,e,this.canonical.x>>o,this.canonical.y>>o)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const n=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>n&&e.canonical.y===this.canonical.y>>n}children(e){if(this.overscaledZ>=e)return[new Oi(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,o=2*this.canonical.x,u=2*this.canonical.y;return[new Oi(n,this.wrap,n,o,u),new Oi(n,this.wrap,n,o+1,u),new Oi(n,this.wrap,n,o,u+1),new Oi(n,this.wrap,n,o+1,u+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Oi(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Oi(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new n_(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Pd(t,e,n,o,u){const f=1<<Math.min(n,22);let m=f*(u%f)+o%f;return t&&n<22&&(m+=f*f*((t<0?-2*t-1:2*t)%(1<<2*(22-n)))),16*(32*m+n)+(e-n)}wt(rh,"CanonicalTileID"),wt(Oi,"OverscaledTileID",{omit:["projMatrix"]});class ih extends Ie{constructor(e,n,o){super(e,n),this.z=o}}function Ld(t,e){return t.x*e.x+t.y*e.y}function py(t,e){if(t.length===1){let n=0;const o=e[n++];let u;for(;!u||o.equals(u);)if(u=e[n++],!u)return 1/0;for(;n<e.length;n++){const f=e[n],m=t[0],y=u.sub(o),w=f.sub(o),A=m.sub(o),B=Ld(y,y),I=Ld(y,w),M=Ld(w,w),z=Ld(A,y),R=Ld(A,w),U=B*M-I*I,H=(M*z-I*R)/U,ie=(B*R-I*z)/U,ce=o.z*(1-H-ie)+u.z*H+f.z*ie;if(isFinite(ce))return ce}return 1/0}{let n=1/0;for(const o of e)n=Math.min(n,o.z);return n}}function my(t,e,n,o,u,f,m,y){const w=m*u.getElevationAt(t,e,!0,!0),A=f[0]!==0,B=A?f[1]===0?m*(f[0]/7-450):m*function(I,M,z){const R=Math.floor(M[0]/8),U=Math.floor(M[1]/8),H=10*(M[0]-8*R),ie=10*(M[1]-8*U),ce=I.getElevationAt(R,U,!0,!0),re=I.getMeterToDEM(z),ae=Math.floor(.5*(H*re-1)),_e=Math.floor(.5*(ie*re-1)),de=I.tileCoordToPixel(R,U),Fe=2*ae+1,ze=2*_e+1,qe=function(lt,je,bt,Xt,It){return[lt.getElevationAtPixel(je,bt,!0),lt.getElevationAtPixel(je+It,bt,!0),lt.getElevationAtPixel(je,bt+It,!0),lt.getElevationAtPixel(je+Xt,bt+It,!0)]}(I,de.x-ae,de.y-_e,Fe,ze),st=Math.abs(qe[0]-qe[1]),Ge=Math.abs(qe[2]-qe[3]),We=Math.abs(qe[0]-qe[2])+Math.abs(qe[1]-qe[3]),Ze=Math.min(.25,.5*re*(st+Ge)/Fe),Ye=Math.min(.25,.5*re*We/ze);return ce+Math.max(Ze*H,Ye*ie)}(u,f,y):w;return{base:w+(n===0)?-1:n,top:A?Math.max(B+o,w+n+2):w+o}}const Rx=ht([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:Ox}=Rx,Gx=ht([{name:"a_packed",components:4,type:"Float32"}]),{members:Nx}=Gx,Ux=sp.types,qx=Math.cos(Math.PI/180*37.5);class mo{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(n=>{this.gradients[n.id]={}}),this.layoutVertexArray=new Dn,this.layoutVertexArray2=new Mr,this.indexArray=new Yr,this.programConfigurations=new as(e.layers,e.zoom),this.segments=new kr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,o,u){this.hasPattern=Zm("line",this.layers,n);const f=this.layers[0].layout.get("line-sort-key"),m=[];for(const{feature:B,id:I,index:M,sourceLayerIndex:z}of e){const R=this.layers[0]._featureFilter.needGeometry,U=Hu(B,R);if(!this.layers[0]._featureFilter.filter(new oe(this.zoom),U,o))continue;const H=f?f.evaluate(U,{},o):void 0,ie={id:I,properties:B.properties,type:B.type,sourceLayerIndex:z,index:M,geometry:R?U.geometry:Hi(B,o,u),patterns:{},sortKey:H};m.push(ie)}f&&m.sort((B,I)=>B.sortKey-I.sortKey);const{lineAtlas:y,featureIndex:w}=n,A=this.addConstantDashes(y);for(const B of m){const{geometry:I,index:M,sourceLayerIndex:z}=B;if(A&&this.addFeatureDashes(B,y),this.hasPattern){const R=Jm("line",this.layers,B,this.zoom,n);this.patternFeatures.push(R)}else this.addFeature(B,I,M,o,y.positions,n.availableImages);w.insert(e[M].feature,I,M,z,this.index)}}addConstantDashes(e){let n=!1;for(const o of this.layers){const u=o.paint.get("line-dasharray").value,f=o.layout.get("line-cap").value;if(u.kind!=="constant"||f.kind!=="constant")n=!0;else{const m=f.value,y=u.value;if(!y)continue;e.addDash(y.from,m),e.addDash(y.to,m),y.other&&e.addDash(y.other,m)}}return n}addFeatureDashes(e,n){const o=this.zoom;for(const u of this.layers){const f=u.paint.get("line-dasharray").value,m=u.layout.get("line-cap").value;if(f.kind==="constant"&&m.kind==="constant")continue;let y,w,A,B,I,M;if(f.kind==="constant"){const H=f.value;if(!H)continue;y=H.other||H.to,w=H.to,A=H.from}else y=f.evaluate({zoom:o-1},e),w=f.evaluate({zoom:o},e),A=f.evaluate({zoom:o+1},e);m.kind==="constant"?B=I=M=m.value:(B=m.evaluate({zoom:o-1},e),I=m.evaluate({zoom:o},e),M=m.evaluate({zoom:o+1},e)),n.addDash(y,B),n.addDash(w,I),n.addDash(A,M);const z=n.getKey(y,B),R=n.getKey(w,I),U=n.getKey(A,M);e.patterns[u.id]={min:z,mid:R,max:U}}}update(e,n,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,o,u)}addFeatures(e,n,o,u,f){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,n,o,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Nx)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ox),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,n,o,u,f,m){const y=this.layers[0].layout,w=y.get("line-join").evaluate(e,{}),A=y.get("line-cap").evaluate(e,{}),B=y.get("line-miter-limit"),I=y.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const M of n)this.addLine(M,e,w,A,B,I);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,f,m,u)}addLine(e,n,o,u,f,m){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ie=0;ie<e.length-1;ie++)this.totalDistance+=e[ie].dist(e[ie+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const y=Ux[n.type]==="Polygon";let w=e.length;for(;w>=2&&e[w-1].equals(e[w-2]);)w--;let A=0;for(;A<w-1&&e[A].equals(e[A+1]);)A++;if(w<(y?3:2))return;o==="bevel"&&(f=1.05);const B=this.overscaling<=16?122880/(512*this.overscaling):0,I=this.segments.prepareSegment(10*w,this.layoutVertexArray,this.indexArray);let M,z,R,U,H;this.e1=this.e2=-1,y&&(M=e[w-2],H=e[A].sub(M)._unit()._perp());for(let ie=A;ie<w;ie++){if(R=ie===w-1?y?e[A+1]:void 0:e[ie+1],R&&e[ie].equals(R))continue;H&&(U=H),M&&(z=M),M=e[ie],H=R?R.sub(M)._unit()._perp():U,U=U||H;let ce=U.add(H);ce.x===0&&ce.y===0||ce._unit();const re=U.x*H.x+U.y*H.y,ae=ce.x*H.x+ce.y*H.y,_e=ae!==0?1/ae:1/0,de=2*Math.sqrt(2-2*ae),Fe=ae<qx&&z&&R,ze=U.x*H.y-U.y*H.x>0;if(Fe&&ie>A){const Ge=M.dist(z);if(Ge>2*B){const We=M.sub(M.sub(z)._mult(B/Ge)._round());this.updateDistance(z,We),this.addCurrentVertex(We,U,0,0,I),z=We}}const qe=z&&R;let st=qe?o:y?"butt":u;if(qe&&st==="round"&&(_e<m?st="miter":_e<=2&&(st="fakeround")),st==="miter"&&_e>f&&(st="bevel"),st==="bevel"&&(_e>2&&(st="flipbevel"),_e<f&&(st="miter")),z&&this.updateDistance(z,M),st==="miter")ce._mult(_e),this.addCurrentVertex(M,ce,0,0,I);else if(st==="flipbevel"){if(_e>100)ce=H.mult(-1);else{const Ge=_e*U.add(H).mag()/U.sub(H).mag();ce._perp()._mult(Ge*(ze?-1:1))}this.addCurrentVertex(M,ce,0,0,I),this.addCurrentVertex(M,ce.mult(-1),0,0,I)}else if(st==="bevel"||st==="fakeround"){const Ge=-Math.sqrt(_e*_e-1),We=ze?Ge:0,Ze=ze?0:Ge;if(z&&this.addCurrentVertex(M,U,We,Ze,I),st==="fakeround"){const Ye=Math.round(180*de/Math.PI/20);for(let lt=1;lt<Ye;lt++){let je=lt/Ye;if(je!==.5){const Xt=je-.5;je+=je*Xt*(je-1)*((1.0904+re*(re*(3.55645-1.43519*re)-3.2452))*Xt*Xt+(.848013+re*(.215638*re-1.06021)))}const bt=H.sub(U)._mult(je)._add(U)._unit()._mult(ze?-1:1);this.addHalfVertex(M,bt.x,bt.y,!1,ze,0,I)}}R&&this.addCurrentVertex(M,H,-We,-Ze,I)}else if(st==="butt")this.addCurrentVertex(M,ce,0,0,I);else if(st==="square"){const Ge=z?1:-1;z||this.addCurrentVertex(M,ce,Ge,Ge,I),this.addCurrentVertex(M,ce,0,0,I),z&&this.addCurrentVertex(M,ce,Ge,Ge,I)}else st==="round"&&(z&&(this.addCurrentVertex(M,U,0,0,I),this.addCurrentVertex(M,U,1,1,I,!0)),R&&(this.addCurrentVertex(M,H,-1,-1,I,!0),this.addCurrentVertex(M,H,0,0,I)));if(Fe&&ie<w-1){const Ge=M.dist(R);if(Ge>2*B){const We=M.add(R.sub(M)._mult(B/Ge)._round());this.updateDistance(M,We),this.addCurrentVertex(We,H,0,0,I),M=We}}}}addCurrentVertex(e,n,o,u,f,m=!1){const y=n.y*u-n.x,w=-n.y-n.x*u;this.addHalfVertex(e,n.x+n.y*o,n.y-n.x*o,m,!1,o,f),this.addHalfVertex(e,y,w,m,!0,-u,f)}addHalfVertex({x:e,y:n},o,u,f,m,y,w){this.layoutVertexArray.emplaceBack((e<<1)+(f?1:0),(n<<1)+(m?1:0),Math.round(63*o)+128,Math.round(63*u)+128,1+(y===0?0:y<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const A=w.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,A),w.primitiveLength++),m?this.e2=A:this.e1=A}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,n){this.distance+=e.dist(n),this.updateScaledDistance()}}wt(mo,"LineBucket",{omit:["layers","patternFeatures"]});const jx=new ct({"line-cap":new ve(Ne.layout_line["line-cap"]),"line-join":new ve(Ne.layout_line["line-join"]),"line-miter-limit":new Me(Ne.layout_line["line-miter-limit"]),"line-round-limit":new Me(Ne.layout_line["line-round-limit"]),"line-sort-key":new ve(Ne.layout_line["line-sort-key"])});var _y={paint:new ct({"line-opacity":new ve(Ne.paint_line["line-opacity"]),"line-color":new ve(Ne.paint_line["line-color"]),"line-translate":new Me(Ne.paint_line["line-translate"]),"line-translate-anchor":new Me(Ne.paint_line["line-translate-anchor"]),"line-width":new ve(Ne.paint_line["line-width"]),"line-gap-width":new ve(Ne.paint_line["line-gap-width"]),"line-offset":new ve(Ne.paint_line["line-offset"]),"line-blur":new ve(Ne.paint_line["line-blur"]),"line-dasharray":new pt(Ne.paint_line["line-dasharray"]),"line-pattern":new pt(Ne.paint_line["line-pattern"]),"line-gradient":new dt(Ne.paint_line["line-gradient"]),"line-trim-offset":new Me(Ne.paint_line["line-trim-offset"])}),layout:jx};const nu=new class extends ve{possiblyEvaluate(t,e){return e=new oe(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(t,e)}evaluate(t,e,n,o){return e=Mt({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(t,e,n,o)}}(_y.paint.properties["line-width"].specification);function yn(t,e){return e>0?e+2*t:t}nu.useIntegerZoom=!0;const Vx=ht([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),_o=ht([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),qr=ht([{name:"a_projected_pos",components:4,type:"Float32"}],4);ht([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Hx=ht([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),ru=ht([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);ht([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const gy=ht([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),$x=ht([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);ht([{name:"triangle",components:3,type:"Uint16"}]),ht([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),ht([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),ht([{type:"Float32",name:"offsetX"}]),ht([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var li=24;const wa=128;function r_(t,e){const{expression:n}=e;if(n.kind==="constant")return{kind:"constant",layoutSize:n.evaluate(new oe(t+1))};if(n.kind==="source")return{kind:"source"};{const{zoomStops:o,interpolationType:u}=n;let f=0;for(;f<o.length&&o[f]<=t;)f++;f=Math.max(0,f-1);let m=f;for(;m<o.length&&o[m]<t+1;)m++;m=Math.min(o.length-1,m);const y=o[f],w=o[m];return n.kind==="composite"?{kind:"composite",minZoom:y,maxZoom:w,interpolationType:u}:{kind:"camera",minZoom:y,maxZoom:w,minSize:n.evaluate(new oe(y)),maxSize:n.evaluate(new oe(w)),interpolationType:u}}}function oh(t,{uSize:e,uSizeT:n},{lowerSize:o,upperSize:u}){return t.kind==="source"?o/wa:t.kind==="composite"?xn(o/wa,u/wa,n):e}function sh(t,e){let n=0,o=0;if(t.kind==="constant")o=t.layoutSize;else if(t.kind!=="source"){const{interpolationType:u,minZoom:f,maxZoom:m}=t,y=u?en(Jo.interpolationFactor(u,e,f,m),0,1):0;t.kind==="camera"?o=xn(t.minSize,t.maxSize,y):n=y}return{uSizeT:n,uSize:o}}var ol=Object.freeze({__proto__:null,getSizeData:r_,evaluateSizeForFeature:oh,evaluateSizeForZoom:sh,SIZE_PACK_FACTOR:wa});function yy(t,e,n){return t.sections.forEach(o=>{o.text=function(u,f,m){const y=f.layout.get("text-transform").evaluate(m,{});return y==="uppercase"?u=u.toLocaleUpperCase():y==="lowercase"&&(u=u.toLocaleLowerCase()),ue.applyArabicShaping&&(u=ue.applyArabicShaping(u)),u}(o.text,e,n)}),t}const iu={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};function Cr(t){return t==="\uFE36"||t==="\uFE48"||t==="\uFE38"||t==="\uFE44"||t==="\uFE42"||t==="\uFE3E"||t==="\uFE3C"||t==="\uFE3A"||t==="\uFE18"||t==="\uFE40"||t==="\uFE10"||t==="\uFE13"||t==="\uFE14"||t==="\uFF40"||t==="\uFFE3"||t==="\uFE11"||t==="\uFE12"}function Lr(t){return t==="\uFE35"||t==="\uFE47"||t==="\uFE37"||t==="\uFE43"||t==="\uFE41"||t==="\uFE3D"||t==="\uFE3B"||t==="\uFE39"||t==="\uFE17"||t==="\uFE3F"}var ah=Wn,vy=function(t,e,n,o,u){var f,m,y=8*u-o-1,w=(1<<y)-1,A=w>>1,B=-7,I=n?u-1:0,M=n?-1:1,z=t[e+I];for(I+=M,f=z&(1<<-B)-1,z>>=-B,B+=y;B>0;f=256*f+t[e+I],I+=M,B-=8);for(m=f&(1<<-B)-1,f>>=-B,B+=o;B>0;m=256*m+t[e+I],I+=M,B-=8);if(f===0)f=1-A;else{if(f===w)return m?NaN:1/0*(z?-1:1);m+=Math.pow(2,o),f-=A}return(z?-1:1)*m*Math.pow(2,f-o)},xy=function(t,e,n,o,u,f){var m,y,w,A=8*f-u-1,B=(1<<A)-1,I=B>>1,M=u===23?Math.pow(2,-24)-Math.pow(2,-77):0,z=o?0:f-1,R=o?1:-1,U=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(y=isNaN(e)?1:0,m=B):(m=Math.floor(Math.log(e)/Math.LN2),e*(w=Math.pow(2,-m))<1&&(m--,w*=2),(e+=m+I>=1?M/w:M*Math.pow(2,1-I))*w>=2&&(m++,w/=2),m+I>=B?(y=0,m=B):m+I>=1?(y=(e*w-1)*Math.pow(2,u),m+=I):(y=e*Math.pow(2,I-1)*Math.pow(2,u),m=0));u>=8;t[n+z]=255&y,z+=R,y/=256,u-=8);for(m=m<<u|y,A+=u;A>0;t[n+z]=255&m,z+=R,m/=256,A-=8);t[n+z-R]|=128*U};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function Wn(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Wn.Varint=0,Wn.Fixed64=1,Wn.Bytes=2,Wn.Fixed32=5;var i_=4294967296,wy=1/i_,Ay=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Aa(t){return t.type===Wn.Bytes?t.readVarint()+t.pos:t.pos+1}function ba(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function cp(t,e,n){var o=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(o);for(var u=n.pos-1;u>=t;u--)n.buf[u+o]=n.buf[u]}function Wx(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function by(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function hp(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function zo(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function lh(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function Kx(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function Zx(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function Jx(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function Xx(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function dp(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function Ju(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function Ca(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function wn(t,e,n){e.glyphs=[],t===1&&n.readMessage(Cy,e)}function Cy(t,e,n){if(t===3){const{id:o,bitmap:u,width:f,height:m,left:y,top:w,advance:A}=n.readMessage(cs,{});e.glyphs.push({id:o,bitmap:new il({width:f+6,height:m+6},u),metrics:{width:f,height:m,left:y,top:w,advance:A}})}else t===4?e.ascender=n.readSVarint():t===5&&(e.descender=n.readSVarint())}function cs(t,e,n){t===1?e.id=n.readVarint():t===2?e.bitmap=n.readBytes():t===3?e.width=n.readVarint():t===4?e.height=n.readVarint():t===5?e.left=n.readSVarint():t===6?e.top=n.readSVarint():t===7&&(e.advance=n.readVarint())}function fp(t){let e=0,n=0;for(const m of t)e+=m.w*m.h,n=Math.max(n,m.w);t.sort((m,y)=>y.h-m.h);const o=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}];let u=0,f=0;for(const m of t)for(let y=o.length-1;y>=0;y--){const w=o[y];if(!(m.w>w.w||m.h>w.h)){if(m.x=w.x,m.y=w.y,f=Math.max(f,m.y+m.h),u=Math.max(u,m.x+m.w),m.w===w.w&&m.h===w.h){const A=o.pop();y<o.length&&(o[y]=A)}else m.h===w.h?(w.x+=m.w,w.w-=m.w):m.w===w.w?(w.y+=m.h,w.h-=m.h):(o.push({x:w.x+m.w,y:w.y,w:w.w-m.w,h:m.h}),w.y+=m.h,w.h-=m.h);break}}return{w:u,h:f,fill:e/(u*f)||0}}Wn.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var o=this.readVarint(),u=o>>3,f=this.pos;this.type=7&o,t(u,e,this),this.pos===f&&this.skip(o)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=dp(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=Ca(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=dp(this.buf,this.pos)+dp(this.buf,this.pos+4)*i_;return this.pos+=8,t},readSFixed64:function(){var t=dp(this.buf,this.pos)+Ca(this.buf,this.pos+4)*i_;return this.pos+=8,t},readFloat:function(){var t=vy(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=vy(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,o=this.buf;return e=127&(n=o[this.pos++]),n<128?e:(e|=(127&(n=o[this.pos++]))<<7,n<128?e:(e|=(127&(n=o[this.pos++]))<<14,n<128?e:(e|=(127&(n=o[this.pos++]))<<21,n<128?e:function(u,f,m){var y,w,A=m.buf;if(y=(112&(w=A[m.pos++]))>>4,w<128||(y|=(127&(w=A[m.pos++]))<<3,w<128)||(y|=(127&(w=A[m.pos++]))<<10,w<128)||(y|=(127&(w=A[m.pos++]))<<17,w<128)||(y|=(127&(w=A[m.pos++]))<<24,w<128)||(y|=(1&(w=A[m.pos++]))<<31,w<128))return ba(u,y,f);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=o[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&Ay?function(n,o,u){return Ay.decode(n.subarray(o,u))}(this.buf,e,t):function(n,o,u){for(var f="",m=o;m<u;){var y,w,A,B=n[m],I=null,M=B>239?4:B>223?3:B>191?2:1;if(m+M>u)break;M===1?B<128&&(I=B):M===2?(192&(y=n[m+1]))==128&&(I=(31&B)<<6|63&y)<=127&&(I=null):M===3?(w=n[m+2],(192&(y=n[m+1]))==128&&(192&w)==128&&((I=(15&B)<<12|(63&y)<<6|63&w)<=2047||I>=55296&&I<=57343)&&(I=null)):M===4&&(w=n[m+2],A=n[m+3],(192&(y=n[m+1]))==128&&(192&w)==128&&(192&A)==128&&((I=(15&B)<<18|(63&y)<<12|(63&w)<<6|63&A)<=65535||I>=1114112)&&(I=null)),I===null?(I=65533,M=1):I>65535&&(I-=65536,f+=String.fromCharCode(I>>>10&1023|55296),I=56320|1023&I),f+=String.fromCharCode(I),m+=M}return f}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==Wn.Bytes)return t.push(this.readVarint(e));var n=Aa(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==Wn.Bytes)return t.push(this.readSVarint());var e=Aa(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Wn.Bytes)return t.push(this.readBoolean());var e=Aa(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Wn.Bytes)return t.push(this.readFloat());var e=Aa(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Wn.Bytes)return t.push(this.readDouble());var e=Aa(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Wn.Bytes)return t.push(this.readFixed32());var e=Aa(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Wn.Bytes)return t.push(this.readSFixed32());var e=Aa(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Wn.Bytes)return t.push(this.readFixed64());var e=Aa(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Wn.Bytes)return t.push(this.readSFixed64());var e=Aa(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Wn.Varint)for(;this.buf[this.pos++]>127;);else if(e===Wn.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Wn.Fixed32)this.pos+=4;else{if(e!==Wn.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Ju(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Ju(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Ju(this.buf,-1&t,this.pos),Ju(this.buf,Math.floor(t*wy),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Ju(this.buf,-1&t,this.pos),Ju(this.buf,Math.floor(t*wy),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(e,n){var o,u;if(e>=0?(o=e%4294967296|0,u=e/4294967296|0):(u=~(-e/4294967296),4294967295^(o=~(-e%4294967296))?o=o+1|0:(o=0,u=u+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");n.realloc(10),function(f,m,y){y.buf[y.pos++]=127&f|128,f>>>=7,y.buf[y.pos++]=127&f|128,f>>>=7,y.buf[y.pos++]=127&f|128,f>>>=7,y.buf[y.pos++]=127&f|128,y.buf[y.pos]=127&(f>>>=7)}(o,0,n),function(f,m){var y=(7&f)<<4;m.buf[m.pos++]|=y|((f>>>=3)?128:0),f&&(m.buf[m.pos++]=127&f|((f>>>=7)?128:0),f&&(m.buf[m.pos++]=127&f|((f>>>=7)?128:0),f&&(m.buf[m.pos++]=127&f|((f>>>=7)?128:0),f&&(m.buf[m.pos++]=127&f|((f>>>=7)?128:0),f&&(m.buf[m.pos++]=127&f)))))}(u,n)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(o,u,f){for(var m,y,w=0;w<u.length;w++){if((m=u.charCodeAt(w))>55295&&m<57344){if(!y){m>56319||w+1===u.length?(o[f++]=239,o[f++]=191,o[f++]=189):y=m;continue}if(m<56320){o[f++]=239,o[f++]=191,o[f++]=189,y=m;continue}m=y-55296<<10|m-56320|65536,y=null}else y&&(o[f++]=239,o[f++]=191,o[f++]=189,y=null);m<128?o[f++]=m:(m<2048?o[f++]=m>>6|192:(m<65536?o[f++]=m>>12|224:(o[f++]=m>>18|240,o[f++]=m>>12&63|128),o[f++]=m>>6&63|128),o[f++]=63&m|128)}return f}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&cp(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),xy(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),xy(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var o=this.pos-n;o>=128&&cp(n,o,this),this.pos=n-1,this.writeVarint(o),this.pos+=o},writeMessage:function(t,e,n){this.writeTag(t,Wn.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,Wx,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,by,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,lh,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,hp,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,zo,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,Kx,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,Zx,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,Jx,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,Xx,e)},writeBytesField:function(t,e){this.writeTag(t,Wn.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Wn.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Wn.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Wn.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Wn.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Wn.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Wn.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Wn.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Wn.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Wn.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};class o_{constructor(e,{pixelRatio:n,version:o,stretchX:u,stretchY:f,content:m}){this.paddedRect=e,this.pixelRatio=n,this.stretchX=u,this.stretchY=f,this.content=m,this.version=o}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Kn{constructor(e,n){const o={},u={};this.haveRenderCallbacks=[];const f=[];this.addImages(e,o,f),this.addImages(n,u,f);const{w:m,h:y}=fp(f),w=new po({width:m||1,height:y||1});for(const A in e){const B=e[A],I=o[A].paddedRect;po.copy(B.data,w,{x:0,y:0},{x:I.x+1,y:I.y+1},B.data)}for(const A in n){const B=n[A],I=u[A].paddedRect,M=I.x+1,z=I.y+1,R=B.data.width,U=B.data.height;po.copy(B.data,w,{x:0,y:0},{x:M,y:z},B.data),po.copy(B.data,w,{x:0,y:U-1},{x:M,y:z-1},{width:R,height:1}),po.copy(B.data,w,{x:0,y:0},{x:M,y:z+U},{width:R,height:1}),po.copy(B.data,w,{x:R-1,y:0},{x:M-1,y:z},{width:1,height:U}),po.copy(B.data,w,{x:0,y:0},{x:M+R,y:z},{width:1,height:U})}this.image=w,this.iconPositions=o,this.patternPositions=u}addImages(e,n,o){for(const u in e){const f=e[u],m={x:0,y:0,w:f.data.width+2,h:f.data.height+2};o.push(m),n[u]=new o_(m,f),f.hasRenderCallback&&this.haveRenderCallbacks.push(u)}}patchUpdatedImages(e,n){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(o=>e.hasImage(o)),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const o in e.updatedImages)this.patchUpdatedImage(this.iconPositions[o],e.getImage(o),n),this.patchUpdatedImage(this.patternPositions[o],e.getImage(o),n)}patchUpdatedImage(e,n,o){if(!e||!n||e.version===n.version)return;e.version=n.version;const[u,f]=e.tl;o.update(n.data,void 0,{x:u,y:f})}}wt(o_,"ImagePosition"),wt(Kn,"ImageAtlas");const Fo={horizontal:1,vertical:2,horizontalOnly:3};class uh{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,n){const o=new uh;return o.scale=e||1,o.fontStack=n,o}static forImage(e){const n=new uh;return n.imageName=e,n}}class sl{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,n){const o=new sl;for(let u=0;u<e.sections.length;u++){const f=e.sections[u];f.image?o.addImageSection(f):o.addTextSection(f,n)}return o}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(n,o){let u="";for(let f=0;f<n.length;f++){const m=n.charCodeAt(f+1)||null,y=n.charCodeAt(f-1)||null;u+=!o&&(m&&b(m)&&!iu[n[f+1]]||y&&b(y)&&!iu[n[f-1]])||!iu[n[f]]?n[f]:iu[n[f]]}return u}(this.text,e)}trim(){let e=0;for(let o=0;o<this.text.length&&pp[this.text.charCodeAt(o)];o++)e++;let n=this.text.length;for(let o=this.text.length-1;o>=0&&o>=e&&pp[this.text.charCodeAt(o)];o--)n--;this.text=this.text.substring(e,n),this.sectionIndex=this.sectionIndex.slice(e,n)}substring(e,n){const o=new sl;return o.text=this.text.substring(e,n),o.sectionIndex=this.sectionIndex.slice(e,n),o.sections=this.sections,o}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,n)=>Math.max(e,this.sections[n].scale),0)}addTextSection(e,n){this.text+=e.text,this.sections.push(uh.forText(e.scale,e.fontStack||n));const o=this.sections.length-1;for(let u=0;u<e.text.length;++u)this.sectionIndex.push(o)}addImageSection(e){const n=e.image?e.image.name:"";if(n.length===0)return void er("Can't add FormattedSection with an empty image.");const o=this.getNextImageSectionCharCode();o?(this.text+=String.fromCharCode(o),this.sections.push(uh.forImage(n)),this.sectionIndex.push(this.sections.length-1)):er("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function s_(t,e,n,o,u,f,m,y,w,A,B,I,M,z,R,U){const H=sl.fromFeature(t,u);let ie;I===Fo.vertical&&H.verticalizePunctuation(M);const{processBidirectionalText:ce,processStyledBidirectionalText:re}=ue;if(ce&&H.sections.length===1){ie=[];const de=ce(H.toString(),a_(H,A,f,e,o,z,R));for(const Fe of de){const ze=new sl;ze.text=Fe,ze.sections=H.sections;for(let qe=0;qe<Fe.length;qe++)ze.sectionIndex.push(0);ie.push(ze)}}else if(re){ie=[];const de=re(H.text,H.sectionIndex,a_(H,A,f,e,o,z,R));for(const Fe of de){const ze=new sl;ze.text=Fe[0],ze.sectionIndex=Fe[1],ze.sections=H.sections,ie.push(ze)}}else ie=function(de,Fe){const ze=[],qe=de.text;let st=0;for(const Ge of Fe)ze.push(de.substring(st,Ge)),st=Ge;return st<qe.length&&ze.push(de.substring(st,qe.length)),ze}(H,a_(H,A,f,e,o,z,R));const ae=[],_e={positionedLines:ae,text:H.toString(),top:B[1],bottom:B[1],left:B[0],right:B[0],writingMode:I,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(de,Fe,ze,qe,st,Ge,We,Ze,Ye,lt,je,bt){let Xt=0,It=0,Dt=0;const gt=Ze==="right"?1:Ze==="left"?0:.5;let Zt=!1;for(const mn of st){const vn=mn.getSections();for(const Zn of vn){if(Zn.imageName)continue;const or=Fe[Zn.fontStack];if(or&&(Zt=or.ascender!==void 0&&or.descender!==void 0,!Zt))break}if(!Zt)break}let an=0;for(const mn of st){mn.trim();const vn=mn.getMaxScale(),Zn=(vn-1)*li,or={positionedGlyphs:[],lineOffset:0};de.positionedLines[an]=or;const nr=or.positionedGlyphs;let sr=0;if(!mn.length()){It+=Ge,++an;continue}let cr=0,Er=0;for(let Vn=0;Vn<mn.length();Vn++){const Kr=mn.getSection(Vn),jr=mn.getSectionIndex(Vn),Pn=mn.getCharCode(Vn);let gr=Kr.scale,ti=null,Jn=null,Fr=null,Ki=li,Ei=0;const Bi=!(Ye===Fo.horizontal||!je&&!x(Pn)||je&&(pp[Pn]||(ln=Pn,Tf(ln)||Nu(ln)||rs(ln)||ju(ln)||h(ln))));if(Kr.imageName){const yo=qe[Kr.imageName];if(!yo)continue;Fr=Kr.imageName,de.iconsInText=de.iconsInText||!0,Jn=yo.paddedRect;const Ti=yo.displaySize;gr=gr*li/bt,ti={width:Ti[0],height:Ti[1],left:1,top:-3,advance:Bi?Ti[1]:Ti[0],localGlyph:!1},Ei=Zt?-ti.height*gr:vn*li-17-Ti[1]*gr,Ki=ti.advance;const ec=(Bi?Ti[0]:Ti[1])*gr-li*vn;ec>0&&ec>sr&&(sr=ec)}else{const yo=ze[Kr.fontStack];if(!yo)continue;yo[Pn]&&(Jn=yo[Pn]);const Ti=Fe[Kr.fontStack];if(!Ti)continue;const ec=Ti.glyphs[Pn];if(!ec)continue;if(ti=ec.metrics,Ki=Pn!==8203?li:0,Zt){const Sp=Ti.ascender!==void 0?Math.abs(Ti.ascender):0,C_=Ti.descender!==void 0?Math.abs(Ti.descender):0,E_=(Sp+C_)*gr;cr<E_&&(cr=E_,Er=(Sp-C_)/2*gr),Ei=-Sp*gr}else Ei=(vn-gr)*li-17}Bi?(de.verticalizable=!0,nr.push({glyph:Pn,imageName:Fr,x:Xt,y:It+Ei,vertical:Bi,scale:gr,localGlyph:ti.localGlyph,fontStack:Kr.fontStack,sectionIndex:jr,metrics:ti,rect:Jn}),Xt+=Ki*gr+lt):(nr.push({glyph:Pn,imageName:Fr,x:Xt,y:It+Ei,vertical:Bi,scale:gr,localGlyph:ti.localGlyph,fontStack:Kr.fontStack,sectionIndex:jr,metrics:ti,rect:Jn}),Xt+=ti.advance*gr+lt)}nr.length!==0&&(Dt=Math.max(Xt-lt,Dt),Zt?Sy(nr,gt,sr,Er,Ge*vn/2):Sy(nr,gt,sr,0,Ge/2)),Xt=0;const Ci=Ge*vn+sr;or.lineOffset=Math.max(sr,Zn),It+=Ci,++an}var ln;const kn=It,{horizontalAlign:rn,verticalAlign:ur}=l_(We);(function(mn,vn,Zn,or,nr,sr){const cr=(vn-Zn)*nr,Er=-sr*or;for(const Ci of mn)for(const Vn of Ci.positionedGlyphs)Vn.x+=cr,Vn.y+=Er})(de.positionedLines,gt,rn,ur,Dt,kn),de.top+=-ur*kn,de.bottom=de.top+kn,de.left+=-rn*Dt,de.right=de.left+Dt,de.hasBaseline=Zt}(_e,e,n,o,ie,m,y,w,I,A,M,U),!function(de){for(const Fe of de)if(Fe.positionedGlyphs.length!==0)return!1;return!0}(ae)&&_e}const pp={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Qx={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Ey(t,e,n,o,u,f){if(e.imageName){const m=o[e.imageName];return m?m.displaySize[0]*e.scale*li/f+u:0}{const m=n[e.fontStack],y=m&&m.glyphs[t];return y?y.metrics.advance*e.scale+u:0}}function By(t,e,n,o){const u=Math.pow(t-e,2);return o?t<e?u/2:2*u:u+Math.abs(n)*n}function Yx(t,e,n){let o=0;return t===10&&(o-=1e4),n&&(o+=150),t!==40&&t!==65288||(o+=50),e!==41&&e!==65289||(o+=50),o}function Ty(t,e,n,o,u,f){let m=null,y=By(e,n,u,f);for(const w of o){const A=By(e-w.x,n,u,f)+w.badness;A<=y&&(m=w,y=A)}return{index:t,x:e,priorBreak:m,badness:y}}function Dy(t){return t?Dy(t.priorBreak).concat(t.index):[]}function a_(t,e,n,o,u,f,m){if(f!=="point")return[];if(!t)return[];const y=[],w=function(M,z,R,U,H,ie){let ce=0;for(let re=0;re<M.length();re++){const ae=M.getSection(re);ce+=Ey(M.getCharCode(re),ae,U,H,z,ie)}return ce/Math.max(1,Math.ceil(ce/R))}(t,e,n,o,u,m),A=t.text.indexOf("\u200B")>=0;let B=0;for(let M=0;M<t.length();M++){const z=t.getSection(M),R=t.getCharCode(M);if(pp[R]||(B+=Ey(R,z,o,u,e,m)),M<t.length()-1){const U=!((I=R)<11904||!(Uc(I)||Nc(I)||el(I)||Pf(I)||If(I)||ud(I)||so(I)||Uu(I)||Mf(I)||dd(I)||hd(I)||r(I)||Gc(I)||cd(I)||Df(I)||Sf(I)||So(I)||Wl(I)||fd(I)||qu(I)));(Qx[R]||U||z.imageName)&&y.push(Ty(M+1,B,w,y,Yx(R,t.getCharCode(M+1),U&&A),!1))}}var I;return Dy(Ty(t.length(),B,w,y,0,!0))}function l_(t){let e=.5,n=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function Sy(t,e,n,o,u){if(!(e||n||o||u))return;const f=t.length-1,m=t[f],y=(m.x+m.metrics.advance*m.scale)*e;for(let w=0;w<=f;w++)t[w].x-=y,t[w].y+=n+o+u}function e1(t,e,n){const{horizontalAlign:o,verticalAlign:u}=l_(n),f=e[0]-t.displaySize[0]*o,m=e[1]-t.displaySize[1]*u;return{image:t,top:m,bottom:m+t.displaySize[1],left:f,right:f+t.displaySize[0]}}function Iy(t,e,n,o,u,f){const m=t.image;let y;if(m.content){const H=m.content,ie=m.pixelRatio||1;y=[H[0]/ie,H[1]/ie,m.displaySize[0]-H[2]/ie,m.displaySize[1]-H[3]/ie]}const w=e.left*f,A=e.right*f;let B,I,M,z;n==="width"||n==="both"?(z=u[0]+w-o[3],I=u[0]+A+o[1]):(z=u[0]+(w+A-m.displaySize[0])/2,I=z+m.displaySize[0]);const R=e.top*f,U=e.bottom*f;return n==="height"||n==="both"?(B=u[1]+R-o[0],M=u[1]+U+o[2]):(B=u[1]+(R+U-m.displaySize[1])/2,M=B+m.displaySize[1]),{image:m,top:B,right:I,bottom:M,left:z,collisionPadding:y}}class Gs extends Ie{constructor(e,n,o,u,f){super(e,n),this.angle=u,this.z=o,f!==void 0&&(this.segment=f)}clone(){return new Gs(this.x,this.y,this.z,this.angle,this.segment)}}function My(t,e,n,o,u){if(e.segment===void 0)return!0;let f=e,m=e.segment+1,y=0;for(;y>-n/2;){if(m--,m<0)return!1;y-=t[m].dist(f),f=t[m]}y+=t[m].dist(t[m+1]),m++;const w=[];let A=0;for(;y<n/2;){const B=t[m],I=t[m+1];if(!I)return!1;let M=t[m-1].angleTo(B)-B.angleTo(I);for(M=Math.abs((M+3*Math.PI)%(2*Math.PI)-Math.PI),w.push({distance:y,angleDelta:M}),A+=M;y-w[0].distance>o;)A-=w.shift().angleDelta;if(A>u)return!1;m++,y+=B.dist(I)}return!0}function mp(t){let e=0;for(let n=0;n<t.length-1;n++)e+=t[n].dist(t[n+1]);return e}function ky(t,e,n){return t?.6*e*n:0}function Py(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function t1(t,e,n,o,u,f){const m=ky(n,u,f),y=Py(n,o)*f;let w=0;const A=mp(t)/2;for(let B=0;B<t.length-1;B++){const I=t[B],M=t[B+1],z=I.dist(M);if(w+z>A){const R=(A-w)/z,U=xn(I.x,M.x,R),H=xn(I.y,M.y,R),ie=new Gs(U,H,0,M.angleTo(I),B);return!m||My(t,ie,y,m,e)?ie:void 0}w+=z}}function ui(t,e,n,o,u,f,m,y,w){const A=ky(o,f,m),B=Py(o,u),I=B*m,M=t[0].x===0||t[0].x===w||t[0].y===0||t[0].y===w;return e-I<e/4&&(e=I+e/4),$i(t,M?e/2*y%e:(B/2+2*f)*m*y%e,e,A,n,I,M,!1,w)}function $i(t,e,n,o,u,f,m,y,w){const A=f/2,B=mp(t);let I=0,M=e-n,z=[];for(let R=0;R<t.length-1;R++){const U=t[R],H=t[R+1],ie=U.dist(H),ce=H.angleTo(U);for(;M+n<I+ie;){M+=n;const re=(M-I)/ie,ae=xn(U.x,H.x,re),_e=xn(U.y,H.y,re);if(ae>=0&&ae<w&&_e>=0&&_e<w&&M-A>=0&&M+A<=B){const de=new Gs(ae,_e,0,ce,R);de._round(),o&&!My(t,de,f,o,u)||z.push(de)}}I+=ie}return y||z.length||m||(z=$i(t,I/2,n,o,u,f,m,!0,w)),z}function Ly(t,e,n,o,u){const f=[];for(let m=0;m<t.length;m++){const y=t[m];let w;for(let A=0;A<y.length-1;A++){let B=y[A],I=y[A+1];B.x<e&&I.x<e||(B.x<e?B=new Ie(e,B.y+(e-B.x)/(I.x-B.x)*(I.y-B.y))._round():I.x<e&&(I=new Ie(e,B.y+(e-B.x)/(I.x-B.x)*(I.y-B.y))._round()),B.y<n&&I.y<n||(B.y<n?B=new Ie(B.x+(n-B.y)/(I.y-B.y)*(I.x-B.x),n)._round():I.y<n&&(I=new Ie(B.x+(n-B.y)/(I.y-B.y)*(I.x-B.x),n)._round()),B.x>=o&&I.x>=o||(B.x>=o?B=new Ie(o,B.y+(o-B.x)/(I.x-B.x)*(I.y-B.y))._round():I.x>=o&&(I=new Ie(o,B.y+(o-B.x)/(I.x-B.x)*(I.y-B.y))._round()),B.y>=u&&I.y>=u||(B.y>=u?B=new Ie(B.x+(u-B.y)/(I.y-B.y)*(I.x-B.x),u)._round():I.y>=u&&(I=new Ie(B.x+(u-B.y)/(I.y-B.y)*(I.x-B.x),u)._round()),w&&B.equals(w[w.length-1])||(w=[B],f.push(w)),w.push(I)))))}}return f}wt(Gs,"Anchor");const zd=1e20;function zy(t,e,n,o,u,f,m,y,w){for(let A=e;A<e+o;A++)u_(t,n*f+A,f,u,m,y,w);for(let A=n;A<n+u;A++)u_(t,A*f+e,1,o,m,y,w)}function u_(t,e,n,o,u,f,m){f[0]=0,m[0]=-zd,m[1]=zd,u[0]=t[e];for(let y=1,w=0,A=0;y<o;y++){u[y]=t[e+y*n];const B=y*y;do{const I=f[w];A=(u[y]-u[I]+B-I*I)/(y-I)/2}while(A<=m[w]&&--w>-1);w++,f[w]=y,m[w]=A,m[w+1]=zd}for(let y=0,w=0;y<o;y++){for(;m[w+1]<y;)w++;const A=f[w],B=y-A;t[e+y*n]=u[A]+B*B}}const c_={none:0,ideographs:1,all:2};class ch{constructor(e,n,o){this.requestManager=e,this.localGlyphMode=n,this.localFontFamily=o,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,n){const o=[];for(const u in e)for(const f of e[u])o.push({stack:u,id:f});xt(o,({stack:u,id:f},m)=>{let y=this.entries[u];y||(y=this.entries[u]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let w=y.glyphs[f];if(w!==void 0)return void m(null,{stack:u,id:f,glyph:w});if(w=this._tinySDF(y,u,f),w)return y.glyphs[f]=w,void m(null,{stack:u,id:f,glyph:w});const A=Math.floor(f/256);if(256*A>65535)return void m(new Error("glyphs > 65535 not supported"));if(y.ranges[A])return void m(null,{stack:u,id:f,glyph:w});let B=y.requests[A];B||(B=y.requests[A]=[],ch.loadGlyphRange(u,A,this.url,this.requestManager,(I,M)=>{if(M){y.ascender=M.ascender,y.descender=M.descender;for(const z in M.glyphs)this._doesCharSupportLocalGlyph(+z)||(y.glyphs[+z]=M.glyphs[+z]);y.ranges[A]=!0}for(const z of B)z(I,M);delete y.requests[A]})),B.push((I,M)=>{I?m(I):M&&m(null,{stack:u,id:f,glyph:M.glyphs[f]||null})})},(u,f)=>{if(u)n(u);else if(f){const m={};for(const{stack:y,id:w,glyph:A}of f)m[y]===void 0&&(m[y]={}),m[y].glyphs===void 0&&(m[y].glyphs={}),m[y].glyphs[w]=A&&{id:A.id,bitmap:A.bitmap.clone(),metrics:A.metrics},m[y].ascender=this.entries[y].ascender,m[y].descender=this.entries[y].descender;n(null,m)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==c_.none&&(this.localGlyphMode===c_.all?!!this.localFontFamily:!!this.localFontFamily&&(dd(e)||kf(e)||Gc(e)||So(e)||Uu(e)))}_tinySDF(e,n,o){const u=this.localFontFamily;if(!u||!this._doesCharSupportLocalGlyph(o))return;let f=e.tinySDF;if(!f){let U="400";/bold/i.test(n)?U="900":/medium/i.test(n)?U="500":/light/i.test(n)&&(U="200"),f=e.tinySDF=new ch.TinySDF({fontFamily:u,fontWeight:U,fontSize:48,buffer:6,radius:16}),f.fontWeight=U}if(this.localGlyphs[f.fontWeight][o])return this.localGlyphs[f.fontWeight][o];const m=String.fromCharCode(o),{data:y,width:w,height:A,glyphWidth:B,glyphHeight:I,glyphLeft:M,glyphTop:z,glyphAdvance:R}=f.draw(m);return this.localGlyphs[f.fontWeight][o]={id:o,bitmap:new il({width:w,height:A},y),metrics:{width:B/2,height:I/2,left:M/2,top:z/2-27,advance:R/2,localGlyph:!0}}}}function Fy(t,e,n,o){const u=[],f=t.image,m=f.pixelRatio,y=f.paddedRect.w-2,w=f.paddedRect.h-2,A=t.right-t.left,B=t.bottom-t.top,I=f.stretchX||[[0,y]],M=f.stretchY||[[0,w]],z=(Ge,We)=>Ge+We[1]-We[0],R=I.reduce(z,0),U=M.reduce(z,0),H=y-R,ie=w-U;let ce=0,re=R,ae=0,_e=U,de=0,Fe=H,ze=0,qe=ie;if(f.content&&o){const Ge=f.content;ce=Fd(I,0,Ge[0]),ae=Fd(M,0,Ge[1]),re=Fd(I,Ge[0],Ge[2]),_e=Fd(M,Ge[1],Ge[3]),de=Ge[0]-ce,ze=Ge[1]-ae,Fe=Ge[2]-Ge[0]-re,qe=Ge[3]-Ge[1]-_e}const st=(Ge,We,Ze,Ye)=>{const lt=_p(Ge.stretch-ce,re,A,t.left),je=gp(Ge.fixed-de,Fe,Ge.stretch,R),bt=_p(We.stretch-ae,_e,B,t.top),Xt=gp(We.fixed-ze,qe,We.stretch,U),It=_p(Ze.stretch-ce,re,A,t.left),Dt=gp(Ze.fixed-de,Fe,Ze.stretch,R),gt=_p(Ye.stretch-ae,_e,B,t.top),Zt=gp(Ye.fixed-ze,qe,Ye.stretch,U),an=new Ie(lt,bt),ln=new Ie(It,bt),kn=new Ie(It,gt),rn=new Ie(lt,gt),ur=new Ie(je/m,Xt/m),mn=new Ie(Dt/m,Zt/m),vn=e*Math.PI/180;if(vn){const nr=Math.sin(vn),sr=Math.cos(vn),cr=[sr,-nr,nr,sr];an._matMult(cr),ln._matMult(cr),rn._matMult(cr),kn._matMult(cr)}const Zn=Ge.stretch+Ge.fixed,or=We.stretch+We.fixed;return{tl:an,tr:ln,bl:rn,br:kn,tex:{x:f.paddedRect.x+1+Zn,y:f.paddedRect.y+1+or,w:Ze.stretch+Ze.fixed-Zn,h:Ye.stretch+Ye.fixed-or},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ur,pixelOffsetBR:mn,minFontScaleX:Fe/m/A,minFontScaleY:qe/m/B,isSDF:n}};if(o&&(f.stretchX||f.stretchY)){const Ge=Ry(I,H,R),We=Ry(M,ie,U);for(let Ze=0;Ze<Ge.length-1;Ze++){const Ye=Ge[Ze],lt=Ge[Ze+1];for(let je=0;je<We.length-1;je++)u.push(st(Ye,We[je],lt,We[je+1]))}}else u.push(st({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:y+1},{fixed:0,stretch:w+1}));return u}function Fd(t,e,n){let o=0;for(const u of t)o+=Math.max(e,Math.min(n,u[1]))-Math.max(e,Math.min(n,u[0]));return o}function Ry(t,e,n){const o=[{fixed:-1,stretch:0}];for(const[u,f]of t){const m=o[o.length-1];o.push({fixed:u-m.stretch,stretch:m.stretch}),o.push({fixed:u-m.stretch,stretch:m.stretch+(f-u)})}return o.push({fixed:e+1,stretch:n}),o}function _p(t,e,n,o){return t/e*n+o}function gp(t,e,n,o){return t-e*n/o}function Oy(t,e,n,o){const u=e+t.positionedLines[o].lineOffset;return o===0?n+u/2:n+(u+(e+t.positionedLines[o-1].lineOffset))/2}ch.loadGlyphRange=function(t,e,n,o,u){const f=256*e,m=f+255,y=o.transformRequest(o.normalizeGlyphsURL(n).replace("{fontstack}",t).replace("{range}",`${f}-${m}`),pi.Glyphs);Vo(y,(w,A)=>{if(w)u(w);else if(A){const B={},I=function(M){return new ah(M).readFields(wn,{})}(A);for(const M of I.glyphs)B[M.id]=M;u(null,{glyphs:B,ascender:I.ascender,descender:I.descender})}})},ch.TinySDF=class{constructor({fontSize:t=24,buffer:e=3,radius:n=8,cutoff:o=.25,fontFamily:u="sans-serif",fontWeight:f="normal",fontStyle:m="normal"}={}){this.buffer=e,this.cutoff=o,this.radius=n;const y=this.size=t+4*e,w=this._createCanvas(y),A=this.ctx=w.getContext("2d",{willReadFrequently:!0});A.font=`${m} ${f} ${t}px ${u}`,A.textBaseline="alphabetic",A.textAlign="left",A.fillStyle="black",this.gridOuter=new Float64Array(y*y),this.gridInner=new Float64Array(y*y),this.f=new Float64Array(y),this.z=new Float64Array(y+1),this.v=new Uint16Array(y)}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){const{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:o,actualBoundingBoxLeft:u,actualBoundingBoxRight:f}=this.ctx.measureText(t),m=Math.ceil(n),y=Math.min(this.size-this.buffer,Math.ceil(f-u)),w=Math.min(this.size-this.buffer,m+Math.ceil(o)),A=y+2*this.buffer,B=w+2*this.buffer,I=Math.max(A*B,0),M=new Uint8ClampedArray(I),z={data:M,width:A,height:B,glyphWidth:y,glyphHeight:w,glyphTop:m,glyphLeft:0,glyphAdvance:e};if(y===0||w===0)return z;const{ctx:R,buffer:U,gridInner:H,gridOuter:ie}=this;R.clearRect(U,U,y,w),R.fillText(t,U,U+m);const ce=R.getImageData(U,U,y,w);ie.fill(zd,0,I),H.fill(0,0,I);for(let re=0;re<w;re++)for(let ae=0;ae<y;ae++){const _e=ce.data[4*(re*y+ae)+3]/255;if(_e===0)continue;const de=(re+U)*A+ae+U;if(_e===1)ie[de]=0,H[de]=zd;else{const Fe=.5-_e;ie[de]=Fe>0?Fe*Fe:0,H[de]=Fe<0?Fe*Fe:0}}zy(ie,0,0,A,B,A,this.f,this.v,this.z),zy(H,U,U,y,w,A,this.f,this.v,this.z);for(let re=0;re<I;re++){const ae=Math.sqrt(ie[re])-Math.sqrt(H[re]);M[re]=Math.round(255-255*(ae/this.radius+this.cutoff))}return z}};class Gy{constructor(e=[],n=n1){if(this.data=e,this.length=this.data.length,this.compare=n,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:n,compare:o}=this,u=n[e];for(;e>0;){const f=e-1>>1,m=n[f];if(o(u,m)>=0)break;n[e]=m,e=f}n[e]=u}_down(e){const{data:n,compare:o}=this,u=this.length>>1,f=n[e];for(;e<u;){let m=1+(e<<1),y=n[m];const w=m+1;if(w<this.length&&o(n[w],y)<0&&(m=w,y=n[w]),o(y,f)>=0)break;n[e]=y,e=m}n[e]=f}}function n1(t,e){return t<e?-1:t>e?1:0}function r1(t,e=1,n=!1){let o=1/0,u=1/0,f=-1/0,m=-1/0;const y=t[0];for(let z=0;z<y.length;z++){const R=y[z];(!z||R.x<o)&&(o=R.x),(!z||R.y<u)&&(u=R.y),(!z||R.x>f)&&(f=R.x),(!z||R.y>m)&&(m=R.y)}const w=Math.min(f-o,m-u);let A=w/2;const B=new Gy([],i1);if(w===0)return new Ie(o,u);for(let z=o;z<f;z+=w)for(let R=u;R<m;R+=w)B.push(new hh(z+A,R+A,A,t));let I=function(z){let R=0,U=0,H=0;const ie=z[0];for(let ce=0,re=ie.length,ae=re-1;ce<re;ae=ce++){const _e=ie[ce],de=ie[ae],Fe=_e.x*de.y-de.x*_e.y;U+=(_e.x+de.x)*Fe,H+=(_e.y+de.y)*Fe,R+=3*Fe}return new hh(U/R,H/R,0,z)}(t),M=B.length;for(;B.length;){const z=B.pop();(z.d>I.d||!I.d)&&(I=z,n&&console.log("found best %d after %d probes",Math.round(1e4*z.d)/1e4,M)),z.max-I.d<=e||(A=z.h/2,B.push(new hh(z.p.x-A,z.p.y-A,A,t)),B.push(new hh(z.p.x+A,z.p.y-A,A,t)),B.push(new hh(z.p.x-A,z.p.y+A,A,t)),B.push(new hh(z.p.x+A,z.p.y+A,A,t)),M+=4)}return n&&(console.log(`num probes: ${M}`),console.log(`best distance: ${I.d}`)),I.p}function i1(t,e){return e.max-t.max}function hh(t,e,n,o){this.p=new Ie(t,e),this.h=n,this.d=function(u,f){let m=!1,y=1/0;for(let w=0;w<f.length;w++){const A=f[w];for(let B=0,I=A.length,M=I-1;B<I;M=B++){const z=A[B],R=A[M];z.y>u.y!=R.y>u.y&&u.x<(R.x-z.x)*(u.y-z.y)/(R.y-z.y)+z.x&&(m=!m),y=Math.min(y,Lg(u,z,R))}}return(m?1:-1)*Math.sqrt(y)}(this.p,o),this.max=this.d+this.h*Math.SQRT2}const ou=Number.POSITIVE_INFINITY,o1=Math.sqrt(2);function Ny(t,e){return e[1]!==ou?function(n,o,u){let f=0,m=0;switch(o=Math.abs(o),u=Math.abs(u),n){case"top-right":case"top-left":case"top":m=u-7;break;case"bottom-right":case"bottom-left":case"bottom":m=7-u}switch(n){case"top-right":case"bottom-right":case"right":f=-o;break;case"top-left":case"bottom-left":case"left":f=o}return[f,m]}(t,e[0],e[1]):function(n,o){let u=0,f=0;o<0&&(o=0);const m=o/o1;switch(n){case"top-right":case"top-left":f=m-7;break;case"bottom-right":case"bottom-left":f=7-m;break;case"bottom":f=7-o;break;case"top":f=o-7}switch(n){case"top-right":case"bottom-right":u=-m;break;case"top-left":case"bottom-left":u=m;break;case"left":u=o;break;case"right":u=-o}return[u,f]}(t,e[0])}function s1(t,e,n,o,u,f,m,y,w,A){t.createArrays(),t.tilePixelRatio=$t/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;const B=t.layers[0].layout,I=t.layers[0]._unevaluatedLayout._values,M={};if(t.textSizeData.kind==="composite"){const{minZoom:U,maxZoom:H}=t.textSizeData;M.compositeTextSizes=[I["text-size"].possiblyEvaluate(new oe(U),y),I["text-size"].possiblyEvaluate(new oe(H),y)]}if(t.iconSizeData.kind==="composite"){const{minZoom:U,maxZoom:H}=t.iconSizeData;M.compositeIconSizes=[I["icon-size"].possiblyEvaluate(new oe(U),y),I["icon-size"].possiblyEvaluate(new oe(H),y)]}M.layoutTextSize=I["text-size"].possiblyEvaluate(new oe(w+1),y),M.layoutIconSize=I["icon-size"].possiblyEvaluate(new oe(w+1),y),M.textMaxSize=I["text-size"].possiblyEvaluate(new oe(18),y);const z=B.get("text-rotation-alignment")==="map"&&B.get("symbol-placement")!=="point",R=B.get("text-size");for(const U of t.features){const H=B.get("text-font").evaluate(U,{},y).join(","),ie=R.evaluate(U,{},y),ce=M.layoutTextSize.evaluate(U,{},y),re=(M.layoutIconSize.evaluate(U,{},y),{horizontal:{},vertical:void 0}),ae=U.text;let _e,de=[0,0];if(ae){const qe=ae.toString(),st=B.get("text-letter-spacing").evaluate(U,{},y)*li,Ge=B.get("text-line-height").evaluate(U,{},y)*li,We=p(qe)?st:0,Ze=B.get("text-anchor").evaluate(U,{},y),Ye=B.get("text-variable-anchor");if(!Ye){const Dt=B.get("text-radial-offset").evaluate(U,{},y);de=Dt?Ny(Ze,[Dt*li,ou]):B.get("text-offset").evaluate(U,{},y).map(gt=>gt*li)}let lt=z?"center":B.get("text-justify").evaluate(U,{},y);const je=B.get("symbol-placement"),bt=je==="point",Xt=je==="point"?B.get("text-max-width").evaluate(U,{},y)*li:0,It=Dt=>{t.allowVerticalPlacement&&l(qe)&&(re.vertical=s_(ae,e,n,u,H,Xt,Ge,Ze,Dt,We,de,Fo.vertical,!0,je,ce,ie))};if(!z&&Ye){const Dt=lt==="auto"?Ye.map(Zt=>h_(Zt)):[lt];let gt=!1;for(let Zt=0;Zt<Dt.length;Zt++){const an=Dt[Zt];if(!re.horizontal[an])if(gt)re.horizontal[an]=re.horizontal[0];else{const ln=s_(ae,e,n,u,H,Xt,Ge,"center",an,We,de,Fo.horizontal,!1,je,ce,ie);ln&&(re.horizontal[an]=ln,gt=ln.positionedLines.length===1)}}It("left")}else{if(lt==="auto"&&(lt=h_(Ze)),bt||B.get("text-writing-mode").indexOf("horizontal")>=0||!l(qe)){const Dt=s_(ae,e,n,u,H,Xt,Ge,Ze,lt,We,de,Fo.horizontal,!1,je,ce,ie);Dt&&(re.horizontal[lt]=Dt)}It(je==="point"?"left":lt)}}let Fe=!1;if(U.icon&&U.icon.name){const qe=o[U.icon.name];qe&&(_e=e1(u[U.icon.name],B.get("icon-offset").evaluate(U,{},y),B.get("icon-anchor").evaluate(U,{},y)),Fe=qe.sdf,t.sdfIcons===void 0?t.sdfIcons=qe.sdf:t.sdfIcons!==qe.sdf&&er("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(qe.pixelRatio!==t.pixelRatio||B.get("icon-rotate").constantOr(1)!==0)&&(t.iconsNeedLinear=!0))}const ze=Uy(re.horizontal)||re.vertical;t.iconsInText||(t.iconsInText=!!ze&&ze.iconsInText),(ze||_e)&&a1(t,U,re,_e,o,M,ce,0,de,Fe,m,y,A)}f&&t.generateCollisionDebugBuffers(w,t.collisionBoxArray)}function h_(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function a1(t,e,n,o,u,f,m,y,w,A,B,I,M){let z=f.textMaxSize.evaluate(e,{},I);z===void 0&&(z=m);const R=t.layers[0].layout,U=R.get("icon-offset").evaluate(e,{},I),H=Uy(n.horizontal)||n.vertical,ie=M.name==="globe",ce=m/24,re=t.tilePixelRatio*z/24,ae=(We=t.overscaling,t.zoom>18&&We>2&&(We>>=1),Math.max($t/(512*We),1)*R.get("symbol-spacing")),_e=R.get("text-padding")*t.tilePixelRatio,de=R.get("icon-padding")*t.tilePixelRatio,Fe=Et(R.get("text-max-angle")),ze=R.get("text-rotation-alignment")==="map"&&R.get("symbol-placement")!=="point",qe=R.get("icon-rotation-alignment")==="map"&&R.get("symbol-placement")!=="point",st=R.get("symbol-placement"),Ge=ae/2;var We;const Ze=R.get("icon-text-fit");let Ye;o&&Ze!=="none"&&(t.allowVerticalPlacement&&n.vertical&&(Ye=Iy(o,n.vertical,Ze,R.get("icon-text-fit-padding"),U,ce)),H&&(o=Iy(o,H,Ze,R.get("icon-text-fit-padding"),U,ce)));const lt=(je,bt,Xt)=>{if(bt.x<0||bt.x>=$t||bt.y<0||bt.y>=$t)return;let It=null;if(ie){const{x:Dt,y:gt,z:Zt}=M.projectTilePoint(bt.x,bt.y,Xt);It={anchor:new Gs(Dt,gt,Zt,0,void 0),up:M.upVector(Xt,bt.x,bt.y)}}(function(Dt,gt,Zt,an,ln,kn,rn,ur,mn,vn,Zn,or,nr,sr,cr,Er,Ci,Vn,Kr,jr,Pn,gr,ti,Jn,Fr){const Ki=Dt.addToLineVertexArray(gt,an);let Ei,Bi,yo,Ti,ec,Sp,C_,E_=0,Db=0,Sb=0,Ib=0,I1=-1,M1=-1;const uu={};let Mb=Vc.exports("");const Vd=Zt?Zt.anchor:gt;let k1=0,P1=0;if(mn._unevaluatedLayout.getValue("text-radial-offset")===void 0?[k1,P1]=mn.layout.get("text-offset").evaluate(Pn,{},Fr).map(ds=>ds*li):(k1=mn.layout.get("text-radial-offset").evaluate(Pn,{},Fr)*li,P1=ou),Dt.allowVerticalPlacement&&ln.vertical){const ds=ln.vertical;if(cr)Sp=f_(ds),ur&&(C_=f_(ur));else{const fs=mn.layout.get("text-rotate").evaluate(Pn,{},Fr)+90;yo=yp(vn,Vd,gt,Zn,or,nr,ds,sr,fs,Er),ur&&(Ti=yp(vn,Vd,gt,Zn,or,nr,ur,Vn,fs))}}if(kn){const ds=mn.layout.get("icon-rotate").evaluate(Pn,{},Fr),fs=mn.layout.get("icon-text-fit")!=="none",B_=Fy(kn,ds,ti,fs),z1=ur?Fy(ur,ds,ti,fs):void 0;Bi=yp(vn,Vd,gt,Zn,or,nr,kn,Vn,ds),E_=4*B_.length;const kb=Dt.iconSizeData;let Hd=null;kb.kind==="source"?(Hd=[wa*mn.layout.get("icon-size").evaluate(Pn,{},Fr)],Hd[0]>al&&er(`${Dt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):kb.kind==="composite"&&(Hd=[wa*gr.compositeIconSizes[0].evaluate(Pn,{},Fr),wa*gr.compositeIconSizes[1].evaluate(Pn,{},Fr)],(Hd[0]>al||Hd[1]>al)&&er(`${Dt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Dt.addSymbols(Dt.icon,B_,Hd,jr,Kr,Pn,!1,Zt,gt,Ki.lineStartIndex,Ki.lineLength,-1,Jn,Fr),I1=Dt.icon.placedSymbolArray.length-1,z1&&(Db=4*z1.length,Dt.addSymbols(Dt.icon,z1,Hd,jr,Kr,Pn,Fo.vertical,Zt,gt,Ki.lineStartIndex,Ki.lineLength,-1,Jn,Fr),M1=Dt.icon.placedSymbolArray.length-1)}for(const ds in ln.horizontal){const fs=ln.horizontal[ds];Ei||(Mb=Vc.exports(fs.text),cr?ec=f_(fs):Ei=yp(vn,Vd,gt,Zn,or,nr,fs,sr,mn.layout.get("text-rotate").evaluate(Pn,{},Fr),Er));const B_=fs.positionedLines.length===1;if(Sb+=d_(Dt,Zt,gt,fs,rn,mn,cr,Pn,Er,Ki,ln.vertical?Fo.horizontal:Fo.horizontalOnly,B_?Object.keys(ln.horizontal):[ds],uu,I1,gr,Jn,Fr),B_)break}ln.vertical&&(Ib+=d_(Dt,Zt,gt,ln.vertical,rn,mn,cr,Pn,Er,Ki,Fo.vertical,["vertical"],uu,M1,gr,Jn,Fr));let vh=-1;const L1=(ds,fs)=>ds?Math.max(ds,fs):fs;vh=L1(ec,vh),vh=L1(Sp,vh),vh=L1(C_,vh);const lT=vh>-1?1:0;Dt.glyphOffsetArray.length>=au.MAX_GLYPHS&&er("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Pn.sortKey!==void 0&&Dt.addToSortKeyRanges(Dt.symbolInstances.length,Pn.sortKey),Dt.symbolInstances.emplaceBack(Vd.x,Vd.y,Vd.z,gt.x,gt.y,uu.right>=0?uu.right:-1,uu.center>=0?uu.center:-1,uu.left>=0?uu.left:-1,uu.vertical>=0?uu.vertical:-1,I1,M1,Mb,Ei!==void 0?Ei:Dt.collisionBoxArray.length,Ei!==void 0?Ei+1:Dt.collisionBoxArray.length,yo!==void 0?yo:Dt.collisionBoxArray.length,yo!==void 0?yo+1:Dt.collisionBoxArray.length,Bi!==void 0?Bi:Dt.collisionBoxArray.length,Bi!==void 0?Bi+1:Dt.collisionBoxArray.length,Ti||Dt.collisionBoxArray.length,Ti?Ti+1:Dt.collisionBoxArray.length,Zn,Sb,Ib,E_,Db,lT,0,k1,P1,vh)})(t,bt,It,je,n,o,u,Ye,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,_e,ze,w,0,de,qe,U,e,f,A,B,I)};if(st==="line")for(const je of Ly(e.geometry,0,0,$t,$t)){const bt=ui(je,ae,Fe,n.vertical||H,o,24,re,t.overscaling,$t);for(const Xt of bt){const It=H;It&&l1(t,It.text,Ge,Xt)||lt(je,Xt,I)}}else if(st==="line-center"){for(const je of e.geometry)if(je.length>1){const bt=t1(je,Fe,n.vertical||H,o,24,re);bt&&lt(je,bt,I)}}else if(e.type==="Polygon")for(const je of Km(e.geometry,0)){const bt=r1(je,16);lt(je[0],new Gs(bt.x,bt.y,0,0,void 0),I)}else if(e.type==="LineString")for(const je of e.geometry)lt(je,new Gs(je[0].x,je[0].y,0,0,void 0),I);else if(e.type==="Point")for(const je of e.geometry)for(const bt of je)lt([bt],new Gs(bt.x,bt.y,0,0,void 0),I)}const al=32640;function d_(t,e,n,o,u,f,m,y,w,A,B,I,M,z,R,U,H){const ie=function(ae,_e,de,Fe,ze,qe,st,Ge){const We=[];if(_e.positionedLines.length===0)return We;const Ze=Fe.layout.get("text-rotate").evaluate(qe,{})*Math.PI/180,Ye=function(It){const Dt=It[0],gt=It[1],Zt=Dt*gt;return Zt>0?[Dt,-gt]:Zt<0?[-Dt,gt]:Dt===0?[gt,Dt]:[gt,-Dt]}(de);let lt=Math.abs(_e.top-_e.bottom);for(const It of _e.positionedLines)lt-=It.lineOffset;const je=_e.positionedLines.length,bt=lt/je;let Xt=_e.top-de[1];for(let It=0;It<je;++It){const Dt=_e.positionedLines[It];Xt=Oy(_e,bt,Xt,It);for(const gt of Dt.positionedGlyphs){if(!gt.rect)continue;const Zt=gt.rect||{};let an=4,ln=!0,kn=1,rn=0;if(gt.imageName){const Jn=st[gt.imageName];if(!Jn)continue;if(Jn.sdf){er("SDF images are not supported in formatted text and will be ignored.");continue}ln=!1,kn=Jn.pixelRatio,an=1/kn}const ur=(ze||Ge)&&gt.vertical,mn=gt.metrics.advance*gt.scale/2,vn=gt.metrics,Zn=gt.rect;if(Zn===null)continue;Ge&&_e.verticalizable&&(rn=gt.imageName?mn-gt.metrics.width*gt.scale/2:0);const or=ze?[gt.x+mn,gt.y]:[0,0];let nr=[0,0],sr=[0,0],cr=!1;ze||(ur?(sr=[gt.x+mn+Ye[0],gt.y+Ye[1]-rn],cr=!0):nr=[gt.x+mn+de[0],gt.y+de[1]-rn]);const Er=Zn.w*gt.scale/(kn*(gt.localGlyph?2:1)),Ci=Zn.h*gt.scale/(kn*(gt.localGlyph?2:1));let Vn,Kr,jr,Pn;if(ur){const Jn=gt.y-Xt,Fr=new Ie(-mn,mn-Jn),Ki=-Math.PI/2,Ei=new Ie(...sr);Vn=new Ie(-mn+nr[0],nr[1]),Vn._rotateAround(Ki,Fr)._add(Ei),Vn.x+=-Jn+mn,Vn.y-=(vn.left-an)*gt.scale;const Bi=gt.imageName?vn.advance*gt.scale:li*gt.scale,yo=String.fromCharCode(gt.glyph);Cr(yo)?Vn.x+=(1-an)*gt.scale:Lr(yo)?Vn.x+=Bi-vn.height*gt.scale+(-an-1)*gt.scale:Vn.x+=gt.imageName||vn.width+2*an===Zn.w&&vn.height+2*an===Zn.h?(Bi-Ci)/2:(Bi-(vn.height+2*an)*gt.scale)/2,Kr=new Ie(Vn.x,Vn.y-Er),jr=new Ie(Vn.x+Ci,Vn.y),Pn=new Ie(Vn.x+Ci,Vn.y-Er)}else{const Jn=(vn.left-an)*gt.scale-mn+nr[0],Fr=(-vn.top-an)*gt.scale+nr[1],Ki=Jn+Er,Ei=Fr+Ci;Vn=new Ie(Jn,Fr),Kr=new Ie(Ki,Fr),jr=new Ie(Jn,Ei),Pn=new Ie(Ki,Ei)}if(Ze){let Jn;Jn=ze?new Ie(0,0):cr?new Ie(Ye[0],Ye[1]):new Ie(de[0],de[1]),Vn._rotateAround(Ze,Jn),Kr._rotateAround(Ze,Jn),jr._rotateAround(Ze,Jn),Pn._rotateAround(Ze,Jn)}const gr=new Ie(0,0),ti=new Ie(0,0);We.push({tl:Vn,tr:Kr,bl:jr,br:Pn,tex:Zt,writingMode:_e.writingMode,glyphOffset:or,sectionIndex:gt.sectionIndex,isSDF:ln,pixelOffsetTL:gr,pixelOffsetBR:ti,minFontScaleX:0,minFontScaleY:0})}}return We}(0,o,w,f,m,y,u,t.allowVerticalPlacement),ce=t.textSizeData;let re=null;ce.kind==="source"?(re=[wa*f.layout.get("text-size").evaluate(y,{},H)],re[0]>al&&er(`${t.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ce.kind==="composite"&&(re=[wa*R.compositeTextSizes[0].evaluate(y,{},H),wa*R.compositeTextSizes[1].evaluate(y,{},H)],(re[0]>al||re[1]>al)&&er(`${t.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),t.addSymbols(t.text,ie,re,w,m,y,B,e,n,A.lineStartIndex,A.lineLength,z,U,H);for(const ae of I)M[ae]=t.text.placedSymbolArray.length-1;return 4*ie.length}function Uy(t){for(const e in t)return t[e];return null}function yp(t,e,n,o,u,f,m,y,w,A){let B=m.top,I=m.bottom,M=m.left,z=m.right;const R=m.collisionPadding;if(R&&(M-=R[0],B-=R[1],z+=R[2],I+=R[3]),w){const U=new Ie(M,B),H=new Ie(z,B),ie=new Ie(M,I),ce=new Ie(z,I),re=Et(w);let ae=new Ie(0,0);A&&(ae=new Ie(A[0],A[1])),U._rotateAround(re,ae),H._rotateAround(re,ae),ie._rotateAround(re,ae),ce._rotateAround(re,ae),M=Math.min(U.x,H.x,ie.x,ce.x),z=Math.max(U.x,H.x,ie.x,ce.x),B=Math.min(U.y,H.y,ie.y,ce.y),I=Math.max(U.y,H.y,ie.y,ce.y)}return t.emplaceBack(e.x,e.y,e.z,n.x,n.y,M,B,z,I,y,o,u,f),t.length-1}function f_(t){t.collisionPadding&&(t.top-=t.collisionPadding[1],t.bottom+=t.collisionPadding[3]);const e=t.bottom-t.top;return e>0?Math.max(10,e):null}function l1(t,e,n,o){const u=t.compareText;if(e in u){const f=u[e];for(let m=f.length-1;m>=0;m--)if(o.dist(f[m])<n)return!0}else u[e]=[];return u[e].push(o),!1}const u1=ht([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:qy}=u1,jy=ht([{name:"a_pos_3",components:3,type:"Int16"}]);var Rd=ht([{name:"a_pos",type:"Int16",components:2}]);const ll=$t/Math.PI/2,p_=2*ko(1,0)*ll*Math.PI,dh=64,fh=[dh,32,16],Ns=-ll,Us=ll,c1=[new Ri([Ns,Ns,Ns],[Us,Us,Us]),new Ri([Ns,Ns,Ns],[0,0,Us]),new Ri([0,Ns,Ns],[Us,0,Us]),new Ri([Ns,0,Ns],[0,Us,Us]),new Ri([0,0,Ns],[Us,Us,Us])];function Vy(t,e,n,o=!0){const u=Lo([],t._camera.position,t.worldSize),f=[e,n,1,1];tu(f,f,t.pixelMatrixInverse),jg(f,f,1/f[3]);const m=Fi([],us([],f,u)),y=t.globeMatrix,w=[y[12],y[13],y[14]],A=us([],w,u),B=Os(A),I=Fi([],A),M=t.worldSize/(2*Math.PI),z=ls(I,m),R=Math.asin(M/B);if(R<Math.acos(z)){if(!o)return null;const st=[],Ge=[];Lo(st,m,B/z),Fi(Ge,us(Ge,st,A)),Fi(m,xa(m,A,Lo(m,Ge,Math.tan(R)*B)))}const U=[];new Um(u,m).closestPointOnSphere(w,M,U);const H=Fi([],Yi(y,0)),ie=Fi([],Yi(y,1)),ce=Fi([],Yi(y,2)),re=ls(H,U),ae=ls(ie,U),_e=ls(ce,U),de=Ot(Math.asin(-ae/M));let Fe=Ot(Math.atan2(re,_e));Fe=t.center.lng+function(st,Ge){const We=(Ge-st+180)%360-180;return We<-180?We+360:We}(t.center.lng,Fe);const ze=si(Fe),qe=en(zs(de),0,1);return new Ql(ze,qe)}class h1{constructor(e,n,o){this.a=us([],e,o),this.b=us([],n,o),this.center=o;const u=Fi([],this.a),f=Fi([],this.b);this.angle=Math.acos(ls(u,f))}}function m_(t,e){if(t.angle===0)return null;let n;return n=t.a[e]===0?1/t.angle*.5*Math.PI:1/t.angle*Math.atan(t.b[e]/t.a[e]/Math.sin(t.angle)-1/Math.tan(t.angle)),n<0||n>1?null:function(o,u,f,m){const y=Math.sin(f);return o*(Math.sin((1-m)*f)/y)+u*(Math.sin(m*f)/y)}(t.a[e],t.b[e],t.angle,en(n,0,1))+t.center[e]}function Ea(t){if(t.z<=1)return c1[t.z+2*t.y+t.x];const e=__(vp(t));return Ri.fromPoints(e)}function Xu(t,e,n){return Lo(t,t,1-n),Ed(t,t,e,n)}function Hy(t,e){const n=_h(e.zoom);if(n===0)return Ea(t);const o=vp(t),u=__(o),f=si(o.getWest())*e.worldSize,m=si(o.getEast())*e.worldSize,y=zs(o.getNorth())*e.worldSize,w=zs(o.getSouth())*e.worldSize,A=[f,y,0],B=[m,y,0],I=[f,w,0],M=[m,w,0],z=Kf([],e.globeMatrix);return Pr(A,A,z),Pr(B,B,z),Pr(I,I,z),Pr(M,M,z),u[0]=Xu(u[0],I,n),u[1]=Xu(u[1],M,n),u[2]=Xu(u[2],B,n),u[3]=Xu(u[3],A,n),Ri.fromPoints(u)}function $y(t,e,n){for(const o of t)Pr(o,o,e),Lo(o,o,n)}function d1(t,e,n){const o=e/t.worldSize,u=t.globeMatrix;if(n.z<=1){const ze=Ea(n).getCorners();return $y(ze,u,o),Ri.fromPoints(ze)}const f=vp(n),m=__(f);$y(m,u,o);const y=Number.MAX_VALUE,w=[-y,-y,-y],A=[y,y,y];if(f.contains(t.center)){for(const st of m)bd(A,A,st),Cd(w,w,st);w[2]=0;const ze=t.point,qe=[ze.x*o,ze.y*o,0];return bd(A,A,qe),Cd(w,w,qe),new Ri(A,w)}const B=[u[12]*o,u[13]*o,u[14]*o],I=f.getCenter(),M=en(t.center.lat,-85.051129,ga),z=en(I.lat,-85.051129,ga),R=si(t.center.lng),U=zs(M);let H=R-si(I.lng);const ie=U-zs(z);H>.5?H-=1:H<-.5&&(H+=1);let ce=0;Math.abs(H)>Math.abs(ie)?ce=H>=0?1:3:(ce=ie>=0?0:2,Ed(B,B,[u[4]*o,u[5]*o,u[6]*o],-Math.sin(Et(ie>=0?f.getSouth():f.getNorth()))*ll));const re=m[ce],ae=m[(ce+1)%4],_e=new h1(re,ae,B),de=[m_(_e,0)||re[0],m_(_e,1)||re[1],m_(_e,2)||re[2]],Fe=_h(t.zoom);if(Fe>0){const ze=function({x:st,y:Ge,z:We},Ze,Ye,lt,je){const bt=1/(1<<We);let Xt=st*bt,It=Xt+bt,Dt=Ge*bt,gt=Dt+bt,Zt=0;const an=(Xt+It)/2-lt;return an>.5?Zt=-1:an<-.5&&(Zt=1),Xt=((Xt+Zt)*Ze-(lt*=Ze))*Ye+lt,It=((It+Zt)*Ze-lt)*Ye+lt,Dt=(Dt*Ze-(je*=Ze))*Ye+je,gt=(gt*Ze-je)*Ye+je,[[Xt,gt,0],[It,gt,0],[It,Dt,0],[Xt,Dt,0]]}(n,e,t._pixelsPerMercatorPixel,R,U);for(let st=0;st<m.length;st++)Xu(m[st],ze[st],Fe);const qe=xa([],ze[ce],ze[(ce+1)%4]);Lo(qe,qe,.5),Xu(de,qe,Fe)}for(const ze of m)bd(A,A,ze),Cd(w,w,ze);return A[2]=Math.min(re[2],ae[2]),bd(A,A,de),Cd(w,w,de),new Ri(A,w)}function vp({x:t,y:e,z:n}){const o=1/(1<<n),u=new bn(Po(t*o),ei((e+1)*o)),f=new bn(Po((t+1)*o),ei(e*o));return new Ls(u,f)}function __(t){const e=Et(t.getNorth()),n=Et(t.getSouth()),o=Math.cos(e),u=Math.cos(n),f=Math.sin(e),m=Math.sin(n),y=t.getWest(),w=t.getEast();return[su(u,m,y),su(u,m,w),su(o,f,w),su(o,f,y)]}function su(t,e,n,o=ll){return n=Et(n),[t*Math.sin(n)*o,-e*o,t*Math.cos(n)*o]}function ph(t,e,n){return su(Math.cos(Et(t)),Math.sin(Et(t)),e,n)}function mh(t,e,n,o){const u=1<<n.z,f=(t/$t+n.x)/u;return ph(ei((e/$t+n.y)/u),Po(f),o)}function xp({min:t,max:e}){return 16383/Math.max(e[0]-t[0],e[1]-t[1],e[2]-t[2])}const Wy=new Float64Array(16);function Od(t){const e=xp(t),n=Rm(Wy,[e,e,e]);return $u(n,n,((o=[])[0]=-(u=t.min)[0],o[1]=-u[1],o[2]=-u[2],o));var o,u}function Gd(t){const e=(o=t.min,(n=Wy)[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=o[0],n[13]=o[1],n[14]=o[2],n[15]=1,n);var n,o;const u=1/xp(t);return eu(e,e,[u,u,u])}function Ky(t,e,n,o,u){const f=function(w){const A=$t/(2*Math.PI);return w/(2*Math.PI)/A}(n),m=[t,e,-n/(2*Math.PI)],y=Fs(new Float64Array(16));return $u(y,y,m),eu(y,y,[f,f,f]),Wu(y,y,Et(-u)),Jc(y,y,Et(-o)),y}function _h(t){return di(5,6,t)}function Zy(t,e){const n=ph(e.lat,e.lng),o=function(R){const U=ph(R._center.lat,R._center.lng);let H=Nm([],Xc(0,1,0),U);const ie=Om([],-R.angle,U);H=Pr(H,H,ie),Om(ie,-R._pitch,H);const ce=Fi([],U);return Lo(ce,ce,R.cameraToCenterDistance/R.pixelsPerMeter*p_),Pr(ce,ce,ie),xa([],U,ce)}(t);return m=(u=Gm([],o,n))[0],y=u[1],w=u[2],A=(f=n)[0],B=f[1],I=f[2],z=(M=Math.sqrt(m*m+y*y+w*w)*Math.sqrt(A*A+B*B+I*I))&&ls(u,f)/M,Math.acos(Math.min(Math.max(z,-1),1));var u,f,m,y,w,A,B,I,M,z}const Wi=Et(85),g_=Math.cos(Wi),f1=Math.sin(Wi);function Jy(t,e){const n=t.fovAboveCenter,o=t.elevation?t.elevation.getMinElevationBelowMSL()*e:0,u=(t._camera.position[2]*t.worldSize-o)/Math.cos(t._pitch),f=Math.sin(n)*u/Math.sin(Math.max(Math.PI/2-t._pitch-n,.01)),m=Math.sin(t._pitch)*f+u;return Math.min(1.01*m,u*(1/t._horizonShift))}function Qu(t,e){if(!e.isReprojectedInTileSpace)return{scale:1<<t.z,x:t.x,y:t.y,x2:t.x+1,y2:t.y+1,projection:e};const n=Math.pow(2,-t.z),o=t.x*n,u=(t.x+1)*n,f=t.y*n,m=(t.y+1)*n,y=Po(o),w=Po(u),A=ei(f),B=ei(m),I=e.project(y,A),M=e.project(w,A),z=e.project(w,B),R=e.project(y,B);let U=Math.min(I.x,M.x,z.x,R.x),H=Math.min(I.y,M.y,z.y,R.y),ie=Math.max(I.x,M.x,z.x,R.x),ce=Math.max(I.y,M.y,z.y,R.y);const re=n/16;function ae(de,Fe,ze,qe,st,Ge){const We=(ze+st)/2,Ze=(qe+Ge)/2,Ye=e.project(Po(We),ei(Ze)),lt=Math.max(0,U-Ye.x,H-Ye.y,Ye.x-ie,Ye.y-ce);U=Math.min(U,Ye.x),ie=Math.max(ie,Ye.x),H=Math.min(H,Ye.y),ce=Math.max(ce,Ye.y),lt>re&&(ae(de,Ye,ze,qe,We,Ze),ae(Ye,Fe,We,Ze,st,Ge))}ae(I,M,o,f,u,f),ae(M,z,u,f,u,m),ae(z,R,u,m,o,m),ae(R,I,o,m,o,f),U-=re,H-=re,ie+=re,ce+=re;const _e=1/Math.max(ie-U,ce-H);return{scale:_e,x:U*_e,y:H*_e,x2:ie*_e,y2:ce*_e,projection:e}}const p1=Fs(new Float32Array(16));class Ba{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,n){return{x:0,y:0,z:0}}unproject(e,n){return new bn(0,0)}projectTilePoint(e,n,o){return{x:e,y:n,z:0}}locationPoint(e,n,o=!0){return e._coordinatePoint(e.locationCoordinate(n),o)}pixelsPerMeter(e,n){return ko(1,e)*n}pixelSpaceConversion(e,n,o){return 1}farthestPixelDistance(e){return Jy(e,e.pixelsPerMeter)}pointCoordinate(e,n,o,u){const f=e.horizonLineFromTop(!1),m=new Ie(n,Math.max(f,o));return e.rayIntersectionCoordinate(e.pointRayIntersection(m,u))}pointCoordinate3D(e,n,o){const u=new Ie(n,o);if(e.elevation)return e.elevation.pointCoordinate(u);{const f=this.pointCoordinate(e,u.x,u.y,0);return[f.x,f.y,f.z]}}isPointAboveHorizon(e,n){if(e.elevation)return!this.pointCoordinate3D(e,n.x,n.y);const o=e.horizonLineFromTop();return n.y<o}createInversionMatrix(e,n){return p1}createTileMatrix(e,n,o){let u,f,m;const y=o.canonical,w=Fs(new Float64Array(16));if(this.isReprojectedInTileSpace){const A=Qu(y,this);u=1,f=A.x+o.wrap*A.scale,m=A.y,eu(w,w,[u/A.scale,u/A.scale,e.pixelsPerMeter/n])}else u=n/e.zoomScale(y.z),f=(y.x+Math.pow(2,y.z)*o.wrap)*u,m=y.y*u;return $u(w,w,[f,m,0]),eu(w,w,[u/$t,u/$t,1]),w}upVector(e,n,o){return[0,0,1]}upVectorScale(e,n,o){return{metersToTile:1}}}class m1 extends Ba{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[n,o]=this.parallels=e.parallels||[29.5,45.5],u=Math.sin(Et(n));this.n=(u+Math.sin(Et(o)))/2,this.c=1+u*(2*this.n-u),this.r0=Math.sqrt(this.c)/this.n}project(e,n){const{n:o,c:u,r0:f}=this,m=Et(e-this.center[0]),y=Et(n),w=Math.sqrt(u-2*o*Math.sin(y))/o;return{x:w*Math.sin(m*o),y:w*Math.cos(m*o)-f,z:0}}unproject(e,n){const{n:o,c:u,r0:f}=this,m=f+n;let y=Math.atan2(e,Math.abs(m))*Math.sign(m);m*o<0&&(y-=Math.PI*Math.sign(e)*Math.sign(m));const w=Et(this.center[0])*o;y=fr(y,-Math.PI-w,Math.PI-w);const A=en(Ot(y/o)+this.center[0],-180,180),B=Math.asin(en((u-(e*e+m*m)*o*o)/(2*o),-1,1)),I=en(Ot(B),-85.051129,ga);return new bn(A,I)}}const Yu=1.340264,Nd=-.081106,Ud=893e-6,qd=.003796,wp=Math.sqrt(3)/2;class Xy extends Ba{project(e,n){n=n/180*Math.PI,e=e/180*Math.PI;const o=Math.asin(wp*Math.sin(n)),u=o*o,f=u*u*u;return{x:.5*(e*Math.cos(o)/(wp*(Yu+3*Nd*u+f*(7*Ud+9*qd*u)))/Math.PI+.5),y:1-.5*(o*(Yu+Nd*u+f*(Ud+qd*u))/Math.PI+1),z:0}}unproject(e,n){e=(2*e-.5)*Math.PI;let o=n=(2*(1-n)-1)*Math.PI,u=o*o,f=u*u*u;for(let B,I,M,z=0;z<12&&(I=o*(Yu+Nd*u+f*(Ud+qd*u))-n,M=Yu+3*Nd*u+f*(7*Ud+9*qd*u),B=I/M,o=en(o-B,-Math.PI/3,Math.PI/3),u=o*o,f=u*u*u,!(Math.abs(B)<1e-12));++z);const m=wp*e*(Yu+3*Nd*u+f*(7*Ud+9*qd*u))/Math.cos(o),y=Math.asin(Math.sin(o)/wp),w=en(180*m/Math.PI,-180,180),A=en(180*y/Math.PI,-85.051129,ga);return new bn(w,A)}}class _1 extends Ba{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,n){return{x:.5+e/360,y:.5-n/360,z:0}}unproject(e,n){const o=360*(e-.5),u=en(360*(.5-n),-85.051129,ga);return new bn(o,u)}}const gh=Math.PI/2;function Ap(t){return Math.tan((gh+t)/2)}class y_ extends Ba{constructor(e){super(e),this.center=e.center||[0,30];const[n,o]=this.parallels=e.parallels||[30,30];let u=Et(n),f=Et(o);this.southernCenter=u+f<0,this.southernCenter&&(u=-u,f=-f);const m=Math.cos(u),y=Ap(u);this.n=u===f?Math.sin(u):Math.log(m/Math.cos(f))/Math.log(Ap(f)/y),this.f=m*Math.pow(Ap(u),this.n)/this.n}project(e,n){n=Et(n),this.southernCenter&&(n=-n),e=Et(e-this.center[0]);const o=1e-6,{n:u,f}=this;f>0?n<-gh+o&&(n=-gh+o):n>gh-o&&(n=gh-o);const m=f/Math.pow(Ap(n),u);let y=m*Math.sin(u*e),w=f-m*Math.cos(u*e);return y=.5*(y/Math.PI+.5),w=.5*(w/Math.PI+.5),{x:y,y:this.southernCenter?w:1-w,z:0}}unproject(e,n){e=(2*e-.5)*Math.PI,this.southernCenter&&(n=1-n),n=(2*(1-n)-.5)*Math.PI;const{n:o,f:u}=this,f=u-n,m=Math.sign(f),y=Math.sign(o)*Math.sqrt(e*e+f*f);let w=Math.atan2(e,Math.abs(f))*m;f*o<0&&(w-=Math.PI*Math.sign(e)*m);const A=en(Ot(w/o)+this.center[0],-180,180),B=en(Ot(2*Math.atan(Math.pow(u/y,1/o))-gh),-85.051129,ga);return new bn(A,this.southernCenter?-B:B)}}class bp extends Ba{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,n){return{x:si(e),y:zs(n),z:0}}unproject(e,n){const o=Po(e),u=ei(n);return new bn(o,u)}}const Qy=Et(ga);class g1 extends Ba{project(e,n){const o=(n=Et(n))*n,u=o*o;return{x:.5*((e=Et(e))*(.8707-.131979*o+u*(u*(.003971*o-.001529*u)-.013791))/Math.PI+.5),y:1-.5*(n*(1.007226+o*(.015085+u*(.028874*o-.044475-.005916*u)))/Math.PI+1),z:0}}unproject(e,n){e=(2*e-.5)*Math.PI;let o=n=(2*(1-n)-1)*Math.PI,u=25,f=0,m=o*o;do{m=o*o;const A=m*m;f=(o*(1.007226+m*(.015085+A*(.028874*m-.044475-.005916*A)))-n)/(1.007226+m*(.045255+A*(.259866*m-.311325-.005916*11*A))),o=en(o-f,-Qy,Qy)}while(Math.abs(f)>1e-6&&--u>0);m=o*o;const y=en(Ot(e/(.8707+m*(m*(m*m*m*(.003971-.001529*m)-.013791)-.131979))),-180,180),w=Ot(o);return new bn(y,w)}}const Yy=Et(ga);class y1 extends Ba{project(e,n){n=Et(n),e=Et(e);const o=Math.cos(n),u=2/Math.PI,f=Math.acos(o*Math.cos(e/2)),m=Math.sin(f)/f,y=.5*(e*u+2*o*Math.sin(e/2)/m)||0,w=.5*(n+Math.sin(n)/m)||0;return{x:.5*(y/Math.PI+.5),y:1-.5*(w/Math.PI+1),z:0}}unproject(e,n){let o=e=(2*e-.5)*Math.PI,u=n=(2*(1-n)-1)*Math.PI,f=25;const m=1e-6;let y=0,w=0;do{const A=Math.cos(u),B=Math.sin(u),I=2*B*A,M=B*B,z=A*A,R=Math.cos(o/2),U=Math.sin(o/2),H=2*R*U,ie=U*U,ce=1-z*R*R,re=ce?1/ce:0,ae=ce?Math.acos(A*R)*Math.sqrt(1/ce):0,_e=.5*(2*ae*A*U+2*o/Math.PI)-e,de=.5*(ae*B+u)-n,Fe=.5*re*(z*ie+ae*A*R*M)+1/Math.PI,ze=re*(H*I/4-ae*B*U),qe=.125*re*(I*U-ae*B*z*H),st=.5*re*(M*R+ae*ie*A)+.5,Ge=ze*qe-st*Fe;y=(de*ze-_e*st)/Ge,w=(_e*qe-de*Fe)/Ge,o=en(o-y,-Math.PI,Math.PI),u=en(u-w,-Yy,Yy)}while((Math.abs(y)>m||Math.abs(w)>m)&&--f>0);return new bn(Ot(o),Ot(u))}}class e0 extends Ba{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Et(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,n){const{scale:o,cosPhi:u}=this;return{x:Et(e)*u*o+.5,y:-Math.sin(Et(n))/u*o+.5,z:0}}unproject(e,n){const{scale:o,cosPhi:u}=this,f=-(n-.5)/o,m=en(Ot((e-.5)/o)/u,-180,180),y=Math.asin(en(f*u,-1,1)),w=en(Ot(y),-85.051129,ga);return new bn(m,w)}}class v1 extends bp{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug","custom"],this.range=[3,5]}projectTilePoint(e,n,o){const u=mh(e,n,o);return Pr(u,u,Od(Ea(o))),{x:u[0],y:u[1],z:u[2]}}locationPoint(e,n){const o=ph(n.lat,n.lng),u=Fi([],o),f=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(n),e._centerAltitude):e._centerAltitude;Ed(o,o,u,ko(1,0)*$t*f);const m=Fs(new Float64Array(16));return Zc(m,e.pixelMatrix,e.globeMatrix),Pr(o,o,m),new Ie(o[0],o[1])}pixelsPerMeter(e,n){return ko(1,0)*n}pixelSpaceConversion(e,n,o){const u=ko(1,e)*n,f=xn(ko(1,45)*n,u,o);return this.pixelsPerMeter(e,n)/f}createTileMatrix(e,n,o){const u=Gd(Ea(o.canonical));return Zc(new Float64Array(16),e.globeMatrix,u)}createInversionMatrix(e,n){const{center:o}=e,u=Od(Ea(n));return Jc(u,u,Et(o.lng)),Wu(u,u,Et(o.lat)),eu(u,u,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(u)}pointCoordinate(e,n,o,u){return Vy(e,n,o,!0)||new Ql(0,0)}pointCoordinate3D(e,n,o){const u=this.pointCoordinate(e,n,o,0);return[u.x,u.y,u.z]}isPointAboveHorizon(e,n){return!Vy(e,n.x,n.y,!1)}farthestPixelDistance(e){const n=function(u,f){const m=u.cameraToCenterDistance,y=u._centerAltitude*f,w=u._camera,A=u._camera.forward(),B=xa([],Lo([],A,-m),[0,0,y]),I=u.worldSize/(2*Math.PI),M=[0,0,-I],z=u.width/u.height,R=Math.tan(u.fovAboveCenter),U=Lo([],w.up(),R),H=Lo([],w.right(),R*z),ie=Fi([],xa([],xa([],A,U),H)),ce=[];let re;if(new Um(B,ie).closestPointOnSphere(M,I,ce)){const ae=xa([],ce,M),_e=us([],ae,B);re=Math.cos(u.fovAboveCenter)*Os(_e)}else{const ae=us([],B,M),_e=us([],M,B);Fi(_e,_e);const de=Os(ae)-I;re=Math.sqrt(de*(de+2*I));const Fe=Math.acos(re/(I+de))-Math.acos(ls(A,_e));re*=Math.cos(Fe)}return 1.01*re}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),o=_h(e.zoom);if(o>0){const u=Jy(e,ko(1,e.center.lat)*e.worldSize),f=e.worldSize/(2*Math.PI),m=Math.max(e.width,e.height)/e.worldSize*Math.PI;return xn(n,u+f*(1-Math.cos(m)),Math.pow(o,10))}return n}upVector(e,n,o){return mh(n,o,e,1)}upVectorScale(e){return{metersToTile:p_*xp(Ea(e))}}}function t0(t){const e=t.parallels,n=!!e&&Math.abs(e[0]+e[1])<.01;switch(t.name){case"mercator":return new bp(t);case"equirectangular":return new _1(t);case"naturalEarth":return new g1(t);case"equalEarth":return new Xy(t);case"winkelTripel":return new y1(t);case"albers":return n?new e0(t):new m1(t);case"lambertConformalConic":return n?new e0(t):new y_(t);case"globe":return new v1(t)}throw new Error(`Invalid projection name: ${t.name}`)}const x1=sp.types,w1=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Cp(t,e,n,o,u,f,m,y,w,A,B,I,M){const z=y?Math.min(al,Math.round(y[0])):0,R=y?Math.min(al,Math.round(y[1])):0;t.emplaceBack(e,n,Math.round(32*o),Math.round(32*u),f,m,(z<<1)+(w?1:0),R,16*A,16*B,256*I,256*M)}function Ep(t,e,n,o,u,f,m){t.emplaceBack(e,n,o,u,f,m)}function Bp(t,e,n,o,u){t.emplaceBack(e,n,o,u),t.emplaceBack(e,n,o,u),t.emplaceBack(e,n,o,u),t.emplaceBack(e,n,o,u)}function A1(t){for(const e of t.sections)if(k(e.text))return!0;return!1}class v_{constructor(e){this.layoutVertexArray=new lr,this.indexArray=new Yr,this.programConfigurations=e,this.segments=new kr,this.dynamicLayoutVertexArray=new Mr,this.opacityVertexArray=new vr,this.placedSymbolArray=new xm,this.globeExtVertexArray=new Sn}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,n,o,u){this.isEmpty()||(o&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Vx.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,qr.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,w1,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,_o.members,!0)),this.opacityVertexBuffer.itemSize=1),(o||u)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}wt(v_,"SymbolBuffers");class x_{constructor(e,n,o){this.layoutVertexArray=new e,this.layoutAttributes=n,this.indexArray=new o,this.segments=new kr,this.collisionVertexArray=new ks,this.collisionVertexArrayExt=new ao}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Hx.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,ru.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}wt(x_,"CollisionBuffers");class au{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(m=>m.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Fs([]),this.placementViewportMatrix=Fs([]);const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=r_(this.zoom,n["text-size"]),this.iconSizeData=r_(this.zoom,n["icon-size"]);const o=this.layers[0].layout,u=o.get("symbol-sort-key"),f=o.get("symbol-z-order");this.canOverlap=o.get("text-allow-overlap")||o.get("icon-allow-overlap")||o.get("text-ignore-placement")||o.get("icon-ignore-placement"),this.sortFeaturesByKey=f!=="viewport-y"&&u.constantOr(1)!==void 0,this.sortFeaturesByY=(f==="viewport-y"||f==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=o.get("text-writing-mode").map(m=>Fo[m]),this.stateDependentLayerIds=this.layers.filter(m=>m.isStateDependent()).map(m=>m.id),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new v_(new as(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new v_(new as(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new tl,this.lineVertexArray=new Ff,this.symbolInstances=new lo}calculateGlyphDependencies(e,n,o,u,f){for(let m=0;m<e.length;m++)if(n[e.charCodeAt(m)]=!0,u&&f){const y=iu[e.charAt(m)];y&&(n[y.charCodeAt(0)]=!0)}}populate(e,n,o,u){const f=this.layers[0],m=f.layout,y=this.projection.name==="globe",w=m.get("text-font"),A=m.get("text-field"),B=m.get("icon-image"),I=(A.value.kind!=="constant"||A.value.value instanceof mi&&!A.value.value.isEmpty()||A.value.value.toString().length>0)&&(w.value.kind!=="constant"||w.value.value.length>0),M=B.value.kind!=="constant"||!!B.value.value||Object.keys(B.parameters).length>0,z=m.get("symbol-sort-key");if(this.features=[],!I&&!M)return;const R=n.iconDependencies,U=n.glyphDependencies,H=n.availableImages,ie=new oe(this.zoom);for(const{feature:ce,id:re,index:ae,sourceLayerIndex:_e}of e){const de=f._featureFilter.needGeometry,Fe=Hu(ce,de);if(!f._featureFilter.filter(ie,Fe,o))continue;if(de||(Fe.geometry=Hi(ce,o,u)),y&&ce.type!==1&&o.z<=5){const Ge=Fe.geometry,We=.98078528056,Ze=(Ye,lt)=>ls(mh(Ye.x,Ye.y,o,1),mh(lt.x,lt.y,o,1))<We;for(let Ye=0;Ye<Ge.length;Ye++)Ge[Ye]=$c(Ge[Ye],Ze)}let ze,qe;if(I){const Ge=f.getValueAndResolveTokens("text-field",Fe,o,H),We=mi.factory(Ge);A1(We)&&(this.hasRTLText=!0),(!this.hasRTLText||J()==="unavailable"||this.hasRTLText&&ue.isParsed())&&(ze=yy(We,f,Fe))}if(M){const Ge=f.getValueAndResolveTokens("icon-image",Fe,o,H);qe=Ge instanceof _i?Ge:_i.fromString(Ge)}if(!ze&&!qe)continue;const st=this.sortFeaturesByKey?z.evaluate(Fe,{},o):void 0;if(this.features.push({id:re,text:ze,icon:qe,index:ae,sourceLayerIndex:_e,geometry:Fe.geometry,properties:ce.properties,type:x1[ce.type],sortKey:st}),qe&&(R[qe.name]=!0),ze){const Ge=w.evaluate(Fe,{},o).join(","),We=m.get("text-rotation-alignment")==="map"&&m.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Fo.vertical)>=0;for(const Ze of ze.sections)if(Ze.image)R[Ze.image.name]=!0;else{const Ye=l(ze.toString()),lt=Ze.fontStack||Ge,je=U[lt]=U[lt]||{};this.calculateGlyphDependencies(Ze.text,je,We,this.allowVerticalPlacement,Ye)}}}m.get("symbol-placement")==="line"&&(this.features=function(ce){const re={},ae={},_e=[];let de=0;function Fe(Ge){_e.push(ce[Ge]),de++}function ze(Ge,We,Ze){const Ye=ae[Ge];return delete ae[Ge],ae[We]=Ye,_e[Ye].geometry[0].pop(),_e[Ye].geometry[0]=_e[Ye].geometry[0].concat(Ze[0]),Ye}function qe(Ge,We,Ze){const Ye=re[We];return delete re[We],re[Ge]=Ye,_e[Ye].geometry[0].shift(),_e[Ye].geometry[0]=Ze[0].concat(_e[Ye].geometry[0]),Ye}function st(Ge,We,Ze){const Ye=Ze?We[0][We[0].length-1]:We[0][0];return`${Ge}:${Ye.x}:${Ye.y}`}for(let Ge=0;Ge<ce.length;Ge++){const We=ce[Ge],Ze=We.geometry,Ye=We.text?We.text.toString():null;if(!Ye){Fe(Ge);continue}const lt=st(Ye,Ze),je=st(Ye,Ze,!0);if(lt in ae&&je in re&&ae[lt]!==re[je]){const bt=qe(lt,je,Ze),Xt=ze(lt,je,_e[bt].geometry);delete re[lt],delete ae[je],ae[st(Ye,_e[Xt].geometry,!0)]=Xt,_e[bt].geometry=null}else lt in ae?ze(lt,je,Ze):je in re?qe(lt,je,Ze):(Fe(Ge),re[lt]=de-1,ae[je]=de-1)}return _e.filter(Ge=>Ge.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ce,re)=>ce.sortKey-re.sortKey)}update(e,n,o,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,n,this.layers,o,u),this.icon.programConfigurations.updatePaintArrays(e,n,this.layers,o,u))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=t0(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,n){const o=this.lineVertexArray.length,u=e.segment;if(u!==void 0){let f=e.dist(n[u+1]),m=e.dist(n[u]);const y={};for(let w=u+1;w<n.length;w++)y[w]={x:n[w].x,y:n[w].y,tileUnitDistanceFromAnchor:f},w<n.length-1&&(f+=n[w+1].dist(n[w]));for(let w=u||0;w>=0;w--)y[w]={x:n[w].x,y:n[w].y,tileUnitDistanceFromAnchor:m},w>0&&(m+=n[w-1].dist(n[w]));for(let w=0;w<n.length;w++){const A=y[w];this.lineVertexArray.emplaceBack(A.x,A.y,A.tileUnitDistanceFromAnchor)}}return{lineStartIndex:o,lineLength:this.lineVertexArray.length-o}}addSymbols(e,n,o,u,f,m,y,w,A,B,I,M,z,R){const U=e.indexArray,H=e.layoutVertexArray,ie=e.globeExtVertexArray,ce=e.segments.prepareSegment(4*n.length,H,U,this.canOverlap?m.sortKey:void 0),re=this.glyphOffsetArray.length,ae=ce.vertexLength,_e=this.allowVerticalPlacement&&y===Fo.vertical?Math.PI/2:0,de=m.text&&m.text.sections;for(let ze=0;ze<n.length;ze++){const{tl:qe,tr:st,bl:Ge,br:We,tex:Ze,pixelOffsetTL:Ye,pixelOffsetBR:lt,minFontScaleX:je,minFontScaleY:bt,glyphOffset:Xt,isSDF:It,sectionIndex:Dt}=n[ze],gt=ce.vertexLength,Zt=Xt[1];if(Cp(H,A.x,A.y,qe.x,Zt+qe.y,Ze.x,Ze.y,o,It,Ye.x,Ye.y,je,bt),Cp(H,A.x,A.y,st.x,Zt+st.y,Ze.x+Ze.w,Ze.y,o,It,lt.x,Ye.y,je,bt),Cp(H,A.x,A.y,Ge.x,Zt+Ge.y,Ze.x,Ze.y+Ze.h,o,It,Ye.x,lt.y,je,bt),Cp(H,A.x,A.y,We.x,Zt+We.y,Ze.x+Ze.w,Ze.y+Ze.h,o,It,lt.x,lt.y,je,bt),w){const an=w.anchor,ln=w.up;Ep(ie,an.x,an.y,an.z,ln[0],ln[1],ln[2]),Ep(ie,an.x,an.y,an.z,ln[0],ln[1],ln[2]),Ep(ie,an.x,an.y,an.z,ln[0],ln[1],ln[2]),Ep(ie,an.x,an.y,an.z,ln[0],ln[1],ln[2]),Bp(e.dynamicLayoutVertexArray,an.x,an.y,an.z,_e)}else Bp(e.dynamicLayoutVertexArray,A.x,A.y,A.z,_e);U.emplaceBack(gt,gt+1,gt+2),U.emplaceBack(gt+1,gt+2,gt+3),ce.vertexLength+=4,ce.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Xt[0]),ze!==n.length-1&&Dt===n[ze+1].sectionIndex||e.programConfigurations.populatePaintArrays(H.length,m,m.index,{},z,R,de&&de[Dt])}const Fe=w?w.anchor:A;e.placedSymbolArray.emplaceBack(Fe.x,Fe.y,Fe.z,A.x,A.y,re,this.glyphOffsetArray.length-re,ae,B,I,A.segment,o?o[0]:0,o?o[1]:0,u[0],u[1],y,0,!1,0,M,0)}_commitLayoutVertex(e,n,o,u,f,m,y){e.emplaceBack(n,o,u,f,m,Math.round(y.x),Math.round(y.y))}_addCollisionDebugVertices(e,n,o,u,f,m,y){const w=o.segments.prepareSegment(4,o.layoutVertexArray,o.indexArray),A=w.vertexLength,B=y.tileAnchorX,I=y.tileAnchorY;for(let z=0;z<4;z++)o.collisionVertexArray.emplaceBack(0,0,0,0);o.collisionVertexArrayExt.emplaceBack(n,-e.padding,-e.padding),o.collisionVertexArrayExt.emplaceBack(n,e.padding,-e.padding),o.collisionVertexArrayExt.emplaceBack(n,e.padding,e.padding),o.collisionVertexArrayExt.emplaceBack(n,-e.padding,e.padding),this._commitLayoutVertex(o.layoutVertexArray,u,f,m,B,I,new Ie(e.x1,e.y1)),this._commitLayoutVertex(o.layoutVertexArray,u,f,m,B,I,new Ie(e.x2,e.y1)),this._commitLayoutVertex(o.layoutVertexArray,u,f,m,B,I,new Ie(e.x2,e.y2)),this._commitLayoutVertex(o.layoutVertexArray,u,f,m,B,I,new Ie(e.x1,e.y2)),w.vertexLength+=4;const M=o.indexArray;M.emplaceBack(A,A+1),M.emplaceBack(A+1,A+2),M.emplaceBack(A+2,A+3),M.emplaceBack(A+3,A),w.primitiveLength+=4}_addTextDebugCollisionBoxes(e,n,o,u,f,m){for(let y=u;y<f;y++){const w=o.get(y),A=this.getSymbolInstanceTextSize(e,m,n,y);this._addCollisionDebugVertices(w,A,this.textCollisionBox,w.projectedAnchorX,w.projectedAnchorY,w.projectedAnchorZ,m)}}_addIconDebugCollisionBoxes(e,n,o,u,f,m){for(let y=u;y<f;y++){const w=o.get(y),A=this.getSymbolInstanceIconSize(e,n,m.placedIconSymbolIndex);this._addCollisionDebugVertices(w,A,this.iconCollisionBox,w.projectedAnchorX,w.projectedAnchorY,w.projectedAnchorZ,m)}}generateCollisionDebugBuffers(e,n){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new x_(jn,gy.members,Ai),this.iconCollisionBox=new x_(jn,gy.members,Ai);const o=sh(this.iconSizeData,e),u=sh(this.textSizeData,e);for(let f=0;f<this.symbolInstances.length;f++){const m=this.symbolInstances.get(f);this._addTextDebugCollisionBoxes(u,e,n,m.textBoxStartIndex,m.textBoxEndIndex,m),this._addTextDebugCollisionBoxes(u,e,n,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m),this._addIconDebugCollisionBoxes(o,e,n,m.iconBoxStartIndex,m.iconBoxEndIndex,m),this._addIconDebugCollisionBoxes(o,e,n,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex,m)}}getSymbolInstanceTextSize(e,n,o,u){const f=this.text.placedSymbolArray.get(n.rightJustifiedTextSymbolIndex>=0?n.rightJustifiedTextSymbolIndex:n.centerJustifiedTextSymbolIndex>=0?n.centerJustifiedTextSymbolIndex:n.leftJustifiedTextSymbolIndex>=0?n.leftJustifiedTextSymbolIndex:n.verticalPlacedTextSymbolIndex>=0?n.verticalPlacedTextSymbolIndex:u),m=oh(this.textSizeData,e,f)/li;return this.tilePixelRatio*m}getSymbolInstanceIconSize(e,n,o){const u=this.icon.placedSymbolArray.get(o),f=oh(this.iconSizeData,e,u);return this.tilePixelRatio*f}_commitDebugCollisionVertexUpdate(e,n,o){e.emplaceBack(n,-o,-o),e.emplaceBack(n,o,-o),e.emplaceBack(n,o,o),e.emplaceBack(n,-o,o)}_updateTextDebugCollisionBoxes(e,n,o,u,f,m){for(let y=u;y<f;y++){const w=o.get(y),A=this.getSymbolInstanceTextSize(e,m,n,y);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,A,w.padding)}}_updateIconDebugCollisionBoxes(e,n,o,u,f,m){for(let y=u;y<f;y++){const w=o.get(y),A=this.getSymbolInstanceIconSize(e,n,m);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,A,w.padding)}}updateCollisionDebugBuffers(e,n){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const o=sh(this.iconSizeData,e),u=sh(this.textSizeData,e);for(let f=0;f<this.symbolInstances.length;f++){const m=this.symbolInstances.get(f);this._updateTextDebugCollisionBoxes(u,e,n,m.textBoxStartIndex,m.textBoxEndIndex,m),this._updateTextDebugCollisionBoxes(u,e,n,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m),this._updateIconDebugCollisionBoxes(o,e,n,m.iconBoxStartIndex,m.iconBoxEndIndex,m.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(o,e,n,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex,m.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,n,o,u,f,m,y,w,A){const B={};for(let I=n;I<o;I++){const M=e.get(I);B.textBox={x1:M.x1,y1:M.y1,x2:M.x2,y2:M.y2,padding:M.padding,projectedAnchorX:M.projectedAnchorX,projectedAnchorY:M.projectedAnchorY,projectedAnchorZ:M.projectedAnchorZ,tileAnchorX:M.tileAnchorX,tileAnchorY:M.tileAnchorY},B.textFeatureIndex=M.featureIndex;break}for(let I=u;I<f;I++){const M=e.get(I);B.verticalTextBox={x1:M.x1,y1:M.y1,x2:M.x2,y2:M.y2,padding:M.padding,projectedAnchorX:M.projectedAnchorX,projectedAnchorY:M.projectedAnchorY,projectedAnchorZ:M.projectedAnchorZ,tileAnchorX:M.tileAnchorX,tileAnchorY:M.tileAnchorY},B.verticalTextFeatureIndex=M.featureIndex;break}for(let I=m;I<y;I++){const M=e.get(I);B.iconBox={x1:M.x1,y1:M.y1,x2:M.x2,y2:M.y2,padding:M.padding,projectedAnchorX:M.projectedAnchorX,projectedAnchorY:M.projectedAnchorY,projectedAnchorZ:M.projectedAnchorZ,tileAnchorX:M.tileAnchorX,tileAnchorY:M.tileAnchorY},B.iconFeatureIndex=M.featureIndex;break}for(let I=w;I<A;I++){const M=e.get(I);B.verticalIconBox={x1:M.x1,y1:M.y1,x2:M.x2,y2:M.y2,padding:M.padding,projectedAnchorX:M.projectedAnchorX,projectedAnchorY:M.projectedAnchorY,projectedAnchorZ:M.projectedAnchorZ,tileAnchorX:M.tileAnchorX,tileAnchorY:M.tileAnchorY},B.verticalIconFeatureIndex=M.featureIndex;break}return B}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const o=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,o.textBoxStartIndex,o.textBoxEndIndex,o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o.iconBoxStartIndex,o.iconBoxEndIndex,o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,n){const o=e.placedSymbolArray.get(n),u=o.vertexStartIndex+4*o.numGlyphs;for(let f=o.vertexStartIndex;f<u;f+=4)e.indexArray.emplaceBack(f,f+1,f+2),e.indexArray.emplaceBack(f+1,f+2,f+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const n=Math.sin(e),o=Math.cos(e),u=[],f=[],m=[];for(let y=0;y<this.symbolInstances.length;++y){m.push(y);const w=this.symbolInstances.get(y);u.push(0|Math.round(n*w.tileAnchorX+o*w.tileAnchorY)),f.push(w.featureIndex)}return m.sort((y,w)=>u[y]-u[w]||f[w]-f[y]),m}addToSortKeyRanges(e,n){const o=this.sortKeyRanges[this.sortKeyRanges.length-1];o&&o.sortKey===n?o.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const o=this.symbolInstances.get(n);this.featureSortOrder.push(o.featureIndex),[o.rightJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.leftJustifiedTextSymbolIndex].forEach((u,f,m)=>{u>=0&&m.indexOf(u)===f&&this.addIndicesForPlacedSymbol(this.text,u)}),o.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,o.verticalPlacedTextSymbolIndex),o.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,o.placedIconSymbolIndex),o.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,o.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}wt(au,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),au.MAX_GLYPHS=65535,au.addDynamicAttributes=Bp;const b1=new ct({"symbol-placement":new Me(Ne.layout_symbol["symbol-placement"]),"symbol-spacing":new Me(Ne.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Me(Ne.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ve(Ne.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Me(Ne.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Me(Ne.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Me(Ne.layout_symbol["icon-ignore-placement"]),"icon-optional":new Me(Ne.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Me(Ne.layout_symbol["icon-rotation-alignment"]),"icon-size":new ve(Ne.layout_symbol["icon-size"]),"icon-text-fit":new Me(Ne.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Me(Ne.layout_symbol["icon-text-fit-padding"]),"icon-image":new ve(Ne.layout_symbol["icon-image"]),"icon-rotate":new ve(Ne.layout_symbol["icon-rotate"]),"icon-padding":new Me(Ne.layout_symbol["icon-padding"]),"icon-keep-upright":new Me(Ne.layout_symbol["icon-keep-upright"]),"icon-offset":new ve(Ne.layout_symbol["icon-offset"]),"icon-anchor":new ve(Ne.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Me(Ne.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Me(Ne.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Me(Ne.layout_symbol["text-rotation-alignment"]),"text-field":new ve(Ne.layout_symbol["text-field"]),"text-font":new ve(Ne.layout_symbol["text-font"]),"text-size":new ve(Ne.layout_symbol["text-size"]),"text-max-width":new ve(Ne.layout_symbol["text-max-width"]),"text-line-height":new ve(Ne.layout_symbol["text-line-height"]),"text-letter-spacing":new ve(Ne.layout_symbol["text-letter-spacing"]),"text-justify":new ve(Ne.layout_symbol["text-justify"]),"text-radial-offset":new ve(Ne.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Me(Ne.layout_symbol["text-variable-anchor"]),"text-anchor":new ve(Ne.layout_symbol["text-anchor"]),"text-max-angle":new Me(Ne.layout_symbol["text-max-angle"]),"text-writing-mode":new Me(Ne.layout_symbol["text-writing-mode"]),"text-rotate":new ve(Ne.layout_symbol["text-rotate"]),"text-padding":new Me(Ne.layout_symbol["text-padding"]),"text-keep-upright":new Me(Ne.layout_symbol["text-keep-upright"]),"text-transform":new ve(Ne.layout_symbol["text-transform"]),"text-offset":new ve(Ne.layout_symbol["text-offset"]),"text-allow-overlap":new Me(Ne.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Me(Ne.layout_symbol["text-ignore-placement"]),"text-optional":new Me(Ne.layout_symbol["text-optional"])});var w_={paint:new ct({"icon-opacity":new ve(Ne.paint_symbol["icon-opacity"]),"icon-color":new ve(Ne.paint_symbol["icon-color"]),"icon-halo-color":new ve(Ne.paint_symbol["icon-halo-color"]),"icon-halo-width":new ve(Ne.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ve(Ne.paint_symbol["icon-halo-blur"]),"icon-translate":new Me(Ne.paint_symbol["icon-translate"]),"icon-translate-anchor":new Me(Ne.paint_symbol["icon-translate-anchor"]),"text-opacity":new ve(Ne.paint_symbol["text-opacity"]),"text-color":new ve(Ne.paint_symbol["text-color"],{runtimeType:Wo,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new ve(Ne.paint_symbol["text-halo-color"]),"text-halo-width":new ve(Ne.paint_symbol["text-halo-width"]),"text-halo-blur":new ve(Ne.paint_symbol["text-halo-blur"]),"text-translate":new Me(Ne.paint_symbol["text-translate"]),"text-translate-anchor":new Me(Ne.paint_symbol["text-translate-anchor"])}),layout:b1};class n0{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:qa,this.defaultValue=e}evaluate(e){if(e.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(e.formattedSection))return n.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}wt(n0,"FormatSectionOverride",{omit:["defaultValue"]});class Tp extends co{constructor(e){super(e,w_)}recalculate(e,n){super.recalculate(e,n),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const o=this.layout.get("text-writing-mode");if(o){const u=[];for(const f of o)u.indexOf(f)<0&&u.push(f);this.layout._values["text-writing-mode"]=u}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,n,o,u){const f=this.layout.get(e).evaluate(n,{},o,u),m=this._unevaluatedLayout._values[e];return m.isDataDriven()||jl(m.value)||!f?f:function(y,w){return w.replace(/{([^{}]+)}/g,(A,B)=>B in y?String(y[B]):"")}(n.properties,f)}createBucket(e){return new au(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of w_.paint.overridableProperties){if(!Tp.hasPaintOverride(this.layout,e))continue;const n=this.paint.get(e),o=new n0(n),u=new aa(o,n.property.specification);let f=null;f=n.value.kind==="constant"||n.value.kind==="source"?new Za("source",u):new Lu("composite",u,n.value.zoomStops,n.value._interpolationType),this.paint._values[e]=new Ve(n.property,f,n.parameters)}}_handleOverridablePaintPropertyUpdate(e,n,o){return!(!this.layout||n.isDataDriven()||o.isDataDriven())&&Tp.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,n){const o=e.get("text-field"),u=w_.paint.properties[n];let f=!1;const m=y=>{for(const w of y)if(u.overrides&&u.overrides.hasOverride(w))return void(f=!0)};if(o.value.kind==="constant"&&o.value.value instanceof mi)m(o.value.value.sections);else if(o.value.kind==="source"){const y=A=>{f||(A instanceof Bu&&Dr(A.value)===Tl?m(A.value.sections):A instanceof Rn?m(A.sections):A.eachChild(y))},w=o.value;w._styleExpression&&y(w._styleExpression.expression)}return f}getProgramConfiguration(e){return new rl(this,e)}}var C1={paint:new ct({"background-color":new Me(Ne.paint_background["background-color"]),"background-pattern":new ut(Ne.paint_background["background-pattern"]),"background-opacity":new Me(Ne.paint_background["background-opacity"])})},d={paint:new ct({"raster-opacity":new Me(Ne.paint_raster["raster-opacity"]),"raster-hue-rotate":new Me(Ne.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Me(Ne.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Me(Ne.paint_raster["raster-brightness-max"]),"raster-saturation":new Me(Ne.paint_raster["raster-saturation"]),"raster-contrast":new Me(Ne.paint_raster["raster-contrast"]),"raster-resampling":new Me(Ne.paint_raster["raster-resampling"]),"raster-fade-duration":new Me(Ne.paint_raster["raster-fade-duration"])})};class _ extends co{constructor(e){super(e,{}),this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var C={paint:new ct({"sky-type":new Me(Ne.paint_sky["sky-type"]),"sky-atmosphere-sun":new Me(Ne.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Me(Ne.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Me(Ne.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Me(Ne.paint_sky["sky-gradient-radius"]),"sky-gradient":new dt(Ne.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Me(Ne.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Me(Ne.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Me(Ne.paint_sky["sky-opacity"])})};function P(t,e,n){const o=[0,0,1],u=$g([]);return Kg(u,u,n?-Et(t)+Math.PI:Et(t)),Wg(u,u,-Et(e)),Ug(o,o,u),Fi(o,o)}const q={circle:class extends co{constructor(t){super(t,Rg)}createBucket(t){return new ai(t)}queryRadius(t){const e=t;return Yl("circle-radius",this,e)+Yl("circle-stroke-width",this,e)+$f(this.paint.get("circle-translate"))}queryIntersectsFeature(t,e,n,o,u,f,m,y){const w=Kc(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),f.angle,t.pixelToTileUnitsFactor),A=this.paint.get("circle-radius").evaluate(e,n)+this.paint.get("circle-stroke-width").evaluate(e,n);return Zg(t,o,f,m,y,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",w,A)}getProgramIds(){return["circle"]}getProgramConfiguration(t){return new rl(this,t)}},heatmap:class extends co{createBucket(t){return new Qg(t)}constructor(t){super(t,cx),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Vm({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(t){return Yl("heatmap-radius",this,t)}queryIntersectsFeature(t,e,n,o,u,f,m,y){const w=this.paint.get("heatmap-radius").evaluate(e,n);return Zg(t,o,f,m,y,!0,!0,new Ie(0,0),w)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(t){return new rl(this,t)}},hillshade:class extends co{constructor(t){super(t,hx)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends co{constructor(t){super(t,Bx)}getProgramIds(){const t=this.paint.get("fill-pattern"),e=t&&t.constantOr(1),n=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&n.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),n}getProgramConfiguration(t){return new rl(this,t)}recalculate(t,e){super.recalculate(t,e);const n=this.paint._values["fill-outline-color"];n.value.kind==="constant"&&n.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new rp(t)}queryRadius(){return $f(this.paint.get("fill-translate"))}queryIntersectsFeature(t,e,n,o,u,f){return!t.queryGeometry.isAboveHorizon&&zm(zg(t.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),f.angle,t.pixelToTileUnitsFactor),o)}isTileClipped(){return!0}},"fill-extrusion":class extends co{constructor(t){super(t,Fx)}createBucket(t){return new Zu(t)}queryRadius(){return $f(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(t){return new rl(this,t)}queryIntersectsFeature(t,e,n,o,u,f,m,y,w){const A=Kc(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),f.angle,t.pixelToTileUnitsFactor),B=this.paint.get("fill-extrusion-height").evaluate(e,n),I=this.paint.get("fill-extrusion-base").evaluate(e,n),M=[0,0],z=y&&f.elevation,R=f.elevation?f.elevation.exaggeration():1,U=t.tile.getBucket(this);if(z&&U instanceof Zu){const ae=U.centroidVertexArray,_e=w+1;if(_e<ae.length){const de=ae.get(_e);M[0]=de.a_centroid_pos0,M[1]=de.a_centroid_pos1}}if(M[0]===0&&M[1]===1)return!1;f.projection.name==="globe"&&(o=kd([o],[new Ie(0,0),new Ie($t,$t)],t.tileID.canonical).map(ae=>ae.polygon).flat());const H=z?y:null,[ie,ce]=function(ae,_e,de,Fe,ze,qe,st,Ge,We,Ze,Ye){return ae.projection.name==="globe"?function(lt,je,bt,Xt,It,Dt,gt,Zt,an,ln,kn){const rn=[],ur=[],mn=lt.projection.upVectorScale(kn,lt.center.lat,lt.worldSize).metersToTile,vn=[0,0,0,1],Zn=[0,0,0,1],or=(sr,cr,Er,Ci)=>{sr[0]=cr,sr[1]=Er,sr[2]=Ci,sr[3]=1},nr=dy();bt>0&&(bt+=nr),Xt+=nr;for(const sr of je){const cr=[],Er=[];for(const Ci of sr){const Vn=Ci.x+It.x,Kr=Ci.y+It.y,jr=lt.projection.projectTilePoint(Vn,Kr,kn),Pn=lt.projection.upVector(kn,Ci.x,Ci.y);let gr=bt,ti=Xt;if(gt){const Jn=my(Vn,Kr,bt,Xt,gt,Zt,an,ln);gr+=Jn.base,ti+=Jn.top}bt!==0?or(vn,jr.x+Pn[0]*mn*gr,jr.y+Pn[1]*mn*gr,jr.z+Pn[2]*mn*gr):or(vn,jr.x,jr.y,jr.z),or(Zn,jr.x+Pn[0]*mn*ti,jr.y+Pn[1]*mn*ti,jr.z+Pn[2]*mn*ti),Pr(vn,vn,Dt),Pr(Zn,Zn,Dt),cr.push(new ih(vn[0],vn[1],vn[2])),Er.push(new ih(Zn[0],Zn[1],Zn[2]))}rn.push(cr),ur.push(Er)}return[rn,ur]}(ae,_e,de,Fe,ze,qe,st,Ge,We,Ze,Ye):st?function(lt,je,bt,Xt,It,Dt,gt,Zt,an){const ln=[],kn=[],rn=[0,0,0,1];for(const ur of lt){const mn=[],vn=[];for(const Zn of ur){const or=Zn.x+Xt.x,nr=Zn.y+Xt.y,sr=my(or,nr,je,bt,Dt,gt,Zt,an);rn[0]=or,rn[1]=nr,rn[2]=sr.base,rn[3]=1,tu(rn,rn,It),rn[3]=Math.max(rn[3],1e-5);const cr=new ih(rn[0]/rn[3],rn[1]/rn[3],rn[2]/rn[3]);rn[0]=or,rn[1]=nr,rn[2]=sr.top,rn[3]=1,tu(rn,rn,It),rn[3]=Math.max(rn[3],1e-5);const Er=new ih(rn[0]/rn[3],rn[1]/rn[3],rn[2]/rn[3]);mn.push(cr),vn.push(Er)}ln.push(mn),kn.push(vn)}return[ln,kn]}(_e,de,Fe,ze,qe,st,Ge,We,Ze):function(lt,je,bt,Xt,It){const Dt=[],gt=[],Zt=It[8]*je,an=It[9]*je,ln=It[10]*je,kn=It[11]*je,rn=It[8]*bt,ur=It[9]*bt,mn=It[10]*bt,vn=It[11]*bt;for(const Zn of lt){const or=[],nr=[];for(const sr of Zn){const cr=sr.x+Xt.x,Er=sr.y+Xt.y,Ci=It[0]*cr+It[4]*Er+It[12],Vn=It[1]*cr+It[5]*Er+It[13],Kr=It[2]*cr+It[6]*Er+It[14],jr=It[3]*cr+It[7]*Er+It[15],Pn=Ci+Zt,gr=Vn+an,ti=Kr+ln,Jn=Math.max(jr+kn,1e-5),Fr=Ci+rn,Ki=Vn+ur,Ei=Kr+mn,Bi=Math.max(jr+vn,1e-5);or.push(new ih(Pn/Jn,gr/Jn,ti/Jn)),nr.push(new ih(Fr/Bi,Ki/Bi,Ei/Bi))}Dt.push(or),gt.push(nr)}return[Dt,gt]}(_e,de,Fe,ze,qe)}(f,o,I,B,A,m,H,M,R,f.center.lat,t.tileID.canonical),re=t.queryGeometry;return function(ae,_e,de){let Fe=1/0;zm(de,_e)&&(Fe=py(de,_e[0]));for(let ze=0;ze<_e.length;ze++){const qe=_e[ze],st=ae[ze];for(let Ge=0;Ge<qe.length-1;Ge++){const We=qe[Ge],Ze=[We,qe[Ge+1],st[Ge+1],st[Ge],We];Pg(de,Ze)&&(Fe=Math.min(Fe,py(de,Ze)))}}return Fe!==1/0&&Fe}(ie,ce,re.isPointQuery()?re.screenBounds:re.screenGeometry)}},line:class extends co{constructor(t){super(t,_y),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof Wa,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,e){super.recalculate(t,e),this.paint._values["line-floorwidth"]=nu.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new mo(t)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(t){return new rl(this,t)}queryRadius(t){const e=t,n=yn(Yl("line-width",this,e),Yl("line-gap-width",this,e)),o=Yl("line-offset",this,e);return n/2+Math.abs(o)+$f(this.paint.get("line-translate"))}queryIntersectsFeature(t,e,n,o,u,f){if(t.queryGeometry.isAboveHorizon)return!1;const m=zg(t.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),f.angle,t.pixelToTileUnitsFactor),y=t.pixelToTileUnitsFactor/2*yn(this.paint.get("line-width").evaluate(e,n),this.paint.get("line-gap-width").evaluate(e,n)),w=this.paint.get("line-offset").evaluate(e,n);return w&&(o=function(A,B){const I=[],M=new Ie(0,0);for(let z=0;z<A.length;z++){const R=A[z],U=[];for(let H=0;H<R.length;H++){const ie=R[H-1],ce=R[H],re=R[H+1],ae=H===0?M:ce.sub(ie)._unit()._perp(),_e=H===R.length-1?M:re.sub(ce)._unit()._perp(),de=ae._add(_e)._unit();de._mult(1/(de.x*_e.x+de.y*_e.y)),U.push(de._mult(B)._add(ce))}I.push(U)}return I}(o,w*t.pixelToTileUnitsFactor)),function(A,B,I){for(let M=0;M<B.length;M++){const z=B[M];if(A.length>=3){for(let R=0;R<z.length;R++)if(Ur(A,z[R]))return!0}if(rx(A,z,I))return!0}return!1}(m,o,y)}isTileClipped(){return!0}},symbol:Tp,background:class extends co{constructor(t){super(t,C1)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends co{constructor(t){super(t,d)}getProgramIds(){return["raster"]}},sky:class extends co{constructor(t){super(t,C),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="sky-gradient"?this._updateColorRamp():t!=="sky-atmosphere-sun"&&t!=="sky-atmosphere-halo-color"&&t!=="sky-atmosphere-color"&&t!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Vm({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(t){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=t.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(t,e){if(this.paint.get("sky-type")==="atmosphere"){const o=this.paint.get("sky-atmosphere-sun"),u=!o,f=t.style.light,m=f.properties.get("position");return u&&f.properties.get("anchor")==="viewport"&&er("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),u?P(m.azimuthal,90-m.polar,e):P(o[0],90-o[1],e)}const n=this.paint.get("sky-gradient-center");return P(n[0],90-n[1],e)}is3D(){return!1}isSky(){return!0}markSkyboxValid(t){this._skyboxInvalidated=!1,this._lightPosition=t.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const t=this.paint.get("sky-type");return t==="atmosphere"?["skyboxCapture","skybox"]:t==="gradient"?["skyboxGradient"]:null}}};class Q{constructor(e,n,o,u){this.context=e,this.format=o,this.texture=e.gl.createTexture(),this.update(n,u)}update(e,n,o){const{width:u,height:f}=e,{context:m}=this,{gl:y}=m,{HTMLImageElement:w,HTMLCanvasElement:A,HTMLVideoElement:B,ImageData:I,ImageBitmap:M}=N;if(y.bindTexture(y.TEXTURE_2D,this.texture),m.pixelStoreUnpackFlipY.set(!1),m.pixelStoreUnpack.set(1),m.pixelStoreUnpackPremultiplyAlpha.set(this.format===y.RGBA&&(!n||n.premultiply!==!1)),o||this.size&&this.size[0]===u&&this.size[1]===f){const{x:z,y:R}=o||{x:0,y:0};e instanceof w||e instanceof A||e instanceof B||e instanceof I||M&&e instanceof M?y.texSubImage2D(y.TEXTURE_2D,0,z,R,y.RGBA,y.UNSIGNED_BYTE,e):y.texSubImage2D(y.TEXTURE_2D,0,z,R,u,f,y.RGBA,y.UNSIGNED_BYTE,e.data)}else this.size=[u,f],e instanceof w||e instanceof A||e instanceof B||e instanceof I||M&&e instanceof M?y.texImage2D(y.TEXTURE_2D,0,this.format,this.format,y.UNSIGNED_BYTE,e):y.texImage2D(y.TEXTURE_2D,0,this.format,u,f,0,this.format,y.UNSIGNED_BYTE,e.data);this.useMipmap=Boolean(n&&n.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&y.generateMipmap(y.TEXTURE_2D)}bind(e,n){const{context:o}=this,{gl:u}=o;u.bindTexture(u.TEXTURE_2D,this.texture),e!==this.filter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,e),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,this.useMipmap?e===u.NEAREST?u.NEAREST_MIPMAP_NEAREST:u.LINEAR_MIPMAP_NEAREST:e),this.filter=e),n!==this.wrap&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,n),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,n),this.wrap=n)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class he{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class xe{constructor(){this.tasks={},this.taskQueue=[],jt(["process"],this),this.invoker=new he(this.process),this.nextId=0}add(e,n){const o=this.nextId++,u=function({type:f,isSymbolTile:m,zoom:y}){return y=y||0,f==="message"?0:f!=="maybePrepare"||m?f!=="parseTile"||m?f==="parseTile"&&m?300-y:f==="maybePrepare"&&m?400-y:500:200-y:100-y}(n);if(u===0){fi();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[o]={fn:e,metadata:n,priority:u,id:o},this.taskQueue.push(o),this.invoker.trigger(),{cancel:()=>{delete this.tasks[o]}}}process(){fi();try{if(this.taskQueue=this.taskQueue.filter(o=>!!this.tasks[o]),!this.taskQueue.length)return;const e=this.pick();if(e===null)return;const n=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!n)return;n.fn()}finally{}}pick(){let e=null,n=1/0;for(let u=0;u<this.taskQueue.length;u++){const f=this.tasks[this.taskQueue[u]];f.priority<n&&(n=f.priority,e=u)}if(e===null)return null;const o=this.taskQueue[e];return this.taskQueue.splice(e,1),o}remove(){this.invoker.remove()}}class ke{constructor(e){this._stringToNumber={},this._numberToString=[];for(let n=0;n<e.length;n++){const o=e[n];this._stringToNumber[o]=n,this._numberToString[n]=o}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const nt=["tile","layer","source","sourceLayer","state"];class rt{constructor(e,n,o,u,f){this.type="Feature",this._vectorTileFeature=e,this._z=n,this._x=o,this._y=u,this.properties=e.properties,this.id=f}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",geometry:this.geometry,properties:this.properties};this.id!==void 0&&(e.id=this.id);for(const n of nt)this[n]!==void 0&&(e[n]=this[n]);return e}}const it=32,At=33,Rt=new Uint16Array(8184);for(let t=0;t<2046;t++){let e=t+2,n=0,o=0,u=0,f=0,m=0,y=0;for(1&e?u=f=m=it:n=o=y=it;(e>>=1)>1;){const A=n+u>>1,B=o+f>>1;1&e?(u=n,f=o,n=m,o=y):(n=u,o=f,u=m,f=y),m=A,y=B}const w=4*t;Rt[w+0]=n,Rt[w+1]=o,Rt[w+2]=u,Rt[w+3]=f}const Kt=new Uint16Array(2178),pn=new Uint8Array(1089),nn=new Uint16Array(1089);function Bn(t){return t===0?-.03125:t===32?.03125:0}var Mn=ht([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const go={type:2,extent:$t,loadGeometry:()=>[[new Ie(0,0),new Ie(8193,0),new Ie(8193,8193),new Ie(0,8193),new Ie(0,0)]]};class bi{constructor(e,n,o,u,f){this.tileID=e,this.uid=Ln(),this.uses=0,this.tileSize=n,this.tileZoom=o,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=f,this.expiredRequestCount=0,this.state="loading",u&&u.transform&&(this.projection=u.transform.projection)}registerFadeDuration(e){const n=e+this.timeAdded;n<Tn.now()||this.fadeEndTime&&n<this.fadeEndTime||(this.fadeEndTime=n)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=Qu(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,n,o){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(u,f){const m={};if(!f)return m;for(const y of u){const w=y.layerIds.map(A=>f.getLayer(A)).filter(Boolean);if(w.length!==0){y.layers=w,y.stateDependentLayerIds&&(y.stateDependentLayers=y.stateDependentLayerIds.map(A=>w.filter(B=>B.id===A)[0]));for(const A of w)m[A.id]=y}}return m}(e.buckets,n.style),this.hasSymbolBuckets=!1;for(const u in this.buckets){const f=this.buckets[u];if(f instanceof au){if(this.hasSymbolBuckets=!0,!o)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const u in this.buckets){const f=this.buckets[u];if(f instanceof au&&f.hasRTLText){this.hasRTLText=!0,ue.isLoading()||ue.isLoaded()||J()!=="deferred"||le();break}}this.queryPadding=0;for(const u in this.buckets){const f=this.buckets[u];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(u).queryRadius(f))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new jc}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const o in this.buckets){const u=this.buckets[o];u.uploadPending()&&u.upload(e)}const n=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Q(e,this.imageAtlas.image,n.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Q(e,this.glyphAtlasImage,n.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Q(e,this.lineAtlas.image,n.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,n,o,u,f,m,y,w){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:u,pixelPosMatrix:y,transform:m,params:f,tileTransform:this.tileTransform},e,n,o):{}}querySourceFeatures(e,n){const o=this.latestFeatureIndex;if(!o||!o.rawTileData)return;const u=o.loadVTLayers(),f=n?n.sourceLayer:"",m=u._geojsonTileLayer||u[f];if(!m)return;const y=Lc(n&&n.filter),{z:w,x:A,y:B}=this.tileID.canonical,I={z:w,x:A,y:B};for(let M=0;M<m.length;M++){const z=m.feature(M);if(y.needGeometry){const H=Hu(z,!0);if(!y.filter(new oe(this.tileID.overscaledZ),H,this.tileID.canonical))continue}else if(!y.filter(new oe(this.tileID.overscaledZ),z))continue;const R=o.getId(z,f),U=new rt(z,w,A,B,R);U.tile=I,e.push(U)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const n=this.expirationTime;if(e.cacheControl){const o=yu(e.cacheControl);o["max-age"]&&(this.expirationTime=Date.now()+1e3*o["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const o=Date.now();let u=!1;if(this.expirationTime>o)u=!1;else if(n)if(this.expirationTime<n)u=!0;else{const f=this.expirationTime-n;f?this.expirationTime=o+Math.max(f,3e4):u=!0}else u=!0;u?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,n){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0||!n)return;const o=this.latestFeatureIndex.loadVTLayers(),u=n.style.listImages();for(const f in this.buckets){if(!n.style.hasLayer(f))continue;const m=this.buckets[f],y=m.layers[0].sourceLayer||"_geojsonTileLayer",w=o[y],A=e[y];if(!w||!A||Object.keys(A).length===0)continue;if(m.update(A,w,u,this.imageAtlas&&this.imageAtlas.patternPositions||{}),m instanceof mo||m instanceof rp){const I=n.style._getSourceCache(m.layers[0].source);n._terrain&&n._terrain.enabled&&I&&m.programConfigurations.needsUpload&&n._terrain._clearRenderCacheForTile(I.id,this.tileID)}const B=n&&n.style&&n.style.getLayer(f);B&&(this.queryPadding=Math.max(this.queryPadding,B.queryRadius(m)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Tn.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=Tn.now()+e}setTexture(e,n){const o=n.context,u=o.gl;this.texture=this.texture||n.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new Q(o,e,u.RGBA,{useMipmap:!0}),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),o.extTextureFilterAnisotropic&&u.texParameterf(u.TEXTURE_2D,o.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o.extTextureFilterAnisotropicMax))}setDependencies(e,n){const o={};for(const u of n)o[u]=!0;this.dependencies[e]=o}hasDependency(e,n){for(const o of e){const u=this.dependencies[o];if(u){for(const f of n)if(u[f])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,n){if(!n||n.name==="mercator"||this._tileDebugBuffer)return;const o=Hi(go,this.tileID.canonical,this.tileTransform)[0],u=new on,f=new qc;for(let m=0;m<o.length;m++){const{x:y,y:w}=o[m];u.emplaceBack(y,w),f.emplaceBack(m)}f.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(f),this._tileDebugBuffer=e.createVertexBuffer(u,Rd.members),this._tileDebugSegments=kr.simpleSegment(0,0,u.length,f.length)}_makeTileBoundsBuffers(e,n){if(this._tileBoundsBuffer||!n||n.name==="mercator")return;const o=Hi(go,this.tileID.canonical,this.tileTransform)[0];let u,f;if(this.isRaster){const m=function(y,w){const A=Qu(y,w),B=Math.pow(2,y.z);for(let H=0;H<At;H++)for(let ie=0;ie<At;ie++){const ce=Po((y.x+(ie+Bn(ie))/it)/B),re=ei((y.y+(H+Bn(H))/it)/B),ae=w.project(ce,re),_e=H*At+ie;Kt[2*_e+0]=Math.round((ae.x*A.scale-A.x)*$t),Kt[2*_e+1]=Math.round((ae.y*A.scale-A.y)*$t)}pn.fill(0),nn.fill(0);for(let H=2045;H>=0;H--){const ie=4*H,ce=Rt[ie+0],re=Rt[ie+1],ae=Rt[ie+2],_e=Rt[ie+3],de=ce+ae>>1,Fe=re+_e>>1,ze=de+Fe-re,qe=Fe+ce-de,st=re*At+ce,Ge=_e*At+ae,We=Fe*At+de,Ze=Math.hypot((Kt[2*st+0]+Kt[2*Ge+0])/2-Kt[2*We+0],(Kt[2*st+1]+Kt[2*Ge+1])/2-Kt[2*We+1])>=16;if(pn[We]=pn[We]||(Ze?1:0),H<1022){const Ye=(re+qe>>1)*At+(ce+ze>>1),lt=(_e+qe>>1)*At+(ae+ze>>1);pn[We]=pn[We]||pn[Ye]||pn[lt]}}const I=new Nn,M=new Yr;let z=0;function R(H,ie){const ce=ie*At+H;return nn[ce]===0&&(I.emplaceBack(Kt[2*ce+0],Kt[2*ce+1],H*$t/it,ie*$t/it),nn[ce]=++z),nn[ce]-1}function U(H,ie,ce,re,ae,_e){const de=H+ce>>1,Fe=ie+re>>1;if(Math.abs(H-ae)+Math.abs(ie-_e)>1&&pn[Fe*At+de])U(ae,_e,H,ie,de,Fe),U(ce,re,ae,_e,de,Fe);else{const ze=R(H,ie),qe=R(ce,re),st=R(ae,_e);M.emplaceBack(ze,qe,st)}}return U(0,0,it,it,it,0),U(it,it,0,0,0,it),{vertices:I,indices:M}}(this.tileID.canonical,n);u=m.vertices,f=m.indices}else{u=new Nn,f=new Yr;for(const{x:y,y:w}of o)u.emplaceBack(y,w,0,0);const m=Bd.exports(u.int16,void 0,4);for(let y=0;y<m.length;y+=3)f.emplaceBack(m[y],m[y+1],m[y+2])}this._tileBoundsBuffer=e.createVertexBuffer(u,Mn.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(f),this._tileBoundsSegments=kr.simpleSegment(0,0,u.length,f.length)}_makeGlobeTileDebugBuffers(e,n){const o=n.projection;if(!o||o.name!=="globe"||n.freezeTileCoverage)return;const u=this.tileID.canonical,f=Od(Hy(u,n)),m=_h(n.zoom);let y;m>0&&(y=Kf(new Float64Array(16),n.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,u,n,f,y,m),this._makeGlobeTileDebugTextBuffer(e,u,n,f,y,m)}_globePoint(e,n,o,u,f,m,y){let w=mh(e,n,o);if(m){const A=1<<o.z,B=si(u.center.lng),I=zs(u.center.lat),M=(o.x+.5)/A-B;let z=0;M>.5?z=-1:M<-.5&&(z=1);let R=(e/$t+o.x)/A+z,U=(n/$t+o.y)/A;R=(R-B)*u._pixelsPerMercatorPixel+B,U=(U-I)*u._pixelsPerMercatorPixel+I;const H=[R*u.worldSize,U*u.worldSize,0];Pr(H,H,m),w=Xu(w,H,y)}return Pr(w,w,f)}_makeGlobeTileDebugBorderBuffer(e,n,o,u,f,m){const y=new on,w=new qc,A=new Fn,B=(M,z,R,U,H)=>{const ie=(R-M)/(H-1),ce=(U-z)/(H-1),re=y.length;for(let ae=0;ae<H;ae++){const _e=M+ae*ie,de=z+ae*ce;y.emplaceBack(_e,de);const Fe=this._globePoint(_e,de,n,o,u,f,m);A.emplaceBack(Fe[0],Fe[1],Fe[2]),w.emplaceBack(re+ae)}},I=$t;B(0,0,I,0,16),B(I,0,I,I,16),B(I,I,0,I,16),B(0,I,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(w),this._tileDebugBuffer=e.createVertexBuffer(y,Rd.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(A,jy.members),this._tileDebugSegments=kr.simpleSegment(0,0,y.length,w.length)}_makeGlobeTileDebugTextBuffer(e,n,o,u,f,m){const y=new on,w=new Yr,A=new Fn,B=25;w.reserve(32),y.reserve(B),A.reserve(B);const I=(M,z)=>B*M+z;for(let M=0;M<B;M++){const z=2048*M;for(let R=0;R<B;R++){const U=2048*R;y.emplaceBack(U,z);const H=this._globePoint(U,z,n,o,u,f,m);A.emplaceBack(H[0],H[1],H[2])}}for(let M=0;M<4;M++)for(let z=0;z<4;z++){const R=I(M,z),U=I(M,z+1),H=I(M+1,z),ie=I(M+1,z+1);w.emplaceBack(R,U,H),w.emplaceBack(H,U,ie)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(w),this._tileDebugTextBuffer=e.createVertexBuffer(y,Rd.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(A,jy.members),this._tileDebugTextSegments=kr.simpleSegment(0,0,B,32)}}class Ro{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,n,o){const u=String(n);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][u]=this.stateChanges[e][u]||{},Mt(this.stateChanges[e][u],o),this.deletedStates[e]===null){this.deletedStates[e]={};for(const f in this.state[e])f!==u&&(this.deletedStates[e][f]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][u]===null){this.deletedStates[e][u]={};for(const f in this.state[e][u])o[f]||(this.deletedStates[e][u][f]=null)}else for(const f in o)this.deletedStates[e]&&this.deletedStates[e][u]&&this.deletedStates[e][u][f]===null&&delete this.deletedStates[e][u][f]}removeFeatureState(e,n,o){if(this.deletedStates[e]===null)return;const u=String(n);if(this.deletedStates[e]=this.deletedStates[e]||{},o&&n!==void 0)this.deletedStates[e][u]!==null&&(this.deletedStates[e][u]=this.deletedStates[e][u]||{},this.deletedStates[e][u][o]=null);else if(n!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][u])for(o in this.deletedStates[e][u]={},this.stateChanges[e][u])this.deletedStates[e][u][o]=null;else this.deletedStates[e][u]=null;else this.deletedStates[e]=null}getState(e,n){const o=String(n),u=Mt({},(this.state[e]||{})[o],(this.stateChanges[e]||{})[o]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const f=this.deletedStates[e][n];if(f===null)return{};for(const m in f)delete u[m]}return u}initializeTileState(e,n){e.setFeatureState(this.state,n)}coalesceChanges(e,n){const o={};for(const u in this.stateChanges){this.state[u]=this.state[u]||{};const f={};for(const m in this.stateChanges[u])this.state[u][m]||(this.state[u][m]={}),Mt(this.state[u][m],this.stateChanges[u][m]),f[m]=this.state[u][m];o[u]=f}for(const u in this.deletedStates){this.state[u]=this.state[u]||{};const f={};if(this.deletedStates[u]===null)for(const m in this.state[u])f[m]={},this.state[u][m]={};else for(const m in this.deletedStates[u]){if(this.deletedStates[u][m]===null)this.state[u][m]={};else for(const y of Object.keys(this.deletedStates[u][m]))delete this.state[u][m][y];f[m]=this.state[u][m]}o[u]=o[u]||{},Mt(o[u],f)}if(this.stateChanges={},this.deletedStates={},Object.keys(o).length!==0)for(const u in e)e[u].setFeatureState(o,n)}}class zr{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,n){const o=this.toIdx(e,n);return{min:this.minimums[o],max:this.maximums[o]}}isLeaf(e,n){return this.leaves[this.toIdx(e,n)]}toIdx(e,n){return n*this.size+e}}function hs(t,e,n,o){let u=0,f=Number.MAX_VALUE;for(let m=0;m<3;m++)if(Math.abs(o[m])<1e-15){if(n[m]<t[m]||n[m]>e[m])return null}else{const y=1/o[m];let w=(t[m]-n[m])*y,A=(e[m]-n[m])*y;if(w>A){const B=w;w=A,A=B}if(w>u&&(u=w),A<f&&(f=A),u>f)return null}return u}function Ta(t,e,n,o,u,f,m,y,w,A,B){const I=o-t,M=u-e,z=f-n,R=m-t,U=y-e,H=w-n,ie=B[1]*H-B[2]*U,ce=B[2]*R-B[0]*H,re=B[0]*U-B[1]*R,ae=I*ie+M*ce+z*re;if(Math.abs(ae)<1e-15)return null;const _e=1/ae,de=A[0]-t,Fe=A[1]-e,ze=A[2]-n,qe=(de*ie+Fe*ce+ze*re)*_e;if(qe<0||qe>1)return null;const st=Fe*z-ze*M,Ge=ze*I-de*z,We=de*M-Fe*I,Ze=(B[0]*st+B[1]*Ge+B[2]*We)*_e;return Ze<0||qe+Ze>1?null:(R*st+U*Ge+H*We)*_e}function A_(t,e,n){return(t-e)/(n-e)}function _b(t,e,n,o,u,f,m,y,w){const A=1<<n,B=f-o,I=m-u,M=(t+1)/A*B+o,z=(e+0)/A*I+u,R=(e+1)/A*I+u;y[0]=(t+0)/A*B+o,y[1]=z,w[0]=M,w[1]=R}class gb{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const n=function(f){const m=Math.ceil(Math.log2(f.dim/8)),y=[];let w=Math.ceil(Math.pow(2,m));const A=1/w,B=(z,R,U,H,ie)=>{const ce=H?1:0,re=(z+1)*U-ce,ae=R*U,_e=(R+1)*U-ce;ie[0]=z*U,ie[1]=ae,ie[2]=re,ie[3]=_e};let I=new zr(w);const M=[];for(let z=0;z<w*w;z++){B(z%w,Math.floor(z/w),A,!1,M);const R=yh(M[0],M[1],f),U=yh(M[2],M[1],f),H=yh(M[2],M[3],f),ie=yh(M[0],M[3],f);I.minimums.push(Math.min(R,U,H,ie)),I.maximums.push(Math.max(R,U,H,ie)),I.leaves.push(1)}for(y.push(I),w/=2;w>=1;w/=2){const z=y[y.length-1];I=new zr(w);for(let R=0;R<w*w;R++){B(R%w,Math.floor(R/w),2,!0,M);const U=z.getElevation(M[0],M[1]),H=z.getElevation(M[2],M[1]),ie=z.getElevation(M[2],M[3]),ce=z.getElevation(M[0],M[3]),re=z.isLeaf(M[0],M[1]),ae=z.isLeaf(M[2],M[1]),_e=z.isLeaf(M[2],M[3]),de=z.isLeaf(M[0],M[3]),Fe=Math.min(U.min,H.min,ie.min,ce.min),ze=Math.max(U.max,H.max,ie.max,ce.max),qe=re&&ae&&_e&&de;I.maximums.push(ze),I.minimums.push(Fe),I.leaves.push(ze-Fe<=5&&qe?1:0)}y.push(I)}return y}(this.dem),o=n.length-1,u=n[o];this._addNode(u.minimums[0],u.maximums[0],u.leaves[0]),this._construct(n,0,0,o,0)}raycastRoot(e,n,o,u,f,m,y=1){return hs([e,n,-100],[o,u,this.maximums[0]*y],f,m)}raycast(e,n,o,u,f,m,y=1){if(!this.nodeCount)return null;const w=this.raycastRoot(e,n,o,u,f,m,y);if(w==null)return null;const A=[],B=[],I=[],M=[],z=[{idx:0,t:w,nodex:0,nodey:0,depth:0}];for(;z.length>0;){const{idx:R,t:U,nodex:H,nodey:ie,depth:ce}=z.pop();if(this.leaves[R]){_b(H,ie,ce,e,n,o,u,I,M);const ae=1<<ce,_e=(H+0)/ae,de=(H+1)/ae,Fe=(ie+0)/ae,ze=(ie+1)/ae,qe=yh(_e,Fe,this.dem)*y,st=yh(de,Fe,this.dem)*y,Ge=yh(de,ze,this.dem)*y,We=yh(_e,ze,this.dem)*y,Ze=Ta(I[0],I[1],qe,M[0],I[1],st,M[0],M[1],Ge,f,m),Ye=Ta(M[0],M[1],Ge,I[0],M[1],We,I[0],I[1],qe,f,m),lt=Math.min(Ze!==null?Ze:Number.MAX_VALUE,Ye!==null?Ye:Number.MAX_VALUE);if(lt!==Number.MAX_VALUE)return lt;{const je=Ed([],f,m,U);if(yb(qe,st,We,Ge,A_(je[0],I[0],M[0]),A_(je[1],I[1],M[1]))>=je[2])return U}continue}let re=0;for(let ae=0;ae<this._siblingOffset.length;ae++){_b((H<<1)+this._siblingOffset[ae][0],(ie<<1)+this._siblingOffset[ae][1],ce+1,e,n,o,u,I,M),I[2]=-100,M[2]=this.maximums[this.childOffsets[R]+ae]*y;const _e=hs(I,M,f,m);if(_e!=null){const de=_e;A[ae]=de;let Fe=!1;for(let ze=0;ze<re&&!Fe;ze++)de>=A[B[ze]]&&(B.splice(ze,0,ae),Fe=!0);Fe||(B[re]=ae),re++}}for(let ae=0;ae<re;ae++){const _e=B[ae];z.push({idx:this.childOffsets[R]+_e,t:A[_e],nodex:(H<<1)+this._siblingOffset[_e][0],nodey:(ie<<1)+this._siblingOffset[_e][1],depth:ce+1})}}return null}_addNode(e,n,o){return this.minimums.push(e),this.maximums.push(n),this.leaves.push(o),this.childOffsets.push(0),this.nodeCount++}_construct(e,n,o,u,f){if(e[u].isLeaf(n,o)===1)return;this.childOffsets[f]||(this.childOffsets[f]=this.nodeCount);const m=u-1,y=e[m];let w=0,A=0;for(let B=0;B<this._siblingOffset.length;B++){const I=2*n+this._siblingOffset[B][0],M=2*o+this._siblingOffset[B][1],z=y.getElevation(I,M),R=y.isLeaf(I,M),U=this._addNode(z.min,z.max,R);R&&(w|=1<<B),A||(A=U)}for(let B=0;B<this._siblingOffset.length;B++)w&1<<B||this._construct(e,2*n+this._siblingOffset[B][0],2*o+this._siblingOffset[B][1],m,A+B)}}function yb(t,e,n,o,u,f){return xn(xn(t,n,f),xn(e,o,f),u)}function yh(t,e,n){const o=n.dim,u=en(t*o-.5,0,o-1),f=en(e*o-.5,0,o-1),m=Math.floor(u),y=Math.floor(f),w=Math.min(m+1,o-1),A=Math.min(y+1,o-1);return yb(n.get(m,y),n.get(w,y),n.get(m,A),n.get(w,A),u-m,f-y)}const vb={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class r0{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,n,o,u=!1,f=!1){if(this.uid=e,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(o&&o!=="mapbox"&&o!=="terrarium")return er(`"${o}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=n.height;const m=this.dim=n.height-2,y=new Uint32Array(n.data.buffer);if(this.pixels=new Uint8Array(n.data.buffer),this.encoding=o||"mapbox",this.borderReady=u,!u){for(let w=0;w<m;w++)y[this._idx(-1,w)]=y[this._idx(0,w)],y[this._idx(m,w)]=y[this._idx(m-1,w)],y[this._idx(w,-1)]=y[this._idx(w,0)],y[this._idx(w,m)]=y[this._idx(w,m-1)];y[this._idx(-1,-1)]=y[this._idx(0,0)],y[this._idx(m,-1)]=y[this._idx(m-1,0)],y[this._idx(-1,m)]=y[this._idx(0,m-1)],y[this._idx(m,m)]=y[this._idx(m-1,m-1)],f&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new gb(this)}get(e,n,o=!1){o&&(e=en(e,-1,this.dim),n=en(n,-1,this.dim));const u=4*this._idx(e,n);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(this.pixels[u],this.pixels[u+1],this.pixels[u+2])}static getUnpackVector(e){return vb[e]}get unpackVector(){return vb[this.encoding]}_idx(e,n){if(e<-1||e>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(e+1)}_unpackMapbox(e,n,o){return(256*e*256+256*n+o)/10-1e4}_unpackTerrarium(e,n,o){return 256*e+n+o/256-32768}static pack(e,n){const o=[0,0,0,0],u=r0.getUnpackVector(n);let f=Math.floor((e+u[3])/u[2]);return o[2]=f%256,f=Math.floor(f/256),o[1]=f%256,f=Math.floor(f/256),o[0]=f,o}getPixels(){return new po({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,n,o){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let u=n*this.dim,f=n*this.dim+this.dim,m=o*this.dim,y=o*this.dim+this.dim;switch(n){case-1:u=f-1;break;case 1:f=u+1}switch(o){case-1:m=y-1;break;case 1:y=m+1}const w=-n*this.dim,A=-o*this.dim;for(let B=m;B<y;B++)for(let I=u;I<f;I++){const M=4*this._idx(I,B),z=4*this._idx(I+w,B+A);this.pixels[M+0]=e.pixels[z+0],this.pixels[M+1]=e.pixels[z+1],this.pixels[M+2]=e.pixels[z+2],this.pixels[M+3]=e.pixels[z+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}wt(r0,"DEMData"),wt(gb,"DemMinMaxQuadTree",{omit:["dem"]});class oT{constructor(e,n){this.max=e,this.onRemove=n,this.reset()}reset(){for(const e in this.data)for(const n of this.data[e])n.timeout&&clearTimeout(n.timeout),this.onRemove(n.value);return this.data={},this.order=[],this}add(e,n,o){const u=e.wrapped().key;this.data[u]===void 0&&(this.data[u]=[]);const f={value:n,timeout:void 0};if(o!==void 0&&(f.timeout=setTimeout(()=>{this.remove(e,f)},o)),this.data[u].push(f),this.order.push(u),this.order.length>this.max){const m=this._getAndRemoveByKey(this.order[0]);m&&this.onRemove(m)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const n=this.data[e].shift();return n.timeout&&clearTimeout(n.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),n.value}getByKey(e){const n=this.data[e];return n?n[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,n){if(!this.has(e))return this;const o=e.wrapped().key,u=n===void 0?0:this.data[o].indexOf(n),f=this.data[o][u];return this.data[o].splice(u,1),f.timeout&&clearTimeout(f.timeout),this.data[o].length===0&&delete this.data[o],this.onRemove(f.value),this.order.splice(this.order.indexOf(o),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const n=this._getAndRemoveByKey(this.order[0]);n&&this.onRemove(n)}return this}filter(e){const n=[];for(const o in this.data)for(const u of this.data[o])e(u.value)||n.push(u);for(const o of n)this.remove(o.value.tileID,o)}}class Dp{constructor(e,n,o){this.func=e,this.mask=n,this.range=o}}Dp.ReadOnly=!1,Dp.ReadWrite=!0,Dp.disabled=new Dp(519,Dp.ReadOnly,[0,1]);const E1=7680;class B1{constructor(e,n,o,u,f,m){this.test=e,this.ref=n,this.mask=o,this.fail=u,this.depthFail=f,this.pass=m}}B1.disabled=new B1({func:519,mask:0},0,0,E1,E1,E1);class lu{constructor(e,n,o){this.blendFunction=e,this.blendColor=n,this.mask=o}}lu.Replace=[1,0],lu.disabled=new lu(lu.Replace,_r.transparent,[!1,!1,!1,!1]),lu.unblended=new lu(lu.Replace,_r.transparent,[!0,!0,!0,!0]),lu.alphaBlended=new lu([1,771],_r.transparent,[!0,!0,!0,!0]);const T1=1029,D1=2305;class ul{constructor(e,n,o){this.enable=e,this.mode=n,this.frontFace=o}}ul.disabled=new ul(!1,T1,D1),ul.backCCW=new ul(!0,T1,D1),ul.backCW=new ul(!0,T1,2304),ul.frontCW=new ul(!0,1028,2304),ul.frontCCW=new ul(!0,1028,D1);class jd extends As{constructor(e,n,o){super(),this.id=e,this._onlySymbols=o,n.on("data",u=>{u.dataType==="source"&&u.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&u.dataType==="source"&&u.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),n.on("error",()=>{this._sourceErrored=!0}),this._source=n,this._tiles={},this._cache=new oT(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=n.minTileCacheSize,this._maxTileCacheSize=n.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new Ro,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(e){this.map=e,this._minTileCacheSize=this._minTileCacheSize===void 0&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const n=this._tiles[e];if(n.state!=="loaded"&&n.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,n){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,n)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const n in this._tiles){const o=this._tiles[n];o.upload(e),o.prepare(this.map.style.imageManager)}}getIds(){return Qt(this._tiles).map(e=>e.tileID).sort(xb).map(e=>e.key)}getRenderableIds(e){const n=[];for(const o in this._tiles)this._isIdRenderable(+o,e)&&n.push(this._tiles[o]);return e?n.sort((o,u)=>{const f=o.tileID,m=u.tileID,y=new Ie(f.canonical.x,f.canonical.y)._rotate(this.transform.angle),w=new Ie(m.canonical.x,m.canonical.y)._rotate(this.transform.angle);return f.overscaledZ-m.overscaledZ||w.y-y.y||w.x-y.x}).map(o=>o.tileID.key):n.map(o=>o.tileID).sort(xb).map(o=>o.key)}hasRenderableParent(e){const n=this.findLoadedParent(e,0);return!!n&&this._isIdRenderable(n.tileID.key)}_isIdRenderable(e,n){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(n||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(+e,"reloading")}}_reloadTile(e,n){const o=this._tiles[e];o&&(o.state!=="loading"&&(o.state=n),this._loadTile(o,this._tileLoaded.bind(this,o,e,n)))}_tileLoaded(e,n,o,u){if(u)if(e.state="errored",u.status!==404)this._source.fire(new ea(u,{tile:e}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const f=this.map.painter.terrain;this.update(this.transform,f.getScaledDemTileSize(),!0),f.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=Tn.now(),o==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(n,e),this._source.type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new In("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const n=this.getRenderableIds();for(let u=0;u<n.length;u++){const f=n[u];if(e.neighboringTiles&&e.neighboringTiles[f]){const m=this.getTileByID(f);o(e,m),o(m,e)}}function o(u,f){if(!u.dem||u.dem.borderReady)return;u.needsHillshadePrepare=!0,u.needsDEMTextureUpload=!0;let m=f.tileID.canonical.x-u.tileID.canonical.x;const y=f.tileID.canonical.y-u.tileID.canonical.y,w=Math.pow(2,u.tileID.canonical.z),A=f.tileID.key;m===0&&y===0||Math.abs(y)>1||(Math.abs(m)>1&&(Math.abs(m+w)===1?m+=w:Math.abs(m-w)===1&&(m-=w)),f.dem&&u.dem&&(u.dem.backfillBorder(f.dem,m,y),u.neighboringTiles&&u.neighboringTiles[A]&&(u.neighboringTiles[A].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,n,o,u){for(const f in this._tiles){let m=this._tiles[f];if(u[f]||!m.hasData()||m.tileID.overscaledZ<=n||m.tileID.overscaledZ>o)continue;let y=m.tileID;for(;m&&m.tileID.overscaledZ>n+1;){const A=m.tileID.scaledTo(m.tileID.overscaledZ-1);m=this._tiles[A.key],m&&m.hasData()&&(y=A)}let w=y;for(;w.overscaledZ>n;)if(w=w.scaledTo(w.overscaledZ-1),e[w.key]){u[y.key]=y;break}}}findLoadedParent(e,n){if(e.key in this._loadedParentTiles){const o=this._loadedParentTiles[e.key];return o&&o.tileID.overscaledZ>=n?o:null}for(let o=e.overscaledZ-1;o>=n;o--){const u=e.scaledTo(o),f=this._getLoadedTile(u);if(f)return f}}_getLoadedTile(e){const n=this._tiles[e.key];return n&&n.hasData()?n:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,n){n=n||this._source.tileSize;const o=Math.ceil(e.width/n)+1,u=Math.ceil(e.height/n)+1,f=Math.floor(o*u*5),m=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,f):f,y=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,m):m;this._cache.setMaxSize(y)}handleWrapJump(e){const n=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,n){const o={};for(const u in this._tiles){const f=this._tiles[u];f.tileID=f.tileID.unwrapTo(f.tileID.wrap+n),o[f.tileID.key]=f}this._tiles=o;for(const u in this._timers)clearTimeout(this._timers[u]),delete this._timers[u];for(const u in this._tiles)this._setTileReloadTimer(+u,this._tiles[u])}}update(e,n,o){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!o)return;let u;this.updateCacheSize(e,n),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(y=>new Oi(y.canonical.z,y.wrap,y.canonical.z,y.canonical.x,y.canonical.y)):(u=e.coveringTiles({tileSize:n||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!o,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(u=u.filter(y=>this._source.hasTile(y)))):u=[];const f=this._updateRetainedTiles(u);if(wb(this._source.type)&&u.length!==0){const y={},w={},A=Object.keys(f);for(const I of A){const M=f[I],z=this._tiles[I];if(!z||z.fadeEndTime&&z.fadeEndTime<=Tn.now())continue;const R=this.findLoadedParent(M,Math.max(M.overscaledZ-jd.maxOverzooming,this._source.minzoom));R&&(this._addTile(R.tileID),y[R.tileID.key]=R.tileID),w[I]=M}const B=u[u.length-1].overscaledZ;for(const I in this._tiles){const M=this._tiles[I];if(f[I]||!M.hasData())continue;let z=M.tileID;for(;z.overscaledZ>B;){z=z.scaledTo(z.overscaledZ-1);const R=this._tiles[z.key];if(R&&R.hasData()&&w[z.key]){f[I]=M.tileID;break}}}for(const I in y)f[I]||(this._coveredTiles[I]=!0,f[I]=y[I])}for(const y in f)this._tiles[y].clearFadeHold();const m=function(y,w){const A=[];for(const B in y)B in w||A.push(B);return A}(this._tiles,f);for(const y of m){const w=this._tiles[y];w.hasSymbolBuckets&&!w.holdingForFade()?w.setHoldDuration(this.map._fadeDuration):w.hasSymbolBuckets&&!w.symbolFadeFinished()||this._removeTile(+y)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const n={};if(e.length===0)return n;const o={},u=e.reduce((A,B)=>Math.min(A,B.overscaledZ),1/0),f=e[0].overscaledZ,m=Math.max(f-jd.maxOverzooming,this._source.minzoom),y=Math.max(f+jd.maxUnderzooming,this._source.minzoom),w={};for(const A of e){const B=this._addTile(A);n[A.key]=A,B.hasData()||u<this._source.maxzoom&&(w[A.key]=A)}this._retainLoadedChildren(w,u,y,n);for(const A of e){let B=this._tiles[A.key];if(B.hasData())continue;if(A.canonical.z>=this._source.maxzoom){const M=A.children(this._source.maxzoom)[0],z=this.getTile(M);if(z&&z.hasData()){n[M.key]=M;continue}}else{const M=A.children(this._source.maxzoom);if(n[M[0].key]&&n[M[1].key]&&n[M[2].key]&&n[M[3].key])continue}let I=B.wasRequested();for(let M=A.overscaledZ-1;M>=m;--M){const z=A.scaledTo(M);if(o[z.key]||(o[z.key]=!0,B=this.getTile(z),!B&&I&&(B=this._addTile(z)),B&&(n[z.key]=z,I=B.wasRequested(),B.hasData())))break}}return n}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const n=[];let o,u=this._tiles[e].tileID;for(;u.overscaledZ>0;){if(u.key in this._loadedParentTiles){o=this._loadedParentTiles[u.key];break}n.push(u.key);const f=u.scaledTo(u.overscaledZ-1);if(o=this._getLoadedTile(f),o)break;u=f}for(const f of n)this._loadedParentTiles[f]=o}}_addTile(e){let n=this._tiles[e.key];if(n)return n;n=this._cache.getAndRemove(e),n&&(this._setTileReloadTimer(e.key,n),n.tileID=e,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,n)));const o=Boolean(n);if(!o){const u=this.map?this.map.painter:null;n=new bi(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,u,this._isRaster),this._loadTile(n,this._tileLoaded.bind(this,n,e.key,n.state))}return n?(n.uses++,this._tiles[e.key]=n,o||this._source.fire(new In("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n):null}_setTileReloadTimer(e,n){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const o=n.getExpiryTimeout();o&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},o))}_removeTile(e){const n=this._tiles[e];n&&(n.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),n.uses>0||(n.hasData()&&n.state!=="reloading"?this._cache.add(n.tileID,n,n.getExpiryTimeout()):(n.aborted=!0,this._abortTile(n),this._unloadTile(n))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,n,o){const u=[],f=this.transform;if(!f)return u;const m=f.projection.name==="globe",y=si(f.center.lng);for(const w in this._tiles){const A=this._tiles[w];if(o&&A.clearQueryDebugViz(),A.holdingForFade())continue;let B;if(m){const I=A.tileID.canonical;if(I.z===0){const M=[Math.abs(en(y,...b_(I,-1))-y),Math.abs(en(y,...b_(I,1))-y)];B=[0,2*M.indexOf(Math.min(...M))-1]}else{const M=[Math.abs(en(y,...b_(I,-1))-y),Math.abs(en(y,...b_(I,0))-y),Math.abs(en(y,...b_(I,1))-y)];B=[M.indexOf(Math.min(...M))-1]}}else B=[0];for(const I of B){const M=e.containsTile(A,f,n,I);M&&u.push(M)}}return u}getVisibleCoordinates(e){const n=this.getRenderableIds(e).map(o=>this._tiles[o].tileID);for(const o of n)o.projMatrix=this.transform.calculateProjMatrix(o.toUnwrapped());return n}hasTransition(){if(this._source.hasTransition())return!0;if(wb(this._source.type))for(const e in this._tiles){const n=this._tiles[e];if(n.fadeEndTime!==void 0&&n.fadeEndTime>=Tn.now())return!0}return!1}setFeatureState(e,n,o){this._state.updateState(e=e||"_geojsonTileLayer",n,o)}removeFeatureState(e,n,o){this._state.removeFeatureState(e=e||"_geojsonTileLayer",n,o)}getFeatureState(e,n){return this._state.getState(e=e||"_geojsonTileLayer",n)}setDependencies(e,n,o){const u=this._tiles[e];u&&u.setDependencies(n,o)}reloadTilesForDependencies(e,n){for(const o in this._tiles)this._tiles[o].hasDependency(e,n)&&this._reloadTile(+o,"reloading");this._cache.filter(o=>!o.hasDependency(e,n))}_preloadTiles(e,n){const o=new Map,u=Array.isArray(e)?e:[e],f=this.map.painter.terrain,m=this.usedForTerrain&&f?f.getScaledDemTileSize():this._source.tileSize;for(const y of u){const w=y.coveringTiles({tileSize:m,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const A of w)o.set(A.key,A);this.usedForTerrain&&y.updateElevation(!1)}xt(Array.from(o.values()),(y,w)=>{const A=new bi(y,this._source.tileSize*y.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(A,B=>{this._source.type==="raster-dem"&&A.dem&&this._backfillDEM(A),w(B,A)})},n)}}function xb(t,e){const n=Math.abs(2*t.wrap)-+(t.wrap<0),o=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||o-n||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function wb(t){return t==="raster"||t==="image"||t==="video"||t==="custom"}function b_(t,e){const n=1<<t.z;return[t.x/n+e,(t.x+1)/n+e]}jd.maxOverzooming=10,jd.maxUnderzooming=3;class i0{constructor(e,n,o){this._demTile=e,this._dem=this._demTile.dem,this._scale=n,this._offset=o}static create(e,n,o){const u=o||e.findDEMTileFor(n);if(!u||!u.dem)return;const f=u.dem,m=u.tileID,y=1<<n.canonical.z-m.canonical.z;return new i0(u,u.tileSize/$t/y,[(n.canonical.x/y-m.canonical.x)*f.dim,(n.canonical.y/y-m.canonical.y)*f.dim])}tileCoordToPixel(e,n){const o=n*this._scale+this._offset[1],u=Math.floor(e*this._scale+this._offset[0]),f=Math.floor(o);return new Ie(u,f)}getElevationAt(e,n,o,u){const f=e*this._scale+this._offset[0],m=n*this._scale+this._offset[1],y=Math.floor(f),w=Math.floor(m),A=this._dem;return u=!!u,o?xn(xn(A.get(y,w,u),A.get(y,w+1,u),m-w),xn(A.get(y+1,w,u),A.get(y+1,w+1,u),m-w),f-y):A.get(y,w,u)}getElevationAtPixel(e,n,o){return this._dem.get(e,n,!!o)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*ko(1,e)*this._dem.stride}}class Ab{constructor(e,n){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new $l($t,16,0),this.featureIndexArray=new pd,this.promoteId=n}insert(e,n,o,u,f,m=0){const y=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(o,u,f,m);const w=this.grid;for(let A=0;A<n.length;A++){const B=n[A],I=[1/0,1/0,-1/0,-1/0];for(let M=0;M<B.length;M++){const z=B[M];I[0]=Math.min(I[0],z.x),I[1]=Math.min(I[1],z.y),I[2]=Math.max(I[2],z.x),I[3]=Math.max(I[3],z.y)}I[0]<$t&&I[1]<$t&&I[2]>=0&&I[3]>=0&&w.insert(y,I[0],I[1],I[2],I[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Xm(new ah(this.rawTileData)).layers,this.sourceLayerCoder=new ke(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,n,o,u){this.loadVTLayers();const f=e.params||{},m=Lc(f.filter),y=e.tileResult,w=e.transform,A=y.bufferedTilespaceBounds,B=this.grid.query(A.min.x,A.min.y,A.max.x,A.max.y,(R,U,H,ie)=>Hf(y.bufferedTilespaceGeometry,R,U,H,ie));B.sort(sT);let I=null;w.elevation&&B.length>0&&(I=i0.create(w.elevation,this.tileID));const M={};let z;for(let R=0;R<B.length;R++){const U=B[R];if(U===z)continue;z=U;const H=this.featureIndexArray.get(U);let ie=null;this.loadMatchingFeature(M,H,m,f.layers,f.availableImages,n,o,u,(ce,re,ae,_e=0)=>(ie||(ie=Hi(ce,this.tileID.canonical,e.tileTransform)),re.queryIntersectsFeature(y,ce,ae,ie,this.z,e.transform,e.pixelPosMatrix,I,_e)))}return M}loadMatchingFeature(e,n,o,u,f,m,y,w,A){const{featureIndex:B,bucketIndex:I,sourceLayerIndex:M,layoutVertexArrayOffset:z}=n,R=this.bucketLayerIDs[I];if(u&&!function(ce,re){for(let ae=0;ae<ce.length;ae++)if(re.indexOf(ce[ae])>=0)return!0;return!1}(u,R))return;const U=this.sourceLayerCoder.decode(M),H=this.vtLayers[U].feature(B);if(o.needGeometry){const ce=Hu(H,!0);if(!o.filter(new oe(this.tileID.overscaledZ),ce,this.tileID.canonical))return}else if(!o.filter(new oe(this.tileID.overscaledZ),H))return;const ie=this.getId(H,U);for(let ce=0;ce<R.length;ce++){const re=R[ce];if(u&&u.indexOf(re)<0)continue;const ae=m[re];if(!ae)continue;let _e={};ie!==void 0&&w&&(_e=w.getState(ae.sourceLayer||"_geojsonTileLayer",ie));const de=Mt({},y[re]);de.paint=bb(de.paint,ae.paint,H,_e,f),de.layout=bb(de.layout,ae.layout,H,_e,f);const Fe=!A||A(H,ae,_e,z);if(!Fe)continue;const ze=new rt(H,this.z,this.x,this.y,ie);ze.layer=de;let qe=e[re];qe===void 0&&(qe=e[re]=[]),qe.push({featureIndex:B,feature:ze,intersectionZ:Fe})}}lookupSymbolFeatures(e,n,o,u,f,m,y,w){const A={};this.loadVTLayers();const B=Lc(f);for(const I of e)this.loadMatchingFeature(A,{bucketIndex:o,sourceLayerIndex:u,featureIndex:I,layoutVertexArrayOffset:0},B,m,y,w,n);return A}loadFeature(e){const{featureIndex:n,sourceLayerIndex:o}=e;this.loadVTLayers();const u=this.sourceLayerCoder.decode(o),f=this.vtFeatures[u];if(f[n])return f[n];const m=this.vtLayers[u].feature(n);return f[n]=m,m}hasLayer(e){for(const n of this.bucketLayerIDs)for(const o of n)if(e===o)return!0;return!1}getId(e,n){let o=e.id;if(this.promoteId){const u=typeof this.promoteId=="string"?this.promoteId:this.promoteId[n];u!=null&&(o=e.properties[u]),typeof o=="boolean"&&(o=Number(o))}return o}}function bb(t,e,n,o,u){return ar(t,(f,m)=>{const y=e instanceof He?e.get(m):null;return y&&y.evaluate?y.evaluate(n,o,u):y})}function sT(t,e){return e-t}wt(Ab,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class Cb{constructor(e,n){this.width=e,this.height=n,this.nextRow=0,this.image=new il({width:e,height:n}),this.positions={},this.uploaded=!1}getDash(e,n){const o=this.getKey(e,n);return this.positions[o]}trim(){const e=this.width,n=this.height=Qn(this.nextRow);this.image.resize({width:e,height:n})}getKey(e,n){return e.join(",")+n}getDashRanges(e,n,o){const u=[];let f=e.length%2==1?-e[e.length-1]*o:0,m=e[0]*o,y=!0;u.push({left:f,right:m,isDash:y,zeroLength:e[0]===0});let w=e[0];for(let A=1;A<e.length;A++){y=!y;const B=e[A];f=w*o,w+=B,m=w*o,u.push({left:f,right:m,isDash:y,zeroLength:B===0})}return u}addRoundDash(e,n,o){const u=n/2;for(let f=-o;f<=o;f++){const m=this.width*(this.nextRow+o+f);let y=0,w=e[y];for(let A=0;A<this.width;A++){A/w.right>1&&(w=e[++y]);const B=Math.abs(A-w.left),I=Math.abs(A-w.right),M=Math.min(B,I);let z;const R=f/o*(u+1);if(w.isDash){const U=u-Math.abs(R);z=Math.sqrt(M*M+U*U)}else z=u-Math.sqrt(M*M+R*R);this.image.data[m+A]=Math.max(0,Math.min(255,z+128))}}}addRegularDash(e,n){for(let w=e.length-1;w>=0;--w){const A=e[w],B=e[w+1];A.zeroLength?e.splice(w,1):B&&B.isDash===A.isDash&&(B.left=A.left,e.splice(w,1))}const o=e[0],u=e[e.length-1];o.isDash===u.isDash&&(o.left=u.left-this.width,u.right=o.right+this.width);const f=this.width*this.nextRow;let m=0,y=e[m];for(let w=0;w<this.width;w++){w/y.right>1&&(y=e[++m]);const A=Math.abs(w-y.left),B=Math.abs(w-y.right),I=Math.min(A,B);this.image.data[f+w]=Math.max(0,Math.min(255,(y.isDash?I:-I)+n+128))}}addDash(e,n){const o=this.getKey(e,n);if(this.positions[o])return this.positions[o];const u=n==="round",f=u?7:0,m=2*f+1;if(this.nextRow+m>this.height)return er("LineAtlas out of space"),null;e.length===0&&e.push(1);let y=0;for(let B=0;B<e.length;B++)e[B]<0&&(er("Negative value is found in line dasharray, replacing values with 0"),e[B]=0),y+=e[B];if(y!==0){const B=this.width/y,I=this.getDashRanges(e,this.width,B);u?this.addRoundDash(I,B,f):this.addRegularDash(I,n==="square"?.5*B:0)}const w=this.nextRow+f;this.nextRow+=m;const A={tl:[w,f],br:[y,0]};return this.positions[o]=A,A}}wt(Cb,"LineAtlas");class Eb{constructor(e){const n={},o=[];for(const y in e){const w=e[y],A=n[y]={};for(const B in w.glyphs){const I=w.glyphs[+B];if(!I||I.bitmap.width===0||I.bitmap.height===0)continue;const M=I.metrics.localGlyph?2:1,z={x:0,y:0,w:I.bitmap.width+2*M,h:I.bitmap.height+2*M};o.push(z),A[B]=z}}const{w:u,h:f}=fp(o),m=new il({width:u||1,height:f||1});for(const y in e){const w=e[y];for(const A in w.glyphs){const B=w.glyphs[+A];if(!B||B.bitmap.width===0||B.bitmap.height===0)continue;const I=n[y][A],M=B.metrics.localGlyph?2:1;il.copy(B.bitmap,m,{x:0,y:0},{x:I.x+M,y:I.y+M},B.bitmap)}}this.image=m,this.positions=n}}wt(Eb,"GlyphAtlas");class aT{constructor(e){this.tileID=new Oi(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=Qu(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,n,o,u,f){this.status="parsing",this.data=e,this.collisionBoxArray=new jc;const m=new ke(Object.keys(e.layers).sort()),y=new Ab(this.tileID,this.promoteId);y.bucketLayerIDs=[];const w={},A=new Cb(256,256),B={featureIndex:y,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:A,availableImages:o},I=n.familiesBySource[this.source];for(const _e in I){const de=e.layers[_e];if(!de)continue;let Fe=!1,ze=!1;for(const Ge of I[_e])Ge[0].type==="symbol"?Fe=!0:ze=!0;if(this.isSymbolTile===!0&&!Fe||this.isSymbolTile===!1&&!ze)continue;de.version===1&&er(`Vector tile source "${this.source}" layer "${_e}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const qe=m.encode(_e),st=[];for(let Ge=0;Ge<de.length;Ge++){const We=de.feature(Ge),Ze=y.getId(We,_e);st.push({feature:We,id:Ze,index:Ge,sourceLayerIndex:qe})}for(const Ge of I[_e]){const We=Ge[0];this.isSymbolTile!==void 0&&We.type==="symbol"!==this.isSymbolTile||We.minzoom&&this.zoom<Math.floor(We.minzoom)||We.maxzoom&&this.zoom>=We.maxzoom||We.visibility!=="none"&&(S1(Ge,this.zoom,o),(w[We.id]=We.createBucket({index:y.bucketLayerIDs.length,layers:Ge,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:qe,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:o})).populate(st,B,this.tileID.canonical,this.tileTransform),y.bucketLayerIDs.push(Ge.map(Ze=>Ze.id)))}}let M,z,R,U;A.trim();const H={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},ie=ar(B.glyphDependencies,_e=>Object.keys(_e).map(Number));Object.keys(ie).length?u.send("getGlyphs",{uid:this.uid,stacks:ie},(_e,de)=>{M||(M=_e,z=de,ae.call(this))},void 0,!1,H):z={};const ce=Object.keys(B.iconDependencies);ce.length?u.send("getImages",{icons:ce,source:this.source,tileID:this.tileID,type:"icons"},(_e,de)=>{M||(M=_e,R=de,ae.call(this))},void 0,!1,H):R={};const re=Object.keys(B.patternDependencies);function ae(){if(M)return f(M);if(z&&R&&U){const _e=new Eb(z),de=new Kn(R,U);for(const Fe in w){const ze=w[Fe];ze instanceof au?(S1(ze.layers,this.zoom,o),s1(ze,z,_e.positions,R,de.iconPositions,this.showCollisionBoxes,o,this.tileID.canonical,this.tileZoom,this.projection)):ze.hasPattern&&(ze instanceof mo||ze instanceof rp||ze instanceof Zu)&&(S1(ze.layers,this.zoom,o),ze.addFeatures(B,this.tileID.canonical,de.patternPositions,o,this.tileTransform))}this.status="done",f(null,{buckets:Qt(w).filter(Fe=>!Fe.isEmpty()),featureIndex:y,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:_e.image,lineAtlas:A,imageAtlas:de,glyphMap:this.returnDependencies?z:null,iconMap:this.returnDependencies?R:null,glyphPositions:this.returnDependencies?_e.positions:null})}}re.length?u.send("getImages",{icons:re,source:this.source,tileID:this.tileID,type:"patterns"},(_e,de)=>{M||(M=_e,U=de,ae.call(this))},void 0,!1,H):U={},ae.call(this)}}function S1(t,e,n){const o=new oe(e);for(const u of t)u.recalculate(o,n)}class Bb{constructor(e){this.entries={},this.scheduler=e}request(e,n,o,u){const f=this.entries[e]=this.entries[e]||{callbacks:[]};if(f.result){const[m,y]=f.result;return this.scheduler?this.scheduler.add(()=>{u(m,y)},n):u(m,y),()=>{}}return f.callbacks.push(u),f.cancel||(f.cancel=o((m,y)=>{f.result=[m,y];for(const w of f.callbacks)this.scheduler?this.scheduler.add(()=>{w(m,y)},n):w(m,y);setTimeout(()=>delete this.entries[e],3e3)})),()=>{f.result||(f.callbacks=f.callbacks.filter(m=>m!==u),f.callbacks.length||(f.cancel(),delete this.entries[e]))}}}function Tb(t,e,n){const o=JSON.stringify(t.request);return t.data&&(this.deduped.entries[o]={result:[null,t.data]}),this.deduped.request(o,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom},u=>{const f=Vo(t.request,(m,y,w,A)=>{m?u(m):y&&u(null,{vectorTile:n?void 0:new Xm(new ah(y)),rawData:y,cacheControl:w,expires:A})});return()=>{f.cancel(),u()}},e)}s.ARRAY_TYPE=ho,s.AUTH_ERR_MSG=Al,s.Aabb=Ri,s.Actor=class{constructor(t,e,n){this.target=t,this.parent=e,this.mapId=n,this.callbacks={},this.cancelCallbacks={},jt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=fi()?t:N,this.scheduler=new xe}send(t,e,n,o,u=!1,f){const m=Math.round(1e18*Math.random()).toString(36).substring(0,10);n&&(n.metadata=f,this.callbacks[m]=n);const y=Ra(this.globalScope)?void 0:[];return this.target.postMessage({id:m,type:t,hasCallback:!!n,targetMapId:o,mustQueue:u,sourceMapId:this.mapId,data:Gu(e,y)},y),{cancel:()=>{n&&delete this.callbacks[m],this.target.postMessage({id:m,type:"<cancel>",targetMapId:o,sourceMapId:this.mapId})}}}receive(t){const e=t.data,n=e.id;if(n&&(!e.targetMapId||this.mapId===e.targetMapId))if(e.type==="<cancel>"){const o=this.cancelCallbacks[n];delete this.cancelCallbacks[n],o&&o.cancel()}else if(e.mustQueue||fi()){const o=this.callbacks[n];this.cancelCallbacks[n]=this.scheduler.add(()=>this.processTask(n,e),o&&o.metadata||{type:"message"})}else this.processTask(n,e)}processTask(t,e){if(e.type==="<response>"){const n=this.callbacks[t];delete this.callbacks[t],n&&(e.error?n(da(e.error)):n(null,da(e.data)))}else{const n=Ra(this.globalScope)?void 0:[],o=e.hasCallback?(f,m)=>{delete this.cancelCallbacks[t],this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:f?Gu(f):null,data:Gu(m,n)},n)}:f=>{},u=da(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,u,o);else if(this.parent.getWorkerSource){const f=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,f[0],u.source)[f[1]](u,o)}else o(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},s.CanonicalTileID=rh,s.Color=_r,s.ColorMode=lu,s.CullFaceMode=ul,s.DEMData=r0,s.DataConstantProperty=Me,s.DedupedRequest=Bb,s.DepthMode=Dp,s.EXTENT=$t,s.Elevation=class{isDataAvailableAtPoint(t){const e=this._source();if(this.isUsingMockSource()||!e||t.y<0||t.y>1)return!1;const n=e.getSource().maxzoom,o=1<<n,u=Math.floor(t.x),f=Math.floor((t.x-u)*o),m=Math.floor(t.y*o),y=this.findDEMTileFor(new Oi(n,u,n,f,m));return!(!y||!y.dem)}getAtPointOrZero(t,e=0){return this.getAtPoint(t,e)||0}getAtPoint(t,e,n=!0){if(this.isUsingMockSource())return null;e==null&&(e=null);const o=this._source();if(!o||t.y<0||t.y>1)return e;const u=o.getSource().maxzoom,f=1<<u,m=Math.floor(t.x),y=t.x-m,w=new Oi(u,m,u,Math.floor(y*f),Math.floor(t.y*f)),A=this.findDEMTileFor(w);if(!A||!A.dem)return e;const B=A.dem,I=1<<A.tileID.canonical.z,M=(y*I-A.tileID.canonical.x)*B.dim,z=(t.y*I-A.tileID.canonical.y)*B.dim,R=Math.floor(M),U=Math.floor(z);return(n?this.exaggeration():1)*xn(xn(B.get(R,U),B.get(R,U+1),z-U),xn(B.get(R+1,U),B.get(R+1,U+1),z-U),M-R)}getAtTileOffset(t,e,n){const o=1<<t.canonical.z;return this.getAtPointOrZero(new Ql(t.wrap+(t.canonical.x+e/$t)/o,(t.canonical.y+n/$t)/o))}getAtTileOffsetFunc(t,e,n,o){return u=>{const f=this.getAtTileOffset(t,u.x,u.y),m=o.upVector(t.canonical,u.x,u.y);return Lo(m,m,f*o.upVectorScale(t.canonical,e,n).metersToTile),m}}getForTilePoints(t,e,n,o){if(this.isUsingMockSource())return!1;const u=i0.create(this,t,o);return!!u&&(e.forEach(f=>{f[2]=this.exaggeration()*u.getElevationAt(f[0],f[1],n)}),!0)}getMinMaxForTile(t){if(this.isUsingMockSource())return null;const e=this.findDEMTileFor(t);if(!e||!e.dem)return null;const n=e.dem.tree,o=e.tileID,u=1<<t.canonical.z-o.canonical.z;let f=t.canonical.x/u-o.canonical.x,m=t.canonical.y/u-o.canonical.y,y=0;for(let w=0;w<t.canonical.z-o.canonical.z&&!n.leaves[y];w++){f*=2,m*=2;const A=2*Math.floor(m)+Math.floor(f);y=n.childOffsets[y]+A,f%=1,m%=1}return{min:this.exaggeration()*n.minimums[y],max:this.exaggeration()*n.maximums[y]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(t,e,n){throw new Error("Pure virtual method called.")}pointCoordinate(t){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(t){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},s.ErrorEvent=ea,s.EvaluationParameters=oe,s.Event=In,s.Evented=As,s.FillExtrusionBucket=Zu,s.Frustum=qm,s.FrustumCorners=fo,s.GLOBE_METERS_TO_ECEF=p_,s.GLOBE_RADIUS=ll,s.GLOBE_SCALE_MATCH_LATITUDE=45,s.GLOBE_ZOOM_THRESHOLD_MAX=6,s.GLOBE_ZOOM_THRESHOLD_MIN=5,s.GlobeSharedBuffers=class{constructor(t){this._createGrid(t),this._createPoles(t)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const t of this._poleSegments)t.destroy();for(const t of this._gridSegments)t.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const t of this._wireframeSegments)t.destroy()}}_createGrid(t){const e=new on,n=new Yr,o=65;for(let u=0;u<o;u++)for(let f=0;f<o;f++)e.emplaceBack(f,u);this._gridSegments=[];for(let u=0,f=0;u<fh.length;u++){const m=fh[u];for(let w=0;w<m;w++)for(let A=0;A<64;A++){const B=w*o+A;n.emplaceBack(B+1,B,B+o),n.emplaceBack(B+o,B+o+1,B+1)}const y=64*m*2;this._gridSegments.push(kr.simpleSegment(0,f,(m+1)*o,y)),f+=y}this._gridBuffer=t.createVertexBuffer(e,Rd.members),this._gridIndexBuffer=t.createIndexBuffer(n,!0)}_createPoles(t){const e=new Yr;for(let u=0;u<=dh;u++)e.emplaceBack(0,u+1,u+2);this._poleIndexBuffer=t.createIndexBuffer(e,!0);const n=new os,o=new os;this._poleSegments=[];for(let u=0,f=0;u<5;u++){const m=360/(1<<u);n.emplaceBack(0,-ll,0,.5,0),o.emplaceBack(0,-ll,0,.5,1);for(let y=0;y<=dh;y++){const w=y/dh,A=xn(0,m,w),[B,I,M]=su(g_,f1,A,ll);n.emplaceBack(B,I,M,w,0),o.emplaceBack(B,I,M,w,1)}this._poleSegments.push(kr.simpleSegment(f,0,66,64)),f+=66}this._poleNorthVertexBuffer=t.createVertexBuffer(n,qy,!1),this._poleSouthVertexBuffer=t.createVertexBuffer(o,qy,!1)}getGridBuffers(t){return[this._gridBuffer,this._gridIndexBuffer,this._gridSegments[t]]}getPoleBuffers(t){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[t]]}getWirefameBuffers(t,e){if(!this._wireframeSegments){const n=new Ai,o=dh,u=o+1;this._wireframeSegments=[];for(let f=0,m=0;f<fh.length;f++){const y=fh[f];for(let A=0;A<y;A++)for(let B=0;B<o;B++){const I=A*u+B;n.emplaceBack(I,I+1),n.emplaceBack(I,I+u),n.emplaceBack(I,I+u+1)}const w=y*o*3;this._wireframeSegments.push(kr.simpleSegment(0,m,(y+1)*u,w)),m+=w}this._wireframeIndexBuffer=t.createIndexBuffer(n)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[e]]}},s.GlyphManager=ch,s.ImagePosition=o_,s.LivePerformanceUtils=Je,s.LngLat=bn,s.LngLatBounds=Ls,s.LocalGlyphMode=c_,s.MAX_MERCATOR_LATITUDE=ga,s.MercatorCoordinate=Ql,s.ONE_EM=li,s.OverscaledTileID=Oi,s.PerformanceMarkers=Pe,s.Properties=ct,s.RGBAImage=po,s.Ray=Um,s.RequestManager=class{constructor(t,e,n){this._transformRequestFn=t,this._customAccessToken=e,this._silenceAuthErrors=!!n,this._createSkuToken()}_createSkuToken(){const t=function(){let e="";for(let n=0;n<10;n++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ge,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}}normalizeStyleURL(t,e){if(!to(t))return t;const n=Mi(t);return n.path=`/styles/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||e)}normalizeGlyphsURL(t,e){if(!to(t))return t;const n=Mi(t);return n.path=`/fonts/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||e)}normalizeSourceURL(t,e,n,o){if(!to(t))return t;const u=Mi(t);return u.path=`/v4/${u.authority}.json`,u.params.push("secure"),n&&u.params.push(`language=${n}`),o&&u.params.push(`worldview=${o}`),this._makeAPIURL(u,this._customAccessToken||e)}normalizeSpriteURL(t,e,n,o){const u=Mi(t);return to(t)?(u.path=`/styles/v1${u.path}/sprite${e}${n}`,this._makeAPIURL(u,this._customAccessToken||o)):(u.path+=`${e}${n}`,Ys(u))}normalizeTileURL(t,e,n){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!to(t))return t;const o=Mi(t);o.path=o.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||n&&o.authority!=="raster"&&n===512?"@2x":""}${Ae.supported?".webp":"$1"}`),o.authority==="raster"?o.path=`/${we.RASTER_URL_PREFIX}${o.path}`:(o.path=o.path.replace(/^.+\/v4\//,"/"),o.path=`/${we.TILE_URL_VERSION}${o.path}`);const u=this._customAccessToken||function(f){for(const m of f){const y=m.match(/^access_token=(.*)$/);if(y)return y[1]}return null}(o.params)||we.ACCESS_TOKEN;return we.REQUIRE_ACCESS_TOKEN&&u&&this._skuToken&&o.params.push(`sku=${this._skuToken}`),this._makeAPIURL(o,u)}canonicalizeTileURL(t,e){const n=Mi(t);if(!n.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!n.path.match(/\.[\w]+$/))return t;let o="mapbox://";n.path.match(/^\/raster\/v1\//)?o+=`raster/${n.path.replace(`/${we.RASTER_URL_PREFIX}/`,"")}`:o+=`tiles/${n.path.replace(`/${we.TILE_URL_VERSION}/`,"")}`;let u=n.params;return e&&(u=u.filter(f=>!f.match(/^access_token=/))),u.length&&(o+=`?${u.join("&")}`),o}canonicalizeTileset(t,e){const n=!!e&&to(e),o=[];for(const u of t.tiles||[])Na(u)?o.push(this.canonicalizeTileURL(u,n)):o.push(u);return o}_makeAPIURL(t,e){const n="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",o=Mi(we.API_URL);if(t.protocol=o.protocol,t.authority=o.authority,t.protocol==="http"){const u=t.params.indexOf("secure");u>=0&&t.params.splice(u,1)}if(o.path!=="/"&&(t.path=`${o.path}${t.path}`),!we.REQUIRE_ACCESS_TOKEN)return Ys(t);if(e=e||we.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${n}`);if(e[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${n}`)}return t.params=t.params.filter(u=>u.indexOf("access_token")===-1),t.params.push(`access_token=${e||""}`),Ys(t)}},s.ResourceType=pi,s.SegmentVector=kr,s.SourceCache=jd,s.StencilMode=B1,s.StructArrayLayout1ui2=qc,s.StructArrayLayout2f1f2i16=zi,s.StructArrayLayout2i4=on,s.StructArrayLayout2ui4=Ai,s.StructArrayLayout3f12=ao,s.StructArrayLayout3ui6=Yr,s.StructArrayLayout4i8=Nn,s.StructArrayLayout5f20=os,s.Texture=Q,s.Tile=bi,s.Transitionable=Oe,s.Uniform1f=Nf,s.Uniform1i=class extends pa{constructor(t){super(t),this.current=0}set(t,e,n){this.fetchUniformLocation(t,e)&&this.current!==n&&(this.current=n,this.gl.uniform1i(this.location,n))}},s.Uniform2f=class extends pa{constructor(t){super(t),this.current=[0,0]}set(t,e,n){this.fetchUniformLocation(t,e)&&(n[0]===this.current[0]&&n[1]===this.current[1]||(this.current=n,this.gl.uniform2f(this.location,n[0],n[1])))}},s.Uniform3f=class extends pa{constructor(t){super(t),this.current=[0,0,0]}set(t,e,n){this.fetchUniformLocation(t,e)&&(n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]||(this.current=n,this.gl.uniform3f(this.location,n[0],n[1],n[2])))}},s.Uniform4f=Im,s.UniformColor=Mm,s.UniformMatrix2f=class extends pa{constructor(t){super(t),this.current=ex}set(t,e,n){if(this.fetchUniformLocation(t,e)){for(let o=0;o<4;o++)if(n[o]!==this.current[o]){this.current=n,this.gl.uniformMatrix2fv(this.location,!1,n);break}}}},s.UniformMatrix3f=class extends pa{constructor(t){super(t),this.current=ma}set(t,e,n){if(this.fetchUniformLocation(t,e)){for(let o=0;o<9;o++)if(n[o]!==this.current[o]){this.current=n,this.gl.uniformMatrix3fv(this.location,!1,n);break}}}},s.UniformMatrix4f=class extends pa{constructor(t){super(t),this.current=uo}set(t,e,n){if(this.fetchUniformLocation(t,e)){if(n[12]!==this.current[12]||n[0]!==this.current[0])return this.current=n,void this.gl.uniformMatrix4fv(this.location,!1,n);for(let o=1;o<16;o++)if(n[o]!==this.current[o]){this.current=n,this.gl.uniformMatrix4fv(this.location,!1,n);break}}}},s.UnwrappedTileID=n_,s.ValidationError=vt,s.VectorTileFeature=sp,s.VectorTileWorkerSource=class extends As{constructor(t,e,n,o,u){super(),this.actor=t,this.layerIndex=e,this.availableImages=n,this.loadVectorData=u||Tb,this.loading={},this.loaded={},this.deduped=new Bb(t.scheduler),this.isSpriteLoaded=o,this.scheduler=t.scheduler}loadTile(t,e){const n=t.uid,o=t&&t.request,u=o&&o.collectResourceTiming,f=this.loading[n]=new aT(t);f.abort=this.loadVectorData(t,(m,y)=>{const w=!this.loading[n];if(delete this.loading[n],w||m||!y)return f.status="done",w||(this.loaded[n]=f),e(m);const A=y.rawData,B={};y.expires&&(B.expires=y.expires),y.cacheControl&&(B.cacheControl=y.cacheControl),f.vectorTile=y.vectorTile||new Xm(new ah(A));const I=()=>{f.parse(f.vectorTile,this.layerIndex,this.availableImages,this.actor,(M,z)=>{if(M||!z)return e(M);const R={};if(u){const U=Nt(o);U.length>0&&(R.resourceTiming=JSON.parse(JSON.stringify(U)))}e(null,Mt({rawTileData:A.slice(0)},z,B,R))})};this.isSpriteLoaded?I():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(I,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom}):I()}),this.loaded=this.loaded||{},this.loaded[n]=f})}reloadTile(t,e){const n=this.loaded,o=t.uid,u=this;if(n&&n[o]){const f=n[o];f.showCollisionBoxes=t.showCollisionBoxes,f.enableTerrain=!!t.enableTerrain,f.projection=t.projection,f.tileTransform=Qu(t.tileID.canonical,t.projection);const m=(y,w)=>{const A=f.reloadCallback;A&&(delete f.reloadCallback,f.parse(f.vectorTile,u.layerIndex,this.availableImages,u.actor,A)),e(y,w)};f.status==="parsing"?f.reloadCallback=m:f.status==="done"&&(f.vectorTile?f.parse(f.vectorTile,this.layerIndex,this.availableImages,this.actor,m):m())}}abortTile(t,e){const n=t.uid,o=this.loading[n];o&&(o.abort&&o.abort(),delete this.loading[n]),e()}removeTile(t,e){const n=this.loaded,o=t.uid;n&&n[o]&&delete n[o],e()}},s.WritingMode=Fo,s.ZoomHistory=Bf,s.add=xa,s.addDynamicAttributes=Bp,s.adjoint=function(t,e){var n=e[0],o=e[1],u=e[2],f=e[3],m=e[4],y=e[5],w=e[6],A=e[7],B=e[8];return t[0]=m*B-y*A,t[1]=u*A-o*B,t[2]=o*y-u*m,t[3]=y*w-f*B,t[4]=n*B-u*w,t[5]=u*f-n*y,t[6]=f*A-m*w,t[7]=o*w-n*A,t[8]=n*m-o*f,t},s.asyncAll=xt,s.bezier=ir,s.bindAll=jt,s.boundsAttributes=Mn,s.bufferConvexPolygon=function(t,e){const n=[];for(let o=0;o<t.length;o++){const u=fr(o-1,-1,t.length-1),f=fr(o+1,-1,t.length-1),m=t[o],y=t[f],w=t[u].sub(m).unit(),A=y.sub(m).unit(),B=A.angleWithSep(w.x,w.y),I=w.add(A).unit().mult(-1*e/Math.sin(B/2));n.push(m.add(I))}return n},s.cacheEntryPossiblyAdded=function(t){Zs++,Zs>ws&&(t.getActor().send("enforceCacheSizeLimit",yl),Zs=0)},s.calculateGlobeLabelMatrix=function(t,e){const{x:n,y:o}=t.point,u=Ky(n,o,t.worldSize/t._pixelsPerMercatorPixel,0,0);return Zc(u,u,Gd(Ea(e)))},s.calculateGlobeMatrix=function(t){const{x:e,y:n}=t.point,{lng:o,lat:u}=t._center;return Ky(e,n,t.worldSize,o,u)},s.calculateGlobeMercatorMatrix=function(t){const e=t.pixelsPerMeter,n=e/ko(1,t.center.lat),o=Fs(new Float64Array(16));return $u(o,o,[t.point.x,t.point.y,0]),eu(o,o,[n,n,e]),Float32Array.from(o)},s.circumferenceAtLatitude=qf,s.clamp=en,s.clearTileCache=function(t){if(!vl())return;const e=N.caches.delete(Ii);t&&e.catch(t).then(()=>t())},s.clipLine=Ly,s.clone=function(t){var e=new ho(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},s.clone$1=Ui,s.collisionCircleLayout=$x,s.config=we,s.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},s.create=function(){var t=new ho(16);return ho!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},s.create$1=Og,s.createExpression=la,s.createLayout=ht,s.createStyleLayer=function(t){return t.type==="custom"?new _(t):new q[t.type](t)},s.cross=Nm,s.degToRad=Et,s.distance=function(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2])},s.div=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t},s.dot=ls,s.earthRadius=vd,s.ease=hi,s.easeCubicInOut=Wr,s.ecefToLatLng=function([t,e,n]){const o=Math.hypot(t,e,n),u=Math.atan2(t,n),f=.5*Math.PI-Math.acos(-e/o);return new bn(Ot(u),Ot(f))},s.emitValidationErrors=Ms,s.endsWith=St,s.enforceCacheSizeLimit=function(t){eo(),Gr&&Gr.then(e=>{e.keys().then(n=>{for(let o=0;o<n.length-t;o++)e.delete(n[o])})})},s.evaluateSizeForFeature=oh,s.evaluateSizeForZoom=sh,s.evaluateVariableOffset=Ny,s.evented=te,s.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},s.exactEquals$1=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},s.exported=Tn,s.exported$1=Ae,s.extend=Mt,s.extend$1=Ho,s.fillExtrusionHeightLift=dy,s.filterObject=pr,s.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},s.fromQuat=function(t,e){var n=e[0],o=e[1],u=e[2],f=e[3],m=n+n,y=o+o,w=u+u,A=n*m,B=o*m,I=o*y,M=u*m,z=u*y,R=u*w,U=f*m,H=f*y,ie=f*w;return t[0]=1-I-R,t[1]=B+ie,t[2]=M-H,t[3]=0,t[4]=B-ie,t[5]=1-A-R,t[6]=z+U,t[7]=0,t[8]=M+H,t[9]=z-U,t[10]=1-A-I,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},s.fromRotation=function(t,e){var n=Math.sin(e),o=Math.cos(e);return t[0]=o,t[1]=n,t[2]=0,t[3]=-n,t[4]=o,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},s.fromScaling=Rm,s.furthestTileCorner=function(t){const e=Math.round((t+45+360)%360/90)%4;return dr[e]},s.getAABBPointSquareDist=function(t,e,n){let o=0;for(let u=0;u<2;++u){const f=n?n[u]:0;t[u]>f&&(o+=(t[u]-f)*(t[u]-f)),e[u]<f&&(o+=(f-e[u])*(f-e[u]))}return o},s.getAnchorAlignment=l_,s.getAnchorJustification=h_,s.getBounds=function(t){let e=1/0,n=1/0,o=-1/0,u=-1/0;for(const f of t)e=Math.min(e,f.x),n=Math.min(n,f.y),o=Math.max(o,f.x),u=Math.max(u,f.y);return{min:new Ie(e,n),max:new Ie(o,u)}},s.getColumn=Yi,s.getGridMatrix=function(t,e,n,o){const u=e.getNorth(),f=e.getSouth(),m=e.getWest(),y=e.getEast(),w=1<<t.z,A=y-m,B=u-f,I=A/dh,M=-B/fh[n],z=[0,I,0,M,0,0,u,m,0];if(t.z>0){const R=180/o;Gg(z,z,[R/A+1,0,0,0,R/B+1,0,-.5*R/I,.5*R/M,1])}return z[2]=w,z[5]=t.x,z[8]=t.y,z},s.getImage=wl,s.getJSON=function(t,e){return jo(Mt(t,{type:"json"}),e)},s.getLatitudinalLod=function(t){const e=80.051129;t=en(t,-80.051129,e)/e*90;const n=Math.pow(Math.abs(Math.sin(Et(t))),3);return Math.round(n*(fh.length-1))},s.getMapSessionAPI=Te,s.getPerformanceMeasurement=Nt,s.getProjection=t0,s.getRTLTextPluginStatus=J,s.getReferrer=Js,s.getTilePoint=function(t,{x:e,y:n},o=0){return new Ie(((e-o)*t.scale-t.x)*$t,(n*t.scale-t.y)*$t)},s.getTileVec3=function(t,e,n=0){return Xc(((e.x-n)*t.scale-t.x)*$t,(e.y*t.scale-t.y)*$t,kg(e.z,e.y))},s.getVideo=function(t,e){const n=N.document.createElement("video");n.muted=!0,n.onloadstart=function(){e(null,n)};for(let o=0;o<t.length;o++){const u=N.document.createElement("source");Ga(t[o])||(n.crossOrigin="Anonymous"),u.src=t[o],n.appendChild(u)}return{cancel:()=>{}}},s.globeCenterToScreenPoint=function(t){const e=[0,0,0],n=Fs(new Float64Array(16));return Zc(n,t.pixelMatrix,t.globeMatrix),Pr(e,e,n),new Ie(e[0],e[1])},s.globeDenormalizeECEF=Gd,s.globeECEFOrigin=function(t,e){const n=[0,0,0];return Pr(n,n,Od(Ea(e.canonical))),Pr(n,n,t),n},s.globeNormalizeECEF=Od,s.globePixelsToTileUnits=function(t,e){return $t/(512*Math.pow(2,t))*xp(Ea(e))},s.globePoleMatrixForTile=function(t,e,n){const o=Fs(new Float64Array(16)),u=(e/(1<<t)-.5)*Math.PI*2;return Jc(o,n.globeMatrix,u),Float32Array.from(o)},s.globeTileBounds=Ea,s.globeTiltAtLngLat=Zy,s.globeToMercatorTransition=_h,s.globeUseCustomAntiAliasing=function(t,e,n){const o=_h(n.zoom),u=t.style.map._antialias,f=!!e.extStandardDerivatives,m=e.extStandardDerivativesForceOff||t.terrain&&t.terrain.exaggeration()>0;return o===0&&!u&&!m&&f},s.identity=Fs,s.identity$1=$g,s.invert=Kf,s.isFullscreen=function(){return!!N.document.fullscreenElement||!!N.document.webkitFullscreenElement},s.isLngLatBehindGlobe=function(t,e){return Zy(t,e)>Math.PI/2*1.01},s.isMapAuthenticated=function(t){return ye.has(t)},s.isMapboxURL=to,s.isSafariWithAntialiasingBug=function(t){const e=t.navigator?t.navigator.userAgent:null;return!!Ra(t)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},s.latFromMercatorY=ei,s.latLngToECEF=ph,s.len=sx,s.length=Os,s.length$1=function(t){return Math.hypot(t[0],t[1],t[2],t[3])},s.lngFromMercatorX=Po,s.loadVectorTile=Tb,s.makeRequest=jo,s.mapValue=function(t,e,n,o,u){return en((t-e)/(n-e)*(u-o)+o,o,u)},s.mercatorScale=ya,s.mercatorXfromLng=si,s.mercatorYfromLat=zs,s.mercatorZfromAltitude=ko,s.mul=Zf,s.mul$1=qg,s.multiply=Zc,s.multiply$1=Gg,s.multiply$2=Ng,s.nextPowerOfTwo=Qn,s.normalize=Fi,s.normalize$1=ax,s.normalize$2=Vg,s.number=xn,s.ortho=function(t,e,n,o,u,f,m){var y=1/(e-n),w=1/(o-u),A=1/(f-m);return t[0]=-2*y,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*w,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*A,t[11]=0,t[12]=(e+n)*y,t[13]=(u+o)*w,t[14]=(m+f)*A,t[15]=1,t},s.pbf=ah,s.perspective=function(t,e,n,o,u){var f,m=1/Math.tan(e/2);return t[0]=m/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=m,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,u!=null&&u!==1/0?(t[10]=(u+o)*(f=1/(o-u)),t[14]=2*u*o*f):(t[10]=-1,t[14]=-2*o),t},s.pick=function(t,e){const n={};for(let o=0;o<e.length;o++){const u=e[o];u in t&&(n[u]=t[u])}return n},s.plugin=ue,s.pointGeometry=Ie,s.polygonContainsPoint=Ur,s.polygonIntersectsBox=Hf,s.polygonIntersectsPolygon=Pg,s.polygonizeBounds=function(t,e,n=0,o=!0){const u=new Ie(n,n),f=t.sub(u),m=e.add(u),y=[f,new Ie(m.x,f.y),m,new Ie(f.x,m.y)];return o&&y.push(f.clone()),y},s.posAttributes=Rd,s.postMapLoadEvent=ee,s.postPerformanceEvent=me,s.postTurnstileEvent=O,s.potpack=fp,s.prevPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},s.radToDeg=Ot,s.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.registerForPluginStateChange=function(t){return t({pluginStatus:Z,pluginURL:Y}),te.on("pluginStateChange",t),t},s.removeAuthState=function(t){ye.delete(t)},s.renderColorRamp=Vm,s.resample=jf,s.rotateX=Wu,s.rotateX$1=Wg,s.rotateY=Jc,s.rotateY$1=Kg,s.rotateZ=function(t,e,n){var o=Math.sin(n),u=Math.cos(n),f=e[0],m=e[1],y=e[2],w=e[3],A=e[4],B=e[5],I=e[6],M=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=f*u+A*o,t[1]=m*u+B*o,t[2]=y*u+I*o,t[3]=w*u+M*o,t[4]=A*u-f*o,t[5]=B*u-m*o,t[6]=I*u-y*o,t[7]=M*u-w*o,t},s.rotateZ$1=function(t,e,n){n*=.5;var o=e[0],u=e[1],f=e[2],m=e[3],y=Math.sin(n),w=Math.cos(n);return t[0]=o*w+u*y,t[1]=u*w-o*y,t[2]=f*w+m*y,t[3]=m*w-f*y,t},s.scale=eu,s.scale$1=jg,s.scale$2=Lo,s.scaleAndAdd=Ed,s.set=function(t,e,n,o){return t[0]=e,t[1]=n,t[2]=o,t},s.setCacheLimits=function(t,e){yl=t,ws=e},s.setColumn=function(t,e,n){t[4*e+0]=n[0],t[4*e+1]=n[1],t[4*e+2]=n[2],t[4*e+3]=n[3]},s.setRTLTextPlugin=function(t,e,n=!1){if(Z===L||Z===G||Z===V)throw new Error("setRTLTextPlugin cannot be called multiple times.");Y=Tn.resolveURL(t),Z=L,X=e,$(),n||le()},s.smoothstep=di,s.spec=Ne,s.squaredLength=function(t){var e=t[0],n=t[1],o=t[2];return e*e+n*n+o*o},s.storeAuthState=function(t,e){e?ye.add(t):ye.delete(t)},s.sub=us,s.subtract=Gm,s.symbolSize=ol,s.tileAABB=function(t,e,n,o,u,f,m,y,w){if(w.name==="globe")return d1(t,e,new rh(n,o,u));const A=Qu({z:n,x:o,y:u},w);return new Ri([(f+A.x/A.scale)*e,e*(A.y/A.scale),m],[(f+A.x2/A.scale)*e,e*(A.y2/A.scale),y])},s.tileCornersToBounds=vp,s.tileTransform=Qu,s.transformMat3=function(t,e,n){var o=e[0],u=e[1],f=e[2];return t[0]=o*n[0]+u*n[3]+f*n[6],t[1]=o*n[1]+u*n[4]+f*n[7],t[2]=o*n[2]+u*n[5]+f*n[8],t},s.transformMat4=Pr,s.transformMat4$1=tu,s.transformQuat=Ug,s.transitionTileAABBinECEF=Hy,s.translate=$u,s.transpose=function(t,e){if(t===e){var n=e[1],o=e[2],u=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=o,t[7]=u}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},s.triggerPluginCompletionEvent=W,s.uniqueId=Ln,s.updateGlobeVertexNormal=function(t,e,n,o,u){const f=5*e+2;t.float32[f+0]=n,t.float32[f+1]=o,t.float32[f+2]=u},s.validateCustomStyleLayer=function(t){const e=[],n=t.id;return n===void 0&&e.push({message:`layers.${n}: missing required property "id"`}),t.render===void 0&&e.push({message:`layers.${n}: missing required method "render"`}),t.renderingMode&&t.renderingMode!=="2d"&&t.renderingMode!=="3d"&&e.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),e},s.validateFilter=t=>Is(Ds(t)),s.validateFog=t=>Is(K(t)),s.validateLayer=t=>Is(ld(t)),s.validateLight=t=>Is(Ss(t)),s.validateSource=t=>Is(Ya(t)),s.validateStyle=An,s.validateTerrain=t=>Is(Rc(t)),s.values=Qt,s.vectorTile=ip,s.version=pe,s.warnOnce=er,s.window=N,s.wrap=fr}),D(["./shared"],function(s){function N(ne){if(typeof ne=="number"||typeof ne=="boolean"||typeof ne=="string"||ne==null)return JSON.stringify(ne);if(Array.isArray(ne)){let j="[";for(const ee of ne)j+=`${N(ee)},`;return`${j}]`}let O="{";for(const j of Object.keys(ne).sort())O+=`${j}:${N(ne[j])},`;return`${O}}`}function pe(ne){let O="";for(const j of s.refProperties)O+=`/${N(ne[j])}`;return O}class Re{constructor(O){this.keyCache={},O&&this.replace(O)}replace(O){this._layerConfigs={},this._layers={},this.update(O,[])}update(O,j){for(const se of O)this._layerConfigs[se.id]=se,(this._layers[se.id]=s.createStyleLayer(se)).compileFilter(),this.keyCache[se.id]&&delete this.keyCache[se.id];for(const se of j)delete this.keyCache[se],delete this._layerConfigs[se],delete this._layers[se];this.familiesBySource={};const ee=function(se,me){const De={};for(let ye=0;ye<se.length;ye++){const Pe=me&&me[se[ye].id]||pe(se[ye]);me&&(me[se[ye].id]=Pe);let Je=De[Pe];Je||(Je=De[Pe]=[]),Je.push(se[ye])}const Te=[];for(const ye in De)Te.push(De[ye]);return Te}(s.values(this._layerConfigs),this.keyCache);for(const se of ee){const me=se.map(yt=>this._layers[yt.id]),De=me[0];if(De.visibility==="none")continue;const Te=De.source||"";let ye=this.familiesBySource[Te];ye||(ye=this.familiesBySource[Te]={});const Pe=De.sourceLayer||"_geojsonTileLayer";let Je=ye[Pe];Je||(Je=ye[Pe]=[]),Je.push(me)}}}class we{loadTile(O,j){const{uid:ee,encoding:se,rawImageData:me,padding:De,buildQuadTree:Te}=O,ye=s.window.ImageBitmap&&me instanceof s.window.ImageBitmap?this.getImageData(me,De):me;j(null,new s.DEMData(ee,ye,se,De<1,Te))}getImageData(O,j){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(O.width,O.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=O.width,this.offscreenCanvas.height=O.height,this.offscreenCanvasContext.drawImage(O,0,0,O.width,O.height);const ee=this.offscreenCanvasContext.getImageData(-j,-j,O.width+2*j,O.height+2*j);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),ee}}var Ae=function ne(O,j){var ee,se=O&&O.type;if(se==="FeatureCollection")for(ee=0;ee<O.features.length;ee++)ne(O.features[ee],j);else if(se==="GeometryCollection")for(ee=0;ee<O.geometries.length;ee++)ne(O.geometries[ee],j);else if(se==="Feature")ne(O.geometry,j);else if(se==="Polygon")$e(O.coordinates,j);else if(se==="MultiPolygon")for(ee=0;ee<O.coordinates.length;ee++)$e(O.coordinates[ee],j);return O};function $e(ne,O){if(ne.length!==0){Qe(ne[0],O);for(var j=1;j<ne.length;j++)Qe(ne[j],!O)}}function Qe(ne,O){for(var j=0,ee=0,se=0,me=ne.length,De=me-1;se<me;De=se++){var Te=(ne[se][0]-ne[De][0])*(ne[De][1]+ne[se][1]),ye=j+Te;ee+=Math.abs(j)>=Math.abs(Te)?j-ye+Te:Te-ye+j,j=ye}j+ee>=0!=!!O&&ne.reverse()}const ot=s.VectorTileFeature.prototype.toGeoJSON;class Vt{constructor(O){this._feature=O,this.extent=s.EXTENT,this.type=O.type,this.properties=O.tags,"id"in O&&!isNaN(O.id)&&(this.id=parseInt(O.id,10))}loadGeometry(){if(this._feature.type===1){const O=[];for(const j of this._feature.geometry)O.push([new s.pointGeometry(j[0],j[1])]);return O}{const O=[];for(const j of this._feature.geometry){const ee=[];for(const se of j)ee.push(new s.pointGeometry(se[0],se[1]));O.push(ee)}return O}}toGeoJSON(O,j,ee){return ot.call(this,O,j,ee)}}class be{constructor(O){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.EXTENT,this.length=O.length,this._features=O}feature(O){return new Vt(this._features[O])}}var ge={exports:{}},Be=s.pointGeometry,Xe=s.vectorTile.VectorTileFeature,Ie=at;function at(ne,O){this.options=O||{},this.features=ne,this.length=ne.length}function ft(ne,O){this.id=typeof ne.id=="number"?ne.id:void 0,this.type=ne.type,this.rawGeometry=ne.type===1?[ne.geometry]:ne.geometry,this.properties=ne.tags,this.extent=O||4096}at.prototype.feature=function(ne){return new ft(this.features[ne],this.options.extent)},ft.prototype.loadGeometry=function(){var ne=this.rawGeometry;this.geometry=[];for(var O=0;O<ne.length;O++){for(var j=ne[O],ee=[],se=0;se<j.length;se++)ee.push(new Be(j[se][0],j[se][1]));this.geometry.push(ee)}return this.geometry},ft.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ne=this.geometry,O=1/0,j=-1/0,ee=1/0,se=-1/0,me=0;me<ne.length;me++)for(var De=ne[me],Te=0;Te<De.length;Te++){var ye=De[Te];O=Math.min(O,ye.x),j=Math.max(j,ye.x),ee=Math.min(ee,ye.y),se=Math.max(se,ye.y)}return[O,ee,j,se]},ft.prototype.toGeoJSON=Xe.prototype.toGeoJSON;var Ct=s.pbf,Et=Ie;function Ot(ne){var O=new Ct;return function(j,ee){for(var se in j.layers)ee.writeMessage(3,dr,j.layers[se])}(ne,O),O.finish()}function dr(ne,O){var j;O.writeVarintField(15,ne.version||1),O.writeStringField(1,ne.name||""),O.writeVarintField(5,ne.extent||4096);var ee={keys:[],values:[],keycache:{},valuecache:{}};for(j=0;j<ne.length;j++)ee.feature=ne.feature(j),O.writeMessage(2,Wr,ee);var se=ee.keys;for(j=0;j<se.length;j++)O.writeStringField(3,se[j]);var me=ee.values;for(j=0;j<me.length;j++)O.writeMessage(4,fr,me[j])}function Wr(ne,O){var j=ne.feature;j.id!==void 0&&O.writeVarintField(1,j.id),O.writeMessage(2,ir,ne),O.writeVarintField(3,j.type),O.writeMessage(4,di,j)}function ir(ne,O){var j=ne.feature,ee=ne.keys,se=ne.values,me=ne.keycache,De=ne.valuecache;for(var Te in j.properties){var ye=j.properties[Te],Pe=me[Te];if(ye!==null){Pe===void 0&&(ee.push(Te),me[Te]=Pe=ee.length-1),O.writeVarint(Pe);var Je=typeof ye;Je!=="string"&&Je!=="boolean"&&Je!=="number"&&(ye=JSON.stringify(ye));var yt=Je+":"+ye,et=De[yt];et===void 0&&(se.push(ye),De[yt]=et=se.length-1),O.writeVarint(et)}}}function hi(ne,O){return(O<<3)+(7&ne)}function en(ne){return ne<<1^ne>>31}function di(ne,O){for(var j=ne.loadGeometry(),ee=ne.type,se=0,me=0,De=j.length,Te=0;Te<De;Te++){var ye=j[Te],Pe=1;ee===1&&(Pe=ye.length),O.writeVarint(hi(1,Pe));for(var Je=ee===3?ye.length-1:ye.length,yt=0;yt<Je;yt++){yt===1&&ee!==1&&O.writeVarint(hi(2,Je-1));var et=ye[yt].x-se,Nt=ye[yt].y-me;O.writeVarint(en(et)),O.writeVarint(en(Nt)),se+=et,me+=Nt}ee===3&&O.writeVarint(hi(7,1))}}function fr(ne,O){var j=typeof ne;j==="string"?O.writeStringField(1,ne):j==="boolean"?O.writeBooleanField(7,ne):j==="number"&&(ne%1!=0?O.writeDoubleField(3,ne):ne<0?O.writeSVarintField(6,ne):O.writeVarintField(5,ne))}function xt(ne,O,j,ee,se,me){if(se-ee<=j)return;const De=ee+se>>1;Qt(ne,O,De,ee,se,me%2),xt(ne,O,j,ee,De-1,me+1),xt(ne,O,j,De+1,se,me+1)}function Qt(ne,O,j,ee,se,me){for(;se>ee;){if(se-ee>600){const Pe=se-ee+1,Je=j-ee+1,yt=Math.log(Pe),et=.5*Math.exp(2*yt/3),Nt=.5*Math.sqrt(yt*et*(Pe-et)/Pe)*(Je-Pe/2<0?-1:1);Qt(ne,O,j,Math.max(ee,Math.floor(j-Je*et/Pe+Nt)),Math.min(se,Math.floor(j+(Pe-Je)*et/Pe+Nt)),me)}const De=O[2*j+me];let Te=ee,ye=se;for(Mt(ne,O,ee,j),O[2*se+me]>De&&Mt(ne,O,ee,se);Te<ye;){for(Mt(ne,O,Te,ye),Te++,ye--;O[2*Te+me]<De;)Te++;for(;O[2*ye+me]>De;)ye--}O[2*ee+me]===De?Mt(ne,O,ee,ye):(ye++,Mt(ne,O,ye,se)),ye<=j&&(ee=ye+1),j<=ye&&(se=ye-1)}}function Mt(ne,O,j,ee){_n(ne,j,ee),_n(O,2*j,2*ee),_n(O,2*j+1,2*ee+1)}function _n(ne,O,j){const ee=ne[O];ne[O]=ne[j],ne[j]=ee}function Ln(ne,O,j,ee){const se=ne-j,me=O-ee;return se*se+me*me}ge.exports=Ot,ge.exports.fromVectorTileJs=Ot,ge.exports.fromGeojsonVt=function(ne,O){O=O||{};var j={};for(var ee in ne)j[ee]=new Et(ne[ee].features,O),j[ee].name=ee,j[ee].version=O.version,j[ee].extent=O.extent;return Ot({layers:j})},ge.exports.GeoJSONWrapper=Et;const Or=ne=>ne[0],Qn=ne=>ne[1];class wr{constructor(O,j=Or,ee=Qn,se=64,me=Float64Array){this.nodeSize=se,this.points=O;const De=O.length<65536?Uint16Array:Uint32Array,Te=this.ids=new De(O.length),ye=this.coords=new me(2*O.length);for(let Pe=0;Pe<O.length;Pe++)Te[Pe]=Pe,ye[2*Pe]=j(O[Pe]),ye[2*Pe+1]=ee(O[Pe]);xt(Te,ye,se,0,Te.length-1,0)}range(O,j,ee,se){return function(me,De,Te,ye,Pe,Je,yt){const et=[0,me.length-1,0],Nt=[];let Ft,zt;for(;et.length;){const Wt=et.pop(),dn=et.pop(),Tn=et.pop();if(dn-Tn<=yt){for(let In=Tn;In<=dn;In++)Ft=De[2*In],zt=De[2*In+1],Ft>=Te&&Ft<=Pe&&zt>=ye&&zt<=Je&&Nt.push(me[In]);continue}const Ut=Math.floor((Tn+dn)/2);Ft=De[2*Ut],zt=De[2*Ut+1],Ft>=Te&&Ft<=Pe&&zt>=ye&&zt<=Je&&Nt.push(me[Ut]);const Gn=(Wt+1)%2;(Wt===0?Te<=Ft:ye<=zt)&&(et.push(Tn),et.push(Ut-1),et.push(Gn)),(Wt===0?Pe>=Ft:Je>=zt)&&(et.push(Ut+1),et.push(dn),et.push(Gn))}return Nt}(this.ids,this.coords,O,j,ee,se,this.nodeSize)}within(O,j,ee){return function(se,me,De,Te,ye,Pe){const Je=[0,se.length-1,0],yt=[],et=ye*ye;for(;Je.length;){const Nt=Je.pop(),Ft=Je.pop(),zt=Je.pop();if(Ft-zt<=Pe){for(let Gn=zt;Gn<=Ft;Gn++)Ln(me[2*Gn],me[2*Gn+1],De,Te)<=et&&yt.push(se[Gn]);continue}const Wt=Math.floor((zt+Ft)/2),dn=me[2*Wt],Tn=me[2*Wt+1];Ln(dn,Tn,De,Te)<=et&&yt.push(se[Wt]);const Ut=(Nt+1)%2;(Nt===0?De-ye<=dn:Te-ye<=Tn)&&(Je.push(zt),Je.push(Wt-1),Je.push(Ut)),(Nt===0?De+ye>=dn:Te+ye>=Tn)&&(Je.push(Wt+1),Je.push(Ft),Je.push(Ut))}return yt}(this.ids,this.coords,O,j,ee,this.nodeSize)}}const jt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ne=>ne},St=Math.fround||(ar=new Float32Array(1),ne=>(ar[0]=+ne,ar[0]));var ar;class pr{constructor(O){this.options=Jr(Object.create(jt),O),this.trees=new Array(this.options.maxZoom+1)}load(O){const{log:j,minZoom:ee,maxZoom:se,nodeSize:me}=this.options;j&&console.time("total time");const De=`prepare ${O.length} points`;j&&console.time(De),this.points=O;let Te=[];for(let ye=0;ye<O.length;ye++)O[ye].geometry&&Te.push(Fa(O[ye],ye));this.trees[se+1]=new wr(Te,Ra,vu,me,Float32Array),j&&console.timeEnd(De);for(let ye=se;ye>=ee;ye--){const Pe=+Date.now();Te=this._cluster(Te,ye),this.trees[ye]=new wr(Te,Ra,vu,me,Float32Array),j&&console.log("z%d: %d clusters in %dms",ye,Te.length,+Date.now()-Pe)}return j&&console.timeEnd("total time"),this}getClusters(O,j){let ee=((O[0]+180)%360+360)%360-180;const se=Math.max(-90,Math.min(90,O[1]));let me=O[2]===180?180:((O[2]+180)%360+360)%360-180;const De=Math.max(-90,Math.min(90,O[3]));if(O[2]-O[0]>=360)ee=-180,me=180;else if(ee>me){const Je=this.getClusters([ee,se,180,De],j),yt=this.getClusters([-180,se,me,De],j);return Je.concat(yt)}const Te=this.trees[this._limitZoom(j)],ye=Te.range(sn(ee),fi(De),sn(me),fi(se)),Pe=[];for(const Je of ye){const yt=Te.points[Je];Pe.push(yt.numPoints?er(yt):this.points[yt.index])}return Pe}getChildren(O){const j=this._getOriginId(O),ee=this._getOriginZoom(O),se="No cluster with the specified id.",me=this.trees[ee];if(!me)throw new Error(se);const De=me.points[j];if(!De)throw new Error(se);const Te=this.options.radius/(this.options.extent*Math.pow(2,ee-1)),ye=me.within(De.x,De.y,Te),Pe=[];for(const Je of ye){const yt=me.points[Je];yt.parentId===O&&Pe.push(yt.numPoints?er(yt):this.points[yt.index])}if(Pe.length===0)throw new Error(se);return Pe}getLeaves(O,j,ee){const se=[];return this._appendLeaves(se,O,j=j||10,ee=ee||0,0),se}getTile(O,j,ee){const se=this.trees[this._limitZoom(O)],me=Math.pow(2,O),{extent:De,radius:Te}=this.options,ye=Te/De,Pe=(ee-ye)/me,Je=(ee+1+ye)/me,yt={features:[]};return this._addTileFeatures(se.range((j-ye)/me,Pe,(j+1+ye)/me,Je),se.points,j,ee,me,yt),j===0&&this._addTileFeatures(se.range(1-ye/me,Pe,1,Je),se.points,me,ee,me,yt),j===me-1&&this._addTileFeatures(se.range(0,Pe,ye/me,Je),se.points,-1,ee,me,yt),yt.features.length?yt:null}getClusterExpansionZoom(O){let j=this._getOriginZoom(O)-1;for(;j<=this.options.maxZoom;){const ee=this.getChildren(O);if(j++,ee.length!==1)break;O=ee[0].properties.cluster_id}return j}_appendLeaves(O,j,ee,se,me){const De=this.getChildren(j);for(const Te of De){const ye=Te.properties;if(ye&&ye.cluster?me+ye.point_count<=se?me+=ye.point_count:me=this._appendLeaves(O,ye.cluster_id,ee,se,me):me<se?me++:O.push(Te),O.length===ee)break}return me}_addTileFeatures(O,j,ee,se,me,De){for(const Te of O){const ye=j[Te],Pe=ye.numPoints;let Je,yt,et;if(Pe)Je=Qi(ye),yt=ye.x,et=ye.y;else{const zt=this.points[ye.index];Je=zt.properties,yt=sn(zt.geometry.coordinates[0]),et=fi(zt.geometry.coordinates[1])}const Nt={type:1,geometry:[[Math.round(this.options.extent*(yt*me-ee)),Math.round(this.options.extent*(et*me-se))]],tags:Je};let Ft;Pe?Ft=ye.id:this.options.generateId?Ft=ye.index:this.points[ye.index].id&&(Ft=this.points[ye.index].id),Ft!==void 0&&(Nt.id=Ft),De.features.push(Nt)}}_limitZoom(O){return Math.max(this.options.minZoom,Math.min(Math.floor(+O),this.options.maxZoom+1))}_cluster(O,j){const ee=[],{radius:se,extent:me,reduce:De,minPoints:Te}=this.options,ye=se/(me*Math.pow(2,j));for(let Pe=0;Pe<O.length;Pe++){const Je=O[Pe];if(Je.zoom<=j)continue;Je.zoom=j;const yt=this.trees[j+1],et=yt.within(Je.x,Je.y,ye),Nt=Je.numPoints||1;let Ft=Nt;for(const zt of et){const Wt=yt.points[zt];Wt.zoom>j&&(Ft+=Wt.numPoints||1)}if(Ft>Nt&&Ft>=Te){let zt=Je.x*Nt,Wt=Je.y*Nt,dn=De&&Nt>1?this._map(Je,!0):null;const Tn=(Pe<<5)+(j+1)+this.points.length;for(const Ut of et){const Gn=yt.points[Ut];if(Gn.zoom<=j)continue;Gn.zoom=j;const In=Gn.numPoints||1;zt+=Gn.x*In,Wt+=Gn.y*In,Gn.parentId=Tn,De&&(dn||(dn=this._map(Je,!0)),De(dn,this._map(Gn)))}Je.parentId=Tn,ee.push(Ui(zt/Ft,Wt/Ft,Tn,Ft,dn))}else if(ee.push(Je),Ft>1)for(const zt of et){const Wt=yt.points[zt];Wt.zoom<=j||(Wt.zoom=j,ee.push(Wt))}}return ee}_getOriginId(O){return O-this.points.length>>5}_getOriginZoom(O){return(O-this.points.length)%32}_map(O,j){if(O.numPoints)return j?Jr({},O.properties):O.properties;const ee=this.points[O.index].properties,se=this.options.map(ee);return j&&se===ee?Jr({},se):se}}function Ui(ne,O,j,ee,se){return{x:St(ne),y:St(O),zoom:1/0,id:j,parentId:-1,numPoints:ee,properties:se}}function Fa(ne,O){const[j,ee]=ne.geometry.coordinates;return{x:St(sn(j)),y:St(fi(ee)),zoom:1/0,index:O,parentId:-1}}function er(ne){return{type:"Feature",id:ne.id,properties:Qi(ne),geometry:{type:"Point",coordinates:[(O=ne.x,360*(O-.5)),yu(ne.y)]}};var O}function Qi(ne){const O=ne.numPoints,j=O>=1e4?`${Math.round(O/1e3)}k`:O>=1e3?Math.round(O/100)/10+"k":O;return Jr(Jr({},ne.properties),{cluster:!0,cluster_id:ne.id,point_count:O,point_count_abbreviated:j})}function sn(ne){return ne/360+.5}function fi(ne){const O=Math.sin(ne*Math.PI/180),j=.5-.25*Math.log((1+O)/(1-O))/Math.PI;return j<0?0:j>1?1:j}function yu(ne){const O=(180-360*ne)*Math.PI/180;return 360*Math.atan(Math.exp(O))/Math.PI-90}function Jr(ne,O){for(const j in O)ne[j]=O[j];return ne}function Ra(ne){return ne.x}function vu(ne){return ne.y}function Yi(ne,O,j,ee){for(var se,me=ee,De=j-O>>1,Te=j-O,ye=ne[O],Pe=ne[O+1],Je=ne[j],yt=ne[j+1],et=O+3;et<j;et+=3){var Nt=Ii(ne[et],ne[et+1],ye,Pe,Je,yt);if(Nt>me)se=et,me=Nt;else if(Nt===me){var Ft=Math.abs(et-De);Ft<Te&&(se=et,Te=Ft)}}me>ee&&(se-O>3&&Yi(ne,O,se,ee),ne[se+2]=me,j-se>3&&Yi(ne,se,j,ee))}function Ii(ne,O,j,ee,se,me){var De=se-j,Te=me-ee;if(De!==0||Te!==0){var ye=((ne-j)*De+(O-ee)*Te)/(De*De+Te*Te);ye>1?(j=se,ee=me):ye>0&&(j+=De*ye,ee+=Te*ye)}return(De=ne-j)*De+(Te=O-ee)*Te}function Gr(ne,O,j,ee){var se={id:ne===void 0?null:ne,type:O,geometry:j,tags:ee,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(me){var De=me.geometry,Te=me.type;if(Te==="Point"||Te==="MultiPoint"||Te==="LineString")bo(me,De);else if(Te==="Polygon"||Te==="MultiLineString")for(var ye=0;ye<De.length;ye++)bo(me,De[ye]);else if(Te==="MultiPolygon")for(ye=0;ye<De.length;ye++)for(var Pe=0;Pe<De[ye].length;Pe++)bo(me,De[ye][Pe])}(se),se}function bo(ne,O){for(var j=0;j<O.length;j+=3)ne.minX=Math.min(ne.minX,O[j]),ne.minY=Math.min(ne.minY,O[j+1]),ne.maxX=Math.max(ne.maxX,O[j]),ne.maxY=Math.max(ne.maxY,O[j+1])}function yl(ne,O,j,ee){if(O.geometry){var se=O.geometry.coordinates,me=O.geometry.type,De=Math.pow(j.tolerance/((1<<j.maxZoom)*j.extent),2),Te=[],ye=O.id;if(j.promoteId?ye=O.properties[j.promoteId]:j.generateId&&(ye=ee||0),me==="Point")ws(se,Te);else if(me==="MultiPoint")for(var Pe=0;Pe<se.length;Pe++)ws(se[Pe],Te);else if(me==="LineString")vl(se,Te,De,!1);else if(me==="MultiLineString"){if(j.lineMetrics){for(Pe=0;Pe<se.length;Pe++)vl(se[Pe],Te=[],De,!1),ne.push(Gr(ye,"LineString",Te,O.properties));return}eo(se,Te,De,!1)}else if(me==="Polygon")eo(se,Te,De,!0);else{if(me!=="MultiPolygon"){if(me==="GeometryCollection"){for(Pe=0;Pe<O.geometry.geometries.length;Pe++)yl(ne,{id:ye,geometry:O.geometry.geometries[Pe],properties:O.properties},j,ee);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Pe=0;Pe<se.length;Pe++){var Je=[];eo(se[Pe],Je,De,!0),Te.push(Je)}}ne.push(Gr(ye,me,Te,O.properties))}}function ws(ne,O){O.push(qo(ne[0])),O.push(Zs(ne[1])),O.push(0)}function vl(ne,O,j,ee){for(var se,me,De=0,Te=0;Te<ne.length;Te++){var ye=qo(ne[Te][0]),Pe=Zs(ne[Te][1]);O.push(ye),O.push(Pe),O.push(0),Te>0&&(De+=ee?(se*Pe-ye*me)/2:Math.sqrt(Math.pow(ye-se,2)+Math.pow(Pe-me,2))),se=ye,me=Pe}var Je=O.length-3;O[2]=1,Yi(O,0,Je,j),O[Je+2]=1,O.size=Math.abs(De),O.start=0,O.end=O.size}function eo(ne,O,j,ee){for(var se=0;se<ne.length;se++){var me=[];vl(ne[se],me,j,ee),O.push(me)}}function qo(ne){return ne/360+.5}function Zs(ne){var O=Math.sin(ne*Math.PI/180),j=.5-.25*Math.log((1+O)/(1-O))/Math.PI;return j<0?0:j>1?1:j}function pi(ne,O,j,ee,se,me,De,Te){if(ee/=O,me>=(j/=O)&&De<ee)return ne;if(De<j||me>=ee)return null;for(var ye=[],Pe=0;Pe<ne.length;Pe++){var Je=ne[Pe],yt=Je.geometry,et=Je.type,Nt=se===0?Je.minX:Je.minY,Ft=se===0?Je.maxX:Je.maxY;if(Nt>=j&&Ft<ee)ye.push(Je);else if(!(Ft<j||Nt>=ee)){var zt=[];if(et==="Point"||et==="MultiPoint")Oa(yt,zt,j,ee,se);else if(et==="LineString")Js(yt,zt,j,ee,se,!1,Te.lineMetrics);else if(et==="MultiLineString")Vo(yt,zt,j,ee,se,!1);else if(et==="Polygon")Vo(yt,zt,j,ee,se,!0);else if(et==="MultiPolygon")for(var Wt=0;Wt<yt.length;Wt++){var dn=[];Vo(yt[Wt],dn,j,ee,se,!0),dn.length&&zt.push(dn)}if(zt.length){if(Te.lineMetrics&&et==="LineString"){for(Wt=0;Wt<zt.length;Wt++)ye.push(Gr(Je.id,et,zt[Wt],Je.tags));continue}et!=="LineString"&&et!=="MultiLineString"||(zt.length===1?(et="LineString",zt=zt[0]):et="MultiLineString"),et!=="Point"&&et!=="MultiPoint"||(et=zt.length===3?"Point":"MultiPoint"),ye.push(Gr(Je.id,et,zt,Je.tags))}}}return ye.length?ye:null}function Oa(ne,O,j,ee,se){for(var me=0;me<ne.length;me+=3){var De=ne[me+se];De>=j&&De<=ee&&(O.push(ne[me]),O.push(ne[me+1]),O.push(ne[me+2]))}}function Js(ne,O,j,ee,se,me,De){for(var Te,ye,Pe=jo(ne),Je=se===0?xl:Xs,yt=ne.start,et=0;et<ne.length-3;et+=3){var Nt=ne[et],Ft=ne[et+1],zt=ne[et+2],Wt=ne[et+3],dn=ne[et+4],Tn=se===0?Nt:Ft,Ut=se===0?Wt:dn,Gn=!1;De&&(Te=Math.sqrt(Math.pow(Nt-Wt,2)+Math.pow(Ft-dn,2))),Tn<j?Ut>j&&(ye=Je(Pe,Nt,Ft,Wt,dn,j),De&&(Pe.start=yt+Te*ye)):Tn>ee?Ut<ee&&(ye=Je(Pe,Nt,Ft,Wt,dn,ee),De&&(Pe.start=yt+Te*ye)):Ga(Pe,Nt,Ft,zt),Ut<j&&Tn>=j&&(ye=Je(Pe,Nt,Ft,Wt,dn,j),Gn=!0),Ut>ee&&Tn<=ee&&(ye=Je(Pe,Nt,Ft,Wt,dn,ee),Gn=!0),!me&&Gn&&(De&&(Pe.end=yt+Te*ye),O.push(Pe),Pe=jo(ne)),De&&(yt+=Te)}var In=ne.length-3;Nt=ne[In],Ft=ne[In+1],zt=ne[In+2],(Tn=se===0?Nt:Ft)>=j&&Tn<=ee&&Ga(Pe,Nt,Ft,zt),In=Pe.length-3,me&&In>=3&&(Pe[In]!==Pe[0]||Pe[In+1]!==Pe[1])&&Ga(Pe,Pe[0],Pe[1],Pe[2]),Pe.length&&O.push(Pe)}function jo(ne){var O=[];return O.size=ne.size,O.start=ne.start,O.end=ne.end,O}function Vo(ne,O,j,ee,se,me){for(var De=0;De<ne.length;De++)Js(ne[De],O,j,ee,se,me,!1)}function Ga(ne,O,j,ee){ne.push(O),ne.push(j),ne.push(ee)}function xl(ne,O,j,ee,se,me){var De=(me-O)/(ee-O);return ne.push(me),ne.push(j+(se-j)*De),ne.push(1),De}function Xs(ne,O,j,ee,se,me){var De=(me-j)/(se-j);return ne.push(O+(ee-O)*De),ne.push(me),ne.push(1),De}function Qs(ne,O){for(var j=[],ee=0;ee<ne.length;ee++){var se,me=ne[ee],De=me.type;if(De==="Point"||De==="MultiPoint"||De==="LineString")se=wl(me.geometry,O);else if(De==="MultiLineString"||De==="Polygon"){se=[];for(var Te=0;Te<me.geometry.length;Te++)se.push(wl(me.geometry[Te],O))}else if(De==="MultiPolygon")for(se=[],Te=0;Te<me.geometry.length;Te++){for(var ye=[],Pe=0;Pe<me.geometry[Te].length;Pe++)ye.push(wl(me.geometry[Te][Pe],O));se.push(ye)}j.push(Gr(me.id,De,se,me.tags))}return j}function wl(ne,O){var j=[];j.size=ne.size,ne.start!==void 0&&(j.start=ne.start,j.end=ne.end);for(var ee=0;ee<ne.length;ee+=3)j.push(ne[ee]+O,ne[ee+1],ne[ee+2]);return j}function Al(ne,O){if(ne.transformed)return ne;var j,ee,se,me=1<<ne.z,De=ne.x,Te=ne.y;for(j=0;j<ne.features.length;j++){var ye=ne.features[j],Pe=ye.geometry,Je=ye.type;if(ye.geometry=[],Je===1)for(ee=0;ee<Pe.length;ee+=2)ye.geometry.push(to(Pe[ee],Pe[ee+1],O,me,De,Te));else for(ee=0;ee<Pe.length;ee++){var yt=[];for(se=0;se<Pe[ee].length;se+=2)yt.push(to(Pe[ee][se],Pe[ee][se+1],O,me,De,Te));ye.geometry.push(yt)}}return ne.transformed=!0,ne}function to(ne,O,j,ee,se,me){return[Math.round(j*(ne*ee-se)),Math.round(j*(O*ee-me))]}function Na(ne,O,j,ee,se){for(var me=O===se.maxZoom?0:se.tolerance/((1<<O)*se.extent),De={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:j,y:ee,z:O,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Te=0;Te<ne.length;Te++){De.numFeatures++,pc(De,ne[Te],me,se);var ye=ne[Te].minX,Pe=ne[Te].minY,Je=ne[Te].maxX,yt=ne[Te].maxY;ye<De.minX&&(De.minX=ye),Pe<De.minY&&(De.minY=Pe),Je>De.maxX&&(De.maxX=Je),yt>De.maxY&&(De.maxY=yt)}return De}function pc(ne,O,j,ee){var se=O.geometry,me=O.type,De=[];if(me==="Point"||me==="MultiPoint")for(var Te=0;Te<se.length;Te+=3)De.push(se[Te]),De.push(se[Te+1]),ne.numPoints++,ne.numSimplified++;else if(me==="LineString")bl(De,se,ne,j,!1,!1);else if(me==="MultiLineString"||me==="Polygon")for(Te=0;Te<se.length;Te++)bl(De,se[Te],ne,j,me==="Polygon",Te===0);else if(me==="MultiPolygon")for(var ye=0;ye<se.length;ye++){var Pe=se[ye];for(Te=0;Te<Pe.length;Te++)bl(De,Pe[Te],ne,j,!0,Te===0)}if(De.length){var Je=O.tags||null;if(me==="LineString"&&ee.lineMetrics){for(var yt in Je={},O.tags)Je[yt]=O.tags[yt];Je.mapbox_clip_start=se.start/se.size,Je.mapbox_clip_end=se.end/se.size}var et={geometry:De,type:me==="Polygon"||me==="MultiPolygon"?3:me==="LineString"||me==="MultiLineString"?2:1,tags:Je};O.id!==null&&(et.id=O.id),ne.features.push(et)}}function bl(ne,O,j,ee,se,me){var De=ee*ee;if(ee>0&&O.size<(se?De:ee))j.numPoints+=O.length/3;else{for(var Te=[],ye=0;ye<O.length;ye+=3)(ee===0||O[ye+2]>De)&&(j.numSimplified++,Te.push(O[ye]),Te.push(O[ye+1])),j.numPoints++;se&&function(Pe,Je){for(var yt=0,et=0,Nt=Pe.length,Ft=Nt-2;et<Nt;Ft=et,et+=2)yt+=(Pe[et]-Pe[Ft])*(Pe[et+1]+Pe[Ft+1]);if(yt>0===Je)for(et=0,Nt=Pe.length;et<Nt/2;et+=2){var zt=Pe[et],Wt=Pe[et+1];Pe[et]=Pe[Nt-2-et],Pe[et+1]=Pe[Nt-1-et],Pe[Nt-2-et]=zt,Pe[Nt-1-et]=Wt}}(Te,me),ne.push(Te)}}function Cl(ne,O){var j=(O=this.options=function(se,me){for(var De in me)se[De]=me[De];return se}(Object.create(this.options),O)).debug;if(j&&console.time("preprocess data"),O.maxZoom<0||O.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(O.promoteId&&O.generateId)throw new Error("promoteId and generateId cannot be used together.");var ee=function(se,me){var De=[];if(se.type==="FeatureCollection")for(var Te=0;Te<se.features.length;Te++)yl(De,se.features[Te],me,Te);else yl(De,se.type==="Feature"?se:{geometry:se},me);return De}(ne,O);this.tiles={},this.tileCoords=[],j&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",O.indexMaxZoom,O.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ee=function(se,me){var De=me.buffer/me.extent,Te=se,ye=pi(se,1,-1-De,De,0,-1,2,me),Pe=pi(se,1,1-De,2+De,0,-1,2,me);return(ye||Pe)&&(Te=pi(se,1,-De,1+De,0,-1,2,me)||[],ye&&(Te=Qs(ye,1).concat(Te)),Pe&&(Te=Te.concat(Qs(Pe,-1)))),Te}(ee,O),ee.length&&this.splitTile(ee,0,0,0),j&&(ee.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Mi(ne,O,j){return 32*((1<<ne)*j+O)+ne}function Ys(ne,O){const j=ne.tileID.canonical;if(!this._geoJSONIndex)return O(null,null);const ee=this._geoJSONIndex.getTile(j.z,j.x,j.y);if(!ee)return O(null,null);const se=new be(ee.features);let me=ge.exports(se);me.byteOffset===0&&me.byteLength===me.buffer.byteLength||(me=new Uint8Array(me)),O(null,{vectorTile:se,rawData:me.buffer})}Cl.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Cl.prototype.splitTile=function(ne,O,j,ee,se,me,De){for(var Te=[ne,O,j,ee],ye=this.options,Pe=ye.debug;Te.length;){ee=Te.pop(),j=Te.pop(),O=Te.pop(),ne=Te.pop();var Je=1<<O,yt=Mi(O,j,ee),et=this.tiles[yt];if(!et&&(Pe>1&&console.time("creation"),et=this.tiles[yt]=Na(ne,O,j,ee,ye),this.tileCoords.push({z:O,x:j,y:ee}),Pe)){Pe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",O,j,ee,et.numFeatures,et.numPoints,et.numSimplified),console.timeEnd("creation"));var Nt="z"+O;this.stats[Nt]=(this.stats[Nt]||0)+1,this.total++}if(et.source=ne,se){if(O===ye.maxZoom||O===se)continue;var Ft=1<<se-O;if(j!==Math.floor(me/Ft)||ee!==Math.floor(De/Ft))continue}else if(O===ye.indexMaxZoom||et.numPoints<=ye.indexMaxPoints)continue;if(et.source=null,ne.length!==0){Pe>1&&console.time("clipping");var zt,Wt,dn,Tn,Ut,Gn,In=.5*ye.buffer/ye.extent,ea=.5-In,As=.5+In,Ne=1+In;zt=Wt=dn=Tn=null,Ut=pi(ne,Je,j-In,j+As,0,et.minX,et.maxX,ye),Gn=pi(ne,Je,j+ea,j+Ne,0,et.minX,et.maxX,ye),ne=null,Ut&&(zt=pi(Ut,Je,ee-In,ee+As,1,et.minY,et.maxY,ye),Wt=pi(Ut,Je,ee+ea,ee+Ne,1,et.minY,et.maxY,ye),Ut=null),Gn&&(dn=pi(Gn,Je,ee-In,ee+As,1,et.minY,et.maxY,ye),Tn=pi(Gn,Je,ee+ea,ee+Ne,1,et.minY,et.maxY,ye),Gn=null),Pe>1&&console.timeEnd("clipping"),Te.push(zt||[],O+1,2*j,2*ee),Te.push(Wt||[],O+1,2*j,2*ee+1),Te.push(dn||[],O+1,2*j+1,2*ee),Te.push(Tn||[],O+1,2*j+1,2*ee+1)}}},Cl.prototype.getTile=function(ne,O,j){var ee=this.options,se=ee.extent,me=ee.debug;if(ne<0||ne>24)return null;var De=1<<ne,Te=Mi(ne,O=(O%De+De)%De,j);if(this.tiles[Te])return Al(this.tiles[Te],se);me>1&&console.log("drilling down to z%d-%d-%d",ne,O,j);for(var ye,Pe=ne,Je=O,yt=j;!ye&&Pe>0;)Pe--,Je=Math.floor(Je/2),yt=Math.floor(yt/2),ye=this.tiles[Mi(Pe,Je,yt)];return ye&&ye.source?(me>1&&console.log("found parent tile z%d-%d-%d",Pe,Je,yt),me>1&&console.time("drilling down"),this.splitTile(ye.source,Pe,Je,yt,ne,O,j),me>1&&console.timeEnd("drilling down"),this.tiles[Te]?Al(this.tiles[Te],se):null):null};class xu extends s.VectorTileWorkerSource{constructor(O,j,ee,se,me){super(O,j,ee,se,Ys),me&&(this.loadGeoJSON=me)}loadData(O,j){const ee=O&&O.request,se=ee&&ee.collectResourceTiming;this.loadGeoJSON(O,(me,De)=>{if(me||!De)return j(me);if(typeof De!="object")return j(new Error(`Input data given to '${O.source}' is not a valid GeoJSON object.`));{Ae(De,!0);try{if(O.filter){const ye=s.createExpression(O.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ye.result==="error")throw new Error(ye.value.map(Je=>`${Je.key}: ${Je.message}`).join(", "));De={type:"FeatureCollection",features:De.features.filter(Je=>ye.value.evaluate({zoom:0},Je))}}this._geoJSONIndex=O.cluster?new pr(function({superclusterOptions:ye,clusterProperties:Pe}){if(!Pe||!ye)return ye;const Je={},yt={},et={accumulated:null,zoom:0},Nt={properties:null},Ft=Object.keys(Pe);for(const zt of Ft){const[Wt,dn]=Pe[zt],Tn=s.createExpression(dn),Ut=s.createExpression(typeof Wt=="string"?[Wt,["accumulated"],["get",zt]]:Wt);Je[zt]=Tn.value,yt[zt]=Ut.value}return ye.map=zt=>{Nt.properties=zt;const Wt={};for(const dn of Ft)Wt[dn]=Je[dn].evaluate(et,Nt);return Wt},ye.reduce=(zt,Wt)=>{Nt.properties=Wt;for(const dn of Ft)et.accumulated=zt[dn],zt[dn]=yt[dn].evaluate(et,Nt)},ye}(O)).load(De.features):function(ye,Pe){return new Cl(ye,Pe)}(De,O.geojsonVtOptions)}catch(ye){return j(ye)}this.loaded={};const Te={};if(se){const ye=s.getPerformanceMeasurement(ee);ye&&(Te.resourceTiming={},Te.resourceTiming[O.source]=JSON.parse(JSON.stringify(ye)))}j(null,Te)}})}reloadTile(O,j){const ee=this.loaded;return ee&&ee[O.uid]?super.reloadTile(O,j):this.loadTile(O,j)}loadGeoJSON(O,j){if(O.request)s.getJSON(O.request,j);else{if(typeof O.data!="string")return j(new Error(`Input data given to '${O.source}' is not a valid GeoJSON object.`));try{return j(null,JSON.parse(O.data))}catch{return j(new Error(`Input data given to '${O.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(O,j){try{j(null,this._geoJSONIndex.getClusterExpansionZoom(O.clusterId))}catch(ee){j(ee)}}getClusterChildren(O,j){try{j(null,this._geoJSONIndex.getChildren(O.clusterId))}catch(ee){j(ee)}}getClusterLeaves(O,j){try{j(null,this._geoJSONIndex.getLeaves(O.clusterId,O.limit,O.offset))}catch(ee){j(ee)}}}class Ua{constructor(O){this.self=O,this.actor=new s.Actor(O,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=s.getProjection({name:"mercator"}),this.workerSourceTypes={vector:s.VectorTileWorkerSource,geojson:xu},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(j,ee)=>{if(this.workerSourceTypes[j])throw new Error(`Worker source with name "${j}" already registered.`);this.workerSourceTypes[j]=ee},this.self.registerRTLTextPlugin=j=>{if(s.plugin.isParsed())throw new Error("RTL text plugin already registered.");s.plugin.applyArabicShaping=j.applyArabicShaping,s.plugin.processBidirectionalText=j.processBidirectionalText,s.plugin.processStyledBidirectionalText=j.processStyledBidirectionalText}}clearCaches(O,j,ee){delete this.layerIndexes[O],delete this.availableImages[O],delete this.workerSources[O],delete this.demWorkerSources[O],ee()}checkIfReady(O,j,ee){ee()}setReferrer(O,j){this.referrer=j}spriteLoaded(O,j){this.isSpriteLoaded[O]=j;for(const ee in this.workerSources[O]){const se=this.workerSources[O][ee];for(const me in se)se[me]instanceof s.VectorTileWorkerSource&&(se[me].isSpriteLoaded=j,se[me].fire(new s.Event("isSpriteLoaded")))}}setImages(O,j,ee){this.availableImages[O]=j;for(const se in this.workerSources[O]){const me=this.workerSources[O][se];for(const De in me)me[De].availableImages=j}ee()}enableTerrain(O,j,ee){this.terrain=j,ee()}setProjection(O,j){this.projections[O]=s.getProjection(j)}setLayers(O,j,ee){this.getLayerIndex(O).replace(j),ee()}updateLayers(O,j,ee){this.getLayerIndex(O).update(j.layers,j.removedIds),ee()}loadTile(O,j,ee){const se=this.enableTerrain?s.extend({enableTerrain:this.terrain},j):j;se.projection=this.projections[O]||this.defaultProjection,this.getWorkerSource(O,j.type,j.source).loadTile(se,ee)}loadDEMTile(O,j,ee){const se=this.enableTerrain?s.extend({buildQuadTree:this.terrain},j):j;this.getDEMWorkerSource(O,j.source).loadTile(se,ee)}reloadTile(O,j,ee){const se=this.enableTerrain?s.extend({enableTerrain:this.terrain},j):j;se.projection=this.projections[O]||this.defaultProjection,this.getWorkerSource(O,j.type,j.source).reloadTile(se,ee)}abortTile(O,j,ee){this.getWorkerSource(O,j.type,j.source).abortTile(j,ee)}removeTile(O,j,ee){this.getWorkerSource(O,j.type,j.source).removeTile(j,ee)}removeSource(O,j,ee){if(!this.workerSources[O]||!this.workerSources[O][j.type]||!this.workerSources[O][j.type][j.source])return;const se=this.workerSources[O][j.type][j.source];delete this.workerSources[O][j.type][j.source],se.removeSource!==void 0?se.removeSource(j,ee):ee()}loadWorkerSource(O,j,ee){try{this.self.importScripts(j.url),ee()}catch(se){ee(se.toString())}}syncRTLPluginState(O,j,ee){try{s.plugin.setState(j);const se=s.plugin.getPluginURL();if(s.plugin.isLoaded()&&!s.plugin.isParsed()&&se!=null){this.self.importScripts(se);const me=s.plugin.isParsed();ee(me?void 0:new Error(`RTL Text Plugin failed to import scripts from ${se}`),me)}}catch(se){ee(se.toString())}}getAvailableImages(O){let j=this.availableImages[O];return j||(j=[]),j}getLayerIndex(O){let j=this.layerIndexes[O];return j||(j=this.layerIndexes[O]=new Re),j}getWorkerSource(O,j,ee){if(this.workerSources[O]||(this.workerSources[O]={}),this.workerSources[O][j]||(this.workerSources[O][j]={}),!this.workerSources[O][j][ee]){const se={send:(me,De,Te,ye,Pe,Je)=>{this.actor.send(me,De,Te,O,Pe,Je)},scheduler:this.actor.scheduler};this.workerSources[O][j][ee]=new this.workerSourceTypes[j](se,this.getLayerIndex(O),this.getAvailableImages(O),this.isSpriteLoaded[O])}return this.workerSources[O][j][ee]}getDEMWorkerSource(O,j){return this.demWorkerSources[O]||(this.demWorkerSources[O]={}),this.demWorkerSources[O][j]||(this.demWorkerSources[O][j]=new we),this.demWorkerSources[O][j]}enforceCacheSizeLimit(O,j){s.enforceCacheSizeLimit(j)}getWorkerPerformanceMetrics(O,j,ee){ee(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Ua(self)),Ua}),D(["./shared"],function(s){function N(h,r){if(Array.isArray(h)){if(!Array.isArray(r)||h.length!==r.length)return!1;for(let l=0;l<h.length;l++)if(!N(h[l],r[l]))return!1;return!0}if(typeof h=="object"&&h!==null&&r!==null){if(typeof r!="object"||Object.keys(h).length!==Object.keys(r).length)return!1;for(const l in h)if(!N(h[l],r[l]))return!1;return!0}return h===r}var pe=Re;function Re(h){return!function(r){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var p,g,x=new Blob([""],{type:"text/javascript"}),b=URL.createObjectURL(x);try{g=new Worker(b),p=!0}catch{p=!1}return g&&g.terminate(),URL.revokeObjectURL(b),p}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var p=document.createElement("canvas");p.width=p.height=1;var g=p.getContext("2d");if(!g)return!1;var x=g.getImageData(0,0,1,1);return x&&x.width===p.width}()?(we[l=r&&r.failIfMajorPerformanceCaveat]===void 0&&(we[l]=function(p){var g,x=function(b){var T=document.createElement("canvas"),S=Object.create(Re.webGLContextAttributes);return S.failIfMajorPerformanceCaveat=b,T.getContext("webgl",S)||T.getContext("experimental-webgl",S)}(p);if(!x)return!1;try{g=x.createShader(x.VERTEX_SHADER)}catch{return!1}return!(!g||x.isContextLost())&&(x.shaderSource(g,"void main() {}"),x.compileShader(g),x.getShaderParameter(g,x.COMPILE_STATUS)===!0)}(l)),we[l]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var l}(h)}var we={};function Ae(h,r,l){const p=s.window.document.createElement(h);return r!==void 0&&(p.className=r),l&&l.appendChild(p),p}function $e(h,r,l){const p=s.window.document.createElementNS("http://www.w3.org/2000/svg",h);for(const g of Object.keys(r))p.setAttributeNS(null,g,r[g]);return l&&l.appendChild(p),p}Re.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Qe=s.window.document&&s.window.document.documentElement.style,ot=Qe&&Qe.userSelect!==void 0?"userSelect":"WebkitUserSelect";let Vt;function be(){Qe&&ot&&(Vt=Qe[ot],Qe[ot]="none")}function ge(){Qe&&ot&&(Qe[ot]=Vt)}function Be(h){h.preventDefault(),h.stopPropagation(),s.window.removeEventListener("click",Be,!0)}function Xe(){s.window.addEventListener("click",Be,!0),s.window.setTimeout(()=>{s.window.removeEventListener("click",Be,!0)},0)}function Ie(h,r){const l=h.getBoundingClientRect();return Ct(h,l,r)}function at(h,r){const l=h.getBoundingClientRect(),p=[];for(let g=0;g<r.length;g++)p.push(Ct(h,l,r[g]));return p}function ft(h){return s.window.InstallTrigger!==void 0&&h.button===2&&h.ctrlKey&&s.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:h.button}function Ct(h,r,l){const p=h.offsetWidth===r.width?1:h.offsetWidth/r.width;return new s.pointGeometry((l.clientX-r.left)*p,(l.clientY-r.top)*p)}function Et(h,r){var l=r[0],p=r[1],g=r[2],x=r[3],b=l*x-g*p;return b?(h[0]=x*(b=1/b),h[1]=-p*b,h[2]=-g*b,h[3]=l*b,h):null}function Ot(h){const{userImage:r}=h;return!!(r&&r.render&&r.render())&&(h.data.replace(new Uint8Array(r.data.buffer)),!0)}class dr extends s.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(r){if(this.loaded!==r&&(this.loaded=r,r)){for(const{ids:l,callback:p}of this.requestors)this._notify(l,p);this.requestors=[]}}hasImage(r){return!!this.getImage(r)}getImage(r){return this.images[r]}addImage(r,l){this._validate(r,l)&&(this.images[r]=l)}_validate(r,l){let p=!0;return this._validateStretch(l.stretchX,l.data&&l.data.width)||(this.fire(new s.ErrorEvent(new Error(`Image "${r}" has invalid "stretchX" value`))),p=!1),this._validateStretch(l.stretchY,l.data&&l.data.height)||(this.fire(new s.ErrorEvent(new Error(`Image "${r}" has invalid "stretchY" value`))),p=!1),this._validateContent(l.content,l)||(this.fire(new s.ErrorEvent(new Error(`Image "${r}" has invalid "content" value`))),p=!1),p}_validateStretch(r,l){if(!r)return!0;let p=0;for(const g of r){if(g[0]<p||g[1]<g[0]||l<g[1])return!1;p=g[1]}return!0}_validateContent(r,l){return!(r&&(r.length!==4||r[0]<0||l.data.width<r[0]||r[1]<0||l.data.height<r[1]||r[2]<0||l.data.width<r[2]||r[3]<0||l.data.height<r[3]||r[2]<r[0]||r[3]<r[1]))}updateImage(r,l){l.version=this.images[r].version+1,this.images[r]=l,this.updatedImages[r]=!0}removeImage(r){const l=this.images[r];delete this.images[r],delete this.patterns[r],l.userImage&&l.userImage.onRemove&&l.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(r,l){let p=!0;if(!this.isLoaded())for(const g of r)this.images[g]||(p=!1);this.isLoaded()||p?this._notify(r,l):this.requestors.push({ids:r,callback:l})}_notify(r,l){const p={};for(const g of r){this.images[g]||this.fire(new s.Event("styleimagemissing",{id:g}));const x=this.images[g];x?p[g]={data:x.data.clone(),pixelRatio:x.pixelRatio,sdf:x.sdf,version:x.version,stretchX:x.stretchX,stretchY:x.stretchY,content:x.content,hasRenderCallback:Boolean(x.userImage&&x.userImage.render)}:s.warnOnce(`Image "${g}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}l(null,p)}getPixelSize(){const{width:r,height:l}=this.atlasImage;return{width:r,height:l}}getPattern(r){const l=this.patterns[r],p=this.getImage(r);if(!p)return null;if(l&&l.position.version===p.version)return l.position;if(l)l.position.version=p.version;else{const g={w:p.data.width+2,h:p.data.height+2,x:0,y:0},x=new s.ImagePosition(g,p);this.patterns[r]={bin:g,position:x}}return this._updatePatternAtlas(),this.patterns[r].position}bind(r){const l=r.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.Texture(r,this.atlasImage,l.RGBA),this.atlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE)}_updatePatternAtlas(){const r=[];for(const x in this.patterns)r.push(this.patterns[x].bin);const{w:l,h:p}=s.potpack(r),g=this.atlasImage;g.resize({width:l||1,height:p||1});for(const x in this.patterns){const{bin:b}=this.patterns[x],T=b.x+1,S=b.y+1,k=this.images[x].data,L=k.width,G=k.height;s.RGBAImage.copy(k,g,{x:0,y:0},{x:T,y:S},{width:L,height:G}),s.RGBAImage.copy(k,g,{x:0,y:G-1},{x:T,y:S-1},{width:L,height:1}),s.RGBAImage.copy(k,g,{x:0,y:0},{x:T,y:S+G},{width:L,height:1}),s.RGBAImage.copy(k,g,{x:L-1,y:0},{x:T-1,y:S},{width:1,height:G}),s.RGBAImage.copy(k,g,{x:0,y:0},{x:T+L,y:S},{width:1,height:G})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(r){for(const l of r){if(this.callbackDispatchedThisFrame[l])continue;this.callbackDispatchedThisFrame[l]=!0;const p=this.images[l];Ot(p)&&this.updateImage(l,p)}}}const Wr=new s.Properties({anchor:new s.DataConstantProperty(s.spec.light.anchor),position:new class{constructor(){this.specification=s.spec.light.position}possiblyEvaluate(h,r){return function([l,p,g]){const x=s.degToRad(p+90),b=s.degToRad(g);return{x:l*Math.cos(x)*Math.sin(b),y:l*Math.sin(x)*Math.sin(b),z:l*Math.cos(b),azimuthal:p,polar:g}}(h.expression.evaluate(r))}interpolate(h,r,l){return{x:s.number(h.x,r.x,l),y:s.number(h.y,r.y,l),z:s.number(h.z,r.z,l),azimuthal:s.number(h.azimuthal,r.azimuthal,l),polar:s.number(h.polar,r.polar,l)}}},color:new s.DataConstantProperty(s.spec.light.color),intensity:new s.DataConstantProperty(s.spec.light.intensity)}),ir="-transition";class hi extends s.Evented{constructor(r){super(),this._transitionable=new s.Transitionable(Wr),this.setLight(r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,l={}){if(!this._validate(s.validateLight,r,l))for(const p in r){const g=r[p];s.endsWith(p,ir)?this._transitionable.setTransition(p.slice(0,-ir.length),g):this._transitionable.setValue(p,g)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,l,p){return(!p||p.validate!==!1)&&s.emitValidationErrors(this,r.call(s.validateStyle,s.extend({value:l,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}const en=new s.Properties({source:new s.DataConstantProperty(s.spec.terrain.source),exaggeration:new s.DataConstantProperty(s.spec.terrain.exaggeration)}),di="-transition";class fr extends s.Evented{constructor(r,l){super(),this._transitionable=new s.Transitionable(en),this.set(r),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=l}get(){return this._transitionable.serialize()}set(r){for(const l in r){const p=r[l];s.endsWith(l,di)?this._transitionable.setTransition(l.slice(0,-di.length),p):this._transitionable.setValue(l,p)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}}function xt(h,r,l,p){const g=s.smoothstep(45,65,l),[x,b]=Qt(h,p),T=s.length(r);let S=1-Math.min(1,Math.exp((T-x)/(b-x)*-6));return S*=S*S,S=Math.min(1,1.00747*S),S*g*h.alpha}function Qt(h,r){const l=.5/Math.tan(.5*r);return[h.range[0]+l,h.range[1]+l]}const Mt=new s.Properties({range:new s.DataConstantProperty(s.spec.fog.range),color:new s.DataConstantProperty(s.spec.fog.color),"high-color":new s.DataConstantProperty(s.spec.fog["high-color"]),"space-color":new s.DataConstantProperty(s.spec.fog["space-color"]),"horizon-blend":new s.DataConstantProperty(s.spec.fog["horizon-blend"]),"star-intensity":new s.DataConstantProperty(s.spec.fog["star-intensity"])}),_n="-transition";class Ln extends s.Evented{constructor(r,l){super(),this._transitionable=new s.Transitionable(Mt),this.set(r),this._transitioning=this._transitionable.untransitioned(),this._transform=l}get state(){const r=this._transform,l=r.projection.name==="globe",p=s.globeToMercatorTransition(r.zoom),g=this.properties.get("range"),x=[.5,3];return{range:l?[s.number(x[0],g[0],p),s.number(x[1],g[1],p)]:g,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(r,l={}){if(!this._validate(s.validateFog,r,l)){for(const p of Object.keys(s.spec.fog))r&&r[p]===void 0&&(r[p]=s.spec.fog[p].default);for(const p in r){const g=r[p];s.endsWith(p,_n)?this._transitionable.setTransition(p.slice(0,-_n.length),g):this._transitionable.setValue(p,g)}}}getOpacity(r){if(!this._transform.projection.supportsFog)return 0;const l=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:s.smoothstep(45,65,r))*l.a}getOpacityAtLatLng(r,l){return this._transform.projection.supportsFog?function(p,g,x){const b=s.MercatorCoordinate.fromLngLat(g),T=x.elevation?x.elevation.getAtPointOrZero(b):0,S=[b.x,b.y,T];return s.transformMat4(S,S,x.mercatorFogMatrix),xt(p,S,x.pitch,x._fov)}(this.state,r,l):0}getFovAdjustedRange(r){return this._transform.projection.supportsFog?Qt(this.state,r):[0,1]}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,l,p){return(!p||p.validate!==!1)&&s.emitValidationErrors(this,r.call(s.validateStyle,s.extend({value:l,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}class Or{constructor(r,l){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=s.uniqueId();const p=this.workerPool.acquire(this.id);for(let g=0;g<p.length;g++){const x=new Or.Actor(p[g],l,this.id);x.name=`Worker ${g}`,this.actors.push(x)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(r,l,p){s.asyncAll(this.actors,(g,x)=>{g.send(r,l,x)},p=p||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(r=>{r.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Qn(h,r,l){return r*(s.EXTENT/(h.tileSize*Math.pow(2,l-h.tileID.overscaledZ)))}Or.Actor=s.Actor;class wr{constructor(r,l,p,g){this.screenBounds=r,this.cameraPoint=l,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=p,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,g)}static createFromScreenPoints(r,l){let p,g;if(r instanceof s.pointGeometry||typeof r[0]=="number"){const x=s.pointGeometry.convert(r);p=[x],g=l.isPointAboveHorizon(x)}else{const x=s.pointGeometry.convert(r[0]),b=s.pointGeometry.convert(r[1]);p=[x,b],g=s.polygonizeBounds(x,b).every(T=>l.isPointAboveHorizon(T))}return new wr(p,l.getCameraPoint(),g,l)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(r){return s.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],r)}bufferedCameraGeometry(r){const l=this.screenBounds[0],p=this.screenBounds.length===1?this.screenBounds[0].add(new s.pointGeometry(1,1)):this.screenBounds[1],g=s.polygonizeBounds(l,p,0,!1);return this.cameraPoint.y>p.y&&(this.cameraPoint.x>l.x&&this.cameraPoint.x<p.x?g.splice(3,0,this.cameraPoint):this.cameraPoint.x>=p.x?g[2]=this.cameraPoint:this.cameraPoint.x<=l.x&&(g[3]=this.cameraPoint)),s.bufferConvexPolygon(g,r)}bufferedCameraGeometryGlobe(r){const l=this.screenBounds[0],p=this.screenBounds.length===1?this.screenBounds[0].add(new s.pointGeometry(1,1)):this.screenBounds[1],g=s.polygonizeBounds(l,p,r),x=this.cameraPoint.clone();switch(3*((x.y>l.y)+(x.y>p.y))+((x.x>l.x)+(x.x>p.x))){case 0:g[0]=x,g[4]=x.clone();break;case 1:g.splice(1,0,x);break;case 2:g[1]=x;break;case 3:g.splice(4,0,x);break;case 5:g.splice(2,0,x);break;case 6:g[3]=x;break;case 7:g.splice(3,0,x);break;case 8:g[2]=x}return g}containsTile(r,l,p,g=0){const x=r.queryPadding/l._pixelsPerMercatorPixel+1,b=p?this._bufferedCameraMercator(x,l):this._bufferedScreenMercator(x,l);let T=r.tileID.wrap+(b.unwrapped?g:0);const S=b.polygon.map(W=>s.getTilePoint(r.tileTransform,W,T));if(!s.polygonIntersectsBox(S,0,0,s.EXTENT,s.EXTENT))return;T=r.tileID.wrap+(this.screenGeometryMercator.unwrapped?g:0);const k=this.screenGeometryMercator.polygon.map(W=>s.getTileVec3(r.tileTransform,W,T)),L=k.map(W=>new s.pointGeometry(W[0],W[1])),G=l.getFreeCameraOptions().position||new s.MercatorCoordinate(0,0,0),V=s.getTileVec3(r.tileTransform,G,T),X=k.map(W=>{const $=s.sub(W,W,V);return s.normalize($,$),new s.Ray(V,$)}),Z=Qn(r,1,l.zoom)*l._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:L,tilespaceRays:X,bufferedTilespaceGeometry:S,bufferedTilespaceBounds:(Y=s.getBounds(S),Y.min.x=s.clamp(Y.min.x,0,s.EXTENT),Y.min.y=s.clamp(Y.min.y,0,s.EXTENT),Y.max.x=s.clamp(Y.max.x,0,s.EXTENT),Y.max.y=s.clamp(Y.max.y,0,s.EXTENT),Y),tile:r,tileID:r.tileID,pixelToTileUnitsFactor:Z};var Y}_bufferedScreenMercator(r,l){const p=ar(r);if(this._screenRaycastCache[p])return this._screenRaycastCache[p];{let g;return g=l.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(r),l):{polygon:this.bufferedScreenGeometry(r).map(x=>l.pointCoordinate3D(x)),unwrapped:!0},this._screenRaycastCache[p]=g,g}}_bufferedCameraMercator(r,l){const p=ar(r);if(this._cameraRaycastCache[p])return this._cameraRaycastCache[p];{let g;return g=l.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(r),l):{polygon:this.bufferedCameraGeometry(r).map(x=>l.pointCoordinate3D(x)),unwrapped:!0},this._cameraRaycastCache[p]=g,g}}_projectAndResample(r,l){const p=function(x,b){const T=s.multiply([],b.pixelMatrix,b.globeMatrix),S=[0,-s.GLOBE_RADIUS,0,1],k=[0,s.GLOBE_RADIUS,0,1],L=[0,0,0,1];s.transformMat4$1(S,S,T),s.transformMat4$1(k,k,T),s.transformMat4$1(L,L,T);const G=new s.pointGeometry(S[0]/S[3],S[1]/S[3]),V=new s.pointGeometry(k[0]/k[3],k[1]/k[3]),X=s.polygonContainsPoint(x,G)&&S[3]<L[3],Z=s.polygonContainsPoint(x,V)&&k[3]<L[3];if(!X&&!Z)return null;const Y=function(fe,Ee,Oe){for(let Le=1;Le<fe.length;Le++){const tt=St(Ee.pointCoordinate3D(fe[Le-1]).x),Ce=St(Ee.pointCoordinate3D(fe[Le]).x);if(Oe<0){if(tt<Ce)return{idx:Le,t:-tt/(Ce-1-tt)}}else if(Ce<tt)return{idx:Le,t:(1-tt)/(Ce+1-tt)}}return null}(x,b,X?-1:1);if(!Y)return null;const{idx:W,t:$}=Y;let te=W>1?jt(x.slice(0,W),b):[],J=W<x.length?jt(x.slice(W),b):[];te=te.map(fe=>new s.pointGeometry(St(fe.x),fe.y)),J=J.map(fe=>new s.pointGeometry(St(fe.x),fe.y));const le=[...te];le.length===0&&le.push(J[J.length-1]);const ue=s.number(le[le.length-1].y,(J.length===0?te[0]:J[0]).y,$);let oe;return oe=X?[new s.pointGeometry(0,ue),new s.pointGeometry(0,0),new s.pointGeometry(1,0),new s.pointGeometry(1,ue)]:[new s.pointGeometry(1,ue),new s.pointGeometry(1,1),new s.pointGeometry(0,1),new s.pointGeometry(0,ue)],le.push(...oe),J.length===0?le.push(te[0]):le.push(...J),{polygon:le.map(fe=>new s.MercatorCoordinate(fe.x,fe.y)),unwrapped:!1}}(r,l);if(p)return p;const g=function(x,b){let T=!1,S=-1/0,k=0;for(let G=0;G<x.length-1;G++)x[G].x>S&&(S=x[G].x,k=G);for(let G=0;G<x.length-1;G++){const V=(k+G)%(x.length-1),X=x[V],Z=x[V+1];Math.abs(X.x-Z.x)>.5&&(X.x<Z.x?(X.x+=1,V===0&&(x[x.length-1].x+=1)):(Z.x+=1,V+1===x.length-1&&(x[0].x+=1)),T=!0)}const L=s.mercatorXfromLng(b.center.lng);return T&&L<Math.abs(L-1)&&x.forEach(G=>{G.x-=1}),{polygon:x,unwrapped:T}}(jt(r,l).map(x=>new s.pointGeometry(St(x.x),x.y)),l);return{polygon:g.polygon.map(x=>new s.MercatorCoordinate(x.x,x.y)),unwrapped:g.unwrapped}}}function jt(h,r){return s.resample(h,l=>{const p=r.pointCoordinate3D(l);l.x=p.x,l.y=p.y},1/256)}function St(h){return h<0?1+h%1:h%1}function ar(h){return 100*h|0}function pr(h,r,l,p,g){const x=function(b,T){if(b)return g(b);if(T){h.url&&T.tiles&&h.tiles&&delete h.tiles;const S=s.pick(s.extend(T,h),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);T.vector_layers&&(S.vectorLayers=T.vector_layers,S.vectorLayerIds=S.vectorLayers.map(k=>k.id)),S.tiles=r.canonicalizeTileset(S,h.url),g(null,S)}};return h.url?s.getJSON(r.transformRequest(r.normalizeSourceURL(h.url,null,l,p),s.ResourceType.Source),x):s.exported.frame(()=>x(null,h))}class Ui{constructor(r,l,p){this.bounds=s.LngLatBounds.convert(this.validateBounds(r)),this.minzoom=l||0,this.maxzoom=p||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const l=Math.pow(2,r.z),p=Math.floor(s.mercatorXfromLng(this.bounds.getWest())*l),g=Math.floor(s.mercatorYfromLat(this.bounds.getNorth())*l),x=Math.ceil(s.mercatorXfromLng(this.bounds.getEast())*l),b=Math.ceil(s.mercatorYfromLat(this.bounds.getSouth())*l);return r.x>=p&&r.x<x&&r.y>=g&&r.y<b}}class Fa{constructor(r,l,p){this.context=r;const g=r.gl;this.buffer=g.createBuffer(),this.dynamicDraw=Boolean(p),this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),g.bufferData(g.ELEMENT_ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||l.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){const l=this.context.gl;this.context.unbindVAO(),this.bind(),l.bufferSubData(l.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const er={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Qi{constructor(r,l,p,g){this.length=l.length,this.attributes=p,this.itemSize=l.bytesPerElement,this.dynamicDraw=g,this.context=r;const x=r.gl;this.buffer=x.createBuffer(),r.bindVertexBuffer.set(this.buffer),x.bufferData(x.ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||l.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){const l=this.context.gl;this.bind(),l.bufferSubData(l.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,l){for(let p=0;p<this.attributes.length;p++){const g=l.attributes[this.attributes[p].name];g!==void 0&&r.enableVertexAttribArray(g)}}setVertexAttribPointers(r,l,p){for(let g=0;g<this.attributes.length;g++){const x=this.attributes[g],b=l.attributes[x.name];b!==void 0&&r.vertexAttribPointer(b,x.components,r[er[x.type]],!1,this.itemSize,x.offset+this.itemSize*(p||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class sn{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class fi extends sn{getDefault(){return s.Color.transparent}set(r){const l=this.current;(r.r!==l.r||r.g!==l.g||r.b!==l.b||r.a!==l.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class yu extends sn{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class Jr extends sn{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class Ra extends sn{getDefault(){return[!0,!0,!0,!0]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||r[3]!==l[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class vu extends sn{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class Yi extends sn{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class Ii extends sn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const l=this.current;(r.func!==l.func||r.ref!==l.ref||r.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class Gr extends sn{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class bo extends sn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=r,this.dirty=!1}}class yl extends sn{getDefault(){return[0,1]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class ws extends sn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=r,this.dirty=!1}}class vl extends sn{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class eo extends sn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.BLEND):l.disable(l.BLEND),this.current=r,this.dirty=!1}}class qo extends sn{getDefault(){const r=this.gl;return[r.ONE,r.ZERO]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||this.dirty)&&(this.gl.blendFunc(r[0],r[1]),this.current=r,this.dirty=!1)}}class Zs extends sn{getDefault(){return s.Color.transparent}set(r){const l=this.current;(r.r!==l.r||r.g!==l.g||r.b!==l.b||r.a!==l.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class pi extends sn{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquation(r),this.current=r,this.dirty=!1)}}class Oa extends sn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=r,this.dirty=!1}}class Js extends sn{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class jo extends sn{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}class Vo extends sn{getDefault(){return null}set(r){(r!==this.current||this.dirty)&&(this.gl.useProgram(r),this.current=r,this.dirty=!1)}}class Ga extends sn{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class xl extends sn{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||r[3]!==l[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Xs extends sn{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class Qs extends sn{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class wl extends sn{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindTexture(l.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class Al extends sn{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class to extends sn{getDefault(){return null}set(r){const l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class Na extends sn{constructor(r){super(r),this.vao=r.extVertexArrayObject}getDefault(){return null}set(r){this.vao&&(r!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(r),this.current=r,this.dirty=!1)}}class pc extends sn{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class bl extends sn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class Cl extends sn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class Mi extends sn{constructor(r,l){super(r),this.context=r,this.parent=l}getDefault(){return null}}class Ys extends Mi{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class xu extends Mi{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,this.attachment(),l.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Ua extends xu{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class ne{constructor(r,l,p,g){this.context=r,this.width=l,this.height=p;const x=this.framebuffer=r.gl.createFramebuffer();this.colorAttachment=new Ys(r,x),g&&(this.depthAttachment=new xu(r,x))}destroy(){const r=this.context.gl,l=this.colorAttachment.get();if(l&&r.deleteTexture(l),this.depthAttachment){const p=this.depthAttachment.get();p&&r.deleteRenderbuffer(p)}r.deleteFramebuffer(this.framebuffer)}}class O{constructor(r){this.gl=r,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new fi(this),this.clearDepth=new yu(this),this.clearStencil=new Jr(this),this.colorMask=new Ra(this),this.depthMask=new vu(this),this.stencilMask=new Yi(this),this.stencilFunc=new Ii(this),this.stencilOp=new Gr(this),this.stencilTest=new bo(this),this.depthRange=new yl(this),this.depthTest=new ws(this),this.depthFunc=new vl(this),this.blend=new eo(this),this.blendFunc=new qo(this),this.blendColor=new Zs(this),this.blendEquation=new pi(this),this.cullFace=new Oa(this),this.cullFaceSide=new Js(this),this.frontFace=new jo(this),this.program=new Vo(this),this.activeTexture=new Ga(this),this.viewport=new xl(this),this.bindFramebuffer=new Xs(this),this.bindRenderbuffer=new Qs(this),this.bindTexture=new wl(this),this.bindVertexBuffer=new Al(this),this.bindElementBuffer=new to(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Na(this),this.pixelStoreUnpack=new pc(this),this.pixelStoreUnpackPremultiplyAlpha=new bl(this),this.pixelStoreUnpackFlipY=new Cl(this),this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=r.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=r.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=r.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.extTextureHalfFloat=r.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(r.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=r.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=r.getExtension("OES_standard_derivatives"),this.extTimerQuery=r.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,l){return new Fa(this,r,l)}createVertexBuffer(r,l,p){return new Qi(this,r,l,p)}createRenderbuffer(r,l,p){const g=this.gl,x=g.createRenderbuffer();return this.bindRenderbuffer.set(x),g.renderbufferStorage(g.RENDERBUFFER,r,l,p),this.bindRenderbuffer.set(null),x}createFramebuffer(r,l,p){return new ne(this,r,l,p)}clear({color:r,depth:l,stencil:p}){const g=this.gl;let x=0;r&&(x|=g.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set([!0,!0,!0,!0])),l!==void 0&&(x|=g.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(l),this.depthMask.set(!0)),p!==void 0&&(x|=g.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),g.clear(x)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){N(r.blendFunction,s.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor)),this.colorMask.set(r.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class j extends s.Evented{constructor(r,l,p,g){super(),this.id=r,this.dispatcher=p,this.setEventedParent(g),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.extend({type:"raster"},l),s.extend(this,s.pick(l,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=pr(this._options,this.map._requestManager,null,null,(r,l)=>{this._tileJSONRequest=null,this._loaded=!0,r?this.fire(new s.ErrorEvent(r)):l&&(s.extend(this,l),l.bounds&&(this.tileBounds=new Ui(l.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(l.tiles),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return s.extend({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,l){const p=s.exported.devicePixelRatio>=2,g=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),p,this.tileSize);r.request=s.getImage(this.map._requestManager.transformRequest(g,s.ResourceType.Tile),(x,b,T,S)=>(delete r.request,r.aborted?(r.state="unloaded",l(null)):x?(r.state="errored",l(x)):b?(this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:T,expires:S}),r.setTexture(b,this.map.painter),r.state="loaded",s.cacheEntryPossiblyAdded(this.dispatcher),void l(null)):l(null)))}static loadTileData(r,l,p){r.setTexture(l,p)}static unloadTileData(r,l){r.texture&&l.saveTileTexture(r.texture)}abortTile(r,l){r.request&&(r.request.cancel(),delete r.request),l()}unloadTile(r,l){r.texture&&this.map.painter.saveTileTexture(r.texture),l()}hasTransition(){return!1}}let ee;function se(h,r,l,p,g,x,b,T){const S=[h,l,g,r,p,x,1,1,1],k=[b,T,1],L=s.adjoint([],S),[G,V,X]=s.transformMat3(k,k,s.transpose(L,L));return s.multiply$1(S,[G,0,0,0,V,0,0,0,X],S)}class me extends s.Evented{constructor(r,l,p,g){super(),this.id=r,this.dispatcher=p,this.coordinates=l.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(g),this.options=l,this._dirty=!1}load(r,l){this._loaded=l||!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=s.getImage(this.map._requestManager.transformRequest(this.url,s.ResourceType.Image),(p,g)=>{if(this._imageRequest=null,this._loaded=!0,p)this.fire(new s.ErrorEvent(p));else if(g){const{HTMLImageElement:x}=s.window;this.image=g instanceof x?s.exported.getImageData(g):g,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,r&&(this.coordinates=r),this._finishLoading()}})}loaded(){return this._loaded}updateImage(r){return this.image&&r.url?(this._imageRequest&&r.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=r.url,this.load(r.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(r){this.map=r,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(r){this.coordinates=r,this._boundsArray=void 0;const l=r.map(s.MercatorCoordinate.fromLngLat);return this.tileID=function(p){let g=1/0,x=1/0,b=-1/0,T=-1/0;for(const G of p)g=Math.min(g,G.x),x=Math.min(x,G.y),b=Math.max(b,G.x),T=Math.max(T,G.y);const S=Math.max(b-g,T-x),k=Math.max(0,Math.floor(-Math.log(S)/Math.LN2)),L=Math.pow(2,k);return new s.CanonicalTileID(k,Math.floor((g+b)/2*L),Math.floor((x+T)/2*L))}(l),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(r){for(const S in this.tiles){const k=this.tiles[S];k.state!=="loaded"&&(k.state="loaded",k.texture=this.texture)}if(this._boundsArray)return;const l=s.tileTransform(this.tileID,this.map.transform.projection),[p,g,x,b]=this.coordinates.map(S=>{const k=l.projection.project(S[0],S[1]);return s.getTilePoint(l,k)._round()});this.perspectiveTransform=function(S,k,L,G,V,X,Z,Y,W,$){const te=se(0,0,S,0,0,k,S,k),J=se(L,G,V,X,Z,Y,W,$);return s.multiply$1(J,s.adjoint(te,te),J),[J[6]/J[8]*S/s.EXTENT,J[7]/J[8]*k/s.EXTENT]}(this.width,this.height,p.x,p.y,g.x,g.y,b.x,b.y,x.x,x.y);const T=this._boundsArray=new s.StructArrayLayout4i8;T.emplaceBack(p.x,p.y,0,0),T.emplaceBack(g.x,g.y,s.EXTENT,0),T.emplaceBack(b.x,b.y,0,s.EXTENT),T.emplaceBack(x.x,x.y,s.EXTENT,s.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=r.createVertexBuffer(T,s.boundsAttributes.members),this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const r=this.map.painter.context,l=r.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new s.Texture(r,this.image,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(r)}loadTile(r,l){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={},l(null)):(r.state="errored",l(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const De={vector:class extends s.Evented{constructor(h,r,l,p){if(super(),this.id=h,this.dispatcher=l,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.extend(this,s.pick(r,["url","scheme","tileSize","promoteId"])),this._options=s.extend({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(p),this._tileWorkers={},this._deduped=new s.DedupedRequest}load(h){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"}));const r=Array.isArray(this.map._language)?this.map._language.join():this.map._language,l=this.map._worldview;this._tileJSONRequest=pr(this._options,this.map._requestManager,r,l,(p,g)=>{this._tileJSONRequest=null,this._loaded=!0,p?(r&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${r}`),l&&l.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${l}`),this.fire(new s.ErrorEvent(p))):g&&(s.extend(this,g),g.bounds&&(this.tileBounds=new Ui(g.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(g.tiles,this.map._requestManager._customAccessToken),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))),h&&h(p)})}loaded(){return this._loaded}hasTile(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)}onAdd(h){this.map=h,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>{const h=this.map.style._getSourceCaches(this.id);for(const r of h)r.clearTiles()})}setSourceProperty(h){h(),this.reload()}setTiles(h){return this._options.tiles=h,this.reload(),this}setUrl(h){return this.url=h,this._options.url=h,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.extend({},this._options)}loadTile(h,r){const l=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme)),p={request:this.map._requestManager.transformRequest(l,s.ResourceType.Tile),data:void 0,uid:h.uid,tileID:h.tileID,tileZoom:h.tileZoom,zoom:h.tileID.overscaledZ,tileSize:this.tileSize*h.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:h.isSymbolTile};if(p.request.collectResourceTiming=this._collectResourceTiming,h.actor&&h.state!=="expired")h.state==="loading"?h.reloadCallback=r:h.request=h.actor.send("reloadTile",p,g.bind(this));else if(h.actor=this._tileWorkers[l]=this._tileWorkers[l]||this.dispatcher.getActor(),this.dispatcher.ready)h.request=h.actor.send("loadTile",p,g.bind(this),void 0,!0);else{const x=s.loadVectorTile.call({deduped:this._deduped},p,(b,T)=>{b||!T?g.call(this,b):(p.data={cacheControl:T.cacheControl,expires:T.expires,rawData:T.rawData.slice(0)},h.actor&&h.actor.send("loadTile",p,g.bind(this),void 0,!0))},!0);h.request={cancel:x}}function g(x,b){return delete h.request,h.aborted?r(null):x&&x.status!==404?r(x):(b&&b.resourceTiming&&(h.resourceTiming=b.resourceTiming),this.map._refreshExpiredTiles&&b&&h.setExpiryData(b),h.loadVectorData(b,this.map.painter),s.cacheEntryPossiblyAdded(this.dispatcher),r(null),void(h.reloadCallback&&(this.loadTile(h,h.reloadCallback),h.reloadCallback=null)))}}abortTile(h){h.request&&(h.request.cancel(),delete h.request),h.actor&&h.actor.send("abortTile",{uid:h.uid,type:this.type,source:this.id})}unloadTile(h){h.unloadVectorData(),h.actor&&h.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}},raster:j,"raster-dem":class extends j{constructor(h,r,l,p){super(h,r,l,p),this.type="raster-dem",this.maxzoom=22,this._options=s.extend({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}loadTile(h,r){const l=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function p(g,x){g&&(h.state="errored",r(g)),x&&(h.dem=x,h.dem.onDeserialize(),h.needsHillshadePrepare=!0,h.needsDEMTextureUpload=!0,h.state="loaded",r(null))}h.request=s.getImage(this.map._requestManager.transformRequest(l,s.ResourceType.Tile),function(g,x,b,T){if(delete h.request,h.aborted)h.state="unloaded",r(null);else if(g)h.state="errored",r(g);else if(x){this.map._refreshExpiredTiles&&h.setExpiryData({cacheControl:b,expires:T});const S=s.window.ImageBitmap&&x instanceof s.window.ImageBitmap&&(ee==null&&(ee=s.window.OffscreenCanvas&&new s.window.OffscreenCanvas(1,1).getContext("2d")&&typeof s.window.createImageBitmap=="function"),ee),k=1-(x.width-s.prevPowerOfTwo(x.width))/2;k<1||h.neighboringTiles||(h.neighboringTiles=this._getNeighboringTiles(h.tileID));const L=S?x:s.exported.getImageData(x,k),G={uid:h.uid,coord:h.tileID,source:this.id,rawImageData:L,encoding:this.encoding,padding:k};h.actor&&h.state!=="expired"||(h.actor=this.dispatcher.getActor(),h.actor.send("loadDEMTile",G,p.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(h){const r=h.canonical,l=Math.pow(2,r.z),p=(r.x-1+l)%l,g=r.x===0?h.wrap-1:h.wrap,x=(r.x+1+l)%l,b=r.x+1===l?h.wrap+1:h.wrap,T={};return T[new s.OverscaledTileID(h.overscaledZ,g,r.z,p,r.y).key]={backfilled:!1},T[new s.OverscaledTileID(h.overscaledZ,b,r.z,x,r.y).key]={backfilled:!1},r.y>0&&(T[new s.OverscaledTileID(h.overscaledZ,g,r.z,p,r.y-1).key]={backfilled:!1},T[new s.OverscaledTileID(h.overscaledZ,h.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},T[new s.OverscaledTileID(h.overscaledZ,b,r.z,x,r.y-1).key]={backfilled:!1}),r.y+1<l&&(T[new s.OverscaledTileID(h.overscaledZ,g,r.z,p,r.y+1).key]={backfilled:!1},T[new s.OverscaledTileID(h.overscaledZ,h.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},T[new s.OverscaledTileID(h.overscaledZ,b,r.z,x,r.y+1).key]={backfilled:!1}),T}unloadTile(h){h.demTexture&&this.map.painter.saveTileTexture(h.demTexture),h.fbo&&(h.fbo.destroy(),delete h.fbo),h.dem&&delete h.dem,delete h.neighboringTiles,h.state="unloaded"}},geojson:class extends s.Evented{constructor(h,r,l,p){super(),this.id=h,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=l.getActor(),this.setEventedParent(p),this._data=r.data,this._options=s.extend({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;const g=s.EXTENT/this.tileSize;this.workerOptions=s.extend({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(r.buffer!==void 0?r.buffer:128)*g,tolerance:(r.tolerance!==void 0?r.tolerance:.375)*g,extent:s.EXTENT,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:s.EXTENT,radius:(r.clusterRadius!==void 0?r.clusterRadius:50)*g,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions)}onAdd(h){this.map=h,this.setData(this._data)}setData(h){return this._data=h,this._updateWorkerData(),this}getClusterExpansionZoom(h,r){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:h,source:this.id},r),this}getClusterChildren(h,r){return this.actor.send("geojson.getClusterChildren",{clusterId:h,source:this.id},r),this}getClusterLeaves(h,r,l,p){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:h,limit:r,offset:l},p),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new s.Event("dataloading",{dataType:"source"})),this._loaded=!1;const h=s.extend({},this.workerOptions),r=this._data;typeof r=="string"?(h.request=this.map._requestManager.transformRequest(s.exported.resolveURL(r),s.ResourceType.Source),h.request.collectResourceTiming=this._collectResourceTiming):h.data=JSON.stringify(r),this._pendingLoad=this.actor.send(`${this.type}.loadData`,h,(l,p)=>{if(this._loaded=!0,this._pendingLoad=null,l)this.fire(new s.ErrorEvent(l));else{const g={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&p&&p.resourceTiming&&p.resourceTiming[this.id]&&(g.resourceTiming=p.resourceTiming[this.id]),this.fire(new s.Event("data",g)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(h,r){const l=h.actor?"reloadTile":"loadTile";h.actor=this.actor,h.request=this.actor.send(l,{type:this.type,uid:h.uid,tileID:h.tileID,tileZoom:h.tileZoom,zoom:h.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(p,g)=>(delete h.request,h.unloadVectorData(),h.aborted?r(null):p?r(p):(h.loadVectorData(g,this.map.painter,l==="reloadTile"),r(null))),void 0,l==="loadTile")}abortTile(h){h.request&&(h.request.cancel(),delete h.request),h.aborted=!0}unloadTile(h){h.unloadVectorData(),this.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return s.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends me{constructor(h,r,l,p){super(h,r,l,p),this.roundZoom=!0,this.type="video",this.options=r}load(){this._loaded=!1;const h=this.options;this.urls=[];for(const r of h.urls)this.urls.push(this.map._requestManager.transformRequest(r,s.ResourceType.Source).url);s.getVideo(this.urls,(r,l)=>{this._loaded=!0,r?this.fire(new s.ErrorEvent(r)):l&&(this.video=l,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(h){if(this.video){const r=this.video.seekable;h<r.start(0)||h>r.end(0)?this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=h}}getVideo(){return this.video}onAdd(h){this.map||(this.map=h,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const h=this.map.painter.context,r=h.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new s.Texture(h,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(h)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:me,canvas:class extends me{constructor(h,r,l,p){super(h,r,l,p),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some(g=>!Array.isArray(g)||g.length!==2||g.some(x=>typeof x!="number"))||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${h}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${h}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${h}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof s.window.HTMLCanvasElement||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${h}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${h}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof s.window.HTMLCanvasElement?this.options.canvas:s.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(h){this.map=h,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let h=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,h=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,h=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context;this.texture?(h||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.Texture(r,this.canvas,r.gl.RGBA,{premultiply:!0}),this._prepareData(r)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const h of[this.canvas.width,this.canvas.height])if(isNaN(h)||h<=0)return!0;return!1}},custom:class extends s.Evented{constructor(h,r,l,p){super(),this.id=h,this.type="custom",this._dataType="raster",this._dispatcher=l,this._implementation=r,this.setEventedParent(p),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new s.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new s.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Ui(this._implementation.bounds,this.minzoom,this.maxzoom)),r.update=this._update.bind(this),r.clearTiles=this._clearTiles.bind(this),r.coveringTiles=this._coveringTiles.bind(this),s.extend(this,s.pick(r,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return s.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(h){this._map=h,this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(h),this.load()}onRemove(h){this._implementation.onRemove&&this._implementation.onRemove(h)}hasTile(h){if(this._implementation.hasTile){const{x:r,y:l,z:p}=h.canonical;return this._implementation.hasTile({x:r,y:l,z:p})}return!this.tileBounds||this.tileBounds.contains(h.canonical)}loadTile(h,r){const{x:l,y:p,z:g}=h.tileID.canonical,x=new s.window.AbortController;h.request=Promise.resolve(this._implementation.loadTile({x:l,y:p,z:g},{signal:x.signal})).then(function(b){return delete h.request,h.aborted?(h.state="unloaded",r(null)):b===void 0?(h.state="errored",r(null)):b===null?(this.loadTileData(h,{width:this.tileSize,height:this.tileSize,data:null}),h.state="loaded",r(null)):function(T){return T instanceof s.window.ImageData||T instanceof s.window.HTMLCanvasElement||T instanceof s.window.ImageBitmap||T instanceof s.window.HTMLImageElement}(b)?(this.loadTileData(h,b),h.state="loaded",void r(null)):(h.state="errored",r(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}.bind(this)).catch(b=>{b.code!==20&&(h.state="errored",r(b))}),h.request.cancel=()=>x.abort()}loadTileData(h,r){j.loadTileData(h,r,this._map.painter)}unloadTileData(h){j.unloadTileData(h,this._map.painter)}unloadTile(h,r){if(this.unloadTileData(h),this._implementation.unloadTile){const{x:l,y:p,z:g}=h.tileID.canonical;this._implementation.unloadTile({x:l,y:p,z:g})}r()}abortTile(h,r){h.request&&h.request.cancel&&(h.request.cancel(),delete h.request),r()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(h=>({x:h.canonical.x,y:h.canonical.y,z:h.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Te=function(h,r,l,p){const g=new De[r.type](h,r,l,p);if(g.id!==h)throw new Error(`Expected Source id to be ${h} instead of ${g.id}`);return s.bindAll(["load","abort","unload","serialize","prepare"],g),g};function ye(h,r){const l=s.identity([]);return s.scale(l,l,[.5*h.width,.5*-h.height,1]),s.translate(l,l,[1,-1,0]),s.multiply(l,l,h.calculateProjMatrix(r.toUnwrapped())),Float32Array.from(l)}function Pe(h,r,l,p,g,x,b,T=!1){const S=h.tilesIn(p,b,T);S.sort(yt);const k=[];for(const G of S)k.push({wrappedTileID:G.tile.tileID.wrapped().key,queryResults:G.tile.queryRenderedFeatures(r,l,h._state,G,g,x,ye(h.transform,G.tile.tileID),T)});const L=function(G){const V={},X={};for(const Z of G){const Y=Z.queryResults,W=Z.wrappedTileID,$=X[W]=X[W]||{};for(const te in Y){const J=Y[te],le=$[te]=$[te]||{},ue=V[te]=V[te]||[];for(const oe of J)le[oe.featureIndex]||(le[oe.featureIndex]=!0,ue.push(oe))}}return V}(k);for(const G in L)L[G].forEach(V=>{const X=V.feature,Z=X.layer;Z&&Z.type!=="background"&&Z.type!=="sky"&&(X.source=Z.source,Z["source-layer"]&&(X.sourceLayer=Z["source-layer"]),X.state=X.id!==void 0?h.getFeatureState(Z["source-layer"],X.id):{})});return L}function Je(h,r){const l=h.getRenderableIds().map(x=>h.getTileByID(x)),p=[],g={};for(let x=0;x<l.length;x++){const b=l[x],T=b.tileID.canonical.key;g[T]||(g[T]=!0,b.querySourceFeatures(p,r))}return p}function yt(h,r){const l=h.tileID,p=r.tileID;return l.overscaledZ-p.overscaledZ||l.canonical.y-p.canonical.y||l.wrap-p.wrap||l.canonical.x-p.canonical.x}function et(){return Vu.workerClass!=null?new Vu.workerClass:new s.window.Worker(Vu.workerUrl)}const Nt="mapboxgl_preloaded_worker_pool";class Ft{constructor(){this.active={}}acquire(r){if(!this.workers)for(this.workers=[];this.workers.length<Ft.workerCount;)this.workers.push(new et);return this.active[r]=!0,this.workers.slice()}release(r){delete this.active[r],this.numActive()===0&&(this.workers.forEach(l=>{l.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Nt]}numActive(){return Object.keys(this.active).length}}let zt;function Wt(){return zt||(zt=new Ft),zt}function dn(h,r){const l={};for(const p in h)p!=="ref"&&(l[p]=h[p]);return s.refProperties.forEach(p=>{p in r&&(l[p]=r[p])}),l}function Tn(h){h=h.slice();const r=Object.create(null);for(let l=0;l<h.length;l++)r[h[l].id]=h[l];for(let l=0;l<h.length;l++)"ref"in h[l]&&(h[l]=dn(h[l],r[h[l].ref]));return h}Ft.workerCount=2;const Ut={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Gn(h,r,l){l.push({command:Ut.addSource,args:[h,r[h]]})}function In(h,r,l){r.push({command:Ut.removeSource,args:[h]}),l[h]=!0}function ea(h,r,l,p){In(h,l,p),Gn(h,r,l)}function As(h,r,l){let p;for(p in h[l])if(h[l].hasOwnProperty(p)&&p!=="data"&&!N(h[l][p],r[l][p]))return!1;for(p in r[l])if(r[l].hasOwnProperty(p)&&p!=="data"&&!N(h[l][p],r[l][p]))return!1;return!0}function Ne(h,r,l,p,g,x){let b;for(b in r=r||{},h=h||{})h.hasOwnProperty(b)&&(N(h[b],r[b])||l.push({command:x,args:[p,b,r[b],g]}));for(b in r)r.hasOwnProperty(b)&&!h.hasOwnProperty(b)&&(N(h[b],r[b])||l.push({command:x,args:[p,b,r[b],g]}))}function Ho(h){return h.id}function yr(h,r){return h[r.id]=r,h}class bs{constructor(r,l){this.reset(r,l)}reset(r,l){this.points=r||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(l||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=s.clamp(r,0,1);let l=1,p=this._distances[l];const g=r*this.paddedLength+this.padding;for(;p<g&&l<this._distances.length;)p=this._distances[++l];const x=l-1,b=this._distances[x],T=p-b,S=T>0?(g-b)/T:0;return this.points[x].mult(1-S).add(this.points[l].mult(S))}}class hf{constructor(r,l,p){const g=this.boxCells=[],x=this.circleCells=[];this.xCellCount=Math.ceil(r/p),this.yCellCount=Math.ceil(l/p);for(let b=0;b<this.xCellCount*this.yCellCount;b++)g.push([]),x.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=l,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/l,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,l,p,g,x){this._forEachCell(l,p,g,x,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(l),this.bboxes.push(p),this.bboxes.push(g),this.bboxes.push(x)}insertCircle(r,l,p,g){this._forEachCell(l-g,p-g,l+g,p+g,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(l),this.circles.push(p),this.circles.push(g)}_insertBoxCell(r,l,p,g,x,b){this.boxCells[x].push(b)}_insertCircleCell(r,l,p,g,x,b){this.circleCells[x].push(b)}_query(r,l,p,g,x,b){if(p<0||r>this.width||g<0||l>this.height)return!x&&[];const T=[];if(r<=0&&l<=0&&this.width<=p&&this.height<=g){if(x)return!0;for(let S=0;S<this.boxKeys.length;S++)T.push({key:this.boxKeys[S],x1:this.bboxes[4*S],y1:this.bboxes[4*S+1],x2:this.bboxes[4*S+2],y2:this.bboxes[4*S+3]});for(let S=0;S<this.circleKeys.length;S++){const k=this.circles[3*S],L=this.circles[3*S+1],G=this.circles[3*S+2];T.push({key:this.circleKeys[S],x1:k-G,y1:L-G,x2:k+G,y2:L+G})}return b?T.filter(b):T}return this._forEachCell(r,l,p,g,this._queryCell,T,{hitTest:x,seenUids:{box:{},circle:{}}},b),x?T.length>0:T}_queryCircle(r,l,p,g,x){const b=r-p,T=r+p,S=l-p,k=l+p;if(T<0||b>this.width||k<0||S>this.height)return!g&&[];const L=[];return this._forEachCell(b,S,T,k,this._queryCellCircle,L,{hitTest:g,circle:{x:r,y:l,radius:p},seenUids:{box:{},circle:{}}},x),g?L.length>0:L}query(r,l,p,g,x){return this._query(r,l,p,g,!1,x)}hitTest(r,l,p,g,x){return this._query(r,l,p,g,!0,x)}hitTestCircle(r,l,p,g){return this._queryCircle(r,l,p,!0,g)}_queryCell(r,l,p,g,x,b,T,S){const k=T.seenUids,L=this.boxCells[x];if(L!==null){const V=this.bboxes;for(const X of L)if(!k.box[X]){k.box[X]=!0;const Z=4*X;if(r<=V[Z+2]&&l<=V[Z+3]&&p>=V[Z+0]&&g>=V[Z+1]&&(!S||S(this.boxKeys[X]))){if(T.hitTest)return b.push(!0),!0;b.push({key:this.boxKeys[X],x1:V[Z],y1:V[Z+1],x2:V[Z+2],y2:V[Z+3]})}}}const G=this.circleCells[x];if(G!==null){const V=this.circles;for(const X of G)if(!k.circle[X]){k.circle[X]=!0;const Z=3*X;if(this._circleAndRectCollide(V[Z],V[Z+1],V[Z+2],r,l,p,g)&&(!S||S(this.circleKeys[X]))){if(T.hitTest)return b.push(!0),!0;{const Y=V[Z],W=V[Z+1],$=V[Z+2];b.push({key:this.circleKeys[X],x1:Y-$,y1:W-$,x2:Y+$,y2:W+$})}}}}}_queryCellCircle(r,l,p,g,x,b,T,S){const k=T.circle,L=T.seenUids,G=this.boxCells[x];if(G!==null){const X=this.bboxes;for(const Z of G)if(!L.box[Z]){L.box[Z]=!0;const Y=4*Z;if(this._circleAndRectCollide(k.x,k.y,k.radius,X[Y+0],X[Y+1],X[Y+2],X[Y+3])&&(!S||S(this.boxKeys[Z])))return b.push(!0),!0}}const V=this.circleCells[x];if(V!==null){const X=this.circles;for(const Z of V)if(!L.circle[Z]){L.circle[Z]=!0;const Y=3*Z;if(this._circlesCollide(X[Y],X[Y+1],X[Y+2],k.x,k.y,k.radius)&&(!S||S(this.circleKeys[Z])))return b.push(!0),!0}}}_forEachCell(r,l,p,g,x,b,T,S){const k=this._convertToXCellCoord(r),L=this._convertToYCellCoord(l),G=this._convertToXCellCoord(p),V=this._convertToYCellCoord(g);for(let X=k;X<=G;X++)for(let Z=L;Z<=V;Z++)if(x.call(this,r,l,p,g,this.xCellCount*Z+X,b,T,S))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,l,p,g,x,b){const T=g-r,S=x-l,k=p+b;return k*k>T*T+S*S}_circleAndRectCollide(r,l,p,g,x,b,T){const S=(b-g)/2,k=Math.abs(r-(g+S));if(k>S+p)return!1;const L=(T-x)/2,G=Math.abs(l-(x+L));if(G>L+p)return!1;if(k<=S||G<=L)return!0;const V=k-S,X=G-L;return V*V+X*X<=p*p}}const $o=Math.tan(85*Math.PI/180);function El(h,r,l,p,g,x,b){const T=s.create();if(l)if(x.name==="globe"){const S=s.calculateGlobeLabelMatrix(g,r);s.multiply(T,T,S)}else{const S=Et([],b);T[0]=S[0],T[1]=S[1],T[4]=S[2],T[5]=S[3],p||s.rotateZ(T,T,g.angle)}else s.multiply(T,g.labelPlaneMatrix,h);return T}function df(h,r,l,p,g,x,b){const T=El(h,r,l,p,g,x,b);return x.name==="globe"&&l||(T[2]=T[6]=T[10]=T[14]=0),T}function qa(h,r,l,p,g,x,b){if(l){if(x.name==="globe"){const T=El(h,r,l,p,g,x,b);return s.invert(T,T),s.multiply(T,h,T),T}{const T=s.clone(h),S=s.identity([]);return S[0]=b[0],S[1]=b[1],S[4]=b[2],S[5]=b[3],s.multiply(T,T,S),p||s.rotateZ(T,T,-g.angle),T}}return g.glCoordMatrix}function mt(h,r,l=0){const p=[h.x,h.y,l,1];l?s.transformMat4$1(p,p,r):Dl(p,p,r);const g=p[3];return{point:[p[0]/g,p[1]/g,p[2]/g],signedDistanceFromCamera:g}}function un(h,r){const l=[h[0],h[1],h[2],1];s.transformMat4$1(l,l,r);const p=l[3];return{point:[l[0]/p,l[1]/p,l[2]/p],signedDistanceFromCamera:p}}function fn(h,r){return Math.min(.5+h/r*.5,1.5)}function Wo(h,r){const l=h[0]/h[3],p=h[1]/h[3];return l>=-r[0]&&l<=r[0]&&p>=-r[1]&&p<=r[1]}function ja(h,r,l,p,g,x,b,T,S,k){const L=l.transform,G=p?h.textSizeData:h.iconSizeData,V=s.evaluateSizeForZoom(G,l.transform.zoom),X=L.projection.name==="globe",Z=[256/l.width*2+1,256/l.height*2+1],Y=p?h.text.dynamicLayoutVertexArray:h.icon.dynamicLayoutVertexArray;Y.clear();let W=null;X&&(W=p?h.text.globeExtVertexArray:h.icon.globeExtVertexArray);const $=h.lineVertexArray,te=p?h.text.placedSymbolArray:h.icon.placedSymbolArray,J=l.transform.width/l.transform.height;let le=!1;for(let ue=0;ue<te.length;ue++){const oe=te.get(ue);if(oe.writingMode!==s.WritingMode.vertical||le||ue!==0&&te.get(ue-1).writingMode===s.WritingMode.horizontal||(le=!0),(oe.hidden||oe.writingMode===s.WritingMode.vertical)&&!le){no(oe.numGlyphs,Y);continue}le=!1;const fe=new s.pointGeometry(oe.tileAnchorX,oe.tileAnchorY),Ee=S?S(fe):[0,0,0],Oe=L.projection.projectTilePoint(fe.x,fe.y,k.canonical),Le=[Oe.x+Ee[0],Oe.y+Ee[1],Oe.z+Ee[2]],tt=[...Le,1];if(s.transformMat4$1(tt,tt,r),!Wo(tt,Z)){no(oe.numGlyphs,Y);continue}const Ce=fn(l.transform.cameraToCenterDistance,tt[3]),Ve=s.evaluateSizeForFeature(G,V,oe),He=b?Ve/Ce:Ve*Ce,Me=mt(new s.pointGeometry(Le[0],Le[1]),g,Le[2]);if(Me.signedDistanceFromCamera<=0){no(oe.numGlyphs,Y);continue}let ve={};const pt=b?null:S,ut=Tl(oe,He,!1,T,r,g,x,h.glyphOffsetArray,$,Y,W,Me.point,fe,ve,J,pt,L.projection,k,b);le=ut.useVertical,pt&&ut.needsFlipping&&(ve={}),(ut.notEnoughRoom||le||ut.needsFlipping&&Tl(oe,He,!0,T,r,g,x,h.glyphOffsetArray,$,Y,W,Me.point,fe,ve,J,pt,L.projection,k,b).notEnoughRoom)&&no(oe.numGlyphs,Y)}p?(h.text.dynamicLayoutVertexBuffer.updateData(Y),W&&h.text.globeExtVertexBuffer.updateData(W)):(h.icon.dynamicLayoutVertexBuffer.updateData(Y),W&&h.icon.globeExtVertexBuffer.updateData(W))}function cn(h,r,l,p,g,x,b,T,S,k,L,G,V,X,Z,Y){const W=T.glyphStartIndex+T.numGlyphs,$=T.lineStartIndex,te=T.lineStartIndex+T.lineLength,J=r.getoffsetX(T.glyphStartIndex),le=r.getoffsetX(W-1),ue=Hn(h*J,l,p,g,x,b,T.segment,$,te,S,k,L,G,V,!0,X,Z,Y);if(!ue)return null;const oe=Hn(h*le,l,p,g,x,b,T.segment,$,te,S,k,L,G,V,!0,X,Z,Y);return oe?{first:ue,last:oe}:null}function Bl(h,r,l,p){return h.writingMode===s.WritingMode.horizontal&&Math.abs(l.y-r.y)>Math.abs(l.x-r.x)*p?{useVertical:!0}:h.writingMode===s.WritingMode.vertical?r.y<l.y?{needsFlipping:!0}:null:h.flipState!==0&&function(g,x,b){const T=(x.x-g.x)*b;return T===0||Math.abs((x.y-g.y)/T)>$o}(r,l,p)?h.flipState===1?{needsFlipping:!0}:null:r.x>l.x?{needsFlipping:!0}:null}function Tl(h,r,l,p,g,x,b,T,S,k,L,G,V,X,Z,Y,W,$,te){const J=r/24,le=h.lineOffsetX*J,ue=h.lineOffsetY*J;let oe=[];if(h.numGlyphs>1){const fe=h.glyphStartIndex+h.numGlyphs,Ee=h.lineStartIndex,Oe=h.lineStartIndex+h.lineLength,Le=cn(J,T,le,ue,l,G,V,h,S,x,X,Y,!1,W,$,te);if(!Le)return{notEnoughRoom:!0};const tt=un(Le.first.point,b).point,Ce=un(Le.last.point,b).point,Ve=new s.pointGeometry(tt[0],tt[1]),He=new s.pointGeometry(Ce[0],Ce[1]);if(p&&!l){const Me=Bl(h,Ve,He,Z);if(h.flipState=Me&&Me.needsFlipping?1:2,Me)return Me}oe=[Le.first];for(let Me=h.glyphStartIndex+1;Me<fe-1;Me++){const ve=Hn(J*T.getoffsetX(Me),le,ue,l,G,V,h.segment,Ee,Oe,S,x,X,Y,!1,!1,W,$,te);if(!ve)return{notEnoughRoom:!0};oe.push(ve)}oe.push(Le.last)}else{if(p&&!l){const Ee=mt(V,g).point,Oe=h.lineStartIndex+h.segment+1,Le=new s.pointGeometry(S.getx(Oe),S.gety(Oe)),tt=mt(Le,g),Ce=tt.signedDistanceFromCamera>0?tt.point:ki(V,Le,Ee,1,g,void 0,W,$.canonical),Ve=Bl(h,new s.pointGeometry(Ee[0],Ee[1]),new s.pointGeometry(Ce[0],Ce[1]),Z);if(h.flipState=Ve&&Ve.needsFlipping?1:2,Ve)return Ve}const fe=Hn(J*T.getoffsetX(h.glyphStartIndex),le,ue,l,G,V,h.segment,h.lineStartIndex,h.lineStartIndex+h.lineLength,S,x,X,Y,!1,!1,W,$,te);if(!fe)return{notEnoughRoom:!0};oe=[fe]}if(L)for(const fe of oe)s.updateGlobeVertexNormal(L,k.length+0,fe.up[0],fe.up[1],fe.up[2]),s.updateGlobeVertexNormal(L,k.length+1,fe.up[0],fe.up[1],fe.up[2]),s.updateGlobeVertexNormal(L,k.length+2,fe.up[0],fe.up[1],fe.up[2]),s.updateGlobeVertexNormal(L,k.length+3,fe.up[0],fe.up[1],fe.up[2]),s.addDynamicAttributes(k,fe.point[0],fe.point[1],fe.point[2],fe.angle);else for(const fe of oe)s.addDynamicAttributes(k,fe.point[0],fe.point[1],fe.point[2],fe.angle);return{}}function Va(h,r,l,p,g){const x=p.projectTilePoint(h.x,h.y,r);if(!g)return mt(x,l,x.z);const b=g(h);return mt(new s.pointGeometry(x.x+b[0],x.y+b[1]),l,x.z+b[2])}function ki(h,r,l,p,g,x,b,T){const S=Va(h.add(h.sub(r)._unit()),T,g,b,x).point,k=s.sub([],l,S);return s.scaleAndAdd([],l,k,p/s.length(k))}function Hn(h,r,l,p,g,x,b,T,S,k,L,G,V,X,Z,Y,W,$){const te=p?h-r:h+r;let J=te>0?1:-1,le=0;p&&(J*=-1,le=Math.PI),J<0&&(le+=Math.PI);let ue=J>0?T+b:T+b+1,oe=g,fe=g,Ee=0,Oe=0;const Le=Math.abs(te),tt=[],Ce=[];let Ve=x;const He=()=>{const ht=ue-J;return Ee===0?x:new s.pointGeometry(k.getx(ht),k.gety(ht))},Me=()=>{const ht=He();return ki(ht,Ve||ht,fe,Le-Ee+1,L,V,Y,W.canonical)};for(;Ee+Oe<=Le;){if(ue+=J,ue<T||ue>=S)return null;if(fe=oe,tt.push(oe),X&&Ce.push(Ve||He()),oe=G[ue],oe===void 0){Ve=new s.pointGeometry(k.getx(ue),k.gety(ue));const ht=Va(Ve,W.canonical,L,Y,V);oe=ht.signedDistanceFromCamera>0?G[ue]=ht.point:Me()}else Ve=null;Ee+=Oe,Oe=s.distance(fe,oe)}Ve=Ve||new s.pointGeometry(k.getx(ue),k.gety(ue));const ve=He();Z&&V&&(G[ue]=oe=G[ue]===void 0?oe:Me(),Oe=s.distance(fe,oe));const pt=(Le-Ee)/Oe,ut=Ve.sub(ve).mult(pt)._add(ve),dt=s.sub([],oe,fe),ct=s.scaleAndAdd([],fe,dt,pt);let Tt=[0,0,1],Ht=dt[0],Gt=dt[1];if($&&(Tt=Y.upVector(W.canonical,ut.x,ut.y),Tt[0]!==0||Tt[1]!==0||Tt[2]!==1)){const ht=[1,0,0],Yt=[0,1,0];ht[0]=Tt[2],ht[1]=0,ht[2]=-Tt[0],s.cross(Yt,Tt,ht),s.normalize(ht,ht),s.normalize(Yt,Yt),Ht=s.dot(dt,ht),Gt=s.dot(dt,Yt)}if(l){const ht=s.cross([],Tt,dt);s.normalize(ht,ht),s.scaleAndAdd(ct,ct,ht,l*J)}const kt=le+Math.atan2(Gt,Ht);return tt.push(ct),X&&Ce.push(ut),{point:ct,angle:kt,path:tt,tilePath:Ce,up:Tt}}const pm=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function no(h,r){for(let l=0;l<h;l++){const p=r.length;r.resize(p+4),r.float32.set(pm,4*p)}}function Dl(h,r,l){const p=r[0],g=r[1];return h[0]=l[0]*p+l[4]*g+l[12],h[1]=l[1]*p+l[5]*g+l[13],h[3]=l[3]*p+l[7]*g+l[15],h}const ri=100;class ta{constructor(r,l,p=new hf(r.width+200,r.height+200,25),g=new hf(r.width+200,r.height+200,25)){this.transform=r,this.grid=p,this.ignoredGrid=g,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+ri,this.screenBottomBoundary=r.height+ri,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.fogState=l}placeCollisionBox(r,l,p,g,x,b,T,S){let k=p.projectedAnchorX,L=p.projectedAnchorY,G=p.projectedAnchorZ;const V=p.elevation,X=p.tileID;if(V&&X){const ue=r.getProjection().upVector(X.canonical,p.tileAnchorX,p.tileAnchorY),oe=r.getProjection().upVectorScale(X.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;k+=ue[0]*V*oe,L+=ue[1]*V*oe,G+=ue[2]*V*oe}const Z=this.projectAndGetPerspectiveRatio(T,[k,L,G],p.tileID,r.projection.name==="globe"||!!V||this.transform.pitch>0,r.getProjection()),Y=b*Z.perspectiveRatio,W=(p.x1*l+g.x-p.padding)*Y+Z.point.x,$=(p.y1*l+g.y-p.padding)*Y+Z.point.y,te=(p.x2*l+g.x+p.padding)*Y+Z.point.x,J=(p.y2*l+g.y+p.padding)*Y+Z.point.y,le=Z.perspectiveRatio<=.55||Z.occluded;return!this.isInsideGrid(W,$,te,J)||!x&&this.grid.hitTest(W,$,te,J,S)||le?{box:[],offscreen:!1,occluded:Z.occluded}:{box:[W,$,te,J],offscreen:this.isOffscreen(W,$,te,J),occluded:!1}}placeCollisionCircles(r,l,p,g,x,b,T,S,k,L,G,V,X,Z,Y){const W=[],$=this.transform.elevation,te=$?$.getAtTileOffsetFunc(Y,this.transform.center.lat,this.transform.worldSize,r.getProjection()):ve=>[0,0,0],J=new s.pointGeometry(p.tileAnchorX,p.tileAnchorY),le=r.getProjection().projectTilePoint(p.tileAnchorX,p.tileAnchorY,Y.canonical),ue=te(J),oe=[le.x+ue[0],le.y+ue[1],le.z+ue[2]],fe=r.projection.name==="globe",Ee=this.projectAndGetPerspectiveRatio(T,[oe[0],oe[1],oe[2]],Y,fe||!!$||this.transform.pitch>0,r.getProjection()),{perspectiveRatio:Oe}=Ee,Le=(G?b/Oe:b*Oe)/s.ONE_EM,tt=mt(new s.pointGeometry(oe[0],oe[1]),S,oe[2]).point,Ce=Ee.signedDistanceFromCamera>0?cn(Le,x,p.lineOffsetX*Le,p.lineOffsetY*Le,!1,tt,J,p,g,S,{},$&&!G?te:null,G&&!!$,r.getProjection(),Y,G):null;let Ve=!1,He=!1,Me=!0;if(Ce&&!Ee.occluded){const ve=.5*X*Oe+Z,pt=new s.pointGeometry(-100,-100),ut=new s.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),dt=new bs,ct=Ce.first,Tt=Ce.last;let Ht=[];for(let ht=ct.path.length-1;ht>=1;ht--)Ht.push(ct.path[ht]);for(let ht=1;ht<Tt.path.length;ht++)Ht.push(Tt.path[ht]);const Gt=2.5*ve;if(k){const ht=Ht.map($&&!fe?(Yt,on)=>{const Fn=te(on<ct.path.length-1?ct.tilePath[ct.path.length-1-on]:Tt.tilePath[on-ct.path.length+2]);return Yt[2]=Fn[2],un(Yt,k)}:Yt=>un(Yt,k));Ht=ht.some(Yt=>Yt.signedDistanceFromCamera<=0)?[]:ht.map(Yt=>Yt.point)}let kt=[];if(Ht.length>0){const ht=Ht.map(Dn=>new s.pointGeometry(Dn[0],Dn[1]));let Yt=1/0,on=-1/0,Fn=1/0,Nn=-1/0;for(let Dn=0;Dn<ht.length;Dn++)Yt=Math.min(Yt,ht[Dn].x),Fn=Math.min(Fn,ht[Dn].y),on=Math.max(on,ht[Dn].x),Nn=Math.max(Nn,ht[Dn].y);kt=Yt>=pt.x&&on<=ut.x&&Fn>=pt.y&&Nn<=ut.y?[ht]:on<pt.x||Yt>ut.x||Nn<pt.y||Fn>ut.y?[]:s.clipLine([ht],pt.x,pt.y,ut.x,ut.y)}for(const ht of kt){dt.reset(ht,.25*ve);let Yt=0;Yt=dt.length<=.5*ve?1:Math.ceil(dt.paddedLength/Gt)+1;for(let on=0;on<Yt;on++){const Fn=on/Math.max(Yt-1,1),Nn=dt.lerp(Fn),Dn=Nn.x+ri,Mr=Nn.y+ri;W.push(Dn,Mr,ve,0);const ii=Dn-ve,Io=Mr-ve,Un=Dn+ve,lr=Mr+ve;if(Me=Me&&this.isOffscreen(ii,Io,Un,lr),He=He||this.isInsideGrid(ii,Io,Un,lr),!l&&this.grid.hitTestCircle(Dn,Mr,ve,V)&&(Ve=!0,!L))return{circles:[],offscreen:!1,collisionDetected:Ve,occluded:!1}}}}return{circles:!L&&Ve||!He?[]:W,offscreen:Me,collisionDetected:Ve,occluded:Ee.occluded}}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const l=[];let p=1/0,g=1/0,x=-1/0,b=-1/0;for(const L of r){const G=new s.pointGeometry(L.x+ri,L.y+ri);p=Math.min(p,G.x),g=Math.min(g,G.y),x=Math.max(x,G.x),b=Math.max(b,G.y),l.push(G)}const T=this.grid.query(p,g,x,b).concat(this.ignoredGrid.query(p,g,x,b)),S={},k={};for(const L of T){const G=L.key;if(S[G.bucketInstanceId]===void 0&&(S[G.bucketInstanceId]={}),S[G.bucketInstanceId][G.featureIndex])continue;const V=[new s.pointGeometry(L.x1,L.y1),new s.pointGeometry(L.x2,L.y1),new s.pointGeometry(L.x2,L.y2),new s.pointGeometry(L.x1,L.y2)];s.polygonIntersectsPolygon(l,V)&&(S[G.bucketInstanceId][G.featureIndex]=!0,k[G.bucketInstanceId]===void 0&&(k[G.bucketInstanceId]=[]),k[G.bucketInstanceId].push(G.featureIndex))}return k}insertCollisionBox(r,l,p,g,x){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:g,collisionGroupID:x},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,l,p,g,x){const b=l?this.ignoredGrid:this.grid,T={bucketInstanceId:p,featureIndex:g,collisionGroupID:x};for(let S=0;S<r.length;S+=4)b.insertCircle(T,r[S],r[S+1],r[S+2])}projectAndGetPerspectiveRatio(r,l,p,g,x){const b=[l[0],l[1],l[2],1];let T=!1;if(l[2]||this.transform.pitch>0){s.transformMat4$1(b,b,r);const S=x.name==="globe";this.fogState&&p&&!S&&(T=function(k,L,G,V,X,Z){const Y=Z.calculateFogTileMatrix(X),W=[L,G,V];return s.transformMat4(W,W,Y),xt(k,W,Z.pitch,Z._fov)}(this.fogState,l[0],l[1],l[2],p.toUnwrapped(),this.transform)>.9)}else Dl(b,b,r);return{point:new s.pointGeometry((b[0]/b[3]+1)/2*this.transform.width+ri,(-b[1]/b[3]+1)/2*this.transform.height+ri),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(x)/b[3]*.5,1.5),signedDistanceFromCamera:b[3],occluded:g&&b[2]>b[3]||T}}isOffscreen(r,l,p,g){return p<ri||r>=this.screenRightBoundary||g<ri||l>this.screenBottomBoundary}isInsideGrid(r,l,p,g){return p>=0&&r<this.gridRightBoundary&&g>=0&&l<this.gridBottomBoundary}getViewportMatrix(){const r=s.identity([]);return s.translate(r,r,[-100,-100,0]),r}}function wu(h,r,l){const p=r.createTileMatrix(h,h.worldSize,l.toUnwrapped());return s.multiply(new Float32Array(16),h.projMatrix,p)}function Au(h,r,l){if(r.projection.name===l.projection.name)return h.projMatrix;const p=l.clone();return p.setProjection(r.projection),wu(p,r.getProjection(),h)}function bu(h,r,l){return r.name===l.projection.name?h.projMatrix:wu(l,r,h)}class Sl{constructor(r,l,p,g){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?l:-l))):g&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class na{constructor(r,l,p,g,x,b=!1){this.text=new Sl(r?r.text:null,l,p,x),this.icon=new Sl(r?r.icon:null,l,g,x),this.clipped=b}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Xr{constructor(r,l,p,g=!1){this.text=r,this.icon=l,this.skipFade=p,this.clipped=g}}class _r{constructor(){this.invProjMatrix=s.create(),this.viewportMatrix=s.create(),this.circles=[]}}class Nh{constructor(r,l,p,g,x){this.bucketInstanceId=r,this.featureIndex=l,this.sourceLayerIndex=p,this.bucketIndex=g,this.tileID=x}}class Uh{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const l=++this.maxGroupID;this.collisionGroups[r]={ID:l,predicate:p=>p.collisionGroupID===l}}return this.collisionGroups[r]}}function mi(h,r,l,p,g){const{horizontalAlign:x,verticalAlign:b}=s.getAnchorAlignment(h),T=-(x-.5)*r,S=-(b-.5)*l,k=s.evaluateVariableOffset(h,p);return new s.pointGeometry(T+k[0]*g,S+k[1]*g)}function _i(h,r,l,p,g){const x=new s.pointGeometry(h,r);return l&&x._rotate(p?g:-g),x}class ff{constructor(r,l,p,g,x){this.transform=r.clone(),this.projection=r.projection.name,this.collisionIndex=new ta(this.transform,x),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new Uh(p),this.collisionCircleArrays={},this.prevPlacement=g,g&&(g.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,l,p,g){const x=p.getBucket(l),b=p.latestFeatureIndex;if(!x||!b||l.id!==x.layerIds[0])return;const T=x.layers[0].layout,S=p.collisionBoxArray,k=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),L=p.tileSize/s.EXTENT,G=p.tileID.toUnwrapped();this.transform.setProjection(x.projection);const V=(X=p.tileID,Z=x.getProjection(),Y=this.transform,Z.name===this.projection?Y.calculateProjMatrix(X.toUnwrapped()):wu(Y,Z,X));var X,Z,Y;const W=T.get("text-pitch-alignment")==="map",$=T.get("text-rotation-alignment")==="map";l.compileFilter();const te=l.dynamicFilter(),J=l.dynamicFilterNeedsFeature(),le=this.transform.calculatePixelsToTileUnitsMatrix(p),ue=df(V,p.tileID.canonical,W,$,this.transform,x.getProjection(),le);let oe=null;if(W){const Oe=qa(V,p.tileID.canonical,W,$,this.transform,x.getProjection(),le);oe=s.multiply([],this.transform.labelPlaneMatrix,Oe)}let fe=null;te&&p.latestFeatureIndex&&(fe={unwrappedTileID:G,dynamicFilter:te,dynamicFilterNeedsFeature:J,featureIndex:p.latestFeatureIndex}),this.retainedQueryData[x.bucketInstanceId]=new Nh(x.bucketInstanceId,b,x.sourceLayerIndex,x.index,p.tileID);const Ee={bucket:x,layout:T,posMatrix:V,textLabelPlaneMatrix:ue,labelToScreenMatrix:oe,clippingData:fe,scale:k,textPixelRatio:L,holdingForFade:p.holdingForFade(),collisionBoxArray:S,partiallyEvaluatedTextSize:s.evaluateSizeForZoom(x.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:s.evaluateSizeForZoom(x.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(x.sourceID)};if(g)for(const Oe of x.sortKeyRanges){const{sortKey:Le,symbolInstanceStart:tt,symbolInstanceEnd:Ce}=Oe;r.push({sortKey:Le,symbolInstanceStart:tt,symbolInstanceEnd:Ce,parameters:Ee})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:x.symbolInstances.length,parameters:Ee})}attemptAnchorPlacement(r,l,p,g,x,b,T,S,k,L,G,V,X,Z,Y,W,$,te){const J=[V.textOffset0,V.textOffset1],le=mi(r,p,g,J,x),ue=this.collisionIndex.placeCollisionBox(Z,x,l,_i(le.x,le.y,b,T,this.transform.angle),G,S,k,L.predicate);if(W){const oe=Z.getSymbolInstanceIconSize(te,this.transform.zoom,V.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(Z,oe,W,_i(le.x,le.y,b,T,this.transform.angle),G,S,k,L.predicate).box.length===0)return}if(ue.box.length>0){let oe;return this.prevPlacement&&this.prevPlacement.variableOffsets[V.crossTileID]&&this.prevPlacement.placements[V.crossTileID]&&this.prevPlacement.placements[V.crossTileID].text&&(oe=this.prevPlacement.variableOffsets[V.crossTileID].anchor),this.variableOffsets[V.crossTileID]={textOffset:J,width:p,height:g,anchor:r,textScale:x,prevAnchor:oe},this.markUsedJustification(Z,r,V,Y),Z.allowVerticalPlacement&&(this.markUsedOrientation(Z,Y,V),this.placedOrientations[V.crossTileID]=Y),{shift:le,placedGlyphBoxes:ue}}}placeLayerBucketPart(r,l,p,g){const{bucket:x,layout:b,posMatrix:T,textLabelPlaneMatrix:S,labelToScreenMatrix:k,clippingData:L,textPixelRatio:G,holdingForFade:V,collisionBoxArray:X,partiallyEvaluatedTextSize:Z,partiallyEvaluatedIconSize:Y,collisionGroup:W}=r.parameters,$=b.get("text-optional"),te=b.get("icon-optional"),J=b.get("text-allow-overlap"),le=b.get("icon-allow-overlap"),ue=b.get("text-rotation-alignment")==="map",oe=b.get("text-pitch-alignment")==="map",fe=b.get("icon-text-fit")!=="none",Ee=b.get("symbol-z-order")==="viewport-y";this.transform.setProjection(x.projection);let Oe=J&&(le||!x.hasIconData()||te),Le=le&&(J||!x.hasTextData()||$);!x.collisionArrays&&X&&x.deserializeCollisionBoxes(X),p&&g&&x.updateCollisionDebugBuffers(this.transform.zoom,X);const tt=(Ce,Ve,He)=>{if(L){const Un={zoom:this.transform.zoom,pitch:this.transform.pitch};let lr=null;if(L.dynamicFilterNeedsFeature){const Sn=this.retainedQueryData[x.bucketInstanceId];lr=L.featureIndex.loadFeature({featureIndex:Ce.featureIndex,bucketIndex:Sn.bucketIndex,sourceLayerIndex:Sn.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,L.dynamicFilter)(Un,lr,this.retainedQueryData[x.bucketInstanceId].tileID.canonical,new s.pointGeometry(Ce.tileAnchorX,Ce.tileAnchorY),this.transform.calculateDistanceTileData(L.unwrappedTileID)))return this.placements[Ce.crossTileID]=new Xr(!1,!1,!1,!0),void(l[Ce.crossTileID]=!0)}if(l[Ce.crossTileID])return;if(V)return void(this.placements[Ce.crossTileID]=new Xr(!1,!1,!1));let Me=!1,ve=!1,pt=!0,ut=!1,dt=!1,ct=null,Tt={box:null,offscreen:null,occluded:null},Ht={box:null,offscreen:null,occluded:null},Gt=null,kt=null,ht=null,Yt=0,on=0,Fn=0;He.textFeatureIndex?Yt=He.textFeatureIndex:Ce.useRuntimeCollisionCircles&&(Yt=Ce.featureIndex),He.verticalTextFeatureIndex&&(on=He.verticalTextFeatureIndex);const Nn=Un=>{Un.tileID=this.retainedQueryData[x.bucketInstanceId].tileID,(this.transform.elevation||Un.elevation)&&(Un.elevation=this.transform.elevation?this.transform.elevation.getAtTileOffset(this.retainedQueryData[x.bucketInstanceId].tileID,Un.tileAnchorX,Un.tileAnchorY):0)},Dn=He.textBox;if(Dn){Nn(Dn);const Un=Sn=>{let vr=s.WritingMode.horizontal;if(x.allowVerticalPlacement&&!Sn&&this.prevPlacement){const oi=this.prevPlacement.placedOrientations[Ce.crossTileID];oi&&(this.placedOrientations[Ce.crossTileID]=oi,vr=oi,this.markUsedOrientation(x,vr,Ce))}return vr},lr=(Sn,vr)=>{if(x.allowVerticalPlacement&&Ce.numVerticalGlyphVertices>0&&He.verticalTextBox){for(const oi of x.writingModes)if(oi===s.WritingMode.vertical?(Tt=vr(),Ht=Tt):Tt=Sn(),Tt&&Tt.box&&Tt.box.length)break}else Tt=Sn()};if(b.get("text-variable-anchor")){let Sn=b.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ce.crossTileID]){const jn=this.prevPlacement.variableOffsets[Ce.crossTileID];Sn.indexOf(jn.anchor)>0&&(Sn=Sn.filter(zi=>zi!==jn.anchor),Sn.unshift(jn.anchor))}const vr=(jn,zi,ks)=>{const ao=x.getSymbolInstanceTextSize(Z,Ce,this.transform.zoom,Ve),Yr=(jn.x2-jn.x1)*ao+2*jn.padding,Kl=(jn.y2-jn.y1)*ao+2*jn.padding,is=fe&&!le?zi:null;is&&Nn(is);let Jt={box:[],offscreen:!1,occluded:!1};const os=J?2*Sn.length:Sn.length;for(let fa=0;fa<os;++fa){const Ai=this.attemptAnchorPlacement(Sn[fa%Sn.length],jn,Yr,Kl,ao,ue,oe,G,T,W,fa>=Sn.length,Ce,Ve,x,ks,is,Z,Y);if(Ai&&(Jt=Ai.placedGlyphBoxes,Jt&&Jt.box&&Jt.box.length)){Me=!0,ct=Ai.shift;break}}return Jt};lr(()=>vr(Dn,He.iconBox,s.WritingMode.horizontal),()=>{const jn=He.verticalTextBox;return jn&&Nn(jn),x.allowVerticalPlacement&&!(Tt&&Tt.box&&Tt.box.length)&&Ce.numVerticalGlyphVertices>0&&jn?vr(jn,He.verticalIconBox,s.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),Tt&&(Me=Tt.box,pt=Tt.offscreen,ut=Tt.occluded);const oi=Un(Tt&&Tt.box);if(!Me&&this.prevPlacement){const jn=this.prevPlacement.variableOffsets[Ce.crossTileID];jn&&(this.variableOffsets[Ce.crossTileID]=jn,this.markUsedJustification(x,jn.anchor,Ce,oi))}}else{const Sn=(vr,oi)=>{const jn=x.getSymbolInstanceTextSize(Z,Ce,this.transform.zoom,Ve),zi=this.collisionIndex.placeCollisionBox(x,jn,vr,new s.pointGeometry(0,0),J,G,T,W.predicate);return zi&&zi.box&&zi.box.length&&(this.markUsedOrientation(x,oi,Ce),this.placedOrientations[Ce.crossTileID]=oi),zi};lr(()=>Sn(Dn,s.WritingMode.horizontal),()=>{const vr=He.verticalTextBox;return x.allowVerticalPlacement&&Ce.numVerticalGlyphVertices>0&&vr?(Nn(vr),Sn(vr,s.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Un(Tt&&Tt.box&&Tt.box.length)}}if(Gt=Tt,Me=Gt&&Gt.box&&Gt.box.length>0,pt=Gt&&Gt.offscreen,ut=Gt&&Gt.occluded,Ce.useRuntimeCollisionCircles){const Un=x.text.placedSymbolArray.get(Ce.centerJustifiedTextSymbolIndex>=0?Ce.centerJustifiedTextSymbolIndex:Ce.verticalPlacedTextSymbolIndex),lr=s.evaluateSizeForFeature(x.textSizeData,Z,Un),Sn=b.get("text-padding");kt=this.collisionIndex.placeCollisionCircles(x,J,Un,x.lineVertexArray,x.glyphOffsetArray,lr,T,S,k,p,oe,W.predicate,Ce.collisionCircleDiameter*lr/s.ONE_EM,Sn,this.retainedQueryData[x.bucketInstanceId].tileID),Me=J||kt.circles.length>0&&!kt.collisionDetected,pt=pt&&kt.offscreen,ut=kt.occluded}if(He.iconFeatureIndex&&(Fn=He.iconFeatureIndex),He.iconBox){const Un=lr=>{Nn(lr);const Sn=fe&&ct?_i(ct.x,ct.y,ue,oe,this.transform.angle):new s.pointGeometry(0,0),vr=x.getSymbolInstanceIconSize(Y,this.transform.zoom,Ce.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(x,vr,lr,Sn,le,G,T,W.predicate)};Ht&&Ht.box&&Ht.box.length&&He.verticalIconBox?(ht=Un(He.verticalIconBox),ve=ht.box.length>0):(ht=Un(He.iconBox),ve=ht.box.length>0),pt=pt&&ht.offscreen,dt=ht.occluded}const Mr=$||Ce.numHorizontalGlyphVertices===0&&Ce.numVerticalGlyphVertices===0,ii=te||Ce.numIconVertices===0;if(Mr||ii?ii?Mr||(ve=ve&&Me):Me=ve&&Me:ve=Me=ve&&Me,Me&&Gt&&Gt.box&&this.collisionIndex.insertCollisionBox(Gt.box,b.get("text-ignore-placement"),x.bucketInstanceId,Ht&&Ht.box&&on?on:Yt,W.ID),ve&&ht&&this.collisionIndex.insertCollisionBox(ht.box,b.get("icon-ignore-placement"),x.bucketInstanceId,Fn,W.ID),kt&&(Me&&this.collisionIndex.insertCollisionCircles(kt.circles,b.get("text-ignore-placement"),x.bucketInstanceId,Yt,W.ID),p)){const Un=x.bucketInstanceId;let lr=this.collisionCircleArrays[Un];lr===void 0&&(lr=this.collisionCircleArrays[Un]=new _r);for(let Sn=0;Sn<kt.circles.length;Sn+=4)lr.circles.push(kt.circles[Sn+0]),lr.circles.push(kt.circles[Sn+1]),lr.circles.push(kt.circles[Sn+2]),lr.circles.push(kt.collisionDetected?1:0)}const Io=x.projection.name!=="globe";Oe=Oe&&(Io||!ut),Le=Le&&(Io||!dt),this.placements[Ce.crossTileID]=new Xr(Me||Oe,ve||Le,pt||x.justReloaded),l[Ce.crossTileID]=!0};if(Ee){const Ce=x.getSortedSymbolIndexes(this.transform.angle);for(let Ve=Ce.length-1;Ve>=0;--Ve){const He=Ce[Ve];tt(x.symbolInstances.get(He),He,x.collisionArrays[He])}}else for(let Ce=r.symbolInstanceStart;Ce<r.symbolInstanceEnd;Ce++)tt(x.symbolInstances.get(Ce),Ce,x.collisionArrays[Ce]);if(p&&x.bucketInstanceId in this.collisionCircleArrays){const Ce=this.collisionCircleArrays[x.bucketInstanceId];s.invert(Ce.invProjMatrix,T),Ce.viewportMatrix=this.collisionIndex.getViewportMatrix()}x.justReloaded=!1}markUsedJustification(r,l,p,g){let x;x=g===s.WritingMode.vertical?p.verticalPlacedTextSymbolIndex:{left:p.leftJustifiedTextSymbolIndex,center:p.centerJustifiedTextSymbolIndex,right:p.rightJustifiedTextSymbolIndex}[s.getAnchorJustification(l)];const b=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex,p.verticalPlacedTextSymbolIndex];for(const T of b)T>=0&&(r.text.placedSymbolArray.get(T).crossTileID=x>=0&&T!==x?0:p.crossTileID)}markUsedOrientation(r,l,p){const g=l===s.WritingMode.horizontal||l===s.WritingMode.horizontalOnly?l:0,x=l===s.WritingMode.vertical?l:0,b=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex].filter(T=>T!==-1);for(const T of b)r.text.placedSymbolArray.get(T).placedOrientation=g;p.verticalPlacedTextSymbolIndex!==-1&&(r.text.placedSymbolArray.get(p.verticalPlacedTextSymbolIndex).placedOrientation=x)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const l=this.prevPlacement;let p=!1;this.prevZoomAdjustment=l?l.zoomAdjustment(this.transform.zoom):0;const g=l?l.symbolFadeChange(r):1,x=l?l.opacities:{},b=l?l.variableOffsets:{},T=l?l.placedOrientations:{};for(const S in this.placements){const k=this.placements[S],L=x[S];L?(this.opacities[S]=new na(L,g,k.text,k.icon,null,k.clipped),p=p||k.text!==L.text.placed||k.icon!==L.icon.placed):(this.opacities[S]=new na(null,g,k.text,k.icon,k.skipFade,k.clipped),p=p||k.text||k.icon)}for(const S in x){const k=x[S];if(!this.opacities[S]){const L=new na(k,g,!1,!1);L.isHidden()||(this.opacities[S]=L,p=p||k.text.placed||k.icon.placed)}}for(const S in b)this.variableOffsets[S]||!this.opacities[S]||this.opacities[S].isHidden()||(this.variableOffsets[S]=b[S]);for(const S in T)this.placedOrientations[S]||!this.opacities[S]||this.opacities[S].isHidden()||(this.placedOrientations[S]=T[S]);p?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=l?l.lastPlacementChangeTime:r)}updateLayerOpacities(r,l){const p={};for(const g of l){const x=g.getBucket(r);x&&g.latestFeatureIndex&&r.id===x.layerIds[0]&&this.updateBucketOpacities(x,p,g.collisionBoxArray)}}updateBucketOpacities(r,l,p){r.hasTextData()&&r.text.opacityVertexArray.clear(),r.hasIconData()&&r.icon.opacityVertexArray.clear(),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const g=r.layers[0].layout,x=!!r.layers[0].dynamicFilter(),b=new na(null,0,!1,!1,!0),T=g.get("text-allow-overlap"),S=g.get("icon-allow-overlap"),k=g.get("text-variable-anchor"),L=g.get("text-rotation-alignment")==="map",G=g.get("text-pitch-alignment")==="map",V=g.get("icon-text-fit")!=="none",X=new na(null,0,T&&(S||!r.hasIconData()||g.get("icon-optional")),S&&(T||!r.hasTextData()||g.get("text-optional")),!0);!r.collisionArrays&&p&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(p);const Z=(W,$,te)=>{for(let J=0;J<$/4;J++)W.opacityVertexArray.emplaceBack(te)};let Y=0;for(let W=0;W<r.symbolInstances.length;W++){const $=r.symbolInstances.get(W),{numHorizontalGlyphVertices:te,numVerticalGlyphVertices:J,crossTileID:le}=$;let ue=this.opacities[le];l[le]?ue=b:ue||(ue=X,this.opacities[le]=ue),l[le]=!0;const oe=te>0||J>0,fe=$.numIconVertices>0,Ee=this.placedOrientations[$.crossTileID],Oe=Ee===s.WritingMode.vertical,Le=Ee===s.WritingMode.horizontal||Ee===s.WritingMode.horizontalOnly;if(!oe&&!fe||ue.isHidden()||Y++,oe){const tt=Ko(ue.text);Z(r.text,te,Oe?Rn:tt),Z(r.text,J,Le?Rn:tt);const Ce=ue.text.isHidden();[$.rightJustifiedTextSymbolIndex,$.centerJustifiedTextSymbolIndex,$.leftJustifiedTextSymbolIndex].forEach(Me=>{Me>=0&&(r.text.placedSymbolArray.get(Me).hidden=Ce||Oe?1:0)}),$.verticalPlacedTextSymbolIndex>=0&&(r.text.placedSymbolArray.get($.verticalPlacedTextSymbolIndex).hidden=Ce||Le?1:0);const Ve=this.variableOffsets[$.crossTileID];Ve&&this.markUsedJustification(r,Ve.anchor,$,Ee);const He=this.placedOrientations[$.crossTileID];He&&(this.markUsedJustification(r,"left",$,He),this.markUsedOrientation(r,He,$))}if(fe){const tt=Ko(ue.icon);$.placedIconSymbolIndex>=0&&(Z(r.icon,$.numIconVertices,Oe?Rn:tt),r.icon.placedSymbolArray.get($.placedIconSymbolIndex).hidden=ue.icon.isHidden()),$.verticalPlacedIconSymbolIndex>=0&&(Z(r.icon,$.numVerticalIconVertices,Le?Rn:tt),r.icon.placedSymbolArray.get($.verticalPlacedIconSymbolIndex).hidden=ue.icon.isHidden())}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const tt=r.collisionArrays[W];if(tt){let Ce=new s.pointGeometry(0,0),Ve=!0;if(tt.textBox||tt.verticalTextBox){if(k){const Me=this.variableOffsets[le];Me?(Ce=mi(Me.anchor,Me.width,Me.height,Me.textOffset,Me.textScale),L&&Ce._rotate(G?this.transform.angle:-this.transform.angle)):Ve=!1}x&&(Ve=!ue.clipped),tt.textBox&&Ha(r.textCollisionBox.collisionVertexArray,ue.text.placed,!Ve||Oe,Ce.x,Ce.y),tt.verticalTextBox&&Ha(r.textCollisionBox.collisionVertexArray,ue.text.placed,!Ve||Le,Ce.x,Ce.y)}const He=Ve&&Boolean(!Le&&tt.verticalIconBox);tt.iconBox&&Ha(r.iconCollisionBox.collisionVertexArray,ue.icon.placed,He,V?Ce.x:0,V?Ce.y:0),tt.verticalIconBox&&Ha(r.iconCollisionBox.collisionVertexArray,ue.icon.placed,!He,V?Ce.x:0,V?Ce.y:0)}}}if(r.fullyClipped=Y===0,r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.bucketInstanceId in this.collisionCircleArrays){const W=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=W.invProjMatrix,r.placementViewportMatrix=W.viewportMatrix,r.collisionCircleArray=W.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,l){const p=this.zoomAtLastRecencyCheck===l?1-this.zoomAdjustment(l):1;return this.zoomAtLastRecencyCheck=l,this.commitTime+this.fadeDuration*p>r}setStale(){this.stale=!0}}function Ha(h,r,l,p,g){h.emplaceBack(r?1:0,l?1:0,p||0,g||0),h.emplaceBack(r?1:0,l?1:0,p||0,g||0),h.emplaceBack(r?1:0,l?1:0,p||0,g||0),h.emplaceBack(r?1:0,l?1:0,p||0,g||0)}const Dr=Math.pow(2,25),Cu=Math.pow(2,24),Eu=Math.pow(2,17),Bu=Math.pow(2,16),Qr=Math.pow(2,9),qh=Math.pow(2,8),jh=Math.pow(2,1);function Ko(h){if(h.opacity===0&&!h.placed)return 0;if(h.opacity===1&&h.placed)return 4294967295;const r=h.placed?1:0,l=Math.floor(127*h.opacity);return l*Dr+r*Cu+l*Eu+r*Bu+l*Qr+r*qh+l*jh+r}const Rn=0;class $n{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&r.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(r,l,p,g,x){const b=this._bucketParts;for(;this._currentTileIndex<r.length;)if(l.getBucketParts(b,g,r[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,x())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,b.sort((T,S)=>T.sortKey-S.sortKey));this._currentPartIndex<b.length;){const T=b[this._currentPartIndex];if(l.placeLayerBucketPart(T,this._seenCrossTileIDs,p,T.symbolInstanceStart===0),this._currentPartIndex++,x())return!0}return!1}}class mm{constructor(r,l,p,g,x,b,T,S){this.placement=new ff(r,x,b,T,S),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=g,this._done=!1}isDone(){return this._done}continuePlacement(r,l,p){const g=s.exported.now(),x=()=>{const b=s.exported.now()-g;return!this._forceFullPlacement&&b>2};for(;this._currentPlacementIndex>=0;){const b=l[r[this._currentPlacementIndex]],T=this.placement.collisionIndex.transform.zoom;if(b.type==="symbol"&&(!b.minzoom||b.minzoom<=T)&&(!b.maxzoom||b.maxzoom>T)){if(this._inProgressLayer||(this._inProgressLayer=new $n(b)),this._inProgressLayer.continuePlacement(p[b.source],this.placement,this._showCollisionBoxes,b,x))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const Vh=512/s.EXTENT/2;class Il{constructor(r,l,p){this.tileID=r,this.indexedSymbolInstances={},this.bucketInstanceId=p;for(let g=0;g<l.length;g++){const x=l.get(g),b=x.key;this.indexedSymbolInstances[b]||(this.indexedSymbolInstances[b]=[]),this.indexedSymbolInstances[b].push({crossTileID:x.crossTileID,coord:this.getScaledCoordinates(x,r)})}}getScaledCoordinates(r,l){const p=Vh/Math.pow(2,l.canonical.z-this.tileID.canonical.z);return{x:Math.floor((l.canonical.x*s.EXTENT+r.tileAnchorX)*p),y:Math.floor((l.canonical.y*s.EXTENT+r.tileAnchorY)*p)}}findMatches(r,l,p){const g=this.tileID.canonical.z<l.canonical.z?1:Math.pow(2,this.tileID.canonical.z-l.canonical.z);for(let x=0;x<r.length;x++){const b=r.get(x);if(b.crossTileID)continue;const T=this.indexedSymbolInstances[b.key];if(!T)continue;const S=this.getScaledCoordinates(b,l);for(const k of T)if(Math.abs(k.coord.x-S.x)<=g&&Math.abs(k.coord.y-S.y)<=g&&!p[k.crossTileID]){p[k.crossTileID]=!0,b.crossTileID=k.crossTileID;break}}}}class _m{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class pf{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const l=Math.round((r-this.lng)/360);if(l!==0)for(const p in this.indexes){const g=this.indexes[p],x={};for(const b in g){const T=g[b];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+l),x[T.tileID.key]=T}this.indexes[p]=x}this.lng=r}addBucket(r,l,p){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===l.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let x=0;x<l.symbolInstances.length;x++)l.symbolInstances.get(x).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]={});const g=this.usedCrossTileIDs[r.overscaledZ];for(const x in this.indexes){const b=this.indexes[x];if(Number(x)>r.overscaledZ)for(const T in b){const S=b[T];S.tileID.isChildOf(r)&&S.findMatches(l.symbolInstances,r,g)}else{const T=b[r.scaledTo(Number(x)).key];T&&T.findMatches(l.symbolInstances,r,g)}}for(let x=0;x<l.symbolInstances.length;x++){const b=l.symbolInstances.get(x);b.crossTileID||(b.crossTileID=p.generate(),g[b.crossTileID]=!0)}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new Il(r,l.symbolInstances,l.bucketInstanceId),!0}removeBucketCrossTileIDs(r,l){for(const p in l.indexedSymbolInstances)for(const g of l.indexedSymbolInstances[p])delete this.usedCrossTileIDs[r][g.crossTileID]}removeStaleBuckets(r){let l=!1;for(const p in this.indexes){const g=this.indexes[p];for(const x in g)r[g[x].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,g[x]),delete g[x],l=!0)}return l}}class $a{constructor(){this.layerIndexes={},this.crossTileIDs=new _m,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,l,p,g){let x=this.layerIndexes[r.id];x===void 0&&(x=this.layerIndexes[r.id]=new pf);let b=!1;const T={};g.name!=="globe"&&x.handleWrapJump(p);for(const S of l){const k=S.getBucket(r);k&&r.id===k.layerIds[0]&&(k.bucketInstanceId||(k.bucketInstanceId=++this.maxBucketInstanceId),x.addBucket(S.tileID,k,this.crossTileIDs)&&(b=!0),T[k.bucketInstanceId]=!0)}return x.removeStaleBuckets(T)&&(b=!0),b}pruneUnusedLayers(r){const l={};r.forEach(p=>{l[p]=!0});for(const p in this.layerIndexes)l[p]||delete this.layerIndexes[p]}}const ro=(h,r)=>s.emitValidationErrors(h,r&&r.filter(l=>l.identifier!=="source.canvas")),mc=s.pick(Ut,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),mr=s.pick(Ut,["setCenter","setZoom","setBearing","setPitch"]),Tu={version:8,layers:[],sources:{}},Zo={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Co extends s.Evented{constructor(r,l={}){super(),this.map=r,this.dispatcher=new Or(Wt(),this),this.imageManager=new dr,this.imageManager.setEventedParent(this),this.glyphManager=new s.GlyphManager(r._requestManager,l.localFontFamily?s.LocalGlyphMode.all:l.localIdeographFontFamily?s.LocalGlyphMode.ideographs:s.LocalGlyphMode.none,l.localFontFamily||l.localIdeographFontFamily),this.crossTileSymbolIndex=new $a,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this.zoomHistory=new s.ZoomHistory,this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",s.getReferrer());const p=this;this._rtlTextPluginCallback=Co.registerForPluginStateChange(g=>{p.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:g.pluginStatus,pluginURL:g.pluginURL},(x,b)=>{if(s.triggerPluginCompletionEvent(x),b&&b.every(T=>T))for(const T in p._sourceCaches){const S=p._sourceCaches[T],k=S.getSource().type;k!=="vector"&&k!=="geojson"||S.reload()}})}),this.on("data",g=>{if(g.dataType!=="source"||g.sourceDataType!=="metadata")return;const x=this.getSource(g.sourceId);if(x&&x.vectorLayerIds)for(const b in this._layers){const T=this._layers[b];T.source===x.id&&this._validateLayer(T)}})}loadURL(r,l={}){this.fire(new s.Event("dataloading",{dataType:"style"}));const p=typeof l.validate=="boolean"?l.validate:!s.isMapboxURL(r);r=this.map._requestManager.normalizeStyleURL(r,l.accessToken);const g=this.map._requestManager.transformRequest(r,s.ResourceType.Style);this._request=s.getJSON(g,(x,b)=>{this._request=null,x?this.fire(new s.ErrorEvent(x)):b&&this._load(b,p)})}loadJSON(r,l={}){this.fire(new s.Event("dataloading",{dataType:"style"})),this._request=s.exported.frame(()=>{this._request=null,this._load(r,l.validate!==!1)})}loadEmpty(){this.fire(new s.Event("dataloading",{dataType:"style"})),this._load(Tu,!1)}_updateLayerCount(r,l){const p=l?1:-1;r.is3D()&&(this._num3DLayers+=p),r.type==="circle"&&(this._numCircleLayers+=p),r.type==="symbol"&&(this._numSymbolLayers+=p)}_load(r,l){if(l&&ro(this,s.validateStyle(r)))return;this._loaded=!0,this.stylesheet=s.clone$1(r),this._updateMapProjection();for(const g in r.sources)this.addSource(g,r.sources[g],{validate:!1});this._changed=!1,r.sprite?this._loadSprite(r.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(r.glyphs);const p=Tn(this.stylesheet.layers);this._order=p.map(g=>g.id),this._layers={},this._serializedLayers={};for(let g of p)g=s.createStyleLayer(g),g.setEventedParent(this,{layer:{id:g.id}}),this._layers[g.id]=g,this._serializedLayers[g.id]=g.serialize(),this._updateLayerCount(g,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new hi(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new s.Event("data",{dataType:"style"})),this.fire(new s.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(r){r?this.stylesheet.projection=r:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(r){this._spriteRequest=function(l,p,g){let x,b,T;const S=s.exported.devicePixelRatio>1?"@2x":"";let k=s.getJSON(p.transformRequest(p.normalizeSpriteURL(l,S,".json"),s.ResourceType.SpriteJSON),(V,X)=>{k=null,T||(T=V,x=X,G())}),L=s.getImage(p.transformRequest(p.normalizeSpriteURL(l,S,".png"),s.ResourceType.SpriteImage),(V,X)=>{L=null,T||(T=V,b=X,G())});function G(){if(T)g(T);else if(x&&b){const V=s.exported.getImageData(b),X={};for(const Z in x){const{width:Y,height:W,x:$,y:te,sdf:J,pixelRatio:le,stretchX:ue,stretchY:oe,content:fe}=x[Z],Ee=new s.RGBAImage({width:Y,height:W});s.RGBAImage.copy(V,Ee,{x:$,y:te},{x:0,y:0},{width:Y,height:W}),X[Z]={data:Ee,pixelRatio:le,sdf:J,stretchX:ue,stretchY:oe,content:fe}}g(null,X)}}return{cancel(){k&&(k.cancel(),k=null),L&&(L.cancel(),L=null)}}}(r,this.map._requestManager,(l,p)=>{if(this._spriteRequest=null,l)this.fire(new s.ErrorEvent(l));else if(p)for(const g in p)this.imageManager.addImage(g,p[g]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new s.Event("data",{dataType:"style"}))})}_validateLayer(r){const l=this.getSource(r.source);if(!l)return;const p=r.sourceLayer;p&&(l.type==="geojson"||l.vectorLayerIds&&l.vectorLayerIds.indexOf(p)===-1)&&this.fire(new s.ErrorEvent(new Error(`Source layer "${p}" does not exist on source "${l.id}" as specified by style layer "${r.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const r in this._sourceCaches)if(!this._sourceCaches[r].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(r){const l=[];for(const p of r){const g=this._layers[p];g.type!=="custom"&&l.push(g.serialize())}return l}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const r in this._sourceCaches)if(this._sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(r){return!!this.terrain&&Zo[r.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(r){if(!this._loaded)return;const l=this._changed;if(this._changed){const g=Object.keys(this._updatedLayers),x=Object.keys(this._removedLayers);(g.length||x.length)&&this._updateWorkerLayers(g,x);for(const b in this._updatedSources){const T=this._updatedSources[b];T==="reload"?this._reloadSource(b):T==="clear"&&this._clearSource(b)}this._updateTilesForChangedImages();for(const b in this._updatedPaintProps)this._layers[b].updateTransitions(r);this.light.updateTransitions(r),this.fog&&this.fog.updateTransitions(r),this._resetUpdates()}const p={};for(const g in this._sourceCaches){const x=this._sourceCaches[g];p[g]=x.used,x.used=!1}for(const g of this._order){const x=this._layers[g];if(x.recalculate(r,this._availableImages),!x.isHidden(r.zoom)){const T=this._getLayerSourceCache(x);T&&(T.used=!0)}const b=this.map.painter;if(b){const T=x.getProgramIds();if(!T)continue;const S=x.getProgramConfiguration(r.zoom);for(const k of T)b.useProgram(k,S)}}for(const g in p){const x=this._sourceCaches[g];p[g]!==x.used&&x.getSource().fire(new s.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:x.getSource().id}))}this.light.recalculate(r),this.terrain&&this.terrain.recalculate(r),this.fog&&this.fog.recalculate(r),this.z=r.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),l&&this.fire(new s.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=Object.keys(this._changedImages);if(r.length){for(const l in this._sourceCaches)this._sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],r);this._changedImages={}}}_updateWorkerLayers(r,l){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(r),removedIds:l})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(r){if(this._checkLoaded(),ro(this,s.validateStyle(r)))return!1;(r=s.clone$1(r)).layers=Tn(r.layers);const l=function(g,x){if(!g)return[{command:Ut.setStyle,args:[x]}];let b=[];try{if(!N(g.version,x.version))return[{command:Ut.setStyle,args:[x]}];N(g.center,x.center)||b.push({command:Ut.setCenter,args:[x.center]}),N(g.zoom,x.zoom)||b.push({command:Ut.setZoom,args:[x.zoom]}),N(g.bearing,x.bearing)||b.push({command:Ut.setBearing,args:[x.bearing]}),N(g.pitch,x.pitch)||b.push({command:Ut.setPitch,args:[x.pitch]}),N(g.sprite,x.sprite)||b.push({command:Ut.setSprite,args:[x.sprite]}),N(g.glyphs,x.glyphs)||b.push({command:Ut.setGlyphs,args:[x.glyphs]}),N(g.transition,x.transition)||b.push({command:Ut.setTransition,args:[x.transition]}),N(g.light,x.light)||b.push({command:Ut.setLight,args:[x.light]}),N(g.fog,x.fog)||b.push({command:Ut.setFog,args:[x.fog]}),N(g.projection,x.projection)||b.push({command:Ut.setProjection,args:[x.projection]});const T={},S=[];(function(G,V,X,Z){let Y;for(Y in V=V||{},G=G||{})G.hasOwnProperty(Y)&&(V.hasOwnProperty(Y)||In(Y,X,Z));for(Y in V)V.hasOwnProperty(Y)&&(G.hasOwnProperty(Y)?N(G[Y],V[Y])||(G[Y].type==="geojson"&&V[Y].type==="geojson"&&As(G,V,Y)?X.push({command:Ut.setGeoJSONSourceData,args:[Y,V[Y].data]}):ea(Y,V,X,Z)):Gn(Y,V,X))})(g.sources,x.sources,S,T);const k=[];g.layers&&g.layers.forEach(G=>{G.source&&T[G.source]?b.push({command:Ut.removeLayer,args:[G.id]}):k.push(G)});let L=g.terrain;L&&T[L.source]&&(b.push({command:Ut.setTerrain,args:[void 0]}),L=void 0),b=b.concat(S),N(L,x.terrain)||b.push({command:Ut.setTerrain,args:[x.terrain]}),function(G,V,X){V=V||[];const Z=(G=G||[]).map(Ho),Y=V.map(Ho),W=G.reduce(yr,{}),$=V.reduce(yr,{}),te=Z.slice(),J=Object.create(null);let le,ue,oe,fe,Ee,Oe,Le;for(le=0,ue=0;le<Z.length;le++)oe=Z[le],$.hasOwnProperty(oe)?ue++:(X.push({command:Ut.removeLayer,args:[oe]}),te.splice(te.indexOf(oe,ue),1));for(le=0,ue=0;le<Y.length;le++)oe=Y[Y.length-1-le],te[te.length-1-le]!==oe&&(W.hasOwnProperty(oe)?(X.push({command:Ut.removeLayer,args:[oe]}),te.splice(te.lastIndexOf(oe,te.length-ue),1)):ue++,Oe=te[te.length-le],X.push({command:Ut.addLayer,args:[$[oe],Oe]}),te.splice(te.length-le,0,oe),J[oe]=!0);for(le=0;le<Y.length;le++)if(oe=Y[le],fe=W[oe],Ee=$[oe],!J[oe]&&!N(fe,Ee))if(N(fe.source,Ee.source)&&N(fe["source-layer"],Ee["source-layer"])&&N(fe.type,Ee.type)){for(Le in Ne(fe.layout,Ee.layout,X,oe,null,Ut.setLayoutProperty),Ne(fe.paint,Ee.paint,X,oe,null,Ut.setPaintProperty),N(fe.filter,Ee.filter)||X.push({command:Ut.setFilter,args:[oe,Ee.filter]}),N(fe.minzoom,Ee.minzoom)&&N(fe.maxzoom,Ee.maxzoom)||X.push({command:Ut.setLayerZoomRange,args:[oe,Ee.minzoom,Ee.maxzoom]}),fe)fe.hasOwnProperty(Le)&&Le!=="layout"&&Le!=="paint"&&Le!=="filter"&&Le!=="metadata"&&Le!=="minzoom"&&Le!=="maxzoom"&&(Le.indexOf("paint.")===0?Ne(fe[Le],Ee[Le],X,oe,Le.slice(6),Ut.setPaintProperty):N(fe[Le],Ee[Le])||X.push({command:Ut.setLayerProperty,args:[oe,Le,Ee[Le]]}));for(Le in Ee)Ee.hasOwnProperty(Le)&&!fe.hasOwnProperty(Le)&&Le!=="layout"&&Le!=="paint"&&Le!=="filter"&&Le!=="metadata"&&Le!=="minzoom"&&Le!=="maxzoom"&&(Le.indexOf("paint.")===0?Ne(fe[Le],Ee[Le],X,oe,Le.slice(6),Ut.setPaintProperty):N(fe[Le],Ee[Le])||X.push({command:Ut.setLayerProperty,args:[oe,Le,Ee[Le]]}))}else X.push({command:Ut.removeLayer,args:[oe]}),Oe=te[te.lastIndexOf(oe)+1],X.push({command:Ut.addLayer,args:[Ee,Oe]})}(k,x.layers,b)}catch(T){console.warn("Unable to compute style diff:",T),b=[{command:Ut.setStyle,args:[x]}]}return b}(this.serialize(),r).filter(g=>!(g.command in mr));if(l.length===0)return!1;const p=l.filter(g=>!(g.command in mc));if(p.length>0)throw new Error(`Unimplemented: ${p.map(g=>g.command).join(", ")}.`);return l.forEach(g=>{g.command!=="setTransition"&&g.command!=="setProjection"&&this[g.command].apply(this,g.args)}),this.stylesheet=r,this._updateMapProjection(),!0}addImage(r,l){return this.getImage(r)?this.fire(new s.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(r,l),this._afterImageUpdated(r),this)}updateImage(r,l){this.imageManager.updateImage(r,l)}getImage(r){return this.imageManager.getImage(r)}removeImage(r){return this.getImage(r)?(this.imageManager.removeImage(r),this._afterImageUpdated(r),this):this.fire(new s.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(),this._changedImages[r]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new s.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(r,l,p={}){if(this._checkLoaded(),this.getSource(r)!==void 0)throw new Error("There is already a source with this ID");if(!l.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(l).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(s.validateSource,`sources.${r}`,l,null,p))return;this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);const g=Te(r,l,this.dispatcher,this);g.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(r),source:g.serialize(),sourceId:r}));const x=b=>{const T=(b?"symbol:":"other:")+r,S=this._sourceCaches[T]=new s.SourceCache(T,g,b);(b?this._symbolSourceCaches:this._otherSourceCaches)[r]=S,S.style=this,S.onAdd(this.map)};x(!1),l.type!=="vector"&&l.type!=="geojson"||x(!0),g.onAdd&&g.onAdd(this.map),this._changed=!0}removeSource(r){this._checkLoaded();const l=this.getSource(r);if(!l)throw new Error("There is no source with this ID");for(const g in this._layers)if(this._layers[g].source===r)return this.fire(new s.ErrorEvent(new Error(`Source "${r}" cannot be removed while layer "${g}" is using it.`)));if(this.terrain&&this.terrain.get().source===r)return this.fire(new s.ErrorEvent(new Error(`Source "${r}" cannot be removed while terrain is using it.`)));const p=this._getSourceCaches(r);for(const g of p)delete this._sourceCaches[g.id],delete this._updatedSources[g.id],g.fire(new s.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:g.getSource().id})),g.setEventedParent(null),g.clearTiles();return delete this._otherSourceCaches[r],delete this._symbolSourceCaches[r],l.setEventedParent(null),l.onRemove&&l.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(r,l){this._checkLoaded(),this.getSource(r).setData(l),this._changed=!0}getSource(r){const l=this._getSourceCache(r);return l&&l.getSource()}_getSources(){const r=[];for(const l in this._otherSourceCaches){const p=this._getSourceCache(l);p&&r.push(p.getSource())}return r}addLayer(r,l,p={}){this._checkLoaded();const g=r.id;if(this.getLayer(g))return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${g}" already exists on this map`)));let x;if(r.type==="custom"){if(ro(this,s.validateCustomStyleLayer(r)))return;x=s.createStyleLayer(r)}else{if(typeof r.source=="object"&&(this.addSource(g,r.source),r=s.clone$1(r),r=s.extend(r,{source:g})),this._validate(s.validateLayer,`layers.${g}`,r,{arrayIndex:-1},p))return;x=s.createStyleLayer(r),this._validateLayer(x),x.setEventedParent(this,{layer:{id:g}}),this._serializedLayers[x.id]=x.serialize(),this._updateLayerCount(x,!0)}const b=l?this._order.indexOf(l):this._order.length;if(l&&b===-1)return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${l}" does not exist on this map.`)));this._order.splice(b,0,g),this._layerOrderChanged=!0,this._layers[g]=x;const T=this._getLayerSourceCache(x);if(this._removedLayers[g]&&x.source&&T&&x.type!=="custom"){const S=this._removedLayers[g];delete this._removedLayers[g],S.type!==x.type?this._updatedSources[x.source]="clear":(this._updatedSources[x.source]="reload",T.pause())}this._updateLayer(x),x.onAdd&&x.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(r,l){if(this._checkLoaded(),this._changed=!0,!this._layers[r])return void this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be moved.`)));if(r===l)return;const p=this._order.indexOf(r);this._order.splice(p,1);const g=l?this._order.indexOf(l):this._order.length;l&&g===-1?this.fire(new s.ErrorEvent(new Error(`Layer with id "${l}" does not exist on this map.`))):(this._order.splice(g,0,r),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(r){this._checkLoaded();const l=this._layers[r];if(!l)return void this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be removed.`)));l.setEventedParent(null),this._updateLayerCount(l,!1);const p=this._order.indexOf(r);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[r]=l,delete this._layers[r],delete this._serializedLayers[r],delete this._updatedLayers[r],delete this._updatedPaintProps[r],l.onRemove&&l.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(r){return this._layers[r]}hasLayer(r){return r in this._layers}hasLayerType(r){for(const l in this._layers)if(this._layers[l].type===r)return!0;return!1}setLayerZoomRange(r,l,p){this._checkLoaded();const g=this.getLayer(r);g?g.minzoom===l&&g.maxzoom===p||(l!=null&&(g.minzoom=l),p!=null&&(g.maxzoom=p),this._updateLayer(g)):this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(r,l,p={}){this._checkLoaded();const g=this.getLayer(r);if(g){if(!N(g.filter,l))return l==null?(g.filter=void 0,void this._updateLayer(g)):void(this._validate(s.validateFilter,`layers.${g.id}.filter`,l,{layerType:g.type},p)||(g.filter=s.clone$1(l),this._updateLayer(g)))}else this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be filtered.`)))}getFilter(r){const l=this.getLayer(r);return l&&s.clone$1(l.filter)}setLayoutProperty(r,l,p,g={}){this._checkLoaded();const x=this.getLayer(r);x?N(x.getLayoutProperty(l),p)||(x.setLayoutProperty(l,p,g),this._updateLayer(x)):this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(r,l){const p=this.getLayer(r);if(p)return p.getLayoutProperty(l);this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style.`)))}setPaintProperty(r,l,p,g={}){this._checkLoaded();const x=this.getLayer(r);x?N(x.getPaintProperty(l),p)||(x.setPaintProperty(l,p,g)&&this._updateLayer(x),this._changed=!0,this._updatedPaintProps[r]=!0):this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(r,l){const p=this.getLayer(r);return p&&p.getPaintProperty(l)}setFeatureState(r,l){this._checkLoaded();const p=r.source,g=r.sourceLayer,x=this.getSource(p);if(!x)return void this.fire(new s.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const b=x.type;if(b==="geojson"&&g)return void this.fire(new s.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(b==="vector"&&!g)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));r.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided.")));const T=this._getSourceCaches(p);for(const S of T)S.setFeatureState(g,r.id,l)}removeFeatureState(r,l){this._checkLoaded();const p=r.source,g=this.getSource(p);if(!g)return void this.fire(new s.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const x=g.type,b=x==="vector"?r.sourceLayer:void 0;if(x==="vector"&&!b)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(l&&typeof r.id!="string"&&typeof r.id!="number")return void this.fire(new s.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const T=this._getSourceCaches(p);for(const S of T)S.removeFeatureState(b,r.id,l)}getFeatureState(r){this._checkLoaded();const l=r.source,p=r.sourceLayer,g=this.getSource(l);if(g){if(g.type!=="vector"||p)return r.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(l)[0].getFeatureState(p,r.id);this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error(`The source '${l}' does not exist in the map's style.`)))}getTransition(){return s.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const r={};for(const l in this._sourceCaches){const p=this._sourceCaches[l].getSource();r[p.id]||(r[p.id]=p.serialize())}return s.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:r,layers:this._serializeLayers(this._order)},l=>l!==void 0)}_updateLayer(r){this._updatedLayers[r.id]=!0;const l=this._getLayerSourceCache(r);r.source&&!this._updatedSources[r.source]&&l&&l.getSource().type!=="raster"&&(this._updatedSources[r.source]="reload",l.pause()),this._changed=!0,r.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(r){const l=b=>this._layers[b].type==="fill-extrusion",p={},g=[];for(let b=this._order.length-1;b>=0;b--){const T=this._order[b];if(l(T)){p[T]=b;for(const S of r){const k=S[T];if(k)for(const L of k)g.push(L)}}}g.sort((b,T)=>T.intersectionZ-b.intersectionZ);const x=[];for(let b=this._order.length-1;b>=0;b--){const T=this._order[b];if(l(T))for(let S=g.length-1;S>=0;S--){const k=g[S].feature;if(p[k.layer.id]<b)break;x.push(k),g.pop()}else for(const S of r){const k=S[T];if(k)for(const L of k)x.push(L.feature)}}return x}queryRenderedFeatures(r,l,p){l&&l.filter&&this._validate(s.validateFilter,"queryRenderedFeatures.filter",l.filter,null,l);const g={};if(l&&l.layers){if(!Array.isArray(l.layers))return this.fire(new s.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const S of l.layers){const k=this._layers[S];if(!k)return this.fire(new s.ErrorEvent(new Error(`The layer '${S}' does not exist in the map's style and cannot be queried for features.`))),[];g[k.source]=!0}}const x=[];l.availableImages=this._availableImages;const b=l&&l.layers?l.layers.some(S=>{const k=this.getLayer(S);return k&&k.is3D()}):this.has3DLayers(),T=wr.createFromScreenPoints(r,p);for(const S in this._sourceCaches){const k=this._sourceCaches[S].getSource().id;l.layers&&!g[k]||x.push(Pe(this._sourceCaches[S],this._layers,this._serializedLayers,T,l,p,b,!!this.map._showQueryGeometry))}return this.placement&&x.push(function(S,k,L,G,V,X,Z){const Y={},W=X.queryRenderedSymbols(G),$=[];for(const te of Object.keys(W).map(Number))$.push(Z[te]);$.sort(yt);for(const te of $){const J=te.featureIndex.lookupSymbolFeatures(W[te.bucketInstanceId],k,te.bucketIndex,te.sourceLayerIndex,V.filter,V.layers,V.availableImages,S);for(const le in J){const ue=Y[le]=Y[le]||[],oe=J[le];oe.sort((fe,Ee)=>{const Oe=te.featureSortOrder;if(Oe){const Le=Oe.indexOf(fe.featureIndex);return Oe.indexOf(Ee.featureIndex)-Le}return Ee.featureIndex-fe.featureIndex});for(const fe of oe)ue.push(fe)}}for(const te in Y)Y[te].forEach(J=>{const le=J.feature,ue=L(S[te]).getFeatureState(le.layer["source-layer"],le.id);le.source=le.layer.source,le.layer["source-layer"]&&(le.sourceLayer=le.layer["source-layer"]),le.state=ue});return Y}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),T.screenGeometry,l,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(x)}querySourceFeatures(r,l){l&&l.filter&&this._validate(s.validateFilter,"querySourceFeatures.filter",l.filter,null,l);const p=this._getSourceCaches(r);let g=[];for(const x of p)g=g.concat(Je(x,l));return g}addSourceType(r,l,p){return Co.getSourceType(r)?p(new Error(`A source type called "${r}" already exists.`)):(Co.setSourceType(r,l),l.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:l.workerSourceURL},p):p(null,null))}getLight(){return this.light.getLight()}setLight(r,l={}){this._checkLoaded();const p=this.light.getLight();let g=!1;for(const b in r)if(!N(r[b],p[b])){g=!0;break}if(!g)return;const x=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(r,l),this.light.updateTransitions(x)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(r,l=1){if(this._checkLoaded(),!r)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(l===1){if(typeof r.source=="object"){const p="terrain-dem-src";this.addSource(p,r.source),r=s.clone$1(r),r=s.extend(r,{source:p})}if(this._validate(s.validateTerrain,"terrain",r))return}if(!this.terrain||this.terrain&&l!==this.terrain.drapeRenderMode)this._createTerrain(r,l);else{const p=this.terrain,g=p.get();for(const x of Object.keys(s.spec.terrain))!r.hasOwnProperty(x)&&s.spec.terrain[x].default&&(r[x]=s.spec.terrain[x].default);for(const x in r)if(!N(r[x],g[x])){p.set(r),this.stylesheet.terrain=r;const b=this._setTransitionParameters({duration:0});p.updateTransitions(b);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(r){const l=this.fog=new Ln(r,this.map.transform);this.stylesheet.fog=r;const p=this._setTransitionParameters({duration:0});l.updateTransitions(p)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const r of this.map._markers)r._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(r){if(this._checkLoaded(),!r)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const l=this.fog,p=l.get();Object.keys(r).length===0&&l.set(r);for(const g in r)if(!N(r[g],p[g])){l.set(r),this.stylesheet.fog=r;const x=this._setTransitionParameters({duration:0});l.updateTransitions(x);break}}else this._createFog(r);this._markersNeedUpdate=!0}_setTransitionParameters(r){return{now:s.exported.now(),transition:s.extend(r,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const r=this._order.filter(p=>this.isLayerDraped(this._layers[p])),l=this._order.filter(p=>!this.isLayerDraped(this._layers[p]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...r),this._drapedFirstOrder.push(...l)}_createTerrain(r,l){const p=this.terrain=new fr(r,l);this.stylesheet.terrain=r,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const g=this._setTransitionParameters({duration:0});p.updateTransitions(g)}_force3DLayerUpdate(){for(const r in this._layers){const l=this._layers[r];l.type==="fill-extrusion"&&this._updateLayer(l)}}_forceSymbolLayerUpdate(){for(const r in this._layers){const l=this._layers[r];l.type==="symbol"&&this._updateLayer(l)}}_validate(r,l,p,g,x={}){return(!x||x.validate!==!1)&&ro(this,r.call(s.validateStyle,s.extend({key:l,style:this.serialize(),value:p,styleSpec:s.spec},g)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const r in this._layers)this._layers[r].setEventedParent(null);for(const r in this._sourceCaches)this._sourceCaches[r].clearTiles(),this._sourceCaches[r].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(r){const l=this._getSourceCaches(r);for(const p of l)p.clearTiles()}_reloadSource(r){const l=this._getSourceCaches(r);for(const p of l)p.resume(),p.reload()}_reloadSources(){for(const r of this._getSources())r.reload&&r.reload()}_updateSources(r){for(const l in this._sourceCaches)this._sourceCaches[l].update(r)}_generateCollisionBoxes(){for(const r in this._sourceCaches){const l=this._sourceCaches[r];l.resume(),l.reload()}}_updatePlacement(r,l,p,g,x=!1){let b=!1,T=!1;const S={};for(const k of this._order){const L=this._layers[k];if(L.type!=="symbol")continue;if(!S[L.source]){const V=this._getLayerSourceCache(L);if(!V)continue;S[L.source]=V.getRenderableIds(!0).map(X=>V.getTileByID(X)).sort((X,Z)=>Z.tileID.overscaledZ-X.tileID.overscaledZ||(X.tileID.isLessThan(Z.tileID)?-1:1))}const G=this.crossTileSymbolIndex.addLayer(L,S[L.source],r.center.lng,r.projection);b=b||G}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),x=x||this._layerOrderChanged||p===0,this._layerOrderChanged&&this.fire(new s.Event("neworder")),(x||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.exported.now(),r.zoom))&&(this.pauseablePlacement=new mm(r,this._order,x,l,p,g,this.placement,this.fog&&r.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,S),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.exported.now()),T=!0),b&&this.pauseablePlacement.placement.setStale()),T||b)for(const k of this._order){const L=this._layers[k];L.type==="symbol"&&this.placement.updateLayerOpacities(L,S[L.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.exported.now())}_releaseSymbolFadeTiles(){for(const r in this._sourceCaches)this._sourceCaches[r].releaseSymbolFadeTiles()}getImages(r,l,p){this.imageManager.getImages(l.icons,p),this._updateTilesForChangedImages();const g=x=>{x&&x.setDependencies(l.tileID.key,l.type,l.icons)};g(this._otherSourceCaches[l.source]),g(this._symbolSourceCaches[l.source])}getGlyphs(r,l,p){this.glyphManager.getGlyphs(l.stacks,p)}getResource(r,l,p){return s.makeRequest(l,p)}_getSourceCache(r){return this._otherSourceCaches[r]}_getLayerSourceCache(r){return r.type==="symbol"?this._symbolSourceCaches[r.source]:this._otherSourceCaches[r.source]}_getSourceCaches(r){const l=[];return this._otherSourceCaches[r]&&l.push(this._otherSourceCaches[r]),this._symbolSourceCaches[r]&&l.push(this._symbolSourceCaches[r]),l}_isSourceCacheLoaded(r){const l=this._getSourceCaches(r);return l.length===0?(this.fire(new s.ErrorEvent(new Error(`There is no source with ID '${r}'`))),!1):l.every(p=>p.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Co.getSourceType=function(h){return De[h]},Co.setSourceType=function(h,r){De[h]=r},Co.registerForPluginStateChange=s.registerForPluginStateChange;var _c=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,gi="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Hh=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,gc=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,$h=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let yc={},vc={};const ra=[];Eo(_c,ra),Eo(Hh,ra),Eo(gc,ra),Eo($h,ra),yc=gn("",Hh),vc=gn($h,gc);const yi=gn(`
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),Wh=_c,vi=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var Kh={background:gn(`uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:gn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:gn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:gn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:gn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:gn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:gn("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:gn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:gn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:gn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:gn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:gn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:gn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:gn(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);directional*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
v_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);float roof_radiance=clamp(u_lightpos.z,0.0,1.0);roof_radiance=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roof_radiance);v_roof_color.rgb+=clamp(color.rgb*roof_radiance*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:gn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);directional*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:gn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos);float f=getElevation(v_pos+vec2(epsilon.x,0));float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float h=getElevation(v_pos+vec2(0,epsilon.y));float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:gn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:gn(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist_a=texture2D(u_dash_image,v_tex_a).a;float sdfdist_b=texture2D(u_dash_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
#ifdef RENDER_LINE_GRADIENT
highp vec4 out_color=texture2D(u_gradient_image,v_uv.xy);
#else
vec4 out_color=color;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);}}
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float scaleA=dash_from.z==0.0 ? 0.0 : tileZoomRatio/(dash_from.z*fromScale);float scaleB=dash_to.z==0.0 ? 0.0 : tileZoomRatio/(dash_to.z*toScale);float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*scaleA/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*scaleB/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:gn(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:gn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:gn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:gn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:gn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:gn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=u_skirt_height*u_skirt_height*wireframeOffset;
#endif
vec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:gn(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:gn(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,gi),skyboxGradient:gn(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,gi),skyboxCapture:gn(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:gn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 latLng=u_grid_matrix*vec3(a_pos,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;
#ifdef GLOBE_POLES
vec3 up_vector=normalize(globe_pos)*u_tile_up_scale;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:gn(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function Eo(h,r){const l=h.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let p of l)if(p=p.trim(),p[0]==="#"&&p.includes("if")&&!p.includes("endif")){p=p.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const g=p.split(" ");for(const x of g)r.includes(x)||r.push(x)}}function gn(h,r){const l=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=r.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),g={},x=[...ra];return Eo(h,x),Eo(r,x),{fragmentSource:h=h.replace(l,(b,T,S,k,L)=>(g[L]=!0,T==="define"?`
#ifndef HAS_UNIFORM_u_${L}
varying ${S} ${k} ${L};
#else
uniform ${S} ${k} u_${L};
#endif
`:`
#ifdef HAS_UNIFORM_u_${L}
    ${S} ${k} ${L} = u_${L};
#endif
`)),vertexSource:r=r.replace(l,(b,T,S,k,L)=>{const G=k==="float"?"vec2":"vec4",V=L.match(/color/)?"color":G;return g[L]?T==="define"?`
#ifndef HAS_UNIFORM_u_${L}
uniform lowp float u_${L}_t;
attribute ${S} ${G} a_${L};
varying ${S} ${k} ${L};
#else
uniform ${S} ${k} u_${L};
#endif
`:V==="vec4"?`
#ifndef HAS_UNIFORM_u_${L}
    ${L} = a_${L};
#else
    ${S} ${k} ${L} = u_${L};
#endif
`:`
#ifndef HAS_UNIFORM_u_${L}
    ${L} = unpack_mix_${V}(a_${L}, u_${L}_t);
#else
    ${S} ${k} ${L} = u_${L};
#endif
`:T==="define"?`
#ifndef HAS_UNIFORM_u_${L}
uniform lowp float u_${L}_t;
attribute ${S} ${G} a_${L};
#else
uniform ${S} ${k} u_${L};
#endif
`:V==="vec4"?`
#ifndef HAS_UNIFORM_u_${L}
    ${S} ${k} ${L} = a_${L};
#else
    ${S} ${k} ${L} = u_${L};
#endif
`:`
#ifndef HAS_UNIFORM_u_${L}
    ${S} ${k} ${L} = unpack_mix_${V}(a_${L}, u_${L}_t);
#else
    ${S} ${k} ${L} = u_${L};
#endif
`}),staticAttributes:p,usedDefines:x}}class ia{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(r,l,p,g,x,b,T){this.context=r;let S=this.boundPaintVertexBuffers.length!==g.length;for(let L=0;!S&&L<g.length;L++)this.boundPaintVertexBuffers[L]!==g[L]&&(S=!0);let k=this.boundDynamicVertexBuffers.length!==T.length;for(let L=0;!k&&L<T.length;L++)this.boundDynamicVertexBuffers[L]!==T[L]&&(k=!0);if(!r.extVertexArrayObject||!this.vao||this.boundProgram!==l||this.boundLayoutVertexBuffer!==p||S||k||this.boundIndexBuffer!==x||this.boundVertexOffset!==b)this.freshBind(l,p,g,x,b,T);else{r.bindVertexArrayOES.set(this.vao);for(const L of T)L&&L.bind();x&&x.dynamicDraw&&x.bind()}}freshBind(r,l,p,g,x,b){let T;const S=r.numAttributes,k=this.context,L=k.gl;if(k.extVertexArrayObject)this.vao&&this.destroy(),this.vao=k.extVertexArrayObject.createVertexArrayOES(),k.bindVertexArrayOES.set(this.vao),T=0,this.boundProgram=r,this.boundLayoutVertexBuffer=l,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=g,this.boundVertexOffset=x,this.boundDynamicVertexBuffers=b;else{T=k.currentNumAttributes||0;for(let G=S;G<T;G++)L.disableVertexAttribArray(G)}l.enableAttributes(L,r),l.bind(),l.setVertexAttribPointers(L,r,x);for(const G of p)G.enableAttributes(L,r),G.bind(),G.setVertexAttribPointers(L,r,x);for(const G of b)G&&(G.enableAttributes(L,r),G.bind(),G.setVertexAttribPointers(L,r,x));g&&g.bind(),k.currentNumAttributes=S}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Ml(h,r){const l=Math.pow(2,r.canonical.z),p=r.canonical.y;return[new s.MercatorCoordinate(0,p/l).toLngLat().lat,new s.MercatorCoordinate(0,(p+1)/l).toLngLat().lat]}function tr(h,r,l,p,g,x,b){const T=h.context,S=T.gl,k=l.fbo;if(!k)return;h.prepareDrawTile();const L=h.useProgram("hillshade");T.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,k.colorAttachment.get());const G=((Y,W,$,te)=>{const J=$.paint.get("hillshade-shadow-color"),le=$.paint.get("hillshade-highlight-color"),ue=$.paint.get("hillshade-accent-color");let oe=$.paint.get("hillshade-illumination-direction")*(Math.PI/180);$.paint.get("hillshade-illumination-anchor")==="viewport"&&(oe-=Y.transform.angle);const fe=!Y.options.moving;return{u_matrix:te||Y.transform.calculateProjMatrix(W.tileID.toUnwrapped(),fe),u_image:0,u_latrange:Ml(0,W.tileID),u_light:[$.paint.get("hillshade-exaggeration"),oe],u_shadow:J,u_highlight:le,u_accent:ue}})(h,l,p,h.terrain?r.projMatrix:null);h.prepareDrawProgram(T,L,r.toUnwrapped());const{tileBoundsBuffer:V,tileBoundsIndexBuffer:X,tileBoundsSegments:Z}=h.getTileBoundsBuffers(l);L.draw(T,S.TRIANGLES,g,x,b,s.CullFaceMode.disabled,G,p.id,V,X,Z)}function Bo(h,r,l){if(!r.needsDEMTextureUpload)return;const p=h.context,g=p.gl;p.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||h.getTileTexture(l.stride);const x=l.getPixels();r.demTexture?r.demTexture.update(x,{premultiply:!1}):r.demTexture=new s.Texture(p,x,g.RGBA,{premultiply:!1}),r.needsDEMTextureUpload=!1}function xc(h,r,l,p,g,x){const b=h.context,T=b.gl;if(!r.dem)return;const S=r.dem;if(b.activeTexture.set(T.TEXTURE1),Bo(h,r,S),!r.demTexture)return;r.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE);const k=S.dim;b.activeTexture.set(T.TEXTURE0);let L=r.fbo;if(!L){const Z=new s.Texture(b,{width:k,height:k,data:null},T.RGBA);Z.bind(T.LINEAR,T.CLAMP_TO_EDGE),L=r.fbo=b.createFramebuffer(k,k,!0),L.colorAttachment.set(Z.texture)}b.bindFramebuffer.set(L.framebuffer),b.viewport.set([0,0,k,k]);const{tileBoundsBuffer:G,tileBoundsIndexBuffer:V,tileBoundsSegments:X}=h.getMercatorTileBoundsBuffers();h.useProgram("hillshadePrepare").draw(b,T.TRIANGLES,p,g,x,s.CullFaceMode.disabled,((Z,Y)=>{const W=Y.stride,$=s.create();return s.ortho($,0,s.EXTENT,-s.EXTENT,0,0,1),s.translate($,$,[0,-s.EXTENT,0]),{u_matrix:$,u_image:1,u_dimension:[W,W],u_zoom:Z.overscaledZ,u_unpack:Y.unpackVector}})(r.tileID,S),l.id,G,V,X),r.needsHillshadePrepare=!1}const wc=h=>({u_matrix:new s.UniformMatrix4f(h),u_image0:new s.Uniform1i(h),u_skirt_height:new s.Uniform1f(h)}),Du=(h,r)=>({u_matrix:h,u_image0:0,u_skirt_height:r}),Ac=(h,r,l,p,g,x,b,T,S,k,L,G,V,X)=>({u_proj_matrix:Float32Array.from(h),u_globe_matrix:r,u_normalize_matrix:Float32Array.from(p),u_merc_matrix:l,u_zoom_transition:g,u_merc_center:x,u_image0:0,u_frustum_tl:b,u_frustum_tr:T,u_frustum_br:S,u_frustum_bl:k,u_globe_pos:L,u_globe_radius:G,u_viewport:V,u_grid_matrix:X?Float32Array.from(X):new Float32Array(9)});function Su(h,r){return h!=null&&r!=null&&!(!h.hasData()||!r.hasData())&&h.demTexture!=null&&r.demTexture!=null&&h.tileID.key!==r.tileID.key}const oa=new class{constructor(){this.operations={}}newMorphing(h,r,l,p,g){if(h in this.operations){const x=this.operations[h];x.to.tileID.key!==l.tileID.key&&(x.queued=l)}else this.operations[h]={startTime:p,phase:0,duration:g,from:r,to:l,queued:null}}getMorphValuesForProxy(h){if(!(h in this.operations))return null;const r=this.operations[h];return{from:r.from,to:r.to,phase:r.phase}}update(h){for(const r in this.operations){const l=this.operations[r];for(l.phase=(h-l.startTime)/l.duration;l.phase>=1||!this._validOp(l);)if(!this._nextOp(l,h)){delete this.operations[r];break}}}_nextOp(h,r){return!!h.queued&&(h.from=h.to,h.to=h.queued,h.queued=null,h.phase=0,h.startTime=r,!0)}_validOp(h){return h.from.hasData()&&h.to.hasData()}},Wa={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function xn(h,r){const l=1<<h.z;return!r&&(h.x===0||h.x===l-1)||h.y===0||h.y===l-1}const To=h=>({u_matrix:h});function Zh(h,r,l,p,g){if(g>0){const x=s.exported.now(),b=(x-h.timeAdded)/g,T=r?(x-r.timeAdded)/g:-1,S=l.getSource(),k=p.coveringZoomLevel({tileSize:S.tileSize,roundZoom:S.roundZoom}),L=!r||Math.abs(r.tileID.overscaledZ-k)>Math.abs(h.tileID.overscaledZ-k),G=L&&h.refreshedUponExpiration?1:s.clamp(L?b:1-T,0,1);return h.refreshedUponExpiration&&b>=1&&(h.refreshedUponExpiration=!1),r?{opacity:1,mix:1-G}:{opacity:G,mix:0}}return{opacity:1,mix:0}}class Jh extends s.SourceCache{constructor(r){const l={type:"raster-dem",maxzoom:r.transform.maxZoom},p=new Or(Wt(),null),g=Te("mock-dem",l,p,r.style);super("mock-dem",g,!1),g.setEventedParent(this),this._sourceLoaded=!0}_loadTile(r,l){r.state="loaded",l(null)}}class Xh extends s.SourceCache{constructor(r){const l=Te("proxy",{type:"geojson",maxzoom:r.transform.maxZoom},new Or(Wt(),null),r.style);super("proxy",l,!1),l.setEventedParent(this),this.map=this.getSource().map=r,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(r,l,p){if(r.freezeTileCoverage)return;this.transform=r;const g=r.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((x,b)=>{if(x[b.key]="",!this._tiles[b.key]){const T=new s.Tile(b,this._source.tileSize*b.overscaleFactor(),r.tileZoom);T.state="loaded",this._tiles[b.key]=T}return x},{});for(const x in this._tiles)x in g||(this.freeFBO(x),this._tiles[x].unloadVectorData(),delete this._tiles[x])}freeFBO(r){const l=this.proxyCachedFBO[r];if(l!==void 0){const p=Object.values(l);this.renderCachePool.push(...p),delete this.proxyCachedFBO[r]}}deallocRenderCache(){this.renderCache.forEach(r=>r.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class kl extends s.OverscaledTileID{constructor(r,l,p){super(r.overscaledZ,r.wrap,r.canonical.z,r.canonical.x,r.canonical.y),this.proxyTileKey=l,this.projMatrix=p}}class bc extends s.Elevation{constructor(r,l){super(),this.painter=r,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[p,g,x]=function(S){const k=new s.StructArrayLayout4i8,L=new s.StructArrayLayout3ui6,G=131;k.reserve(17161),L.reserve(33800);const V=s.EXTENT/128,X=s.EXTENT+V/2,Z=X+V;for(let W=-V;W<Z;W+=V)for(let $=-V;$<Z;$+=V){const te=$<0||$>X||W<0||W>X?24575:0,J=s.clamp(Math.round($),0,s.EXTENT),le=s.clamp(Math.round(W),0,s.EXTENT);k.emplaceBack(J+te,le,J,le)}const Y=(W,$)=>{const te=$*G+W;L.emplaceBack(te+1,te,te+G),L.emplaceBack(te+G,te+G+1,te+1)};for(let W=1;W<129;W++)for(let $=1;$<129;$++)Y($,W);return[0,129].forEach(W=>{for(let $=0;$<130;$++)Y($,W),Y(W,$)}),[k,L,32768]}(),b=r.context;this.gridBuffer=b.createVertexBuffer(p,s.boundsAttributes.members),this.gridIndexBuffer=b.createIndexBuffer(g),this.gridSegments=s.SegmentVector.simpleSegment(0,0,p.length,g.length),this.gridNoSkirtSegments=s.SegmentVector.simpleSegment(0,0,p.length,x),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Xh(l.map),this.orthoMatrix=s.create(),s.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,s.EXTENT,0,s.EXTENT,0,1);const T=b.gl;this._overlapStencilMode=new s.StencilMode({func:T.GEQUAL,mask:255},0,255,T.KEEP,T.KEEP,T.REPLACE),this._previousZoom=r.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=l,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Jh(l.map)}set style(r){r.on("data",this._onStyleDataEvent.bind(this)),r.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=r,this._checkRenderCacheEfficiency()}update(r,l,p){if(r&&r.terrain){this._style!==r&&(this.style=r),this.enabled=!0;const g=r.terrain.properties;this.sourceCache=r.terrain.drapeRenderMode===0?this._mockSourceCache:r._getSourceCache(g.get("source")),this._exaggeration=g.get("exaggeration");const x=()=>{this.sourceCache.used&&s.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const b=this.getScaledDemTileSize();this.sourceCache.update(l,b,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,x(),this._initializing=!0),x(),l.updateElevation(!p),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(l),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(r){this._findCoveringTileCache[r]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const r=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||r.efficiency!==100&&s.warnOnce(`Terrain render cache efficiency is not optimal (${r.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${r.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(r){r.coord&&r.dataType==="source"?this._clearRenderCacheForTile(r.sourceCacheId,r.coord):r.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const r in this._style._sourceCaches)this._style._sourceCaches[r].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(r=>r.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const r=2*this.proxySourceCache.getSource().tileSize;return[r,r]}set useVertexMorphing(r){this._useVertexMorphing=r}updateTileBinding(r){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const l=this.proxySourceCache,p=this.painter.transform;this._initializing&&(this._initializing=p._centerAltitude===0&&this.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(p.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const g=this.proxyCoords=l.getIds().map(S=>{const k=l.getTileByID(S).tileID;return k.projMatrix=p.calculateProjMatrix(k.toUnwrapped()),k});(function(S,k){const L=k.transform.pointCoordinate(k.transform.getCameraPoint()),G=new s.pointGeometry(L.x,L.y);S.sort((V,X)=>{if(X.overscaledZ-V.overscaledZ)return X.overscaledZ-V.overscaledZ;const Z=new s.pointGeometry(V.canonical.x+(1<<V.canonical.z)*V.wrap,V.canonical.y),Y=new s.pointGeometry(X.canonical.x+(1<<X.canonical.z)*X.wrap,X.canonical.y),W=G.mult(1<<V.canonical.z);return W.x-=.5,W.y-=.5,W.distSqr(Z)-W.distSqr(Y)})})(g,this.painter),this._previousZoom=p.zoom;const x=this.proxyToSource||{};this.proxyToSource={},g.forEach(S=>{this.proxyToSource[S.key]={}}),this.terrainTileForTile={};const b=this._style._sourceCaches;for(const S in b){const k=b[S];if(!k.used||(k!==this.sourceCache&&this.resetTileLookupCache(k.id),this._setupProxiedCoordsForOrtho(k,r[S],x),k.usedForTerrain))continue;const L=r[S];k.getSource().reparseOverscaled&&this._assignTerrainTiles(L)}this.proxiedCoords[l.id]=g.map(S=>new kl(S,S.key,this.orthoMatrix)),this._assignTerrainTiles(g),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(x),this.renderingToTexture=!1,this._updateTimestamp=s.exported.now();const T={};this._visibleDemTiles=[];for(const S of this.proxyCoords){const k=this.terrainTileForTile[S.key];if(!k)continue;const L=k.tileID.key;L in T||(this._visibleDemTiles.push(k),T[L]=L)}}_assignTerrainTiles(r){this._initializing||r.forEach(l=>{if(this.terrainTileForTile[l.key])return;const p=this._findTileCoveringTileID(l,this.sourceCache);p&&(this.terrainTileForTile[l.key]=p)})}_prepareDEMTextures(){const r=this.painter.context,l=r.gl;for(const p in this.terrainTileForTile){const g=this.terrainTileForTile[p],x=g.dem;!x||g.demTexture&&!g.needsDEMTextureUpload||(r.activeTexture.set(l.TEXTURE1),Bo(this.painter,g,x))}}_prepareDemTileUniforms(r,l,p,g){if(!l||l.demTexture==null)return!1;const x=r.tileID.canonical,b=Math.pow(2,l.tileID.canonical.z-x.z),T=g||"";return p[`u_dem_tl${T}`]=[x.x*b%1,x.y*b%1],p[`u_dem_scale${T}`]=b,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const r=this.painter.context,l=r.gl;if(!this._emptyDepthBufferTexture){const p=new s.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new s.Texture(r,p,l.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let r=0;const l=this._visibleDemTiles.reduce((p,g)=>{if(!g.dem)return p;const x=g.dem.tree.minimums[0];return x>0&&r++,p+x},0);return r?l/r:0}_updateEmptyDEMTexture(){const r=this.painter.context,l=r.gl;r.activeTexture.set(l.TEXTURE2);const p=this._getLoadedAreaMinimum(),g=new s.RGBAImage({width:1,height:1},new Uint8Array(s.DEMData.pack(p,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let x=this._emptyDEMTexture;return x?x.update(g,{premultiply:!1}):x=this._emptyDEMTexture=new s.Texture(r,g,l.RGBA,{premultiply:!1}),x}setupElevationDraw(r,l,p){const g=this.painter.context,x=g.gl,b=(T=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:s.DEMData.getUnpackVector(T),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var T;b.u_dem_size=this.sourceCache.getSource().tileSize,b.u_exaggeration=this.exaggeration();let S=null,k=null,L=1;if(p&&p.morphing&&this._useVertexMorphing){const G=p.morphing.srcDemTile,V=p.morphing.dstDemTile;L=p.morphing.phase,G&&V&&(this._prepareDemTileUniforms(r,G,b,"_prev")&&(k=G),this._prepareDemTileUniforms(r,V,b)&&(S=V))}if(k&&S?(g.activeTexture.set(x.TEXTURE2),S.demTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE,x.NEAREST),g.activeTexture.set(x.TEXTURE4),k.demTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE,x.NEAREST),b.u_dem_lerp=L):(S=this.terrainTileForTile[r.tileID.key],g.activeTexture.set(x.TEXTURE2),(this._prepareDemTileUniforms(r,S,b)?S.demTexture:this.emptyDEMTexture).bind(x.NEAREST,x.CLAMP_TO_EDGE)),g.activeTexture.set(x.TEXTURE3),p&&p.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE),this._depthFBO&&(b.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE),b.u_depth_size_inv=[1,1]),p&&p.useMeterToDem&&S){const G=(1<<S.tileID.canonical.z)*s.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;b.u_meter_to_dem=G}if(p&&p.labelPlaneMatrixInv&&(b.u_label_plane_matrix_inv=p.labelPlaneMatrixInv),l.setTerrainUniformValues(g,b),this.painter.transform.projection.name==="globe"){const G=this.globeUniformValues(this.painter.transform,r.tileID.canonical,p&&p.useDenormalizedUpVectorScale);l.setGlobeUniformValues(g,G)}}globeUniformValues(r,l,p){const g=r.projection;return{u_tile_tl_up:g.upVector(l,0,0),u_tile_tr_up:g.upVector(l,s.EXTENT,0),u_tile_br_up:g.upVector(l,s.EXTENT,s.EXTENT),u_tile_bl_up:g.upVector(l,0,s.EXTENT),u_tile_up_scale:p?s.GLOBE_METERS_TO_ECEF:g.upVectorScale(l,r.center.lat,r.worldSize).metersToTile}}renderToBackBuffer(r){const l=this.painter,p=this.painter.context;r.length!==0&&(p.bindFramebuffer.set(null),p.viewport.set([0,0,l.width,l.height]),l.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(g,x,b,T,S){if(g.transform.projection.name==="globe")(function(k,L,G,V,X){const Z=k.context,Y=Z.gl;let W,$;const te=k.options.showTerrainWireframe?2:0,J=k.transform,le=s.globeUseCustomAntiAliasing(k,Z,J),ue=(Me,ve)=>{if($===Me)return;const pt=[Wa[Me],"PROJECTION_GLOBE_VIEW"];le&&pt.push("CUSTOM_ANTIALIASING"),ve&&pt.push(Wa[te]),W=k.useProgram("globeRaster",null,pt),$=Me},oe=k.colorModeForRenderPass(),fe=new s.DepthMode(Y.LEQUAL,s.DepthMode.ReadWrite,k.depthRangeFor3D);oa.update(X);const Ee=s.calculateGlobeMercatorMatrix(J),Oe=[s.mercatorXfromLng(J.center.lng),s.mercatorYfromLat(J.center.lat)],Le=te?[!1,!0]:[!1],tt=k.globeSharedBuffers,Ce=[J.width*s.exported.devicePixelRatio,J.height*s.exported.devicePixelRatio],Ve=Float32Array.from(J.globeMatrix),He={useDenormalizedUpVectorScale:!0};if(Le.forEach(Me=>{$=-1;const ve=Me?Y.LINES:Y.TRIANGLES;for(const pt of V){const ut=G.getTile(pt),dt=s.StencilMode.disabled,ct=L.prevTerrainTileForTile[pt.key],Tt=L.terrainTileForTile[pt.key];Su(ct,Tt)&&oa.newMorphing(pt.key,ct,Tt,X,250),Z.activeTexture.set(Y.TEXTURE0),ut.texture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE);const Ht=oa.getMorphValuesForProxy(pt.key),Gt=Ht?1:0;Ht&&s.extend$1(He,{morphing:{srcDemTile:Ht.from,dstDemTile:Ht.to,phase:s.easeCubicInOut(Ht.phase)}});const kt=s.tileCornersToBounds(pt.canonical),ht=s.getLatitudinalLod(kt.getCenter().lat),Yt=s.getGridMatrix(pt.canonical,kt,ht,J.worldSize/J._pixelsPerMercatorPixel),on=s.globeNormalizeECEF(s.globeTileBounds(pt.canonical)),Fn=Ac(J.projMatrix,Ve,Ee,on,s.globeToMercatorTransition(J.zoom),Oe,J.frustumCorners.TL,J.frustumCorners.TR,J.frustumCorners.BR,J.frustumCorners.BL,J.globeCenterInViewSpace,J.globeRadius,Ce,Yt);if(ue(Gt,Me),L.setupElevationDraw(ut,W,He),k.prepareDrawProgram(Z,W,pt.toUnwrapped()),tt){const[Nn,Dn,Mr]=Me?tt.getWirefameBuffers(k.context,ht):tt.getGridBuffers(ht);W.draw(Z,ve,fe,dt,oe,s.CullFaceMode.backCCW,Fn,"globe_raster",Nn,Dn,Mr)}}}),tt){const Me=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];le&&Me.push("CUSTOM_ANTIALIASING"),W=k.useProgram("globeRaster",null,Me);for(const ve of V){const{x:pt,y:ut,z:dt}=ve.canonical,ct=ut===0,Tt=ut===(1<<dt)-1,[Ht,Gt,kt,ht]=tt.getPoleBuffers(dt);if(ht&&(ct||Tt)){const Yt=G.getTile(ve);Z.activeTexture.set(Y.TEXTURE0),Yt.texture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE);let on=s.globePoleMatrixForTile(dt,pt,J);const Fn=s.globeNormalizeECEF(s.globeTileBounds(ve.canonical)),Nn=(Dn,Mr)=>Dn.draw(Z,Y.TRIANGLES,fe,s.StencilMode.disabled,oe,s.CullFaceMode.disabled,Ac(J.projMatrix,on,on,Fn,0,Oe,J.frustumCorners.TL,J.frustumCorners.TR,J.frustumCorners.BR,J.frustumCorners.BL,J.globeCenterInViewSpace,J.globeRadius,Ce),"globe_pole_raster",Mr,kt,ht);L.setupElevationDraw(Yt,W,He),k.prepareDrawProgram(Z,W,ve.toUnwrapped()),ct&&Nn(W,Ht),Tt&&(on=s.scale(s.create(),on,[1,-1,1]),Nn(W,Gt))}}}})(g,x,b,T,S);else{const k=g.context,L=k.gl;let G,V;const X=g.options.showTerrainWireframe?2:0,Z=(J,le)=>{if(V===J)return;const ue=[Wa[J]];le&&ue.push(Wa[X]),G=g.useProgram("terrainRaster",null,ue),V=J},Y=g.colorModeForRenderPass(),W=new s.DepthMode(L.LEQUAL,s.DepthMode.ReadWrite,g.depthRangeFor3D);oa.update(S);const $=g.transform,te=6*Math.pow(1.5,22-$.zoom)*x.exaggeration();(X?[!1,!0]:[!1]).forEach(J=>{V=-1;const le=J?L.LINES:L.TRIANGLES,[ue,oe]=J?x.getWirefameBuffer():[x.gridIndexBuffer,x.gridSegments];for(const fe of T){const Ee=b.getTile(fe),Oe=s.StencilMode.disabled,Le=x.prevTerrainTileForTile[fe.key],tt=x.terrainTileForTile[fe.key];Su(Le,tt)&&oa.newMorphing(fe.key,Le,tt,S,250),k.activeTexture.set(L.TEXTURE0),Ee.texture.bind(L.LINEAR,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST);const Ce=oa.getMorphValuesForProxy(fe.key),Ve=Ce?1:0;let He;Ce&&(He={morphing:{srcDemTile:Ce.from,dstDemTile:Ce.to,phase:s.easeCubicInOut(Ce.phase)}});const Me=Du(fe.projMatrix,xn(fe.canonical,$.renderWorldCopies)?te/10:te);Z(Ve,J),x.setupElevationDraw(Ee,G,He),g.prepareDrawProgram(k,G,fe.toUnwrapped()),G.draw(k,le,W,Oe,Y,s.CullFaceMode.backCCW,Me,"terrain_raster",x.gridBuffer,ue,oe)}})}}(l,this,this.proxySourceCache,r,this._updateTimestamp),this.renderingToTexture=!0,l.gpuTimingDeferredRenderEnd(),r.splice(0,r.length))}renderBatch(r){if(this._drapedRenderBatches.length===0)return r+1;this.renderingToTexture=!0;const l=this.painter,p=this.painter.context,g=this.proxySourceCache,x=this.proxiedCoords[g.id],b=this._drapedRenderBatches.shift(),T=[],S=l.style.order;let k=0;for(const L of x){const G=g.getTileByID(L.proxyTileKey),V=g.proxyCachedFBO[L.key]?g.proxyCachedFBO[L.key][r]:void 0,X=V!==void 0?g.renderCache[V]:this.pool[k++],Z=V!==void 0;if(G.texture=X.tex,Z&&!X.dirty){T.push(G.tileID);continue}let Y;p.bindFramebuffer.set(X.fb.framebuffer),this.renderedToTile=!1,X.dirty&&(p.clear({color:s.Color.transparent,stencil:0}),X.dirty=!1);for(let W=b.start;W<=b.end;++W){const $=l.style._layers[S[W]];if($.isHidden(l.transform.zoom))continue;const te=l.style._getLayerSourceCache($),J=te?this.proxyToSource[L.key][te.id]:[L];if(!J)continue;const le=J;p.viewport.set([0,0,X.fb.width,X.fb.height]),Y!==(te?te.id:null)&&(this._setupStencil(X,J,$,te),Y=te?te.id:null),l.renderLayer(l,te,$,le)}this.renderedToTile?(X.dirty=!0,T.push(G.tileID)):Z||--k,k===5&&(k=0,this.renderToBackBuffer(T))}return this.renderToBackBuffer(T),this.renderingToTexture=!1,p.bindFramebuffer.set(null),p.viewport.set([0,0,l.width,l.height]),b.end+1}postRender(){}renderCacheEfficiency(r){const l=r.order.length;if(l===0)return{efficiency:100};let p,g=0,x=0,b=!1;for(let T=0;T<l;++T){const S=r._layers[r.order[T]];this._style.isLayerDraped(S)?(b&&++g,++x):b||(b=!0,p=S.id)}return x===0?{efficiency:100}:{efficiency:100*(1-g/x),firstUndrapedLayer:p}}getMinElevationBelowMSL(){let r=0;return this._visibleDemTiles.filter(l=>l.dem).forEach(l=>{r=Math.min(r,l.dem.tree.minimums[0])}),r===0?r:(r-30)*this._exaggeration}raycast(r,l,p){if(!this._visibleDemTiles)return null;const g=this._visibleDemTiles.filter(x=>x.dem).map(x=>{const b=x.tileID,T=1<<b.overscaledZ,{x:S,y:k}=b.canonical,L=S/T,G=(S+1)/T,V=k/T,X=(k+1)/T;return{minx:L,miny:V,maxx:G,maxy:X,t:x.dem.tree.raycastRoot(L,V,G,X,r,l,p),tile:x}});g.sort((x,b)=>(x.t!==null?x.t:Number.MAX_VALUE)-(b.t!==null?b.t:Number.MAX_VALUE));for(const x of g){if(x.t==null)return null;const b=x.tile.dem.tree.raycast(x.minx,x.miny,x.maxx,x.maxy,r,l,p);if(b!=null)return b}return null}_createFBO(){const r=this.painter.context,l=r.gl,p=this.drapeBufferSize;r.activeTexture.set(l.TEXTURE0);const g=new s.Texture(r,{width:p[0],height:p[1],data:null},l.RGBA);g.bind(l.LINEAR,l.CLAMP_TO_EDGE);const x=r.createFramebuffer(p[0],p[1],!1);return x.colorAttachment.set(g.texture),x.depthAttachment=new Ua(r,x.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=r.createRenderbuffer(r.gl.DEPTH_STENCIL,p[0],p[1]),this._stencilRef=0,x.depthAttachment.set(this._sharedDepthStencil),r.clear({stencil:0})):x.depthAttachment.set(this._sharedDepthStencil),r.extTextureFilterAnisotropic&&!r.extTextureFilterAnisotropicForceOff&&l.texParameterf(l.TEXTURE_2D,r.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,r.extTextureFilterAnisotropicMax),{fb:x,tex:g,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const r in this._style._sourceCaches)if(this._style._sourceCaches[r].hasTransition())return!0;return this._style.order.some(r=>{const l=this._style._layers[r],p=l.isHidden(this.painter.transform.zoom),g=l.getCrossfadeParameters(),x=!!g&&g.t!==1,b=l.hasTransition();return l.type!=="custom"&&!p&&(x||b)})}_clearRasterFadeFromRenderCache(){let r=!1;for(const l in this._style._sourceCaches)if(this._style._sourceCaches[l]._source instanceof j){r=!0;break}if(r)for(let l=0;l<this._style.order.length;++l){const p=this._style._layers[this._style.order[l]],g=p.isHidden(this.painter.transform.zoom),x=this._style._getLayerSourceCache(p);if(p.type!=="raster"||g||!x)continue;const b=p.paint.get("raster-fade-duration");for(const T of this.proxyCoords){const S=this.proxyToSource[T.key][x.id];if(S)for(const k of S){const L=Zh(x.getTile(k),x.findLoadedParent(k,0),x,this.painter.transform,b);(L.opacity!==1||L.mix!==0)&&this._clearRenderCacheForTile(x.id,k)}}}}_setupDrapedRenderBatches(){const r=this._style.order,l=r.length;if(l===0)return;const p=[];let g,x=0,b=this._style._layers[r[x]];for(;!this._style.isLayerDraped(b)&&b.isHidden(this.painter.transform.zoom)&&++x<l;)b=this._style._layers[r[x]];for(;x<l;++x){const T=this._style._layers[r[x]];T.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(T)?g===void 0&&(g=x):g!==void 0&&(p.push({start:g,end:x-1}),g=void 0))}g!==void 0&&p.push({start:g,end:x-1}),this._drapedRenderBatches=p}_setupRenderCache(r){const l=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,l.renderCache.length>l.renderCachePool.length){const b=Object.values(l.proxyCachedFBO);l.proxyCachedFBO={};for(let T=0;T<b.length;++T){const S=Object.values(b[T]);l.renderCachePool.push(...S)}}return}this._clearRasterFadeFromRenderCache();const p=this.proxyCoords,g=this._tilesDirty;for(let b=p.length-1;b>=0;b--){const T=p[b];if(l.getTileByID(T.key),l.proxyCachedFBO[T.key]!==void 0){const S=r[T.key],k=this.proxyToSource[T.key];let L=0;for(const G in k){const V=k[G],X=S[G];if(!X||X.length!==V.length||V.some((Z,Y)=>Z!==X[Y]||g[G]&&g[G].hasOwnProperty(Z.key))){L=-1;break}++L}for(const G in l.proxyCachedFBO[T.key])l.renderCache[l.proxyCachedFBO[T.key][G]].dirty=L<0||L!==Object.values(S).length}}const x=[...this._drapedRenderBatches];x.sort((b,T)=>T.end-T.start-(b.end-b.start));for(const b of x)for(const T of p){if(l.proxyCachedFBO[T.key])continue;let S=l.renderCachePool.pop();S===void 0&&l.renderCache.length<50&&(S=l.renderCache.length,l.renderCache.push(this._createFBO())),S!==void 0&&(l.proxyCachedFBO[T.key]={},l.proxyCachedFBO[T.key][b.start]=S,l.renderCache[S].dirty=!0)}this._tilesDirty={}}_setupStencil(r,l,p,g){if(!g||!this._sourceTilesOverlap[g.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const x=this.painter.context,b=x.gl;if(l.length<=1)return void(this._overlapStencilType=!1);let T;if(p.isTileClipped())T=l.length,this._overlapStencilMode.test={func:b.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(l[0].overscaledZ>l[l.length-1].overscaledZ))return void(this._overlapStencilType=!1);T=1,this._overlapStencilMode.test={func:b.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+T>255&&(x.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=T,this._overlapStencilMode.ref=this._stencilRef,p.isTileClipped()&&this._renderTileClippingMasks(l,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(r){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[r.key]),this._overlapStencilMode):s.StencilMode.disabled}_renderTileClippingMasks(r,l){const p=this.painter,g=this.painter.context,x=g.gl;p._tileClippingMaskIDs={},g.setColorMode(s.ColorMode.disabled),g.setDepthMode(s.DepthMode.disabled);const b=p.useProgram("clippingMask");for(const T of r){const S=p._tileClippingMaskIDs[T.key]=--l;b.draw(g,x.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:x.ALWAYS,mask:0},S,255,x.KEEP,x.KEEP,x.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,To(T.projMatrix),"$clipping",p.tileExtentBuffer,p.quadTriangleIndexBuffer,p.tileExtentSegments)}}pointCoordinate(r){const l=this.painter.transform;if(r.x<0||r.x>l.width||r.y<0||r.y>l.height)return null;const p=[r.x,r.y,1,1];s.transformMat4$1(p,p,l.pixelMatrixInverse),s.scale$1(p,p,1/p[3]),p[0]/=l.worldSize,p[1]/=l.worldSize;const g=l._camera.position,x=s.mercatorZfromAltitude(1,l.center.lat),b=[g[0],g[1],g[2]/x,0],T=s.subtract([],p.slice(0,3),b);s.normalize(T,T);const S=this.raycast(b,T,this._exaggeration);return S!==null&&S?(s.scaleAndAdd(b,b,T,S),b[3]=b[2],b[2]*=x,b):null}drawDepth(){const r=this.painter,l=r.context,p=this.proxySourceCache,g=Math.ceil(r.width),x=Math.ceil(r.height);if(!this._depthFBO||this._depthFBO.width===g&&this._depthFBO.height===x||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const b=l.gl,T=l.createFramebuffer(g,x,!0);l.activeTexture.set(b.TEXTURE0);const S=new s.Texture(l,{width:g,height:x,data:null},b.RGBA);S.bind(b.NEAREST,b.CLAMP_TO_EDGE),T.colorAttachment.set(S.texture);const k=l.createRenderbuffer(l.gl.DEPTH_COMPONENT16,g,x);T.depthAttachment.set(k),this._depthFBO=T,this._depthTexture=S}l.bindFramebuffer.set(this._depthFBO.framebuffer),l.viewport.set([0,0,g,x]),function(b,T,S,k){if(b.transform.projection.name==="globe")return;const L=b.context,G=L.gl;L.clear({depth:1});const V=b.useProgram("terrainDepth"),X=new s.DepthMode(G.LESS,s.DepthMode.ReadWrite,b.depthRangeFor3D);for(const Z of k){const Y=S.getTile(Z),W=Du(Z.projMatrix,0);T.setupElevationDraw(Y,V),V.draw(L,G.TRIANGLES,X,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.backCCW,W,"terrain_depth",T.gridBuffer,T.gridIndexBuffer,T.gridNoSkirtSegments)}}(r,this,p,this.proxyCoords)}_setupProxiedCoordsForOrtho(r,l,p){if(r.getSource()instanceof me)return this._setupProxiedCoordsForImageSource(r,l,p);this._findCoveringTileCache[r.id]=this._findCoveringTileCache[r.id]||{};const g=this.proxiedCoords[r.id]=[],x=this.proxyCoords;for(let T=0;T<x.length;T++){const S=x[T],k=this._findTileCoveringTileID(S,r);if(k){const L=this._createProxiedId(S,k,p[S.key]&&p[S.key][r.id]);g.push(L),this.proxyToSource[S.key][r.id]=[L]}}let b=!1;for(let T=0;T<l.length;T++){const S=r.getTile(l[T]);if(!S||!S.hasData())continue;const k=this._findTileCoveringTileID(S.tileID,this.proxySourceCache);if(k&&k.tileID.canonical.z!==S.tileID.canonical.z){const L=this.proxyToSource[k.tileID.key][r.id],G=this._createProxiedId(k.tileID,S,p[k.tileID.key]&&p[k.tileID.key][r.id]);L?L.splice(L.length-1,0,G):this.proxyToSource[k.tileID.key][r.id]=[G],g.push(G),b=!0}}this._sourceTilesOverlap[r.id]=b}_setupProxiedCoordsForImageSource(r,l,p){if(!r.getSource().loaded())return;const g=this.proxiedCoords[r.id]=[],x=this.proxyCoords,b=r.getSource(),T=new s.pointGeometry(b.tileID.x,b.tileID.y)._div(1<<b.tileID.z),S=b.coordinates.map(s.MercatorCoordinate.fromLngLat).reduce((L,G)=>(L.min.x=Math.min(L.min.x,G.x-T.x),L.min.y=Math.min(L.min.y,G.y-T.y),L.max.x=Math.max(L.max.x,G.x-T.x),L.max.y=Math.max(L.max.y,G.y-T.y),L),{min:new s.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new s.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),k=(L,G)=>{const V=L.wrap+L.canonical.x/(1<<L.canonical.z),X=L.canonical.y/(1<<L.canonical.z),Z=s.EXTENT/(1<<L.canonical.z),Y=G.wrap+G.canonical.x/(1<<G.canonical.z),W=G.canonical.y/(1<<G.canonical.z);return V+Z<Y+S.min.x||V>Y+S.max.x||X+Z<W+S.min.y||X>W+S.max.y};for(let L=0;L<x.length;L++){const G=x[L];for(let V=0;V<l.length;V++){const X=r.getTile(l[V]);if(!X||!X.hasData()||k(G,X.tileID))continue;const Z=this._createProxiedId(G,X,p[G.key]&&p[G.key][r.id]),Y=this.proxyToSource[G.key][r.id];Y?Y.push(Z):this.proxyToSource[G.key][r.id]=[Z],g.push(Z)}}}_createProxiedId(r,l,p){let g=this.orthoMatrix;if(p){const x=p.find(b=>b.key===l.tileID.key);if(x)return x}if(l.tileID.key!==r.key){const x=r.canonical.z-l.tileID.canonical.z;let b,T,S;g=s.create();const k=l.tileID.wrap-r.wrap<<r.overscaledZ;x>0?(b=s.EXTENT>>x,T=b*((l.tileID.canonical.x<<x)-r.canonical.x+k),S=b*((l.tileID.canonical.y<<x)-r.canonical.y)):(b=s.EXTENT<<-x,T=s.EXTENT*(l.tileID.canonical.x-(r.canonical.x+k<<-x)),S=s.EXTENT*(l.tileID.canonical.y-(r.canonical.y<<-x))),s.ortho(g,0,b,0,b,0,1),s.translate(g,g,[T,S,0])}return new kl(l.tileID,r.key,g)}_findTileCoveringTileID(r,l){let p=l.getTile(r);if(p&&p.hasData())return p;const g=this._findCoveringTileCache[l.id],x=g[r.key];if(p=x?l.getTileByID(x):null,p&&p.hasData()||x===null)return p;let b=p?p.tileID:r,T=b.overscaledZ;const S=l.getSource().minzoom,k=[];if(!x){const G=l.getSource().maxzoom;if(r.canonical.z>=G){const V=r.canonical.z-G;l.getSource().reparseOverscaled?(T=Math.max(r.canonical.z+2,l.transform.tileZoom),b=new s.OverscaledTileID(T,r.wrap,G,r.canonical.x>>V,r.canonical.y>>V)):V!==0&&(T=G,b=new s.OverscaledTileID(T,r.wrap,G,r.canonical.x>>V,r.canonical.y>>V))}b.key!==r.key&&(k.push(b.key),p=l.getTile(b))}const L=G=>{k.forEach(V=>{g[V]=G}),k.length=0};for(T-=1;T>=S&&(!p||!p.hasData());T--){p&&L(p.tileID.key);const G=b.calculateScaledKey(T);if(p=l.getTileByID(G),p&&p.hasData())break;const V=g[G];if(V===null)break;V===void 0?k.push(G):p=l.getTileByID(V)}return L(p?p.tileID.key:null),p&&p.hasData()?p:null}findDEMTileFor(r){return this.enabled?this._findTileCoveringTileID(r,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(r,l){let p=this._tilesDirty[r];p||(p=this._tilesDirty[r]={}),p[l.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const r=function(l){let p=0;const g=new s.StructArrayLayout2ui4,x=131;for(let b=1;b<129;b++){for(let T=1;T<129;T++)p=b*x+T,g.emplaceBack(p,p+1),g.emplaceBack(p,p+x),g.emplaceBack(p+1,p+x),b===128&&g.emplaceBack(p+x,p+x+1);g.emplaceBack(p+1,p+1+x)}return g}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(r),this.wireframeSegments=s.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,r.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Qh{static cacheKey(r,l,p,g){let x=`${l}${g?g.cacheKey:""}`;for(const b of p)r.usedDefines.includes(b)&&(x+=`/${b}`);return x}constructor(r,l,p,g,x,b){const T=r.gl;this.program=T.createProgram();const S=function(W){const $=[];for(let te=0;te<W.length;te++){if(W[te]===null)continue;const J=W[te].split(" ");$.push(J.pop())}return $}(p.staticAttributes),k=g?g.getBinderAttributes():[],L=S.concat(k);let G=g?g.defines():[];G=G.concat(b.map(W=>`#define ${W}`));const V=G.concat(r.extStandardDerivatives?`#extension GL_OES_standard_derivatives : enable
`.concat(vi):vi,vi,Wh,yi.fragmentSource,vc.fragmentSource,p.fragmentSource).join(`
`),X=G.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Wh,yi.vertexSource,vc.vertexSource,yc.vertexSource,p.vertexSource).join(`
`),Z=T.createShader(T.FRAGMENT_SHADER);if(T.isContextLost())return void(this.failedToCreate=!0);T.shaderSource(Z,V),T.compileShader(Z),T.attachShader(this.program,Z);const Y=T.createShader(T.VERTEX_SHADER);if(T.isContextLost())this.failedToCreate=!0;else{T.shaderSource(Y,X),T.compileShader(Y),T.attachShader(this.program,Y),this.attributes={},this.numAttributes=L.length;for(let W=0;W<this.numAttributes;W++)L[W]&&(T.bindAttribLocation(this.program,W,L[W]),this.attributes[L[W]]=W);T.linkProgram(this.program),T.deleteShader(Y),T.deleteShader(Z),this.fixedUniforms=x(r),this.binderUniforms=g?g.getUniforms(r):[],b.includes("TERRAIN")&&(this.terrainUniforms=(W=>({u_dem:new s.Uniform1i(W),u_dem_prev:new s.Uniform1i(W),u_dem_unpack:new s.Uniform4f(W),u_dem_tl:new s.Uniform2f(W),u_dem_scale:new s.Uniform1f(W),u_dem_tl_prev:new s.Uniform2f(W),u_dem_scale_prev:new s.Uniform1f(W),u_dem_size:new s.Uniform1f(W),u_dem_lerp:new s.Uniform1f(W),u_exaggeration:new s.Uniform1f(W),u_depth:new s.Uniform1i(W),u_depth_size_inv:new s.Uniform2f(W),u_meter_to_dem:new s.Uniform1f(W),u_label_plane_matrix_inv:new s.UniformMatrix4f(W)}))(r)),b.includes("GLOBE")&&(this.globeUniforms=(W=>({u_tile_tl_up:new s.Uniform3f(W),u_tile_tr_up:new s.Uniform3f(W),u_tile_br_up:new s.Uniform3f(W),u_tile_bl_up:new s.Uniform3f(W),u_tile_up_scale:new s.Uniform1f(W)}))(r)),b.includes("FOG")&&(this.fogUniforms=(W=>({u_fog_matrix:new s.UniformMatrix4f(W),u_fog_range:new s.Uniform2f(W),u_fog_color:new s.Uniform4f(W),u_fog_horizon_blend:new s.Uniform1f(W),u_fog_temporal_offset:new s.Uniform1f(W),u_frustum_tl:new s.Uniform3f(W),u_frustum_tr:new s.Uniform3f(W),u_frustum_br:new s.Uniform3f(W),u_frustum_bl:new s.Uniform3f(W),u_globe_pos:new s.Uniform3f(W),u_globe_radius:new s.Uniform1f(W),u_globe_transition:new s.Uniform1f(W),u_is_globe:new s.Uniform1i(W),u_viewport:new s.Uniform2f(W)}))(r))}}setTerrainUniformValues(r,l){if(!this.terrainUniforms)return;const p=this.terrainUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const g in l)p[g]&&p[g].set(this.program,g,l[g])}}setGlobeUniformValues(r,l){if(!this.globeUniforms)return;const p=this.globeUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const g in l)p[g]&&p[g].set(this.program,g,l[g])}}setFogUniformValues(r,l){if(!this.fogUniforms)return;const p=this.fogUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const g in l)p[g].set(this.program,g,l[g])}}draw(r,l,p,g,x,b,T,S,k,L,G,V,X,Z,Y){const W=r.gl;if(this.failedToCreate)return;r.program.set(this.program),r.setDepthMode(p),r.setStencilMode(g),r.setColorMode(x),r.setCullFace(b);for(const te of Object.keys(this.fixedUniforms))this.fixedUniforms[te].set(this.program,te,T[te]);Z&&Z.setUniforms(this.program,r,this.binderUniforms,V,{zoom:X});const $={[W.LINES]:2,[W.TRIANGLES]:3,[W.LINE_STRIP]:1}[l];for(const te of G.get()){const J=te.vaos||(te.vaos={});(J[S]||(J[S]=new ia)).bind(r,this,k,Z?Z.getPaintVertexBuffers():[],L,te.vertexOffset,Y||[]),W.drawElements(l,te.primitiveLength*$,W.UNSIGNED_SHORT,te.primitiveOffset*$*2)}}}function mf(h,r,l){const p=1/Qn(l,1,r.transform.tileZoom),g=Math.pow(2,l.tileID.overscaledZ),x=l.tileSize*Math.pow(2,r.transform.tileZoom)/g,b=x*(l.tileID.canonical.x+l.tileID.wrap*g),T=x*l.tileID.canonical.y;return{u_image:0,u_texsize:l.imageAtlasTexture.size,u_scale:[p,h.fromScale,h.toScale],u_fade:h.t,u_pixel_coord_upper:[b>>16,T>>16],u_pixel_coord_lower:[65535&b,65535&T]}}const Iu=s.create(),Pl=(h,r,l,p,g,x,b,T,S,k,L)=>{const G=r.style.light,V=G.properties.get("position"),X=[V.x,V.y,V.z],Z=s.create$1();G.properties.get("anchor")==="viewport"&&(s.fromRotation(Z,-r.transform.angle),s.transformMat3(X,X,Z));const Y=G.properties.get("color"),W=r.transform,$={u_matrix:h,u_lightpos:X,u_lightintensity:G.properties.get("intensity"),u_lightcolor:[Y.r,Y.g,Y.b],u_vertical_gradient:+l,u_opacity:p,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Iu,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:g,u_edge_radius:x};return W.projection.name==="globe"&&($.u_tile_id=[b.canonical.x,b.canonical.y,1<<b.canonical.z],$.u_zoom_transition=S,$.u_inv_rot_matrix=L,$.u_merc_center=k,$.u_up_dir=W.projection.upVector(new s.CanonicalTileID(0,0,0),k[0]*s.EXTENT,k[1]*s.EXTENT),$.u_height_lift=T),$},Yh=(h,r,l,p,g,x,b,T,S,k,L,G,V)=>{const X=Pl(h,r,l,p,g,x,b,k,L,G,V),Z={u_height_factor:-Math.pow(2,b.overscaledZ)/S.tileSize/8};return s.extend(X,mf(T,r,S),Z)},Mu=h=>({u_matrix:h}),xi=(h,r,l,p)=>s.extend(Mu(h),mf(l,r,p)),Cc=(h,r)=>({u_matrix:h,u_world:r}),ku=(h,r,l,p,g)=>s.extend(xi(h,r,l,p),{u_world:g}),Ll=s.create(),zl=(h,r,l,p,g,x)=>{const b=h.transform,T=b.projection.name==="globe";let S;if(x.paint.get("circle-pitch-alignment")==="map")if(T){const L=s.globePixelsToTileUnits(b.zoom,r.canonical)*b._pixelsPerMercatorPixel;S=Float32Array.from([L,0,0,L])}else S=b.calculatePixelsToTileUnitsMatrix(l);else S=new Float32Array([b.pixelsToGLUnits[0],0,0,b.pixelsToGLUnits[1]]);const k={u_camera_to_center_distance:b.cameraToCenterDistance,u_matrix:h.translatePosMatrix(r.projMatrix,l,x.paint.get("circle-translate"),x.paint.get("circle-translate-anchor")),u_device_pixel_ratio:s.exported.devicePixelRatio,u_extrude_scale:S,u_inv_rot_matrix:Ll,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(T){k.u_inv_rot_matrix=p,k.u_merc_center=g,k.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],k.u_zoom_transition=s.globeToMercatorTransition(b.zoom);const L=g[0]*s.EXTENT,G=g[1]*s.EXTENT;k.u_up_dir=b.projection.upVector(new s.CanonicalTileID(0,0,0),L,G)}return k},_f=h=>{const r=[];return h.paint.get("circle-pitch-alignment")==="map"&&r.push("PITCH_WITH_MAP"),h.paint.get("circle-pitch-scale")==="map"&&r.push("SCALE_WITH_MAP"),r},Ec=(h,r,l,p)=>{const g=s.EXTENT/l.tileSize;return{u_matrix:h,u_camera_to_center_distance:r.getCameraToCenterDistance(p),u_extrude_scale:[r.pixelsToGLUnits[0]/g,r.pixelsToGLUnits[1]/g]}},Bc=(h,r,l=1)=>({u_matrix:h,u_color:r,u_overlay:0,u_overlay_scale:l}),Jo=s.create(),ed=(h,r,l,p,g,x,b)=>{const T=h.transform,S=T.projection.name==="globe",k=S?s.globePixelsToTileUnits(T.zoom,r.canonical)*T._pixelsPerMercatorPixel:Qn(l,1,x),L={u_matrix:r.projMatrix,u_extrude_scale:k,u_intensity:b,u_inv_rot_matrix:Jo,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(S){L.u_inv_rot_matrix=p,L.u_merc_center=g,L.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],L.u_zoom_transition=s.globeToMercatorTransition(T.zoom);const G=g[0]*s.EXTENT,V=g[1]*s.EXTENT;L.u_up_dir=T.projection.upVector(new s.CanonicalTileID(0,0,0),G,V)}return L},Ka=(h,r,l,p,g,x,b,T)=>{const S=h.transform,k=S.calculatePixelsToTileUnitsMatrix(r),L={u_matrix:Fl(h,r,l,g),u_pixels_to_tile_units:k,u_device_pixel_ratio:b,u_units_to_pixels:[1/S.pixelsToGLUnits[0],1/S.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:x,u_texsize:[0,0],u_scale:[0,0,0],u_mix:0,u_alpha_discard_threshold:0,u_trim_offset:T};if(rd(l)){const G=nd(r,h.transform);L.u_texsize=r.lineAtlasTexture.size,L.u_scale=[G,p.fromScale,p.toScale],L.u_mix=p.t}return L},td=(h,r,l,p,g,x)=>{const b=h.transform,T=nd(r,b);return{u_matrix:Fl(h,r,l,g),u_texsize:r.imageAtlasTexture.size,u_pixels_to_tile_units:b.calculatePixelsToTileUnitsMatrix(r),u_device_pixel_ratio:x,u_image:0,u_scale:[T,p.fromScale,p.toScale],u_fade:p.t,u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function nd(h,r){return 1/Qn(h,1,r.tileZoom)}function Fl(h,r,l,p){return h.translatePosMatrix(p||r.tileID.projMatrix,r,l.paint.get("line-translate"),l.paint.get("line-translate-anchor"))}function rd(h){const r=h.paint.get("line-dasharray").value;return r.value||r.kind!=="constant"}const Xo=(h,r,l,p,g,x)=>{return{u_matrix:h,u_tl_parent:r,u_scale_parent:l,u_fade_t:p.mix,u_opacity:p.opacity*g.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:g.paint.get("raster-brightness-min"),u_brightness_high:g.paint.get("raster-brightness-max"),u_saturation_factor:(T=g.paint.get("raster-saturation"),T>0?1-1/(1.001-T):-T),u_contrast_factor:(b=g.paint.get("raster-contrast"),b>0?1/(1-b):1+b),u_spin_weights:Tc(g.paint.get("raster-hue-rotate")),u_perspective_transform:x};var b,T};function Tc(h){h*=Math.PI/180;const r=Math.sin(h),l=Math.cos(h);return[(2*l+1)/3,(-Math.sqrt(3)*r-l+1)/3,(Math.sqrt(3)*r-l+1)/3]}const Pu=s.create(),gf=(h,r,l,p,g,x,b,T,S,k,L,G,V,X,Z,Y)=>{const W=g.transform,$={u_is_size_zoom_constant:+(h==="constant"||h==="source"),u_is_size_feature_constant:+(h==="constant"||h==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:W.cameraToCenterDistance,u_rotate_symbol:+l,u_aspect_ratio:W.width/W.height,u_fade_change:g.options.fadeDuration?g.symbolFadeChange:1,u_matrix:x,u_label_plane_matrix:b,u_coord_matrix:T,u_is_text:+S,u_pitch_with_map:+p,u_texsize:k,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Pu,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Pu,u_up_vector:[0,-1,0]};return Y.name==="globe"&&($.u_tile_id=[L.canonical.x,L.canonical.y,1<<L.canonical.z],$.u_zoom_transition=G,$.u_inv_rot_matrix=X,$.u_merc_center=V,$.u_camera_forward=W._camera.forward(),$.u_ecef_origin=s.globeECEFOrigin(W.globeMatrix,L.toUnwrapped()),$.u_tile_matrix=Float32Array.from(W.globeMatrix),$.u_up_vector=Z),$},Dc=(h,r,l,p,g,x,b,T,S,k,L,G,V,X,Z,Y,W)=>s.extend(gf(h,r,l,p,g,x,b,T,S,k,G,V,X,Z,Y,W),{u_gamma_scale:p?g.transform.cameraToCenterDistance*Math.cos(g.terrain?0:g.transform._pitch):1,u_device_pixel_ratio:s.exported.devicePixelRatio,u_is_halo:+L}),Rl=(h,r,l,p,g,x,b,T,S,k,L,G,V,X,Z,Y)=>s.extend(Dc(h,r,l,p,g,x,b,T,!0,S,!0,L,G,V,X,Z,Y),{u_texsize_icon:k,u_texture_icon:1}),qi=(h,r,l)=>({u_matrix:h,u_opacity:r,u_color:l}),yf=(h,r,l,p,g,x)=>s.extend(function(b,T,S,k){const L=S.imageManager.getPattern(b.from.toString()),G=S.imageManager.getPattern(b.to.toString()),{width:V,height:X}=S.imageManager.getPixelSize(),Z=Math.pow(2,k.tileID.overscaledZ),Y=k.tileSize*Math.pow(2,S.transform.tileZoom)/Z,W=Y*(k.tileID.canonical.x+k.tileID.wrap*Z),$=Y*k.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:L.tl,u_pattern_br_a:L.br,u_pattern_tl_b:G.tl,u_pattern_br_b:G.br,u_texsize:[V,X],u_mix:T.t,u_pattern_size_a:L.displaySize,u_pattern_size_b:G.displaySize,u_scale_a:T.fromScale,u_scale_b:T.toScale,u_tile_units_to_pixels:1/Qn(k,1,S.transform.tileZoom),u_pixel_coord_upper:[W>>16,$>>16],u_pixel_coord_lower:[65535&W,65535&$]}}(p,x,l,g),{u_matrix:h,u_opacity:r}),Sc={fillExtrusion:h=>({u_matrix:new s.UniformMatrix4f(h),u_lightpos:new s.Uniform3f(h),u_lightintensity:new s.Uniform1f(h),u_lightcolor:new s.Uniform3f(h),u_vertical_gradient:new s.Uniform1f(h),u_opacity:new s.Uniform1f(h),u_edge_radius:new s.Uniform1f(h),u_ao:new s.Uniform2f(h),u_tile_id:new s.Uniform3f(h),u_zoom_transition:new s.Uniform1f(h),u_inv_rot_matrix:new s.UniformMatrix4f(h),u_merc_center:new s.Uniform2f(h),u_up_dir:new s.Uniform3f(h),u_height_lift:new s.Uniform1f(h)}),fillExtrusionPattern:h=>({u_matrix:new s.UniformMatrix4f(h),u_lightpos:new s.Uniform3f(h),u_lightintensity:new s.Uniform1f(h),u_lightcolor:new s.Uniform3f(h),u_vertical_gradient:new s.Uniform1f(h),u_height_factor:new s.Uniform1f(h),u_edge_radius:new s.Uniform1f(h),u_ao:new s.Uniform2f(h),u_tile_id:new s.Uniform3f(h),u_zoom_transition:new s.Uniform1f(h),u_inv_rot_matrix:new s.UniformMatrix4f(h),u_merc_center:new s.Uniform2f(h),u_up_dir:new s.Uniform3f(h),u_height_lift:new s.Uniform1f(h),u_image:new s.Uniform1i(h),u_texsize:new s.Uniform2f(h),u_pixel_coord_upper:new s.Uniform2f(h),u_pixel_coord_lower:new s.Uniform2f(h),u_scale:new s.Uniform3f(h),u_fade:new s.Uniform1f(h),u_opacity:new s.Uniform1f(h)}),fill:h=>({u_matrix:new s.UniformMatrix4f(h)}),fillPattern:h=>({u_matrix:new s.UniformMatrix4f(h),u_image:new s.Uniform1i(h),u_texsize:new s.Uniform2f(h),u_pixel_coord_upper:new s.Uniform2f(h),u_pixel_coord_lower:new s.Uniform2f(h),u_scale:new s.Uniform3f(h),u_fade:new s.Uniform1f(h)}),fillOutline:h=>({u_matrix:new s.UniformMatrix4f(h),u_world:new s.Uniform2f(h)}),fillOutlinePattern:h=>({u_matrix:new s.UniformMatrix4f(h),u_world:new s.Uniform2f(h),u_image:new s.Uniform1i(h),u_texsize:new s.Uniform2f(h),u_pixel_coord_upper:new s.Uniform2f(h),u_pixel_coord_lower:new s.Uniform2f(h),u_scale:new s.Uniform3f(h),u_fade:new s.Uniform1f(h)}),circle:h=>({u_camera_to_center_distance:new s.Uniform1f(h),u_extrude_scale:new s.UniformMatrix2f(h),u_device_pixel_ratio:new s.Uniform1f(h),u_matrix:new s.UniformMatrix4f(h),u_inv_rot_matrix:new s.UniformMatrix4f(h),u_merc_center:new s.Uniform2f(h),u_tile_id:new s.Uniform3f(h),u_zoom_transition:new s.Uniform1f(h),u_up_dir:new s.Uniform3f(h)}),collisionBox:h=>({u_matrix:new s.UniformMatrix4f(h),u_camera_to_center_distance:new s.Uniform1f(h),u_extrude_scale:new s.Uniform2f(h)}),collisionCircle:h=>({u_matrix:new s.UniformMatrix4f(h),u_inv_matrix:new s.UniformMatrix4f(h),u_camera_to_center_distance:new s.Uniform1f(h),u_viewport_size:new s.Uniform2f(h)}),debug:h=>({u_color:new s.UniformColor(h),u_matrix:new s.UniformMatrix4f(h),u_overlay:new s.Uniform1i(h),u_overlay_scale:new s.Uniform1f(h)}),clippingMask:h=>({u_matrix:new s.UniformMatrix4f(h)}),heatmap:h=>({u_extrude_scale:new s.Uniform1f(h),u_intensity:new s.Uniform1f(h),u_matrix:new s.UniformMatrix4f(h),u_inv_rot_matrix:new s.UniformMatrix4f(h),u_merc_center:new s.Uniform2f(h),u_tile_id:new s.Uniform3f(h),u_zoom_transition:new s.Uniform1f(h),u_up_dir:new s.Uniform3f(h)}),heatmapTexture:h=>({u_image:new s.Uniform1i(h),u_color_ramp:new s.Uniform1i(h),u_opacity:new s.Uniform1f(h)}),hillshade:h=>({u_matrix:new s.UniformMatrix4f(h),u_image:new s.Uniform1i(h),u_latrange:new s.Uniform2f(h),u_light:new s.Uniform2f(h),u_shadow:new s.UniformColor(h),u_highlight:new s.UniformColor(h),u_accent:new s.UniformColor(h)}),hillshadePrepare:h=>({u_matrix:new s.UniformMatrix4f(h),u_image:new s.Uniform1i(h),u_dimension:new s.Uniform2f(h),u_zoom:new s.Uniform1f(h),u_unpack:new s.Uniform4f(h)}),line:h=>({u_matrix:new s.UniformMatrix4f(h),u_pixels_to_tile_units:new s.UniformMatrix2f(h),u_device_pixel_ratio:new s.Uniform1f(h),u_units_to_pixels:new s.Uniform2f(h),u_dash_image:new s.Uniform1i(h),u_gradient_image:new s.Uniform1i(h),u_image_height:new s.Uniform1f(h),u_texsize:new s.Uniform2f(h),u_scale:new s.Uniform3f(h),u_mix:new s.Uniform1f(h),u_alpha_discard_threshold:new s.Uniform1f(h),u_trim_offset:new s.Uniform2f(h)}),linePattern:h=>({u_matrix:new s.UniformMatrix4f(h),u_texsize:new s.Uniform2f(h),u_pixels_to_tile_units:new s.UniformMatrix2f(h),u_device_pixel_ratio:new s.Uniform1f(h),u_image:new s.Uniform1i(h),u_units_to_pixels:new s.Uniform2f(h),u_scale:new s.Uniform3f(h),u_fade:new s.Uniform1f(h),u_alpha_discard_threshold:new s.Uniform1f(h)}),raster:h=>({u_matrix:new s.UniformMatrix4f(h),u_tl_parent:new s.Uniform2f(h),u_scale_parent:new s.Uniform1f(h),u_fade_t:new s.Uniform1f(h),u_opacity:new s.Uniform1f(h),u_image0:new s.Uniform1i(h),u_image1:new s.Uniform1i(h),u_brightness_low:new s.Uniform1f(h),u_brightness_high:new s.Uniform1f(h),u_saturation_factor:new s.Uniform1f(h),u_contrast_factor:new s.Uniform1f(h),u_spin_weights:new s.Uniform3f(h),u_perspective_transform:new s.Uniform2f(h)}),symbolIcon:h=>({u_is_size_zoom_constant:new s.Uniform1i(h),u_is_size_feature_constant:new s.Uniform1i(h),u_size_t:new s.Uniform1f(h),u_size:new s.Uniform1f(h),u_camera_to_center_distance:new s.Uniform1f(h),u_rotate_symbol:new s.Uniform1i(h),u_aspect_ratio:new s.Uniform1f(h),u_fade_change:new s.Uniform1f(h),u_matrix:new s.UniformMatrix4f(h),u_label_plane_matrix:new s.UniformMatrix4f(h),u_coord_matrix:new s.UniformMatrix4f(h),u_is_text:new s.Uniform1i(h),u_pitch_with_map:new s.Uniform1i(h),u_texsize:new s.Uniform2f(h),u_tile_id:new s.Uniform3f(h),u_zoom_transition:new s.Uniform1f(h),u_inv_rot_matrix:new s.UniformMatrix4f(h),u_merc_center:new s.Uniform2f(h),u_camera_forward:new s.Uniform3f(h),u_tile_matrix:new s.UniformMatrix4f(h),u_up_vector:new s.Uniform3f(h),u_ecef_origin:new s.Uniform3f(h),u_texture:new s.Uniform1i(h)}),symbolSDF:h=>({u_is_size_zoom_constant:new s.Uniform1i(h),u_is_size_feature_constant:new s.Uniform1i(h),u_size_t:new s.Uniform1f(h),u_size:new s.Uniform1f(h),u_camera_to_center_distance:new s.Uniform1f(h),u_rotate_symbol:new s.Uniform1i(h),u_aspect_ratio:new s.Uniform1f(h),u_fade_change:new s.Uniform1f(h),u_matrix:new s.UniformMatrix4f(h),u_label_plane_matrix:new s.UniformMatrix4f(h),u_coord_matrix:new s.UniformMatrix4f(h),u_is_text:new s.Uniform1i(h),u_pitch_with_map:new s.Uniform1i(h),u_texsize:new s.Uniform2f(h),u_texture:new s.Uniform1i(h),u_gamma_scale:new s.Uniform1f(h),u_device_pixel_ratio:new s.Uniform1f(h),u_tile_id:new s.Uniform3f(h),u_zoom_transition:new s.Uniform1f(h),u_inv_rot_matrix:new s.UniformMatrix4f(h),u_merc_center:new s.Uniform2f(h),u_camera_forward:new s.Uniform3f(h),u_tile_matrix:new s.UniformMatrix4f(h),u_up_vector:new s.Uniform3f(h),u_ecef_origin:new s.Uniform3f(h),u_is_halo:new s.Uniform1i(h)}),symbolTextAndIcon:h=>({u_is_size_zoom_constant:new s.Uniform1i(h),u_is_size_feature_constant:new s.Uniform1i(h),u_size_t:new s.Uniform1f(h),u_size:new s.Uniform1f(h),u_camera_to_center_distance:new s.Uniform1f(h),u_rotate_symbol:new s.Uniform1i(h),u_aspect_ratio:new s.Uniform1f(h),u_fade_change:new s.Uniform1f(h),u_matrix:new s.UniformMatrix4f(h),u_label_plane_matrix:new s.UniformMatrix4f(h),u_coord_matrix:new s.UniformMatrix4f(h),u_is_text:new s.Uniform1i(h),u_pitch_with_map:new s.Uniform1i(h),u_texsize:new s.Uniform2f(h),u_texsize_icon:new s.Uniform2f(h),u_texture:new s.Uniform1i(h),u_texture_icon:new s.Uniform1i(h),u_gamma_scale:new s.Uniform1f(h),u_device_pixel_ratio:new s.Uniform1f(h),u_is_halo:new s.Uniform1i(h)}),background:h=>({u_matrix:new s.UniformMatrix4f(h),u_opacity:new s.Uniform1f(h),u_color:new s.UniformColor(h)}),backgroundPattern:h=>({u_matrix:new s.UniformMatrix4f(h),u_opacity:new s.Uniform1f(h),u_image:new s.Uniform1i(h),u_pattern_tl_a:new s.Uniform2f(h),u_pattern_br_a:new s.Uniform2f(h),u_pattern_tl_b:new s.Uniform2f(h),u_pattern_br_b:new s.Uniform2f(h),u_texsize:new s.Uniform2f(h),u_mix:new s.Uniform1f(h),u_pattern_size_a:new s.Uniform2f(h),u_pattern_size_b:new s.Uniform2f(h),u_scale_a:new s.Uniform1f(h),u_scale_b:new s.Uniform1f(h),u_pixel_coord_upper:new s.Uniform2f(h),u_pixel_coord_lower:new s.Uniform2f(h),u_tile_units_to_pixels:new s.Uniform1f(h)}),terrainRaster:wc,terrainDepth:wc,skybox:h=>({u_matrix:new s.UniformMatrix4f(h),u_sun_direction:new s.Uniform3f(h),u_cubemap:new s.Uniform1i(h),u_opacity:new s.Uniform1f(h),u_temporal_offset:new s.Uniform1f(h)}),skyboxGradient:h=>({u_matrix:new s.UniformMatrix4f(h),u_color_ramp:new s.Uniform1i(h),u_center_direction:new s.Uniform3f(h),u_radius:new s.Uniform1f(h),u_opacity:new s.Uniform1f(h),u_temporal_offset:new s.Uniform1f(h)}),skyboxCapture:h=>({u_matrix_3f:new s.UniformMatrix3f(h),u_sun_direction:new s.Uniform3f(h),u_sun_intensity:new s.Uniform1f(h),u_color_tint_r:new s.Uniform4f(h),u_color_tint_m:new s.Uniform4f(h),u_luminance:new s.Uniform1f(h)}),globeRaster:h=>({u_proj_matrix:new s.UniformMatrix4f(h),u_globe_matrix:new s.UniformMatrix4f(h),u_normalize_matrix:new s.UniformMatrix4f(h),u_merc_matrix:new s.UniformMatrix4f(h),u_zoom_transition:new s.Uniform1f(h),u_merc_center:new s.Uniform2f(h),u_image0:new s.Uniform1i(h),u_grid_matrix:new s.UniformMatrix3f(h),u_frustum_tl:new s.Uniform3f(h),u_frustum_tr:new s.Uniform3f(h),u_frustum_br:new s.Uniform3f(h),u_frustum_bl:new s.Uniform3f(h),u_globe_pos:new s.Uniform3f(h),u_globe_radius:new s.Uniform1f(h),u_viewport:new s.Uniform2f(h)}),globeAtmosphere:h=>({u_frustum_tl:new s.Uniform3f(h),u_frustum_tr:new s.Uniform3f(h),u_frustum_br:new s.Uniform3f(h),u_frustum_bl:new s.Uniform3f(h),u_horizon:new s.Uniform1f(h),u_transition:new s.Uniform1f(h),u_fadeout_range:new s.Uniform1f(h),u_color:new s.Uniform4f(h),u_high_color:new s.Uniform4f(h),u_space_color:new s.Uniform4f(h),u_star_intensity:new s.Uniform1f(h),u_star_density:new s.Uniform1f(h),u_star_size:new s.Uniform1f(h),u_temporal_offset:new s.Uniform1f(h),u_horizon_angle:new s.Uniform1f(h),u_rotation_matrix:new s.UniformMatrix4f(h)})};let Ic;function id(h,r,l,p,g,x,b){const T=h.context,S=T.gl,k=h.transform,L=h.useProgram("collisionBox"),G=[];let V=0,X=0;for(let le=0;le<p.length;le++){const ue=p[le],oe=r.getTile(ue),fe=oe.getBucket(l);if(!fe)continue;const Ee=Au(ue,fe,k);let Oe=Ee;g[0]===0&&g[1]===0||(Oe=h.translatePosMatrix(Ee,oe,g,x));const Le=b?fe.textCollisionBox:fe.iconCollisionBox,tt=fe.collisionCircleArray;if(tt.length>0){const Ce=s.create(),Ve=Oe;s.mul(Ce,fe.placementInvProjMatrix,k.glCoordMatrix),s.mul(Ce,Ce,fe.placementViewportMatrix),G.push({circleArray:tt,circleOffset:X,transform:Ve,invTransform:Ce,projection:fe.getProjection()}),V+=tt.length/4,X=V}Le&&(h.terrain&&h.terrain.setupElevationDraw(oe,L),L.draw(T,S.LINES,s.DepthMode.disabled,s.StencilMode.disabled,h.colorModeForRenderPass(),s.CullFaceMode.disabled,Ec(Oe,k,oe,fe.getProjection()),l.id,Le.layoutVertexBuffer,Le.indexBuffer,Le.segments,null,k.zoom,null,[Le.collisionVertexBuffer,Le.collisionVertexBufferExt]))}if(!b||!G.length)return;const Z=h.useProgram("collisionCircle"),Y=new s.StructArrayLayout2f1f2i16;Y.resize(4*V),Y._trim();let W=0;for(const le of G)for(let ue=0;ue<le.circleArray.length/4;ue++){const oe=4*ue,fe=le.circleArray[oe+0],Ee=le.circleArray[oe+1],Oe=le.circleArray[oe+2],Le=le.circleArray[oe+3];Y.emplace(W++,fe,Ee,Oe,Le,0),Y.emplace(W++,fe,Ee,Oe,Le,1),Y.emplace(W++,fe,Ee,Oe,Le,2),Y.emplace(W++,fe,Ee,Oe,Le,3)}(!Ic||Ic.length<2*V)&&(Ic=function(le){const ue=2*le,oe=new s.StructArrayLayout3ui6;oe.resize(ue),oe._trim();for(let fe=0;fe<ue;fe++){const Ee=6*fe;oe.uint16[Ee+0]=4*fe+0,oe.uint16[Ee+1]=4*fe+1,oe.uint16[Ee+2]=4*fe+2,oe.uint16[Ee+3]=4*fe+2,oe.uint16[Ee+4]=4*fe+3,oe.uint16[Ee+5]=4*fe+0}return oe}(V));const $=T.createIndexBuffer(Ic,!0),te=T.createVertexBuffer(Y,s.collisionCircleLayout.members,!0);for(const le of G){const ue={u_matrix:le.transform,u_inv_matrix:le.invTransform,u_camera_to_center_distance:(J=k).getCameraToCenterDistance(le.projection),u_viewport_size:[J.width,J.height]};Z.draw(T,S.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,h.colorModeForRenderPass(),s.CullFaceMode.disabled,ue,l.id,te,$,s.SegmentVector.simpleSegment(0,2*le.circleOffset,le.circleArray.length,le.circleArray.length/2),null,k.zoom)}var J;te.destroy(),$.destroy()}const od=s.create();function Ol(h,r,l,p,g,x){const{horizontalAlign:b,verticalAlign:T}=s.getAnchorAlignment(h),S=-(b-.5)*r,k=-(T-.5)*l,L=s.evaluateVariableOffset(h,p);return new s.pointGeometry((S/g+L[0])*x,(k/g+L[1])*x)}function Gl(h,r,l,p,g,x,b,T,S,k,L){const G=h.text.placedSymbolArray,V=h.text.dynamicLayoutVertexArray,X=h.icon.dynamicLayoutVertexArray,Z={},Y=bu(T,h.getProjection(),x),W=x.elevation,$=h.getProjection().upVectorScale(T.canonical,x.center.lat,x.worldSize);V.clear();for(let te=0;te<G.length;te++){const J=G.get(te),le=h.allowVerticalPlacement&&!J.placedOrientation,ue=J.hidden||!J.crossTileID||le?null:p[J.crossTileID];if(ue){const oe=new s.pointGeometry(J.tileAnchorX,J.tileAnchorY),fe=h.getProjection().upVector(T.canonical,oe.x,oe.y),Ee=W?W.getAtTileOffset(T,oe.x,oe.y):0,Oe=un([J.projectedAnchorX+Ee*fe[0]*$.metersToTile,J.projectedAnchorY+Ee*fe[1]*$.metersToTile,J.projectedAnchorZ+Ee*fe[2]*$.metersToTile],l?Y:b),Le=fn(x.getCameraToCenterDistance(h.getProjection()),Oe.signedDistanceFromCamera);let tt=g.evaluateSizeForFeature(h.textSizeData,k,J)*Le/s.ONE_EM;l&&(tt*=h.tilePixelRatio/S);const{width:Ce,height:Ve,anchor:He,textOffset:Me,textScale:ve}=ue,pt=Ol(He,Ce,Ve,Me,ve,tt);let ut;if(l){const ct=oe.add(pt),{x:Tt,y:Ht,z:Gt}=h.getProjection().projectTilePoint(ct.x,ct.y,T.canonical);ut=un([Tt+Ee*fe[0]*$.metersToTile,Ht+Ee*fe[1]*$.metersToTile,Gt+Ee*fe[2]*$.metersToTile],b).point}else{const ct=r?pt.rotate(-x.angle):pt;ut=[Oe.point[0]+ct.x,Oe.point[1]+ct.y,0]}const dt=h.allowVerticalPlacement&&J.placedOrientation===s.WritingMode.vertical?Math.PI/2:0;for(let ct=0;ct<J.numGlyphs;ct++)s.addDynamicAttributes(V,ut[0],ut[1],ut[2],dt);L&&J.associatedIconIndex>=0&&(Z[J.associatedIconIndex]={shiftedAnchor:ut,angle:dt})}else no(J.numGlyphs,V)}if(L){X.clear();const te=h.icon.placedSymbolArray;for(let J=0;J<te.length;J++){const le=te.get(J);if(le.hidden)no(le.numGlyphs,X);else{const ue=Z[J];if(ue)for(let oe=0;oe<le.numGlyphs;oe++)s.addDynamicAttributes(X,ue.shiftedAnchor[0],ue.shiftedAnchor[1],ue.shiftedAnchor[2],ue.angle);else no(le.numGlyphs,X)}}h.icon.dynamicLayoutVertexBuffer.updateData(X)}h.text.dynamicLayoutVertexBuffer.updateData(V)}function Se(h,r,l){return l.iconsInText&&r?"symbolTextAndIcon":h?"symbolSDF":"symbolIcon"}function Ke(h,r,l,p,g,x,b,T,S,k,L,G){const V=h.context,X=V.gl,Z=h.transform,Y=T==="map",W=S==="map",$=Y&&l.layout.get("symbol-placement")!=="point",te=Y&&!W&&!$,J=l.layout.get("symbol-sort-key").constantOr(1)!==void 0;let le=!1;const ue=h.depthModeForSublayer(0,s.DepthMode.ReadOnly),oe=[s.mercatorXfromLng(Z.center.lng),s.mercatorYfromLat(Z.center.lat)],fe=l.layout.get("text-variable-anchor"),Ee=Z.projection.name==="globe",Oe=[],Le=[0,-1,0];let tt=Le;!Ee&&!Z.mercatorFromTransition||Y||(tt=function(Ce){const Ve=Ce._camera.getWorldToCamera(Ce.worldSize,1),He=s.multiply([],Ve,Ce.globeMatrix);s.invert(He,He);const Me=[0,0,0],ve=[0,1,0,0];return s.transformMat4$1(ve,ve,He),Me[0]=ve[0],Me[1]=ve[1],Me[2]=ve[2],s.normalize(Me,Me),Me}(Z));for(const Ce of p){const Ve=r.getTile(Ce),He=Ve.getBucket(l);if(!He||He.projection.name==="mercator"&&Ee)continue;const Me=g?He.text:He.icon;if(!Me||He.fullyClipped||!Me.segments.get().length)continue;const ve=Me.programConfigurations.get(l.id),pt=g||He.sdfIcons,ut=g?He.textSizeData:He.iconSizeData,dt=W||Z.pitch!==0,ct=s.evaluateSizeForZoom(ut,Z.zoom);let Tt,Ht,Gt,kt,ht=[0,0],Yt=null;if(g){if(Ht=Ve.glyphAtlasTexture,Gt=X.LINEAR,Tt=Ve.glyphAtlasTexture.size,He.iconsInText){ht=Ve.imageAtlasTexture.size,Yt=Ve.imageAtlasTexture;const Jt=ut.kind==="composite"||ut.kind==="camera";kt=dt||h.options.rotating||h.options.zooming||Jt?X.LINEAR:X.NEAREST}}else{const Jt=l.layout.get("icon-size").constantOr(0)!==1||He.iconsNeedLinear;Ht=Ve.imageAtlasTexture,Gt=pt||h.options.rotating||h.options.zooming||Jt||dt?X.LINEAR:X.NEAREST,Tt=Ve.imageAtlasTexture.size}const on=He.projection.name==="globe",Fn=on?tt:Le,Nn=on?s.globeToMercatorTransition(Z.zoom):0,Dn=bu(Ce,He.getProjection(),Z),Mr=Z.calculatePixelsToTileUnitsMatrix(Ve),ii=El(Dn,Ve.tileID.canonical,W,Y,Z,He.getProjection(),Mr),Io=h.terrain&&W&&$?s.invert(s.create(),ii):od,Un=qa(Dn,Ve.tileID.canonical,W,Y,Z,He.getProjection(),Mr),lr=fe&&He.hasTextData(),Sn=l.layout.get("icon-text-fit")!=="none"&&lr&&He.hasIconData();if($){const Jt=Z.elevation,os=Jt?Jt.getAtTileOffsetFunc(Ce,Z.center.lat,Z.worldSize,He.getProjection()):Ai=>[0,0,0],fa=df(Dn,Ve.tileID.canonical,W,Y,Z,He.getProjection(),Mr);ja(He,Dn,h,g,fa,Un,W,k,os,Ce)}const vr=$||g&&fe||Sn,oi=h.translatePosMatrix(Dn,Ve,x,b),jn=vr?od:ii,zi=h.translatePosMatrix(Un,Ve,x,b,!0),ks=He.getProjection().createInversionMatrix(Z,Ce.canonical),ao=[];h.terrainRenderModeElevated()&&W&&ao.push("PITCH_WITH_MAP_TERRAIN"),on&&ao.push("PROJECTION_GLOBE_VIEW"),vr&&ao.push("PROJECTED_POS_ON_VIEWPORT");const Yr=pt&&l.paint.get(g?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Kl;Kl=pt?He.iconsInText?Rl(ut.kind,ct,te,W,h,oi,jn,zi,Tt,ht,Ce,Nn,oe,ks,Fn,He.getProjection()):Dc(ut.kind,ct,te,W,h,oi,jn,zi,g,Tt,!0,Ce,Nn,oe,ks,Fn,He.getProjection()):gf(ut.kind,ct,te,W,h,oi,jn,zi,g,Tt,Ce,Nn,oe,ks,Fn,He.getProjection());const is={program:h.useProgram(Se(pt,g,He),ve,ao),buffers:Me,uniformValues:Kl,atlasTexture:Ht,atlasTextureIcon:Yt,atlasInterpolation:Gt,atlasInterpolationIcon:kt,isSDF:pt,hasHalo:Yr,tile:Ve,labelPlaneMatrixInv:Io};if(J&&He.canOverlap){le=!0;const Jt=Me.segments.get();for(const os of Jt)Oe.push({segments:new s.SegmentVector([os]),sortKey:os.sortKey,state:is})}else Oe.push({segments:Me.segments,sortKey:0,state:is})}le&&Oe.sort((Ce,Ve)=>Ce.sortKey-Ve.sortKey);for(const Ce of Oe){const Ve=Ce.state;if(h.terrain&&h.terrain.setupElevationDraw(Ve.tile,Ve.program,{useDepthForOcclusion:!Ee,labelPlaneMatrixInv:Ve.labelPlaneMatrixInv}),V.activeTexture.set(X.TEXTURE0),Ve.atlasTexture.bind(Ve.atlasInterpolation,X.CLAMP_TO_EDGE),Ve.atlasTextureIcon&&(V.activeTexture.set(X.TEXTURE1),Ve.atlasTextureIcon&&Ve.atlasTextureIcon.bind(Ve.atlasInterpolationIcon,X.CLAMP_TO_EDGE)),Ve.isSDF){const He=Ve.uniformValues;Ve.hasHalo&&(He.u_is_halo=1,Ue(Ve.buffers,Ce.segments,l,h,Ve.program,ue,L,G,He)),He.u_is_halo=0}Ue(Ve.buffers,Ce.segments,l,h,Ve.program,ue,L,G,Ve.uniformValues)}}function Ue(h,r,l,p,g,x,b,T,S){const k=p.context,L=[h.dynamicLayoutVertexBuffer,h.opacityVertexBuffer,h.globeExtVertexBuffer];g.draw(k,k.gl.TRIANGLES,x,b,T,s.CullFaceMode.disabled,S,l.id,h.layoutVertexBuffer,h.indexBuffer,r,l.paint,p.transform.zoom,h.programConfigurations.get(l.id),L)}function Pt(h,r,l,p,g,x,b){const T=h.context.gl,S=l.paint.get("fill-pattern"),k=S&&S.constantOr(1),L=l.getCrossfadeParameters();let G,V,X,Z,Y;b?(V=k&&!l.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",G=T.LINES):(V=k?"fillPattern":"fill",G=T.TRIANGLES);for(const W of p){const $=r.getTile(W);if(k&&!$.patternsLoaded())continue;const te=$.getBucket(l);if(!te)continue;h.prepareDrawTile();const J=te.programConfigurations.get(l.id),le=h.useProgram(V,J);k&&(h.context.activeTexture.set(T.TEXTURE0),$.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),J.updatePaintBuffers(L));const ue=S.constantOr(null);if(ue&&$.imageAtlas){const fe=$.imageAtlas,Ee=fe.patternPositions[ue.to.toString()],Oe=fe.patternPositions[ue.from.toString()];Ee&&Oe&&J.setConstantPatternPositions(Ee,Oe)}const oe=h.translatePosMatrix(W.projMatrix,$,l.paint.get("fill-translate"),l.paint.get("fill-translate-anchor"));if(b){Z=te.indexBuffer2,Y=te.segments2;const fe=h.terrain&&h.terrain.renderingToTexture?h.terrain.drapeBufferSize:[T.drawingBufferWidth,T.drawingBufferHeight];X=V==="fillOutlinePattern"&&k?ku(oe,h,L,$,fe):Cc(oe,fe)}else Z=te.indexBuffer,Y=te.segments,X=k?xi(oe,h,L,$):Mu(oe);h.prepareDrawProgram(h.context,le,W.toUnwrapped()),le.draw(h.context,G,g,h.stencilModeForClipping(W),x,s.CullFaceMode.disabled,X,l.id,te.layoutVertexBuffer,Z,Y,l.paint,h.transform.zoom,J)}}function hn(h,r,l,p,g,x,b){const T=h.context,S=T.gl,k=h.transform,L=l.paint.get("fill-extrusion-pattern"),G=L.constantOr(1),V=l.getCrossfadeParameters(),X=l.paint.get("fill-extrusion-opacity"),Z=[l.paint.get("fill-extrusion-ambient-occlusion-intensity"),l.paint.get("fill-extrusion-ambient-occlusion-radius")],Y=l.layout.get("fill-extrusion-edge-radius"),W=k.projection.name==="globe"?s.fillExtrusionHeightLift():0,$=k.projection.name==="globe",te=$?s.globeToMercatorTransition(k.zoom):0,J=[s.mercatorXfromLng(k.center.lng),s.mercatorYfromLat(k.center.lat)],le=[];$&&(le.push("PROJECTION_GLOBE_VIEW"),h.style.terrainSetForDrapingOnly()&&le.push("TERRAIN")),Z[0]>0&&le.push("FAUX_AO");for(const ue of p){const oe=r.getTile(ue),fe=oe.getBucket(l);if(!fe||fe.projection.name!==k.projection.name)continue;const Ee=fe.programConfigurations.get(l.id),Oe=h.useProgram(G?"fillExtrusionPattern":"fillExtrusion",Ee,le);if(h.terrain){const ve=h.terrain;if(h.style.terrainSetForDrapingOnly())ve.setupElevationDraw(oe,Oe,{useMeterToDem:!0});else{if(!fe.enableTerrain)continue;if(ve.setupElevationDraw(oe,Oe,{useMeterToDem:!0}),zn(T,r,ue,fe,l,ve),!fe.centroidVertexBuffer){const pt=Oe.attributes.a_centroid_pos;pt!==void 0&&S.vertexAttrib2f(pt,0,0)}}}G&&(h.context.activeTexture.set(S.TEXTURE0),oe.imageAtlasTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),Ee.updatePaintBuffers(V));const Le=L.constantOr(null);if(Le&&oe.imageAtlas){const ve=oe.imageAtlas,pt=ve.patternPositions[Le.to.toString()],ut=ve.patternPositions[Le.from.toString()];pt&&ut&&Ee.setConstantPatternPositions(pt,ut)}const tt=h.translatePosMatrix(ue.projMatrix,oe,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),Ce=k.projection.createInversionMatrix(k,ue.canonical),Ve=l.paint.get("fill-extrusion-vertical-gradient"),He=G?Yh(tt,h,Ve,X,Z,Y,ue,V,oe,W,te,J,Ce):Pl(tt,h,Ve,X,Z,Y,ue,W,te,J,Ce);h.prepareDrawProgram(T,Oe,ue.toUnwrapped());const Me=[];h.terrain&&Me.push(fe.centroidVertexBuffer),$&&Me.push(fe.layoutVertexExtBuffer),Oe.draw(T,T.gl.TRIANGLES,g,x,b,s.CullFaceMode.backCCW,He,l.id,fe.layoutVertexBuffer,fe.indexBuffer,fe.segments,l.paint,h.transform.zoom,Ee,Me)}}function zn(h,r,l,p,g,x){const b=[$=>{let te=$.canonical.x-1,J=$.wrap;return te<0&&(te=(1<<$.canonical.z)-1,J--),new s.OverscaledTileID($.overscaledZ,J,$.canonical.z,te,$.canonical.y)},$=>{let te=$.canonical.x+1,J=$.wrap;return te===1<<$.canonical.z&&(te=0,J++),new s.OverscaledTileID($.overscaledZ,J,$.canonical.z,te,$.canonical.y)},$=>new s.OverscaledTileID($.overscaledZ,$.wrap,$.canonical.z,$.canonical.x,($.canonical.y===0?1<<$.canonical.z:$.canonical.y)-1),$=>new s.OverscaledTileID($.overscaledZ,$.wrap,$.canonical.z,$.canonical.x,$.canonical.y===(1<<$.canonical.z)-1?0:$.canonical.y+1)],T=$=>{const te=r.getSource().minzoom,J=ue=>{const oe=r.getTileByID(ue);if(oe&&oe.hasData())return oe.getBucket(g)},le=[0,-1,1];for(const ue of le){if($.overscaledZ+ue<te)continue;const oe=J($.calculateScaledKey($.overscaledZ+ue));if(oe)return oe}},S=[0,0,0],k=($,te)=>(S[0]=Math.min($.min.y,te.min.y),S[1]=Math.max($.max.y,te.max.y),S[2]=s.EXTENT-te.min.x>$.max.x?te.min.x-s.EXTENT:$.max.x,S),L=($,te)=>(S[0]=Math.min($.min.x,te.min.x),S[1]=Math.max($.max.x,te.max.x),S[2]=s.EXTENT-te.min.y>$.max.y?te.min.y-s.EXTENT:$.max.y,S),G=[($,te)=>k($,te),($,te)=>k(te,$),($,te)=>L($,te),($,te)=>L(te,$)],V=new s.pointGeometry(0,0);let X,Z,Y;const W=($,te,J,le,ue)=>{const oe=[[le?J:$,le?$:J,0],[le?J:te,le?te:J,0]],fe=ue<0?s.EXTENT+ue:ue,Ee=[le?fe:($+te)/2,le?($+te)/2:fe,0];return J===0&&ue<0||J!==0&&ue>0?x.getForTilePoints(Y,[Ee],!0,Z):oe.push(Ee),x.getForTilePoints(l,oe,!0,X),Math.max(oe[0][2],oe[1][2],Ee[2])/x.exaggeration()};for(let $=0;$<4;$++){const te=($<2?1:5)-$,J=p.borders[$];if(J.length===0)continue;const le=Y=b[$](l),ue=T(le);if(!(ue&&ue instanceof s.FillExtrusionBucket&&ue.enableTerrain)||p.borderDoneWithNeighborZ[$]===ue.canonical.z&&ue.borderDoneWithNeighborZ[te]===p.canonical.z||(Z=x.findDEMTileFor(le),!Z||!Z.dem))continue;if(!X){const Oe=x.findDEMTileFor(l);if(!Oe||!Oe.dem)return;X=Oe}const oe=ue.borders[te];let fe=0;const Ee=ue.borderDoneWithNeighborZ[te]!==p.canonical.z;if(p.canonical.z===ue.canonical.z){for(let Oe=0;Oe<J.length;Oe++){const Le=p.featuresOnBorder[J[Oe]],tt=Le.borders[$];let Ce;for(;fe<oe.length&&(Ce=ue.featuresOnBorder[oe[fe]],!(Ce.borders[te][1]>tt[0]+3));)Ee&&ue.encodeCentroid(void 0,Ce,!1),fe++;if(Ce&&fe<oe.length){const Ve=fe;let He=0;for(;!(Ce.borders[te][0]>tt[1]-3)&&(He++,++fe!==oe.length);)Ce=ue.featuresOnBorder[oe[fe]];if(Ce=ue.featuresOnBorder[oe[Ve]],Le.intersectsCount()>1||Ce.intersectsCount()>1||He!==1){He!==1&&(fe=Ve),p.encodeCentroid(void 0,Le,!1),Ee&&ue.encodeCentroid(void 0,Ce,!1);continue}const Me=G[$](Le,Ce),ve=$%2?s.EXTENT-1:0;V.x=W(Me[0],Math.min(s.EXTENT-1,Me[1]),ve,$<2,Me[2]),V.y=0,p.encodeCentroid(V,Le,!1),Ee&&ue.encodeCentroid(V,Ce,!1)}else p.encodeCentroid(void 0,Le,!1)}p.borderDoneWithNeighborZ[$]=ue.canonical.z,p.needsCentroidUpdate=!0,Ee&&(ue.borderDoneWithNeighborZ[te]=p.canonical.z,ue.needsCentroidUpdate=!0)}else{for(const Oe of J)p.encodeCentroid(void 0,p.featuresOnBorder[Oe],!1);if(Ee){for(const Oe of oe)ue.encodeCentroid(void 0,ue.featuresOnBorder[Oe],!1);ue.borderDoneWithNeighborZ[te]=p.canonical.z,ue.needsCentroidUpdate=!0}p.borderDoneWithNeighborZ[$]=ue.canonical.z,p.needsCentroidUpdate=!0}}(p.needsCentroidUpdate||!p.centroidVertexBuffer&&p.centroidVertexArray.length!==0)&&p.uploadCentroid(h)}const Ar=new s.Color(1,0,0,1),Yn=new s.Color(0,1,0,1),Mc=new s.Color(0,0,1,1),vf=new s.Color(1,0,1,1),Pi=new s.Color(0,1,1,1);function Qo(h,r,l){const p=h.context,g=h.transform,x=p.gl,b=g.projection.name==="globe",T=b?["PROJECTION_GLOBE_VIEW"]:null;let S=l.projMatrix;if(b&&s.globeToMercatorTransition(g.zoom)>0){const Le=s.transitionTileAABBinECEF(l.canonical,g),tt=s.globeDenormalizeECEF(Le);S=s.multiply(new Float32Array(16),g.globeMatrix,tt),s.multiply(S,g.projMatrix,S)}const k=h.useProgram("debug",null,T),L=r.getTileByID(l.key);h.terrain&&h.terrain.setupElevationDraw(L,k);const G=s.DepthMode.disabled,V=s.StencilMode.disabled,X=h.colorModeForRenderPass(),Z="$debug";p.activeTexture.set(x.TEXTURE0),h.emptyTexture.bind(x.LINEAR,x.CLAMP_TO_EDGE),b?L._makeGlobeTileDebugBuffers(h.context,g):L._makeDebugTileBoundsBuffers(h.context,g.projection);const Y=L._tileDebugBuffer||h.debugBuffer,W=L._tileDebugIndexBuffer||h.debugIndexBuffer,$=L._tileDebugSegments||h.debugSegments;k.draw(p,x.LINE_STRIP,G,V,X,s.CullFaceMode.disabled,Bc(S,s.Color.red),Z,Y,W,$,null,null,null,[L._globeTileDebugBorderBuffer]);const te=L.latestRawTileData,J=Math.floor((te&&te.byteLength||0)/1024),le=r.getTile(l).tileSize,ue=512/Math.min(le,512)*(l.overscaledZ/g.zoom)*.5;let oe=l.canonical.toString();l.overscaledZ!==l.canonical.z&&(oe+=` => ${l.overscaledZ}`),oe+=` ${J}kb`,function(Le,tt){Le.initDebugOverlayCanvas();const Ce=Le.debugOverlayCanvas,Ve=Le.context.gl,He=Le.debugOverlayCanvas.getContext("2d");He.clearRect(0,0,Ce.width,Ce.height),He.shadowColor="white",He.shadowBlur=2,He.lineWidth=1.5,He.strokeStyle="white",He.textBaseline="top",He.font="bold 36px Open Sans, sans-serif",He.fillText(tt,5,5),He.strokeText(tt,5,5),Le.debugOverlayTexture.update(Ce),Le.debugOverlayTexture.bind(Ve.LINEAR,Ve.CLAMP_TO_EDGE)}(h,oe);const fe=L._tileDebugTextBuffer||h.debugBuffer,Ee=L._tileDebugTextIndexBuffer||h.quadTriangleIndexBuffer,Oe=L._tileDebugTextSegments||h.debugSegments;k.draw(p,x.TRIANGLES,G,V,s.ColorMode.alphaBlended,s.CullFaceMode.disabled,Bc(S,s.Color.transparent,ue),Z,fe,Ee,Oe,null,null,null,[L._globeTileDebugTextBuffer])}function Nl(h,r,l,p){io(h,0,r+l/2,h.transform.width,l,p)}function sa(h,r,l,p){io(h,r-l/2,0,l,h.transform.height,p)}function io(h,r,l,p,g,x){const b=h.context,T=b.gl;T.enable(T.SCISSOR_TEST),T.scissor(r*s.exported.devicePixelRatio,l*s.exported.devicePixelRatio,p*s.exported.devicePixelRatio,g*s.exported.devicePixelRatio),b.clear({color:x}),T.disable(T.SCISSOR_TEST)}const Cs=s.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:qn}=Cs;function Yo(h,r,l,p){h.emplaceBack(r,l,p)}class En{constructor(r){this.vertexArray=new s.StructArrayLayout3f12,this.indices=new s.StructArrayLayout3ui6,Yo(this.vertexArray,-1,-1,1),Yo(this.vertexArray,1,-1,1),Yo(this.vertexArray,-1,1,1),Yo(this.vertexArray,1,1,1),Yo(this.vertexArray,-1,-1,-1),Yo(this.vertexArray,1,-1,-1),Yo(this.vertexArray,-1,1,-1),Yo(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=r.createVertexBuffer(this.vertexArray,qn),this.indexBuffer=r.createIndexBuffer(this.indices),this.segment=s.SegmentVector.simpleSegment(0,0,36,12)}}function oo(h,r,l,p,g,x){const b=h.gl,T=r.paint.get("sky-atmosphere-color"),S=r.paint.get("sky-atmosphere-halo-color"),k=r.paint.get("sky-atmosphere-sun-intensity"),L=((G,V,X,Z,Y)=>({u_matrix_3f:G,u_sun_direction:V,u_sun_intensity:X,u_color_tint_r:[Z.r,Z.g,Z.b,Z.a],u_color_tint_m:[Y.r,Y.g,Y.b,Y.a],u_luminance:5e-5}))(s.fromMat4(s.create$1(),p),g,k,T,S);b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_CUBE_MAP_POSITIVE_X+x,r.skyboxTexture,0),l.draw(h,b.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.frontCW,L,"skyboxCapture",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}const gm=s.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class xf{constructor(r){const l=new s.StructArrayLayout5f20;l.emplaceBack(-1,1,1,0,0),l.emplaceBack(1,1,1,1,0),l.emplaceBack(1,-1,1,1,1),l.emplaceBack(-1,-1,1,0,1);const p=new s.StructArrayLayout3ui6;p.emplaceBack(0,1,2),p.emplaceBack(2,3,0),this.vertexBuffer=r.createVertexBuffer(l,gm.members),this.indexBuffer=r.createIndexBuffer(p),this.segments=s.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Ul={symbol:function(h,r,l,p,g){if(h.renderPass!=="translucent")return;const x=s.StencilMode.disabled,b=h.colorModeForRenderPass();l.layout.get("text-variable-anchor")&&function(T,S,k,L,G,V,X){const Z=S.transform,Y=G==="map",W=V==="map";for(const $ of T){const te=L.getTile($),J=te.getBucket(k);if(!J||!J.text||!J.text.segments.get().length)continue;const le=s.evaluateSizeForZoom(J.textSizeData,Z.zoom),ue=bu($,J.getProjection(),Z),oe=Z.calculatePixelsToTileUnitsMatrix(te),fe=El(ue,te.tileID.canonical,W,Y,Z,J.getProjection(),oe),Ee=k.layout.get("icon-text-fit")!=="none"&&J.hasIconData();if(le){const Oe=Math.pow(2,Z.zoom-te.tileID.overscaledZ);Gl(J,Y,W,X,s.symbolSize,Z,fe,$,Oe,le,Ee)}}}(p,h,l,r,l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),g),l.paint.get("icon-opacity").constantOr(1)!==0&&Ke(h,r,l,p,!1,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),l.layout.get("icon-rotation-alignment"),l.layout.get("icon-pitch-alignment"),l.layout.get("icon-keep-upright"),x,b),l.paint.get("text-opacity").constantOr(1)!==0&&Ke(h,r,l,p,!0,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),l.layout.get("text-keep-upright"),x,b),r.map.showCollisionBoxes&&(id(h,r,l,p,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),!0),id(h,r,l,p,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),!1))},circle:function(h,r,l,p){if(h.renderPass!=="translucent")return;const g=l.paint.get("circle-opacity"),x=l.paint.get("circle-stroke-width"),b=l.paint.get("circle-stroke-opacity"),T=l.layout.get("circle-sort-key").constantOr(1)!==void 0;if(g.constantOr(1)===0&&(x.constantOr(1)===0||b.constantOr(1)===0))return;const S=h.context,k=S.gl,L=h.transform,G=h.depthModeForSublayer(0,s.DepthMode.ReadOnly),V=s.StencilMode.disabled,X=h.colorModeForRenderPass(),Z=L.projection.name==="globe",Y=[s.mercatorXfromLng(L.center.lng),s.mercatorYfromLat(L.center.lat)],W=[];for(let te=0;te<p.length;te++){const J=p[te],le=r.getTile(J),ue=le.getBucket(l);if(!ue||ue.projection.name!==L.projection.name)continue;const oe=ue.programConfigurations.get(l.id),fe=_f(l);Z&&fe.push("PROJECTION_GLOBE_VIEW");const Ee=h.useProgram("circle",oe,fe),Oe=ue.layoutVertexBuffer,Le=ue.globeExtVertexBuffer,tt=ue.indexBuffer,Ce=L.projection.createInversionMatrix(L,J.canonical),Ve={programConfiguration:oe,program:Ee,layoutVertexBuffer:Oe,globeExtVertexBuffer:Le,indexBuffer:tt,uniformValues:zl(h,J,le,Ce,Y,l),tile:le};if(T){const He=ue.segments.get();for(const Me of He)W.push({segments:new s.SegmentVector([Me]),sortKey:Me.sortKey,state:Ve})}else W.push({segments:ue.segments,sortKey:0,state:Ve})}T&&W.sort((te,J)=>te.sortKey-J.sortKey);const $={useDepthForOcclusion:!Z};for(const te of W){const{programConfiguration:J,program:le,layoutVertexBuffer:ue,globeExtVertexBuffer:oe,indexBuffer:fe,uniformValues:Ee,tile:Oe}=te.state,Le=te.segments;h.terrain&&h.terrain.setupElevationDraw(Oe,le,$),h.prepareDrawProgram(S,le,Oe.tileID.toUnwrapped()),le.draw(S,k.TRIANGLES,G,V,X,s.CullFaceMode.disabled,Ee,l.id,ue,fe,Le,l.paint,L.zoom,J,[oe])}},heatmap:function(h,r,l,p){if(l.paint.get("heatmap-opacity")!==0)if(h.renderPass==="offscreen"){const g=h.context,x=g.gl,b=s.StencilMode.disabled,T=new s.ColorMode([x.ONE,x.ONE],s.Color.transparent,[!0,!0,!0,!0]);(function(X,Z,Y,W){const $=X.gl,te=Z.width*W,J=Z.height*W;X.activeTexture.set($.TEXTURE1),X.viewport.set([0,0,te,J]);let le=Y.heatmapFbo;if(!le||le&&(le.width!==te||le.height!==J)){le&&le.destroy();const ue=$.createTexture();$.bindTexture($.TEXTURE_2D,ue),$.texParameteri($.TEXTURE_2D,$.TEXTURE_WRAP_S,$.CLAMP_TO_EDGE),$.texParameteri($.TEXTURE_2D,$.TEXTURE_WRAP_T,$.CLAMP_TO_EDGE),$.texParameteri($.TEXTURE_2D,$.TEXTURE_MIN_FILTER,$.LINEAR),$.texParameteri($.TEXTURE_2D,$.TEXTURE_MAG_FILTER,$.LINEAR),le=Y.heatmapFbo=X.createFramebuffer(te,J,!1),function(oe,fe,Ee,Oe,Le,tt){const Ce=oe.gl;Ce.texImage2D(Ce.TEXTURE_2D,0,Ce.RGBA,Le,tt,0,Ce.RGBA,oe.extRenderToTextureHalfFloat?oe.extTextureHalfFloat.HALF_FLOAT_OES:Ce.UNSIGNED_BYTE,null),Oe.colorAttachment.set(Ee)}(X,0,ue,le,te,J)}else $.bindTexture($.TEXTURE_2D,le.colorAttachment.get()),X.bindFramebuffer.set(le.framebuffer)})(g,h,l,h.transform.projection.name==="globe"?.5:.25),g.clear({color:s.Color.transparent});const S=h.transform,k=S.projection.name==="globe",L=k?["PROJECTION_GLOBE_VIEW"]:null,G=k?s.CullFaceMode.frontCCW:s.CullFaceMode.disabled,V=[s.mercatorXfromLng(S.center.lng),s.mercatorYfromLat(S.center.lat)];for(let X=0;X<p.length;X++){const Z=p[X];if(r.hasRenderableParent(Z))continue;const Y=r.getTile(Z),W=Y.getBucket(l);if(!W||W.projection.name!==S.projection.name)continue;const $=W.programConfigurations.get(l.id),te=h.useProgram("heatmap",$,L),{zoom:J}=h.transform;h.terrain&&h.terrain.setupElevationDraw(Y,te),h.prepareDrawProgram(g,te,Z.toUnwrapped());const le=S.projection.createInversionMatrix(S,Z.canonical);te.draw(g,x.TRIANGLES,s.DepthMode.disabled,b,T,G,ed(h,Z,Y,le,V,J,l.paint.get("heatmap-intensity")),l.id,W.layoutVertexBuffer,W.indexBuffer,W.segments,l.paint,h.transform.zoom,$,k?[W.globeExtVertexBuffer]:null)}g.viewport.set([0,0,h.width,h.height])}else h.renderPass==="translucent"&&(h.context.setColorMode(h.colorModeForRenderPass()),function(g,x){const b=g.context,T=b.gl,S=x.heatmapFbo;if(!S)return;b.activeTexture.set(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,S.colorAttachment.get()),b.activeTexture.set(T.TEXTURE1);let k=x.colorRampTexture;k||(k=x.colorRampTexture=new s.Texture(b,x.colorRamp,T.RGBA)),k.bind(T.LINEAR,T.CLAMP_TO_EDGE),g.useProgram("heatmapTexture").draw(b,T.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,g.colorModeForRenderPass(),s.CullFaceMode.disabled,((L,G,V,X)=>({u_image:0,u_color_ramp:1,u_opacity:G.paint.get("heatmap-opacity")}))(0,x),x.id,g.viewportBuffer,g.quadTriangleIndexBuffer,g.viewportSegments,x.paint,g.transform.zoom)}(h,l))},line:function(h,r,l,p){if(h.renderPass!=="translucent")return;const g=l.paint.get("line-opacity"),x=l.paint.get("line-width");if(g.constantOr(1)===0||x.constantOr(1)===0)return;const b=h.depthModeForSublayer(0,s.DepthMode.ReadOnly),T=h.colorModeForRenderPass(),S=h.terrain&&h.terrain.renderingToTexture?1:s.exported.devicePixelRatio,k=l.paint.get("line-dasharray"),L=k.constantOr(1),G=l.layout.get("line-cap"),V=l.paint.get("line-pattern"),X=V.constantOr(1),Z=l.paint.get("line-gradient"),Y=l.getCrossfadeParameters(),W=X?"linePattern":"line",$=h.context,te=$.gl,J=(ue=>{const oe=[];rd(ue)&&oe.push("RENDER_LINE_DASH"),ue.paint.get("line-gradient")&&oe.push("RENDER_LINE_GRADIENT");const fe=ue.paint.get("line-trim-offset");fe[0]===0&&fe[1]===0||oe.push("RENDER_LINE_TRIM_OFFSET");const Ee=ue.paint.get("line-pattern").constantOr(1),Oe=ue.paint.get("line-opacity").constantOr(1)!==1;return!Ee&&Oe&&oe.push("RENDER_LINE_ALPHA_DISCARD"),oe})(l);let le=J.includes("RENDER_LINE_ALPHA_DISCARD");h.terrain&&h.terrain.clipOrMaskOverlapStencilType()&&(le=!1);for(const ue of p){const oe=r.getTile(ue);if(X&&!oe.patternsLoaded())continue;const fe=oe.getBucket(l);if(!fe)continue;h.prepareDrawTile();const Ee=fe.programConfigurations.get(l.id),Oe=h.useProgram(W,Ee,J),Le=V.constantOr(null);if(Le&&oe.imageAtlas){const ut=oe.imageAtlas,dt=ut.patternPositions[Le.to.toString()],ct=ut.patternPositions[Le.from.toString()];dt&&ct&&Ee.setConstantPatternPositions(dt,ct)}const tt=k.constantOr(null),Ce=G.constantOr(null);if(!X&&tt&&Ce&&oe.lineAtlas){const ut=oe.lineAtlas,dt=ut.getDash(tt.to,Ce),ct=ut.getDash(tt.from,Ce);dt&&ct&&Ee.setConstantPatternPositions(dt,ct)}let[Ve,He]=l.paint.get("line-trim-offset");(Ce==="round"||Ce==="square")&&Ve!==He&&(Ve===0&&(Ve-=1),He===1&&(He+=1));const Me=h.terrain?ue.projMatrix:null,ve=X?td(h,oe,l,Y,Me,S):Ka(h,oe,l,Y,Me,fe.lineClipsArray.length,S,[Ve,He]);if(Z){const ut=fe.gradients[l.id];let dt=ut.texture;if(l.gradientVersion!==ut.version){let ct=256;if(l.stepInterpolant){const Tt=r.getSource().maxzoom,Ht=ue.canonical.z===Tt?Math.ceil(1<<h.transform.maxZoom-ue.canonical.z):1;ct=s.clamp(s.nextPowerOfTwo(fe.maxLineLength/s.EXTENT*1024*Ht),256,$.maxTextureSize)}ut.gradient=s.renderColorRamp({expression:l.gradientExpression(),evaluationKey:"lineProgress",resolution:ct,image:ut.gradient||void 0,clips:fe.lineClipsArray}),ut.texture?ut.texture.update(ut.gradient):ut.texture=new s.Texture($,ut.gradient,te.RGBA),ut.version=l.gradientVersion,dt=ut.texture}$.activeTexture.set(te.TEXTURE1),dt.bind(l.stepInterpolant?te.NEAREST:te.LINEAR,te.CLAMP_TO_EDGE)}L&&($.activeTexture.set(te.TEXTURE0),oe.lineAtlasTexture.bind(te.LINEAR,te.REPEAT),Ee.updatePaintBuffers(Y)),X&&($.activeTexture.set(te.TEXTURE0),oe.imageAtlasTexture.bind(te.LINEAR,te.CLAMP_TO_EDGE),Ee.updatePaintBuffers(Y)),h.prepareDrawProgram($,Oe,ue.toUnwrapped());const pt=ut=>{Oe.draw($,te.TRIANGLES,b,ut,T,s.CullFaceMode.disabled,ve,l.id,fe.layoutVertexBuffer,fe.indexBuffer,fe.segments,l.paint,h.transform.zoom,Ee,[fe.layoutVertexBuffer2])};if(le){const ut=h.stencilModeForClipping(ue).ref;ut===0&&h.terrain&&$.clear({stencil:0});const dt={func:te.EQUAL,mask:255};ve.u_alpha_discard_threshold=.8,pt(new s.StencilMode(dt,ut,255,te.KEEP,te.KEEP,te.INVERT)),ve.u_alpha_discard_threshold=0,pt(new s.StencilMode(dt,ut,255,te.KEEP,te.KEEP,te.KEEP))}else pt(h.stencilModeForClipping(ue))}le&&(h.resetStencilClippingMasks(),h.terrain&&$.clear({stencil:0}))},fill:function(h,r,l,p){const g=l.paint.get("fill-color"),x=l.paint.get("fill-opacity");if(x.constantOr(1)===0)return;const b=h.colorModeForRenderPass(),T=l.paint.get("fill-pattern"),S=h.opaquePassEnabledForLayer()&&!T.constantOr(1)&&g.constantOr(s.Color.transparent).a===1&&x.constantOr(0)===1?"opaque":"translucent";if(h.renderPass===S){const k=h.depthModeForSublayer(1,h.renderPass==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly);Pt(h,r,l,p,k,b,!1)}if(h.renderPass==="translucent"&&l.paint.get("fill-antialias")){const k=h.depthModeForSublayer(l.getPaintProperty("fill-outline-color")?2:0,s.DepthMode.ReadOnly);Pt(h,r,l,p,k,b,!0)}},"fill-extrusion":function(h,r,l,p){const g=l.paint.get("fill-extrusion-opacity");if(g!==0&&h.renderPass==="translucent"){const x=new s.DepthMode(h.context.gl.LEQUAL,s.DepthMode.ReadWrite,h.depthRangeFor3D);if(g!==1||l.paint.get("fill-extrusion-pattern").constantOr(1))hn(h,r,l,p,x,s.StencilMode.disabled,s.ColorMode.disabled),hn(h,r,l,p,x,h.stencilModeFor3D(),h.colorModeForRenderPass()),h.resetStencilClippingMasks();else{const b=h.colorModeForRenderPass();hn(h,r,l,p,x,s.StencilMode.disabled,b)}}},hillshade:function(h,r,l,p){if(h.renderPass!=="offscreen"&&h.renderPass!=="translucent")return;const g=h.context,x=h.depthModeForSublayer(0,s.DepthMode.ReadOnly),b=h.colorModeForRenderPass(),T=h.terrain&&h.terrain.renderingToTexture,[S,k]=h.renderPass!=="translucent"||T?[{},p]:h.stencilConfigForOverlap(p);for(const L of k){const G=r.getTile(L);if(G.needsHillshadePrepare&&h.renderPass==="offscreen")xc(h,G,l,x,s.StencilMode.disabled,b);else if(h.renderPass==="translucent"){const V=T&&h.terrain?h.terrain.stencilModeForRTTOverlap(L):S[L.overscaledZ];tr(h,L,G,l,x,V,b)}}g.viewport.set([0,0,h.width,h.height]),h.resetStencilClippingMasks()},raster:function(h,r,l,p,g,x){if(h.renderPass!=="translucent"||l.paint.get("raster-opacity")===0||!p.length)return;const b=h.context,T=b.gl,S=r.getSource(),k=h.useProgram("raster"),L=h.colorModeForRenderPass(),G=h.terrain&&h.terrain.renderingToTexture,[V,X]=S instanceof me||G?[{},p]:h.stencilConfigForOverlap(p),Z=X[X.length-1].overscaledZ,Y=!h.options.moving;for(const W of X){const $=G?s.DepthMode.disabled:h.depthModeForSublayer(W.overscaledZ-Z,l.paint.get("raster-opacity")===1?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly,T.LESS),te=W.toUnwrapped(),J=r.getTile(W);if(G&&(!J||!J.hasData()))continue;const le=G?W.projMatrix:h.transform.calculateProjMatrix(te,Y),ue=h.terrain&&G?h.terrain.stencilModeForRTTOverlap(W):V[W.overscaledZ],oe=x?0:l.paint.get("raster-fade-duration");J.registerFadeDuration(oe);const fe=r.findLoadedParent(W,0),Ee=Zh(J,fe,r,h.transform,oe);let Oe,Le;h.terrain&&h.terrain.prepareDrawTile();const tt=l.paint.get("raster-resampling")==="nearest"?T.NEAREST:T.LINEAR;b.activeTexture.set(T.TEXTURE0),J.texture.bind(tt,T.CLAMP_TO_EDGE),b.activeTexture.set(T.TEXTURE1),fe?(fe.texture.bind(tt,T.CLAMP_TO_EDGE),Oe=Math.pow(2,fe.tileID.overscaledZ-J.tileID.overscaledZ),Le=[J.tileID.canonical.x*Oe%1,J.tileID.canonical.y*Oe%1]):J.texture.bind(tt,T.CLAMP_TO_EDGE);const Ce=Xo(le,Le||[0,0],Oe||1,Ee,l,S instanceof me?S.perspectiveTransform:[0,0]);if(h.prepareDrawProgram(b,k,te),S instanceof me)S.boundsBuffer&&S.boundsSegments&&k.draw(b,T.TRIANGLES,$,s.StencilMode.disabled,L,s.CullFaceMode.disabled,Ce,l.id,S.boundsBuffer,h.quadTriangleIndexBuffer,S.boundsSegments);else{const{tileBoundsBuffer:Ve,tileBoundsIndexBuffer:He,tileBoundsSegments:Me}=h.getTileBoundsBuffers(J);k.draw(b,T.TRIANGLES,$,ue,L,s.CullFaceMode.disabled,Ce,l.id,Ve,He,Me)}}h.resetStencilClippingMasks()},background:function(h,r,l,p){const g=l.paint.get("background-color"),x=l.paint.get("background-opacity");if(x===0)return;const b=h.context,T=b.gl,S=h.transform,k=S.tileSize,L=l.paint.get("background-pattern");if(h.isPatternMissing(L))return;const G=!L&&g.a===1&&x===1&&h.opaquePassEnabledForLayer()?"opaque":"translucent";if(h.renderPass!==G)return;const V=s.StencilMode.disabled,X=h.depthModeForSublayer(0,G==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly),Z=h.colorModeForRenderPass(),Y=h.useProgram(L?"backgroundPattern":"background");let W,$=p;$||(W=h.getBackgroundTiles(),$=Object.values(W).map(J=>J.tileID)),L&&(b.activeTexture.set(T.TEXTURE0),h.imageManager.bind(h.context));const te=l.getCrossfadeParameters();for(const J of $){const le=J.toUnwrapped(),ue=p?J.projMatrix:h.transform.calculateProjMatrix(le);h.prepareDrawTile();const oe=r?r.getTile(J):W?W[J.key]:new s.Tile(J,k,S.zoom,h),fe=L?yf(ue,x,h,L,{tileID:J,tileSize:k},te):qi(ue,x,g);h.prepareDrawProgram(b,Y,le);const{tileBoundsBuffer:Ee,tileBoundsIndexBuffer:Oe,tileBoundsSegments:Le}=h.getTileBoundsBuffers(oe);Y.draw(b,T.TRIANGLES,X,V,Z,s.CullFaceMode.disabled,fe,l.id,Ee,Oe,Le)}},sky:function(h,r,l){const p=h.transform,g=p.projection.name==="mercator"||p.projection.name==="globe"?1:s.smoothstep(7,8,p.zoom),x=l.paint.get("sky-opacity")*g;if(x===0)return;const b=h.context,T=l.paint.get("sky-type"),S=new s.DepthMode(b.gl.LEQUAL,s.DepthMode.ReadOnly,[0,1]),k=h.frameCounter/1e3%1;T==="atmosphere"?h.renderPass==="offscreen"?l.needsSkyboxCapture(h)&&(function(L,G,V,X){const Z=L.context,Y=Z.gl;let W=G.skyboxFbo;if(!W){W=G.skyboxFbo=Z.createFramebuffer(32,32,!1),G.skyboxGeometry=new En(Z),G.skyboxTexture=Z.gl.createTexture(),Y.bindTexture(Y.TEXTURE_CUBE_MAP,G.skyboxTexture),Y.texParameteri(Y.TEXTURE_CUBE_MAP,Y.TEXTURE_WRAP_S,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_CUBE_MAP,Y.TEXTURE_WRAP_T,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_CUBE_MAP,Y.TEXTURE_MIN_FILTER,Y.LINEAR),Y.texParameteri(Y.TEXTURE_CUBE_MAP,Y.TEXTURE_MAG_FILTER,Y.LINEAR);for(let le=0;le<6;++le)Y.texImage2D(Y.TEXTURE_CUBE_MAP_POSITIVE_X+le,0,Y.RGBA,32,32,0,Y.RGBA,Y.UNSIGNED_BYTE,null)}Z.bindFramebuffer.set(W.framebuffer),Z.viewport.set([0,0,32,32]);const $=G.getCenter(L,!0),te=L.useProgram("skyboxCapture"),J=new Float64Array(16);s.identity(J),s.rotateY(J,J,.5*-Math.PI),oo(Z,G,te,J,$,0),s.identity(J),s.rotateY(J,J,.5*Math.PI),oo(Z,G,te,J,$,1),s.identity(J),s.rotateX(J,J,.5*-Math.PI),oo(Z,G,te,J,$,2),s.identity(J),s.rotateX(J,J,.5*Math.PI),oo(Z,G,te,J,$,3),s.identity(J),oo(Z,G,te,J,$,4),s.identity(J),s.rotateY(J,J,Math.PI),oo(Z,G,te,J,$,5),Z.viewport.set([0,0,L.width,L.height])}(h,l),l.markSkyboxValid(h)):h.renderPass==="sky"&&function(L,G,V,X,Z){const Y=L.context,W=Y.gl,$=L.transform,te=L.useProgram("skybox");Y.activeTexture.set(W.TEXTURE0),W.bindTexture(W.TEXTURE_CUBE_MAP,G.skyboxTexture);const J=((le,ue,oe,fe,Ee)=>({u_matrix:le,u_sun_direction:ue,u_cubemap:0,u_opacity:fe,u_temporal_offset:Ee}))($.skyboxMatrix,G.getCenter(L,!1),0,X,Z);L.prepareDrawProgram(Y,te),te.draw(Y,W.TRIANGLES,V,s.StencilMode.disabled,L.colorModeForRenderPass(),s.CullFaceMode.backCW,J,"skybox",G.skyboxGeometry.vertexBuffer,G.skyboxGeometry.indexBuffer,G.skyboxGeometry.segment)}(h,l,S,x,k):T==="gradient"&&h.renderPass==="sky"&&function(L,G,V,X,Z){const Y=L.context,W=Y.gl,$=L.transform,te=L.useProgram("skyboxGradient");G.skyboxGeometry||(G.skyboxGeometry=new En(Y)),Y.activeTexture.set(W.TEXTURE0);let J=G.colorRampTexture;J||(J=G.colorRampTexture=new s.Texture(Y,G.colorRamp,W.RGBA)),J.bind(W.LINEAR,W.CLAMP_TO_EDGE);const le=((ue,oe,fe,Ee,Oe)=>({u_matrix:ue,u_color_ramp:0,u_center_direction:oe,u_radius:s.degToRad(fe),u_opacity:Ee,u_temporal_offset:Oe}))($.skyboxMatrix,G.getCenter(L,!1),G.paint.get("sky-gradient-radius"),X,Z);L.prepareDrawProgram(Y,te),te.draw(Y,W.TRIANGLES,V,s.StencilMode.disabled,L.colorModeForRenderPass(),s.CullFaceMode.backCW,le,"skyboxGradient",G.skyboxGeometry.vertexBuffer,G.skyboxGeometry.indexBuffer,G.skyboxGeometry.segment)}(h,l,S,x,k)},debug:function(h,r,l){for(let p=0;p<l.length;p++)Qo(h,r,l[p])},custom:function(h,r,l){const p=h.context,g=l.implementation;if(h.transform.projection.unsupportedLayers&&h.transform.projection.unsupportedLayers.includes("custom"))s.warnOnce("Custom layers are not yet supported with non-mercator projections. Use mercator to enable custom layers.");else if(h.renderPass==="offscreen"){const x=g.prerender;x&&(h.setCustomLayerDefaults(),p.setColorMode(h.colorModeForRenderPass()),x.call(g,p.gl,h.transform.customLayerMatrix()),p.setDirty(),h.setBaseState())}else if(h.renderPass==="translucent"){h.setCustomLayerDefaults(),p.setColorMode(h.colorModeForRenderPass()),p.setStencilMode(s.StencilMode.disabled);const x=g.renderingMode==="3d"?new s.DepthMode(h.context.gl.LEQUAL,s.DepthMode.ReadWrite,h.depthRangeFor3D):h.depthModeForSublayer(0,s.DepthMode.ReadOnly);p.setDepthMode(x),g.render(p.gl,h.transform.customLayerMatrix()),p.setDirty(),h.setBaseState(),p.bindFramebuffer.set(null)}}};class kc{constructor(r,l){this.context=new O(r),this.transform=l,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=s.SourceCache.maxUnderzooming+s.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new $a,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(r,l){const p=!!r&&!!r.terrain&&this.transform.projection.supportsTerrain;if(!(p||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new bc(this,r));const g=this._terrain;this.transform.elevation=p?g:null,g.update(r,this.transform,l)}_updateFog(r){const l=r.fog;if(!l||this.transform.projection.name==="globe"||l.getOpacity(this.transform.pitch)<1||l.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[p,g]=l.getFovAdjustedRange(this.transform._fov);if(p>g)return void(this.transform.fogCullDistSq=null);const x=p+.78*(g-p);this.transform.fogCullDistSq=x*x}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(r,l){if(this.width=r*s.exported.devicePixelRatio,this.height=l*s.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style.order)this.style._layers[p].resize()}setup(){const r=this.context,l=new s.StructArrayLayout2i4;l.emplaceBack(0,0),l.emplaceBack(s.EXTENT,0),l.emplaceBack(0,s.EXTENT),l.emplaceBack(s.EXTENT,s.EXTENT),this.tileExtentBuffer=r.createVertexBuffer(l,s.posAttributes.members),this.tileExtentSegments=s.SegmentVector.simpleSegment(0,0,4,2);const p=new s.StructArrayLayout2i4;p.emplaceBack(0,0),p.emplaceBack(s.EXTENT,0),p.emplaceBack(0,s.EXTENT),p.emplaceBack(s.EXTENT,s.EXTENT),this.debugBuffer=r.createVertexBuffer(p,s.posAttributes.members),this.debugSegments=s.SegmentVector.simpleSegment(0,0,4,5);const g=new s.StructArrayLayout2i4;g.emplaceBack(-1,-1),g.emplaceBack(1,-1),g.emplaceBack(-1,1),g.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(g,s.posAttributes.members),this.viewportSegments=s.SegmentVector.simpleSegment(0,0,4,2);const x=new s.StructArrayLayout4i8;x.emplaceBack(0,0,0,0),x.emplaceBack(s.EXTENT,0,s.EXTENT,0),x.emplaceBack(0,s.EXTENT,0,s.EXTENT),x.emplaceBack(s.EXTENT,s.EXTENT,s.EXTENT,s.EXTENT),this.mercatorBoundsBuffer=r.createVertexBuffer(x,s.boundsAttributes.members),this.mercatorBoundsSegments=s.SegmentVector.simpleSegment(0,0,4,2);const b=new s.StructArrayLayout3ui6;b.emplaceBack(0,1,2),b.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(b);const T=new s.StructArrayLayout1ui2;for(const k of[0,1,3,2,0])T.emplaceBack(k);this.debugIndexBuffer=r.createIndexBuffer(T),this.emptyTexture=new s.Texture(r,new s.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),r.gl.RGBA),this.identityMat=s.create();const S=this.context.gl;this.stencilClearMode=new s.StencilMode({func:S.ALWAYS,mask:0},0,255,S.ZERO,S.ZERO,S.ZERO),this.loadTimeStamps.push(s.window.performance.now()),this.atmosphereBuffer=new xf(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(r){return r._makeTileBoundsBuffers(this.context,this.transform.projection),r._tileBoundsBuffer?{tileBoundsBuffer:r._tileBoundsBuffer,tileBoundsIndexBuffer:r._tileBoundsIndexBuffer,tileBoundsSegments:r._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const r=this.context,l=r.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(r,l.TRIANGLES,s.DepthMode.disabled,this.stencilClearMode,s.ColorMode.disabled,s.CullFaceMode.disabled,To(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(r,l,p){if(!l||this.currentStencilSource===l.id||!r.isTileClipped()||!p||p.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let T=!1;for(const S of p)if(this._tileClippingMaskIDs[S.key]===void 0){T=!0;break}if(!T)return}this.currentStencilSource=l.id;const g=this.context,x=g.gl;this.nextStencilID+p.length>256&&this.clearStencil(),g.setColorMode(s.ColorMode.disabled),g.setDepthMode(s.DepthMode.disabled);const b=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const T of p){const S=l.getTile(T),k=this._tileClippingMaskIDs[T.key]=this.nextStencilID++,{tileBoundsBuffer:L,tileBoundsIndexBuffer:G,tileBoundsSegments:V}=this.getTileBoundsBuffers(S);b.draw(g,x.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:x.ALWAYS,mask:0},k,255,x.KEEP,x.KEEP,x.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,To(T.projMatrix),"$clipping",L,G,V)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,l=this.context.gl;return new s.StencilMode({func:l.NOTEQUAL,mask:255},r,255,l.KEEP,l.KEEP,l.REPLACE)}stencilModeForClipping(r){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(r);const l=this.context.gl;return new s.StencilMode({func:l.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,l.KEEP,l.KEEP,l.REPLACE)}stencilConfigForOverlap(r){const l=this.context.gl,p=r.sort((b,T)=>T.overscaledZ-b.overscaledZ),g=p[p.length-1].overscaledZ,x=p[0].overscaledZ-g+1;if(x>1){this.currentStencilSource=void 0,this.nextStencilID+x>256&&this.clearStencil();const b={};for(let T=0;T<x;T++)b[T+g]=new s.StencilMode({func:l.GEQUAL,mask:255},T+this.nextStencilID,255,l.KEEP,l.KEEP,l.REPLACE);return this.nextStencilID+=x,[b,p]}return[{[g]:s.StencilMode.disabled},p]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new s.ColorMode([r.CONSTANT_COLOR,r.ONE],new s.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?s.ColorMode.unblended:s.ColorMode.alphaBlended}depthModeForSublayer(r,l,p){if(!this.opaquePassEnabledForLayer())return s.DepthMode.disabled;const g=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new s.DepthMode(p||this.context.gl.LEQUAL,l,[g,g])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(r,l){this.style=r,this.options=l,this.imageManager=r.imageManager,this.glyphManager=r.glyphManager,this.symbolFadeChange=r.placement.symbolFadeChange(s.exported.now()),this.imageManager.beginFrame();const p=this.style.order,g=this.style._sourceCaches;for(const S in g){const k=g[S];k.used&&k.prepare(this.context)}const x={},b={},T={};for(const S in g){const k=g[S];x[S]=k.getVisibleCoordinates(),b[S]=x[S].slice().reverse(),T[S]=k.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let S=0;S<p.length;S++)if(this.style._layers[p[S]].is3D()){this.opaquePassCutoff=S;break}if(this.terrain&&(this.terrain.updateTileBinding(T),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new s.GlobeSharedBuffers(this.context)),s.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";for(const S of p){const k=this.style._layers[S],L=r._getLayerSourceCache(k);if(!k.hasOffscreenPass()||k.isHidden(this.transform.zoom))continue;const G=L?b[L.id]:void 0;(k.type==="custom"||k.isSky()||G&&G.length)&&this.renderLayer(this,L,k,G)}if(this.depthRangeFor3D=[0,1-(r.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:l.showOverdrawInspector?s.Color.black:s.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=l.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){const S=this.style._layers[p[this.currentLayer]],k=r._getLayerSourceCache(S);if(S.isSky())continue;const L=k?b[k.id]:void 0;this._renderTileClippingMasks(S,k,L),this.renderLayer(this,k,S,L)}if(this.style.fog&&this.transform.projection.supportsFog&&function(S,k){const L=S.context,G=L.gl,V=S.transform,X=new s.DepthMode(G.LEQUAL,s.DepthMode.ReadOnly,[0,1]),Z=S.useProgram("globeAtmosphere",null,V.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),Y=s.globeToMercatorTransition(V.zoom),W=k.properties.get("color").toArray01(),$=k.properties.get("high-color").toArray01(),te=k.properties.get("space-color").toArray01PremultipliedAlpha(),J=s.identity$1([]);s.rotateY$1(J,J,-s.degToRad(V._center.lng)),s.rotateX$1(J,J,s.degToRad(V._center.lat)),s.rotateZ$1(J,J,V.angle),s.rotateX$1(J,J,-V._pitch);const le=s.fromQuat(new Float32Array(16),J),ue=s.mapValue(k.properties.get("star-intensity"),0,1,0,.25),oe=5e-4,fe=s.mapValue(k.properties.get("horizon-blend"),0,1,oe,.25),Ee=s.globeUseCustomAntiAliasing(S,L,V)&&fe===oe?V.worldSize/(2*Math.PI*1.025)-1:V.globeRadius,Oe=S.frameCounter/1e3%1,Le=s.length(V.globeCenterInViewSpace),tt=Math.sqrt(Math.pow(Le,2)-Math.pow(Ee,2)),Ce=Math.acos(tt/Le),Ve=((Me,ve,pt,ut,dt,ct,Tt,Ht,Gt,kt,ht,Yt,on,Fn)=>({u_frustum_tl:Me,u_frustum_tr:ve,u_frustum_br:pt,u_frustum_bl:ut,u_horizon:dt,u_transition:ct,u_fadeout_range:Tt,u_color:Ht,u_high_color:Gt,u_space_color:kt,u_star_intensity:ht,u_star_size:5*s.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Yt,u_horizon_angle:on,u_rotation_matrix:Fn}))(V.frustumCorners.TL,V.frustumCorners.TR,V.frustumCorners.BR,V.frustumCorners.BL,V.frustumCorners.horizon,Y,fe,W,$,te,ue,Oe,Ce,le);S.prepareDrawProgram(L,Z);const He=S.atmosphereBuffer;He&&Z.draw(L,G.TRIANGLES,X,s.StencilMode.disabled,s.ColorMode.alphaBlended,s.CullFaceMode.backCW,Ve,"skybox",He.vertexBuffer,He.indexBuffer,He.segments)}(this,this.style.fog),this.renderPass="sky",(s.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){const S=this.style._layers[p[this.currentLayer]],k=r._getLayerSourceCache(S);S.isSky()&&this.renderLayer(this,k,S,k?b[k.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<p.length;){const S=this.style._layers[p[this.currentLayer]],k=r._getLayerSourceCache(S);if(S.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(S)){if(S.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const L=k?(S.type==="symbol"?T:b)[k.id]:void 0;this._renderTileClippingMasks(S,k,k?x[k.id]:void 0),this.renderLayer(this,k,S,L),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let S=null;s.values(this.style._layers).forEach(k=>{const L=r._getLayerSourceCache(k);L&&!k.isHidden(this.transform.zoom)&&(!S||S.getSource().maxzoom<L.getSource().maxzoom)&&(S=L)}),S&&this.options.showTileBoundaries&&Ul.debug(this,S,S.getVisibleCoordinates())}this.options.showPadding&&function(S){const k=S.transform.padding;Nl(S,S.transform.height-(k.top||0),3,Ar),Nl(S,k.bottom||0,3,Yn),sa(S,k.left||0,3,Mc),sa(S,S.transform.width-(k.right||0),3,vf);const L=S.transform.centerPoint;(function(G,V,X,Z){io(G,V-1,X-10,2,20,Z),io(G,V-10,X-1,20,2,Z)})(S,L.x,S.transform.height-L.y,Pi)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(s.window.performance.now()),this.saveCanvasCopy())}}renderLayer(r,l,p,g){p.isHidden(this.transform.zoom)||(p.type==="background"||p.type==="sky"||p.type==="custom"||g&&g.length)&&(this.id=p.id,this.gpuTimingStart(p),r.transform.projection.unsupportedLayers&&r.transform.projection.unsupportedLayers.includes(p.type)||Ul[p.type](r,l,p,g,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(r){if(!this.options.gpuTiming)return;const l=this.context.extTimerQuery;let p=this.gpuTimers[r.id];p||(p=this.gpuTimers[r.id]={calls:0,cpuTime:0,query:l.createQueryEXT()}),p.calls++,l.beginQueryEXT(l.TIME_ELAPSED_EXT,p.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const r=this.context.extTimerQuery,l=r.createQueryEXT();this.deferredRenderGpuTimeQueries.push(l),r.beginQueryEXT(r.TIME_ELAPSED_EXT,l)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const r=this.context.extTimerQuery;r.endQueryEXT(r.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const r=this.context.extTimerQuery;r.endQueryEXT(r.TIME_ELAPSED_EXT)}collectGpuTimers(){const r=this.gpuTimers;return this.gpuTimers={},r}collectDeferredRenderGpuQueries(){const r=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],r}queryGpuTimers(r){const l={};for(const p in r){const g=r[p],x=this.context.extTimerQuery,b=x.getQueryObjectEXT(g.query,x.QUERY_RESULT_EXT)/1e6;x.deleteQueryEXT(g.query),l[p]=b}return l}queryGpuTimeDeferredRender(r){if(!this.options.gpuTimingDeferredRender)return 0;const l=this.context.extTimerQuery;let p=0;for(const g of r)p+=l.getQueryObjectEXT(g,l.QUERY_RESULT_EXT)/1e6,l.deleteQueryEXT(g);return p}translatePosMatrix(r,l,p,g,x){if(!p[0]&&!p[1])return r;const b=x?g==="map"?this.transform.angle:0:g==="viewport"?-this.transform.angle:0;if(b){const k=Math.sin(b),L=Math.cos(b);p=[p[0]*L-p[1]*k,p[0]*k+p[1]*L]}const T=[x?p[0]:Qn(l,p[0],this.transform.zoom),x?p[1]:Qn(l,p[1],this.transform.zoom),0],S=new Float32Array(16);return s.translate(S,r,T),S}saveTileTexture(r){const l=this._tileTextures[r.size[0]];l?l.push(r):this._tileTextures[r.size[0]]=[r]}getTileTexture(r){const l=this._tileTextures[r];return l&&l.length>0?l.pop():null}isPatternMissing(r){if(!r)return!1;if(!r.from||!r.to)return!0;const l=this.imageManager.getPattern(r.from.toString()),p=this.imageManager.getPattern(r.to.toString());return!l||!p}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const r=this.terrain&&this.terrain.renderingToTexture,l=this.style&&this.style.fog,p=[];return this.terrainRenderModeElevated()&&p.push("TERRAIN"),this.transform.projection.name==="globe"&&p.push("GLOBE"),l&&!r&&l.getOpacity(this.transform.pitch)!==0&&p.push("FOG"),r&&p.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&p.push("OVERDRAW_INSPECTOR"),p}useProgram(r,l,p){this.cache=this.cache||{};const g=p||[],x=this.currentGlobalDefines().concat(g),b=Qh.cacheKey(Kh[r],r,x,l);return this.cache[b]||(this.cache[b]=new Qh(this.context,r,Kh[r],l,Sc[r],x)),this.cache[b]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=s.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(r,l,p){if(this.terrain&&this.terrain.renderingToTexture)return;const g=this.style.fog;if(g){const x=g.getOpacity(this.transform.pitch),b=((T,S,k,L,G,V,X,Z,Y,W,$)=>{const te=T.transform,J=S.properties.get("color").toArray01();J[3]=L;const le=T.frameCounter/1e3%1;return{u_fog_matrix:k?te.calculateFogTileMatrix(k):T.identityMat,u_fog_range:S.getFovAdjustedRange(te._fov),u_fog_color:J,u_fog_horizon_blend:S.properties.get("horizon-blend"),u_fog_temporal_offset:le,u_frustum_tl:G,u_frustum_tr:V,u_frustum_br:X,u_frustum_bl:Z,u_globe_pos:Y,u_globe_radius:W,u_viewport:$,u_globe_transition:s.globeToMercatorTransition(te.zoom),u_is_globe:+(te.projection.name==="globe")}})(this,g,p,x,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*s.exported.devicePixelRatio,this.transform.height*s.exported.devicePixelRatio]);l.setFogUniformValues(r,b)}}setTileLoadedFlag(r){this.tileLoaded=r}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const r=this.context.gl,l=r.createTexture();return r.bindTexture(r.TEXTURE_2D,l),r.copyTexImage2D(r.TEXTURE_2D,0,r.RGBA,0,0,r.drawingBufferWidth,r.drawingBufferHeight,0),l}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const r=this.style&&this.style.fog;return!!r&&r.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const r=this._backgroundTiles,l=this._backgroundTiles={},p=this.transform.coveringTiles({tileSize:512});for(const g of p)l[g.key]=r[g.key]||new s.Tile(g,512,this.transform.tileZoom,this);return l}clearBackgroundTiles(){this._backgroundTiles={}}}class es{constructor(r=0,l=0,p=0,g=0){if(isNaN(r)||r<0||isNaN(l)||l<0||isNaN(p)||p<0||isNaN(g)||g<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=l,this.left=p,this.right=g}interpolate(r,l,p){return l.top!=null&&r.top!=null&&(this.top=s.number(r.top,l.top,p)),l.bottom!=null&&r.bottom!=null&&(this.bottom=s.number(r.bottom,l.bottom,p)),l.left!=null&&r.left!=null&&(this.left=s.number(r.left,l.left,p)),l.right!=null&&r.right!=null&&(this.right=s.number(r.right,l.right,p)),this}getCenter(r,l){const p=s.clamp((this.left+r-this.right)/2,0,r),g=s.clamp((this.top+l-this.bottom)/2,0,l);return new s.pointGeometry(p,g)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new es(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function ql(h,r){const l=s.getColumn(h,3);s.fromQuat(h,r),s.setColumn(h,3,l)}function Pc(h,r){const l=s.identity$1([]);return s.rotateZ$1(l,l,-r),s.rotateX$1(l,l,-h),l}function aa(h,r){const l=[h[0],h[1],0],p=[r[0],r[1],0];if(s.length(l)>=1e-15){const b=s.normalize([],l);s.scale$2(p,b,s.dot(p,b)),r[0]=p[0],r[1]=p[1]}const g=s.cross([],r,h);if(s.len(g)<1e-15)return null;const x=Math.atan2(-g[1],g[0]);return Pc(Math.atan2(Math.sqrt(h[0]*h[0]+h[1]*h[1]),-h[2]),x)}class jl{constructor(r,l){this.position=r,this.orientation=l}get position(){return this._position}set position(r){if(r){const l=r instanceof s.MercatorCoordinate?r:new s.MercatorCoordinate(r[0],r[1],r[2]);this._renderWorldCopies&&(l.x=s.wrap(l.x,0,1)),this._position=l}else this._position=null}lookAtPoint(r,l){if(this.orientation=null,!this.position)return;const p=this._elevation?this._elevation.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(r)):0,g=this.position,x=s.MercatorCoordinate.fromLngLat(r,p),b=[x.x-g.x,x.y-g.y,x.z-g.z];l||(l=[0,0,1]),l[2]=Math.abs(l[2]),this.orientation=aa(b,l)}setPitchBearing(r,l){this.orientation=Pc(s.degToRad(r),s.degToRad(-l))}}class la{constructor(r,l){this._transform=s.identity([]),this.orientation=l,this.position=r}get mercatorPosition(){const r=this.position;return new s.MercatorCoordinate(r[0],r[1],r[2])}get position(){const r=s.getColumn(this._transform,3);return[r[0],r[1],r[2]]}set position(r){var l;r&&s.setColumn(this._transform,3,[(l=r)[0],l[1],l[2],1])}get orientation(){return this._orientation}set orientation(r){this._orientation=r||s.identity$1([]),r&&ql(this._transform,this._orientation)}getPitchBearing(){const r=this.forward(),l=this.right();return{bearing:Math.atan2(-l[1],l[0]),pitch:Math.atan2(Math.sqrt(r[0]*r[0]+r[1]*r[1]),-r[2])}}setPitchBearing(r,l){this._orientation=Pc(r,l),ql(this._transform,this._orientation)}forward(){const r=s.getColumn(this._transform,2);return[-r[0],-r[1],-r[2]]}up(){const r=s.getColumn(this._transform,1);return[-r[0],-r[1],-r[2]]}right(){const r=s.getColumn(this._transform,0);return[r[0],r[1],r[2]]}getCameraToWorld(r,l){const p=new Float64Array(16);return s.invert(p,this.getWorldToCamera(r,l)),p}getWorldToCameraPosition(r,l,p){const g=this.position;s.scale$2(g,g,-r);const x=new Float64Array(16);return s.fromScaling(x,[p,p,p]),s.translate(x,x,g),x[10]*=l,x}getWorldToCamera(r,l){const p=new Float64Array(16),g=new Float64Array(4),x=this.position;return s.conjugate(g,this._orientation),s.scale$2(x,x,-r),s.fromQuat(p,g),s.translate(p,p,x),p[1]*=-1,p[5]*=-1,p[9]*=-1,p[13]*=-1,p[8]*=l,p[9]*=l,p[10]*=l,p[11]*=l,p}getCameraToClipPerspective(r,l,p,g){const x=new Float64Array(16);return s.perspective(x,r,l,p,g),x}getDistanceToElevation(r){const l=r===0?0:s.mercatorZfromAltitude(r,this.position[1]),p=this.forward();return(l-this.position[2])/p[2]}clone(){return new la([...this.position],[...this.orientation])}}function Za(h,r){const l=Es(h.projection,h.zoom,h.width,h.height),p=function(x,b,T,S,k){const L=new s.LngLat(T.lng-180*wi,T.lat),G=new s.LngLat(T.lng+180*wi,T.lat),V=x.project(L.lng,L.lat),X=x.project(G.lng,G.lat),Z=-Math.atan2(X.y-V.y,X.x-V.x),Y=s.MercatorCoordinate.fromLngLat(T);Y.y=s.clamp(Y.y,-.999975,.999975);const W=Y.toLngLat(),$=x.project(W.lng,W.lat),te=s.MercatorCoordinate.fromLngLat(W);te.x+=wi;const J=te.toLngLat(),le=x.project(J.lng,J.lat),ue=vt(le.x-$.x,le.y-$.y,Z),oe=s.MercatorCoordinate.fromLngLat(W);oe.y+=wi;const fe=oe.toLngLat(),Ee=x.project(fe.lng,fe.lat),Oe=vt(Ee.x-$.x,Ee.y-$.y,Z),Le=Math.abs(ue.x)/Math.abs(Oe.y),tt=s.identity([]);s.rotateZ(tt,tt,-Z*(1-(k?0:S)));const Ce=s.identity([]);return s.scale(Ce,Ce,[1,1-(1-Le)*S,1]),Ce[4]=-Oe.x/Oe.y*S,s.rotateZ(Ce,Ce,Z),s.multiply(Ce,tt,Ce),Ce}(h.projection,0,h.center,l,r),g=Lu(h);return s.scale(p,p,[g,g,1]),p}function Lu(h){const r=h.projection,l=Es(h.projection,h.zoom,h.width,h.height),p=ua(r,h.center),g=ua(r,s.LngLat.convert(r.center));return Math.pow(2,p*l+(1-l)*g)}function Es(h,r,l,p,g=1/0){const x=h.range;if(!x)return 0;const b=Math.min(g,Math.max(l,p)),T=Math.log(b/1024)/Math.LN2;return s.smoothstep(x[0]+T,x[1]+T,r)}const wi=1/4e4;function ua(h,r){const l=s.clamp(r.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),p=new s.LngLat(r.lng-180*wi,l),g=new s.LngLat(r.lng+180*wi,l),x=h.project(p.lng,l),b=h.project(g.lng,l),T=s.MercatorCoordinate.fromLngLat(p),S=s.MercatorCoordinate.fromLngLat(g),k=b.x-x.x,L=b.y-x.y,G=S.x-T.x,V=S.y-T.y,X=Math.sqrt((G*G+V*V)/(k*k+L*L));return Math.log(X)/Math.LN2}function vt(h,r,l){const p=Math.cos(l),g=Math.sin(l);return{x:h*p-r*g,y:h*g+r*p}}class ji{constructor(r,l,p,g,x,b,T){this.tileSize=512,this._renderWorldCopies=x===void 0||x,this._minZoom=r||0,this._maxZoom=l||22,this._minPitch=p==null?0:p,this._maxPitch=g==null?60:g,this.setProjection(b),this.setMaxBounds(T),this.width=0,this.height=0,this._center=new s.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new es,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new la,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const r=new ji(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return r._elevation=this._elevation,r._centerAltitude=this._centerAltitude,r._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,r.tileSize=this.tileSize,r.mercatorFromTransition=this.mercatorFromTransition,r.width=this.width,r.height=this.height,r.cameraElevationReference=this.cameraElevationReference,r._center=this._center,r._setZoom(this.zoom),r._seaLevelZoom=this._seaLevelZoom,r.angle=this.angle,r._fov=this._fov,r._pitch=this._pitch,r._nearZ=this._nearZ,r._farZ=this._farZ,r._averageElevation=this._averageElevation,r._unmodified=this._unmodified,r._edgeInsets=this._edgeInsets.clone(),r._camera=this._camera.clone(),r._calcMatrices(),r.freezeTileCoverage=this.freezeTileCoverage,r.frustumCorners=this.frustumCorners,r}get elevation(){return this._elevation}set elevation(r){this._elevation!==r&&(this._elevation=r,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(r){const l=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||l)&&this._updateCameraOnTerrain(),(r||l)&&this._constrainCameraAltitude(),this._calcMatrices()}getProjection(){return s.pick(this.projection,["name","center","parallels"])}setProjection(r){this.projectionOptions=r||{name:"mercator"};const l=this.projection?this.getProjection():void 0;this.projection=s.getProjection(this.projectionOptions);const p=!N(l,this.getProjection());return p&&this._calcMatrices(),this.mercatorFromTransition=!1,p}setMercatorFromTransition(){const r=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=s.getProjection({name:"mercator"});const l=r!==this.projection.name;return l&&this._calcMatrices(),l}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get cameraWorldSize(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return s.mercatorZfromAltitude(this.center.lat,this.cameraWorldSize)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.pointGeometry(this.width,this.height)}get bearing(){return s.wrap(this.rotation,-180,180)}set bearing(r){this.rotation=r}get rotation(){return-this.angle/Math.PI*180}set rotation(r){const l=-r*Math.PI/180;var p;this.angle!==l&&(this._unmodified=!1,this.angle=l,this._calcMatrices(),this.rotationMatrix=(p=new s.ARRAY_TYPE(4),s.ARRAY_TYPE!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p),function(g,x,b){var T=x[0],S=x[1],k=x[2],L=x[3],G=Math.sin(b),V=Math.cos(b);g[0]=T*V+k*G,g[1]=S*V+L*G,g[2]=T*-G+k*V,g[3]=S*-G+L*V}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const l=s.clamp(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==l&&(this._unmodified=!1,this._pitch=l,this._calcMatrices())}get aspect(){return this.width/this.height}get fovX(){return this._fov}get fovY(){const r=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/r)}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=s.degToRad(r),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(r){this._averageElevation=r,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(r){const l=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==l&&(this._unmodified=!1,this._setZoom(l),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(r){this._zoom=r,this.scale=this.zoomScale(r),this.tileZoom=Math.floor(r),this.zoomFraction=r-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const r=this._elevation;this._centerAltitude=r.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=r.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const r=this._elevation,l=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],p=this.horizonLineFromTop();let g=0,x=0;for(let b=0;b<l.length;b++){const T=new s.pointGeometry(l[b][0]*this.width,p+l[b][1]*(this.height-p)),S=r.pointCoordinate(T);if(!S)continue;const k=1/Math.hypot(S[0]-this._camera.position[0],S[1]-this._camera.position[1]);g+=S[3]*k,x+=k}return x===0?NaN:g/x}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const r=this._seaLevelZoom,l=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),p=this.pixelsPerMeter/this.worldSize*l,g=this._mercatorZfromZoom(r),x=this._mercatorZfromZoom(this._maxZoom),b=Math.max(g-p,x);this._setZoom(this._zoomFromMercatorZ(b))}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}computeZoomRelativeTo(r){const l=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,r.toAltitude()));let p;p=r.z<this._camera.position[2]?[l.x,l.y,l.z]:[r.x,r.y,r.z];const g=s.length(s.sub([],this._camera.position,p));return s.clamp(this._zoomFromMercatorZ(g),this._minZoom,this._maxZoom)}setFreeCameraOptions(r){if(!this.height||!r.position&&!r.orientation)return;this._updateCameraState();let l=!1;if(r.orientation&&!s.exactEquals(r.orientation,this._camera.orientation)&&(l=this._setCameraOrientation(r.orientation)),r.position){const p=[r.position.x,r.position.y,r.position.z];s.exactEquals$1(p,this._camera.position)||(this._setCameraPosition(p),l=!0)}l&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const r=this._camera.position,l=new jl;return l.position=new s.MercatorCoordinate(r[0],r[1],r[2]),l.orientation=this._camera.orientation,l._elevation=this.elevation,l._renderWorldCopies=this.renderWorldCopies,l}_setCameraOrientation(r){if(!s.length$1(r))return!1;s.normalize$1(r,r);const l=s.transformQuat([],[0,0,-1],r),p=s.transformQuat([],[0,-1,0],r);if(p[2]<0)return!1;const g=aa(l,p);return!!g&&(this._camera.orientation=g,!0)}_setCameraPosition(r){const l=this.zoomScale(this.minZoom)*this.tileSize,p=this.zoomScale(this.maxZoom)*this.tileSize,g=this.cameraToCenterDistance;r[2]=s.clamp(r[2],g/p,g/l),this._camera.position=r}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,l,p){this._unmodified=!1,this._edgeInsets.interpolate(r,l,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const l=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,l)}getVisibleUnwrappedCoordinates(r){const l=[new s.UnwrappedTileID(0,r)];if(this.renderWorldCopies){const p=this.pointCoordinate(new s.pointGeometry(0,0)),g=this.pointCoordinate(new s.pointGeometry(this.width,0)),x=this.pointCoordinate(new s.pointGeometry(this.width,this.height)),b=this.pointCoordinate(new s.pointGeometry(0,this.height)),T=Math.floor(Math.min(p.x,g.x,x.x,b.x)),S=Math.floor(Math.max(p.x,g.x,x.x,b.x)),k=1;for(let L=T-k;L<=S+k;L++)L!==0&&l.push(new s.UnwrappedTileID(L,r))}return l}coveringTiles(r){let l=this.coveringZoomLevel(r);const p=l,g=this.elevation&&!r.isTerrainDEM,x=this.projection.name==="mercator";if(r.minzoom!==void 0&&l<r.minzoom)return[];r.maxzoom!==void 0&&l>r.maxzoom&&(l=r.maxzoom);const b=this.locationCoordinate(this.center),T=this.center.lat,S=1<<l,k=[S*b.x,S*b.y,0],L=this.projection.name==="globe",G=!L,V=s.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,l,G),X=L?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Z=S*s.mercatorZfromAltitude(1,this.center.lat),Y=this._camera.position[2]/s.mercatorZfromAltitude(1,this.center.lat),W=[S*X.x,S*X.y,Y*(G?1:Z)],$=this.cameraToCenterDistance/r.tileSize*(r.roundZoom?1:.502),te=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?l:0,J=r.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,le=r.isTerrainDEM?-J:this._elevation?this._elevation.getMinElevationBelowMSL():0,ue=this.projection.isReprojectedInTileSpace?Lu(this):1,oe=ve=>{const ut=new s.MercatorCoordinate(ve.x+25e-6,ve.y,ve.z),dt=new s.MercatorCoordinate(ve.x,ve.y+25e-6,ve.z),ct=ve.toLngLat(),Tt=ut.toLngLat(),Ht=dt.toLngLat(),Gt=this.locationCoordinate(ct),kt=this.locationCoordinate(Tt),ht=this.locationCoordinate(Ht),Yt=Math.hypot(kt.x-Gt.x,kt.y-Gt.y),on=Math.hypot(ht.x-Gt.x,ht.y-Gt.y);return Math.sqrt(Yt*on)*ue/25e-6},fe=ve=>{const pt=J,ut=le;return{aabb:s.tileAABB(this,S,0,0,0,ve,ut,pt,this.projection),zoom:0,x:0,y:0,minZ:ut,maxZ:pt,wrap:ve,fullyVisible:!1}},Ee=[];let Oe=[];const Le=l,tt=r.reparseOverscaled?p:l,Ce=ve=>ve*ve,Ve=Ce((Y-this._centerAltitude)*Z),He=ve=>{if(!this._elevation||!ve.tileID||!x)return;const pt=this._elevation.getMinMaxForTile(ve.tileID),ut=ve.aabb;pt?(ut.min[2]=pt.min,ut.max[2]=pt.max,ut.center[2]=(ut.min[2]+ut.max[2])/2):(ve.shouldSplit=Me(ve),ve.shouldSplit||(ut.min[2]=ut.max[2]=ut.center[2]=this._centerAltitude))},Me=ve=>{if(ve.zoom<te)return!0;if(ve.zoom===Le)return!1;if(ve.shouldSplit!=null)return ve.shouldSplit;const pt=ve.aabb.distanceX(W),ut=ve.aabb.distanceY(W);let dt=Ve,ct=1;if(L){dt=Ce(ve.aabb.distanceZ(W));const Gt=Math.pow(2,ve.zoom),kt=s.latFromMercatorY((ve.y+1)/Gt),ht=s.latFromMercatorY(ve.y/Gt),Yt=Math.min(Math.max(T,kt),ht),on=s.circumferenceAtLatitude(Yt)/s.circumferenceAtLatitude(T);if(ct=Yt===T?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,on/this._mercatorScaleRatio),this.zoom<=s.GLOBE_ZOOM_THRESHOLD_MIN&&ve.zoom===Le-1&&on>=.9)return!0}else if(g&&(dt=Ce(ve.aabb.distanceZ(W)*Z)),this.projection.isReprojectedInTileSpace&&p<=5){const Gt=Math.pow(2,ve.zoom),kt=oe(new s.MercatorCoordinate((ve.x+.5)/Gt,(ve.y+.5)/Gt));ct=kt>.85?1:kt}const Tt=pt*pt+ut*ut+dt,Ht=Ce((1<<Le-ve.zoom)*$*ct*((Gt,kt)=>{if(kt*Ce(.707)<Gt)return 1;const ht=Math.sqrt(kt/Gt);return ht/(1.4144271570014144+(Math.pow(1.1,ht-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(dt,Ve),Tt));return Tt<Ht};if(this.renderWorldCopies)for(let ve=1;ve<=3;ve++)Ee.push(fe(-ve)),Ee.push(fe(ve));for(Ee.push(fe(0));Ee.length>0;){const ve=Ee.pop(),pt=ve.x,ut=ve.y;let dt=ve.fullyVisible;if(!dt){const ct=ve.aabb.intersects(V);if(ct===0)continue;dt=ct===2}if(ve.zoom!==Le&&Me(ve))for(let ct=0;ct<4;ct++){const Tt=(pt<<1)+ct%2,Ht=(ut<<1)+(ct>>1),Gt={aabb:x?ve.aabb.quadrant(ct):s.tileAABB(this,S,ve.zoom+1,Tt,Ht,ve.wrap,ve.minZ,ve.maxZ,this.projection),zoom:ve.zoom+1,x:Tt,y:Ht,wrap:ve.wrap,fullyVisible:dt,tileID:void 0,shouldSplit:void 0,minZ:ve.minZ,maxZ:ve.maxZ};g&&!L&&(Gt.tileID=new s.OverscaledTileID(ve.zoom+1===Le?tt:ve.zoom+1,ve.wrap,ve.zoom+1,Tt,Ht),He(Gt)),Ee.push(Gt)}else{const ct=ve.zoom===Le?tt:ve.zoom;if(r.minzoom&&r.minzoom>ct)continue;const Tt=k[0]-(.5+pt+(ve.wrap<<ve.zoom))*(1<<l-ve.zoom),Ht=k[1]-.5-ut,Gt=ve.tileID?ve.tileID:new s.OverscaledTileID(ct,ve.wrap,ve.zoom,pt,ut);Oe.push({tileID:Gt,distanceSq:Tt*Tt+Ht*Ht})}}if(this.fogCullDistSq){const ve=this.fogCullDistSq,pt=this.horizonLineFromTop();Oe=Oe.filter(ut=>{const dt=[0,0,0,1],ct=[s.EXTENT,s.EXTENT,0,1],Tt=this.calculateFogTileMatrix(ut.tileID.toUnwrapped());s.transformMat4$1(dt,dt,Tt),s.transformMat4$1(ct,ct,Tt);const Ht=s.getAABBPointSquareDist(dt,ct);if(Ht===0)return!0;let Gt=!1;const kt=this._elevation;if(kt&&Ht>ve&&pt!==0){const ht=this.calculateProjMatrix(ut.tileID.toUnwrapped());let Yt;r.isTerrainDEM||(Yt=kt.getMinMaxForTile(ut.tileID)),Yt||(Yt={min:le,max:J});const on=s.furthestTileCorner(this.rotation),Fn=[on[0]*s.EXTENT,on[1]*s.EXTENT,Yt.max];s.transformMat4(Fn,Fn,ht),Gt=(1-Fn[1])*this.height*.5<pt}return Ht<ve||Gt})}return Oe.sort((ve,pt)=>ve.distanceSq-pt.distanceSq).map(ve=>ve.tileID)}resize(r,l){this.width=r,this.height=l,this.pixelsToGLUnits=[2/r,-2/l],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const l=s.clamp(r.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),p=this.projection.project(r.lng,l);return new s.pointGeometry(p.x*this.worldSize,p.y*this.worldSize)}unproject(r){return this.projection.unproject(r.x/this.worldSize,r.y/this.worldSize)}get point(){return this.project(this.center)}setLocationAtPoint(r,l){let p,g;const x=this.centerPoint;if(this.projection.name==="globe"){const T=this.worldSize;p=(l.x-x.x)/T,g=(l.y-x.y)/T}else{const T=this.pointCoordinate(l),S=this.pointCoordinate(x);p=T.x-S.x,g=T.y-S.y}const b=this.locationCoordinate(r);this.setLocation(new s.MercatorCoordinate(b.x-p,b.y-g))}setLocation(r){this.center=this.coordinateLocation(r),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(r){return this.projection.locationPoint(this,r)}locationPoint3D(r){return this.projection.locationPoint(this,r,!0)}pointLocation(r){return this.coordinateLocation(this.pointCoordinate(r))}pointLocation3D(r){return this.coordinateLocation(this.pointCoordinate3D(r))}locationCoordinate(r,l){const p=l?s.mercatorZfromAltitude(l,r.lat):void 0,g=this.projection.project(r.lng,r.lat);return new s.MercatorCoordinate(g.x,g.y,p)}coordinateLocation(r){return this.projection.unproject(r.x,r.y)}pointRayIntersection(r,l){const p=l!=null?l:this._centerAltitude,g=[r.x,r.y,0,1],x=[r.x,r.y,1,1];s.transformMat4$1(g,g,this.pixelMatrixInverse),s.transformMat4$1(x,x,this.pixelMatrixInverse);const b=x[3];s.scale$1(g,g,1/g[3]),s.scale$1(x,x,1/b);const T=g[2],S=x[2];return{p0:g,p1:x,t:T===S?0:(p-T)/(S-T)}}screenPointToMercatorRay(r){const l=[r.x,r.y,0,1],p=[r.x,r.y,1,1];return s.transformMat4$1(l,l,this.pixelMatrixInverse),s.transformMat4$1(p,p,this.pixelMatrixInverse),s.scale$1(l,l,1/l[3]),s.scale$1(p,p,1/p[3]),l[2]=s.mercatorZfromAltitude(l[2],this._center.lat)*this.worldSize,p[2]=s.mercatorZfromAltitude(p[2],this._center.lat)*this.worldSize,s.scale$1(l,l,1/this.worldSize),s.scale$1(p,p,1/this.worldSize),new s.Ray([l[0],l[1],l[2]],s.normalize([],s.sub([],p,l)))}rayIntersectionCoordinate(r){const{p0:l,p1:p,t:g}=r,x=s.mercatorZfromAltitude(l[2],this._center.lat),b=s.mercatorZfromAltitude(p[2],this._center.lat);return new s.MercatorCoordinate(s.number(l[0],p[0],g)/this.worldSize,s.number(l[1],p[1],g)/this.worldSize,s.number(x,b,g))}pointCoordinate(r,l=this._centerAltitude){return this.projection.pointCoordinate(this,r.x,r.y,l)}pointCoordinate3D(r){if(!this.elevation)return this.pointCoordinate(r);let l=this.projection.pointCoordinate3D(this,r.x,r.y);if(l)return new s.MercatorCoordinate(l[0],l[1],l[2]);let p=0,g=this.horizonLineFromTop();if(r.y>g)return this.pointCoordinate(r);const x=.02*g,b=r.clone();for(let T=0;T<10&&g-p>x;T++){b.y=s.number(p,g,.66);const S=this.projection.pointCoordinate3D(this,b.x,b.y);S?(g=b.y,l=S):p=b.y}return l?new s.MercatorCoordinate(l[0],l[1],l[2]):this.pointCoordinate(r)}isPointAboveHorizon(r){return this.projection.isPointAboveHorizon(this,r)}_coordinatePoint(r,l){const p=l&&this.elevation?this.elevation.getAtPointOrZero(r,this._centerAltitude):this._centerAltitude,g=[r.x*this.worldSize,r.y*this.worldSize,p+r.toAltitude(),1];return s.transformMat4$1(g,g,this.pixelMatrix),g[3]>0?new s.pointGeometry(g[0]/g[3],g[1]/g[3]):new s.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getGlobeBounds(){const{top:r,left:l}=this._edgeInsets,p=this.height-this._edgeInsets.bottom,g=this.width-this._edgeInsets.right,x=this.pointCoordinate3D(new s.pointGeometry(l,r)),b=this.pointCoordinate3D(new s.pointGeometry(g,r)),T=this.pointCoordinate3D(new s.pointGeometry(g,p)),S=this.pointCoordinate3D(new s.pointGeometry(l,p));let k=Math.min(x.x,S.x),L=Math.max(b.x,T.x),G=Math.min(x.y,b.y),V=Math.max(S.y,T.y);const X=Math.pow(2,-this.zoom)/16,Z=($,te,J,le)=>{const ue=($+J)/2,oe=(te+le)/2,fe=new s.pointGeometry(ue,oe),Ee=this.pointCoordinate3D(fe),Oe=Math.max(0,k-Ee.x,G-Ee.y,Ee.x-L,Ee.y-V);k=Math.min(k,Ee.x),L=Math.max(L,Ee.x),G=Math.min(G,Ee.y),V=Math.max(V,Ee.y),Oe>X&&(Z($,te,ue,oe),Z(ue,oe,J,le))};Z(l,r,g,r),Z(g,r,g,p),Z(g,p,l,p),Z(l,p,l,r);const Y=new s.LngLat(s.lngFromMercatorX(L),s.latFromMercatorY(G)),W=new s.LngLat(s.lngFromMercatorX(k),s.latFromMercatorY(V));return new s.LngLatBounds(W,Y)}_getBounds(r,l){if(this.projection.name==="globe")return this._getGlobeBounds();const p=new s.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),g=new s.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),x=new s.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),b=new s.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let T=this.pointCoordinate(p,r),S=this.pointCoordinate(g,r);const k=this.pointCoordinate(x,l),L=this.pointCoordinate(b,l),G=(V,X)=>(X.y-V.y)/(X.x-V.x);return T.y>1&&S.y>=0?T=new s.MercatorCoordinate((1-L.y)/G(L,T)+L.x,1):T.y<0&&S.y<=1&&(T=new s.MercatorCoordinate(-L.y/G(L,T)+L.x,0)),S.y>1&&T.y>=0?S=new s.MercatorCoordinate((1-k.y)/G(k,S)+k.x,1):S.y<0&&T.y<=1&&(S=new s.MercatorCoordinate(-k.y/G(k,S)+k.x,0)),new s.LngLatBounds().extend(this.coordinateLocation(T)).extend(this.coordinateLocation(S)).extend(this.coordinateLocation(L)).extend(this.coordinateLocation(k))}_getBounds3D(){const r=this.elevation;if(!r.visibleDemTiles.length||r.isUsingMockSource())return this._getBounds(0,0);const l=r.visibleDemTiles.reduce((p,g)=>{if(g.dem){const x=g.dem.tree;p.min=Math.min(p.min,x.minimums[0]),p.max=Math.max(p.max,x.maximums[0])}return p},{min:Number.MAX_VALUE,max:0});return this._getBounds(l.min*r.exaggeration(),l.max*r.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(r=!0){const l=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,p=this.height/2-l*(1-this._horizonShift);return r?Math.max(0,p):p}getMaxBounds(){return this.maxBounds}setMaxBounds(r){this.maxBounds=r,this.minLat=-s.MAX_MERCATOR_LATITUDE,this.maxLat=s.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,r&&(this.minLat=r.getSouth(),this.maxLat=r.getNorth(),this.minLng=r.getWest(),this.maxLng=r.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=s.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=s.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=s.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=s.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(r,l){return this.projection.createTileMatrix(this,l,r)}calculateDistanceTileData(r){const l=r.key,p=this._distanceTileDataCache;if(p[l])return p[l];const g=r.canonical,x=1/this.height,b=this.cameraWorldSize/this.zoomScale(g.z),T=(g.x+Math.pow(2,g.z)*r.wrap)*b,S=g.y*b,k=this.point,L=this.angle,G=Math.sin(-L),V=-Math.cos(-L);return p[l]={bearing:[G,V],center:[(k.x-T)*x,(k.y-S)*x],scale:b/s.EXTENT*x},p[l]}calculateFogTileMatrix(r){const l=r.key,p=this._fogTileMatrixCache;if(p[l])return p[l];const g=this.projection.createTileMatrix(this,this.cameraWorldSize,r);return s.multiply(g,this.worldToFogMatrix,g),p[l]=new Float32Array(g),p[l]}calculateProjMatrix(r,l=!1){const p=r.key,g=l?this._alignedProjMatrixCache:this._projMatrixCache;if(g[p])return g[p];const x=this.calculatePosMatrix(r,this.worldSize);return s.multiply(x,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:l?this.alignedProjMatrix:this.projMatrix,x),g[p]=new Float32Array(x),g[p]}calculatePixelsToTileUnitsMatrix(r){const l=r.tileID.key,p=this._pixelsToTileUnitsCache;if(p[l])return p[l];const g=function(x,b){const{scale:T}=x.tileTransform,S=T*s.EXTENT/(x.tileSize*Math.pow(2,b.zoom-x.tileID.overscaledZ+x.tileID.canonical.z));return k=new Float32Array(4),V=(L=b.inverseAdjustmentMatrix)[1],X=L[2],Z=L[3],W=(G=[S,S])[1],k[0]=L[0]*(Y=G[0]),k[1]=V*Y,k[2]=X*W,k[3]=Z*W,k;var k,L,G,V,X,Z,Y,W}(r,this);return p[l]=g,p[l]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const r=this._elevation;this._updateCameraState();const l=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,p=this._computeCameraPosition(l),g=this._camera.forward(),x=s.mercatorZfromAltitude(1,this._center.lat);p[2]/=x,g[2]/=x,s.normalize(g,g);const b=r.raycast(p,g,r.exaggeration());if(b){const T=s.scaleAndAdd([],p,g,b),S=new s.MercatorCoordinate(T[0],T[1],s.mercatorZfromAltitude(T[2],s.latFromMercatorY(T[1]))),k=(S.z+s.length([S.x-p[0],S.y-p[1],S.z-p[2]*x]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(k),this._centerAltitude=S.toAltitude(),this._center=this.coordinateLocation(S),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCameraAltitude(){if(!this._elevation)return;const r=this._elevation;this._updateCameraState();const l=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,p=this._computeCameraPosition(l),g=r.getAtPointOrZero(new s.MercatorCoordinate(...p)),x=this._minimumHeightOverTerrain()*Math.cos(s.degToRad(this._maxPitch)),b=this._camera.position[2]-this.pixelsPerMeter/this.worldSize*g;if(b<x){const T=this.locationCoordinate(this._center,this._centerAltitude),S=[T.x-p[0],T.y-p[1],T.z-p[2]],k=s.length(S);S[2]-=(x-b)/this._pixelsPerMercatorPixel;const L=s.length(S);if(L===0)return;s.scale$2(S,S,k/L*this._pixelsPerMercatorPixel),this._camera.position=[T.x-S[0],T.y-S[1],T.z*this._pixelsPerMercatorPixel-S[2]],this._camera.orientation=aa(S,this._camera.up()),this._updateStateFromCamera()}}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const r=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||r){const V=this.center;return V.lat=s.clamp(V.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!r)&&(V.lng=s.clamp(V.lng,this.minLng,this.maxLng)),this.center=V,void(this._constraining=!1)}const l=this._unmodified,{x:p,y:g}=this.point;let x=0,b=p,T=g;const S=this.width/2,k=this.height/2,L=this.worldMinY*this.scale,G=this.worldMaxY*this.scale;if(g-k<L&&(T=L+k),g+k>G&&(T=G-k),G-L<this.height&&(x=Math.max(x,this.height/(G-L)),T=(G+L)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const V=this.worldMinX*this.scale,X=this.worldMaxX*this.scale,Z=this.worldSize/2-(V+X)/2;b=(p+Z+this.worldSize)%this.worldSize-Z,b-S<V&&(b=V+S),b+S>X&&(b=X-S),X-V<this.width&&(x=Math.max(x,this.width/(X-V)),b=(X+V)/2)}b===p&&T===g||(this.center=this.unproject(new s.pointGeometry(b,T))),x&&(this.zoom+=this.scaleZoom(x)),this._constrainCameraAltitude(),this._unmodified=l,this._constraining=!1}_minZoomForBounds(){let r=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(r=Math.max(r,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),r}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,l=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=s.mercatorZfromAltitude(1,this.center.lat)/s.mercatorZfromAltitude(1,s.GLOBE_SCALE_MATCH_LATITUDE));const p=Es(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,p),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const g=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?l:1),x=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);x[8]=2*-r.x/this.width,x[9]=2*r.y/this.height;let b=s.mul([],x,g);if(this.projection.isReprojectedInTileSpace){const ue=this.locationCoordinate(this.center),oe=s.identity([]);s.translate(oe,oe,[ue.x*this.worldSize,ue.y*this.worldSize,0]),s.multiply(oe,oe,Za(this)),s.translate(oe,oe,[-ue.x*this.worldSize,-ue.y*this.worldSize,0]),s.multiply(b,b,oe),this.inverseAdjustmentMatrix=function(fe){const Ee=Za(fe,!0);return Et([],[Ee[0],Ee[1],Ee[4],Ee[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=s.scale([],b,[this.worldSize,this.worldSize,this.worldSize/l,1]),this.projMatrix=b,this.invProjMatrix=s.invert(new Float64Array(16),this.projMatrix);const T=s.invert([],x);this.frustumCorners=s.FrustumCorners.fromInvProjectionMatrix(T,this.horizonLineFromTop(),this.height);const S=new Float32Array(16);s.identity(S),s.scale(S,S,[1,-1,1]),s.rotateX(S,S,this._pitch),s.rotateZ(S,S,this.angle);const k=s.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),L=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;k[8]=2*-r.x/this.width,k[9]=2*(r.y+L)/this.height,this.skyboxMatrix=s.multiply(S,k,S);const G=this.point,V=G.x,X=G.y,Z=this.width%2/2,Y=this.height%2/2,W=Math.cos(this.angle),$=Math.sin(this.angle),te=V-Math.round(V)+W*Z+$*Y,J=X-Math.round(X)+W*Y+$*Z,le=new Float64Array(b);if(s.translate(le,le,[te>.5?te-1:te,J>.5?J-1:J,0]),this.alignedProjMatrix=le,b=s.create(),s.scale(b,b,[this.width/2,-this.height/2,1]),s.translate(b,b,[1,-1,0]),this.labelPlaneMatrix=b,b=s.create(),s.scale(b,b,[1,-1,1]),s.translate(b,b,[-1,-1,0]),s.scale(b,b,[2/this.width,2/this.height,1]),this.glCoordMatrix=b,this.pixelMatrix=s.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},b=s.invert(new Float64Array(16),this.pixelMatrix),!b)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=b,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=s.calculateGlobeMatrix(this);const ue=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=s.transformMat4(ue,ue,g),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=b;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const r=this.cameraWorldSize,l=this.cameraPixelsPerMeter,p=this._camera.position,g=1/this.height/this._pixelsPerMercatorPixel,x=[r,r,l];s.scale$2(x,x,g),s.scale$2(p,p,-1),s.multiply$2(p,p,x);const b=s.create();s.translate(b,b,p),s.scale(b,b,x),this.mercatorFogMatrix=b,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(r,l,g)}_computeCameraPosition(r){const l=(r=r||this.pixelsPerMeter)/this.pixelsPerMeter,p=this._camera.forward(),g=this.point,x=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*l-r/this.worldSize*this._centerAltitude;return[g.x/this.worldSize-p[0]*x,g.y/this.worldSize-p[1]*x,r/this.worldSize*this._centerAltitude-p[2]*x]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(r){const l=this._maxCameraBoundsDistance()*Math.cos(this._pitch),p=this._camera.position[2],g=r[2];let x=1;this.projection.wrap&&(this.center=this.center.wrap()),g>0&&(x=Math.min((l-p)/g,1)),this._camera.position=s.scaleAndAdd([],this._camera.position,r,x),this._updateStateFromCamera()}_updateStateFromCamera(){const r=this._camera.position,l=this._camera.forward(),{pitch:p,bearing:g}=this._camera.getPitchBearing(),x=s.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,b=this._mercatorZfromZoom(this._maxZoom)*Math.cos(s.degToRad(this._maxPitch)),T=Math.max((r[2]-x)/Math.cos(p),b),S=this._zoomFromMercatorZ(T);s.scaleAndAdd(r,r,l,T),this._pitch=s.clamp(p,s.degToRad(this.minPitch),s.degToRad(this.maxPitch)),this.angle=s.wrap(g,-Math.PI,Math.PI),this._setZoom(s.clamp(S,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new s.MercatorCoordinate(r[0],r[1],r[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(r){return Math.pow(2,r)*this.tileSize}_mercatorZfromZoom(r){return this.cameraToCenterDistance/this._worldSizeFromZoom(r)}_minimumHeightOverTerrain(){const r=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(r)}_zoomFromMercatorZ(r){return this.scaleZoom(this.cameraToCenterDistance/(r*this.tileSize))}zoomFromMercatorZAdjusted(r){const l=b=>{const T=this.getCameraToCenterDistance(this.projection,b);return this.scaleZoom(T/(r*this.tileSize))};let p,g=l(this.zoom),x=Math.abs(g-l(g));for(;p!==x;)g=l(g),p=x,x=Math.abs(g-l(g));return g}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(s.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(r,l){const p=Math.min(r.x,l.x),g=Math.max(r.x,l.x),x=Math.min(r.y,l.y),b=Math.max(r.y,l.y);if(x<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const T=[new s.pointGeometry(p,x),new s.pointGeometry(g,b),new s.pointGeometry(p,b),new s.pointGeometry(g,x)],S=this.renderWorldCopies?-3:0,k=this.renderWorldCopies?4:1;for(const L of T){const G=this.pointRayIntersection(L);if(G.t<0)return!0;const V=this.rayIntersectionCoordinate(G);if(V.x<S||V.y<0||V.x>k||V.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+s.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new s.pointGeometry(0,0),new s.pointGeometry(this.width,this.height))}zoomDeltaToMovement(r,l){const p=s.length(s.sub([],this._camera.position,r)),g=this._zoomFromMercatorZ(p)+l;return p-this._mercatorZfromZoom(g)}getCameraPoint(){if(this.projection.name==="globe"){const r=function(l,p){const g=[l[0],l[1],l[2],1];s.transformMat4$1(g,g,p);const x=Math.max(g[3],1e-6);return[g[0]/x,g[1]/x,g[2]/x,x]}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new s.pointGeometry(r[0],r[1])}{const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.pointGeometry(0,r))}}getCameraToCenterDistance(r,l=this.zoom){const p=Es(r,l,this.width,this.height,1024),g=r.pixelSpaceConversion(this.center.lat,this.worldSize,p);return .5/Math.tan(.5*this._fov)*this.height*g}getWorldToCameraMatrix(){const r=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&s.multiply(r,r,this.globeMatrix),r}}function sd(h,r){let l=!1,p=null;const g=()=>{p=null,l&&(h(),p=setTimeout(g,r),l=!1)};return()=>(l=!0,p||g(),p)}class zu{constructor(r){this._hashName=r&&encodeURIComponent(r),s.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=sd(this._updateHashUnthrottled.bind(this),300)}addTo(r){return this._map=r,s.window.addEventListener("hashchange",this._onHashChange,!1),r.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),s.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const r=this._map;if(!r)return"";const l=Vl(r);if(this._hashName){const p=this._hashName;let g=!1;const x=s.window.location.hash.slice(1).split("&").map(b=>{const T=b.split("=")[0];return T===p?(g=!0,`${T}=${l}`):b}).filter(b=>b);return g||x.push(`${p}=${l}`),`#${x.join("&")}`}return`#${l}`}_getCurrentHash(){const r=s.window.location.hash.replace("#","");if(this._hashName){let l;return r.split("&").map(p=>p.split("=")).forEach(p=>{p[0]===this._hashName&&(l=p)}),(l&&l[1]||"").split("/")}return r.split("/")}_onHashChange(){const r=this._map;if(!r)return!1;const l=this._getCurrentHash();if(l.length>=3&&!l.some(p=>isNaN(p))){const p=r.dragRotate.isEnabled()&&r.touchZoomRotate.isEnabled()?+(l[3]||0):r.getBearing();return r.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:p,pitch:+(l[4]||0)}),!0}return!1}_updateHashUnthrottled(){const r=s.window.location.href.replace(/(#.+)?$/,this.getHashString());s.window.history.replaceState(s.window.history.state,null,r)}}function Vl(h,r){const l=h.getCenter(),p=Math.round(100*h.getZoom())/100,g=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),x=Math.pow(10,g),b=Math.round(l.lng*x)/x,T=Math.round(l.lat*x)/x,S=h.getBearing(),k=h.getPitch();let L=r?`/${b}/${T}/${p}`:`${p}/${T}/${b}`;return(S||k)&&(L+="/"+Math.round(10*S)/10),k&&(L+=`/${Math.round(k)}`),L}const Do={linearity:.3,easing:s.bezier(0,0,.3,1)},wf=s.extend({deceleration:2500,maxSpeed:1400},Do),Fu=s.extend({deceleration:20,maxSpeed:1400},Do),ad=s.extend({deceleration:1e3,maxSpeed:360},Do),Lc=s.extend({deceleration:1e3,maxSpeed:90},Do);class Sr{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.exported.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,l=s.exported.now();for(;r.length>0&&l-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const l={zoom:0,bearing:0,pitch:0,pan:new s.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:x}of this._inertiaBuffer)l.zoom+=x.zoomDelta||0,l.bearing+=x.bearingDelta||0,l.pitch+=x.pitchDelta||0,x.panDelta&&l.pan._add(x.panDelta),x.around&&(l.around=x.around),x.pinchAround&&(l.pinchAround=x.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,g={};if(l.pan.mag()){const x=Bs(l.pan.mag(),p,s.extend({},wf,r||{}));g.offset=l.pan.mult(x.amount/l.pan.mag()),g.center=this._map.transform.center,Ir(g,x)}if(l.zoom){const x=Bs(l.zoom,p,Fu);g.zoom=this._map.transform.zoom+x.amount,Ir(g,x)}if(l.bearing){const x=Bs(l.bearing,p,ad);g.bearing=this._map.transform.bearing+s.clamp(x.amount,-179,179),Ir(g,x)}if(l.pitch){const x=Bs(l.pitch,p,Lc);g.pitch=this._map.transform.pitch+x.amount,Ir(g,x)}if(g.zoom||g.bearing){const x=l.pinchAround===void 0?l.around:l.pinchAround;g.around=x?this._map.unproject(x):this._map.getCenter()}return this.clear(),g.noMoveStart=!0,g}}function Ir(h,r){(!h.duration||h.duration<r.duration)&&(h.duration=r.duration,h.easing=r.easing)}function Bs(h,r,l){const{maxSpeed:p,linearity:g,deceleration:x}=l,b=s.clamp(h*g/(r/1e3),-p,p),T=Math.abs(b)/(x*g);return{easing:l.easing,duration:1e3*T,amount:b*(T/2)}}class Vi extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,l,p,g={}){const x=Ie(l.getCanvasContainer(),p),b=l.unproject(x);super(r,s.extend({point:x,lngLat:b,originalEvent:p},g)),this._defaultPrevented=!1,this.target=l}}class Ru extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,l,p){const g=r==="touchend"?p.changedTouches:p.touches,x=at(l.getCanvasContainer(),g),b=x.map(S=>l.unproject(S)),T=x.reduce((S,k,L,G)=>S.add(k.div(G.length)),new s.pointGeometry(0,0));super(r,{points:x,point:T,lngLats:b,lngLat:l.unproject(T),originalEvent:p}),this._defaultPrevented=!1}}class Af extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,l,p){super(r,{originalEvent:p}),this._defaultPrevented=!1}}class Hl{constructor(r,l){this._map=r,this._clickTolerance=l.clickTolerance}reset(){this._mousedownPos=void 0}wheel(r){return this._firePreventable(new Af(r.type,this._map,r))}mousedown(r,l){return this._mousedownPos=l,this._firePreventable(new Vi(r.type,this._map,r))}mouseup(r){this._map.fire(new Vi(r.type,this._map,r))}preclick(r){const l=s.extend({},r);l.type="preclick",this._map.fire(new Vi(l.type,this._map,l))}click(r,l){this._mousedownPos&&this._mousedownPos.dist(l)>=this._clickTolerance||(this.preclick(r),this._map.fire(new Vi(r.type,this._map,r)))}dblclick(r){return this._firePreventable(new Vi(r.type,this._map,r))}mouseover(r){this._map.fire(new Vi(r.type,this._map,r))}mouseout(r){this._map.fire(new Vi(r.type,this._map,r))}touchstart(r){return this._firePreventable(new Ru(r.type,this._map,r))}touchmove(r){this._map.fire(new Ru(r.type,this._map,r))}touchend(r){this._map.fire(new Ru(r.type,this._map,r))}touchcancel(r){this._map.fire(new Ru(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ja{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(r){this._map.fire(new Vi(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Vi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._map.fire(new Vi(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class zc{constructor(r,l){this._map=r,this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=l.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,l){this.isEnabled()&&r.shiftKey&&r.button===0&&(be(),this._startPos=this._lastPos=l,this._active=!0)}mousemoveWindow(r,l){if(!this._active)return;const p=l,g=this._startPos,x=this._lastPos;if(!g||!x||x.equals(p)||!this._box&&p.dist(g)<this._clickTolerance)return;this._lastPos=p,this._box||(this._box=Ae("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",r));const b=Math.min(g.x,p.x),T=Math.max(g.x,p.x),S=Math.min(g.y,p.y),k=Math.max(g.y,p.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${b}px,${S}px)`,this._box.style.width=T-b+"px",this._box.style.height=k-S+"px")})}mouseupWindow(r,l){if(!this._active)return;const p=this._startPos,g=l;if(p&&r.button===0){if(this.reset(),Xe(),p.x!==g.x||p.y!==g.y)return this._map.fire(new s.Event("boxzoomend",{originalEvent:r})),{cameraAnimation:x=>x.fitScreenCoordinates(p,g,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",r)}}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),ge(),delete this._startPos,delete this._lastPos}_fireEvent(r,l){return this._map.fire(new s.Event(r,{originalEvent:l}))}}function Ts(h,r){const l={};for(let p=0;p<h.length;p++)l[h[p].identifier]=r[p];return l}class ca{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(r,l,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=r.timeStamp),p.length===this.numTouches&&(this.centroid=function(g){const x=new s.pointGeometry(0,0);for(const b of g)x._add(b);return x.div(g.length)}(l),this.touches=Ts(p,l)))}touchmove(r,l,p){if(this.aborted||!this.centroid)return;const g=Ts(p,l);for(const x in this.touches){const b=this.touches[x],T=g[x];(!T||T.dist(b)>30)&&(this.aborted=!0)}}touchend(r,l,p){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){const g=!this.aborted&&this.centroid;if(this.reset(),g)return g}}}class Ds{constructor(r){this.singleTap=new ca(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(r,l,p){this.singleTap.touchstart(r,l,p)}touchmove(r,l,p){this.singleTap.touchmove(r,l,p)}touchend(r,l,p){const g=this.singleTap.touchend(r,l,p);if(g){const x=r.timeStamp-this.lastTime<500,b=!this.lastTap||this.lastTap.dist(g)<30;if(x&&b||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=g,this.count===this.numTaps)return this.reset(),g}}}class Ou{constructor(){this._zoomIn=new Ds({numTouches:1,numTaps:2}),this._zoomOut=new Ds({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,l,p){this._zoomIn.touchstart(r,l,p),this._zoomOut.touchstart(r,l,p)}touchmove(r,l,p){this._zoomIn.touchmove(r,l,p),this._zoomOut.touchmove(r,l,p)}touchend(r,l,p){const g=this._zoomIn.touchend(r,l,p),x=this._zoomOut.touchend(r,l,p);return g?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:b=>b.easeTo({duration:300,zoom:b.getZoom()+1,around:b.unproject(g)},{originalEvent:r})}):x?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:b=>b.easeTo({duration:300,zoom:b.getZoom()-1,around:b.unproject(x)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Xa={0:1,2:2};class Fc{constructor(r){this.reset(),this._clickTolerance=r.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(r,l){return!1}_move(r,l){return{}}mousedown(r,l){if(this._lastPoint)return;const p=ft(r);this._correctButton(r,p)&&(this._lastPoint=l,this._eventButton=p)}mousemoveWindow(r,l){const p=this._lastPoint;if(p){if(r.preventDefault(),this._eventButton!=null&&function(g,x){const b=Xa[x];return g.buttons===void 0||(g.buttons&b)!==b}(r,this._eventButton))this.reset();else if(this._moved||!(l.dist(p)<this._clickTolerance))return this._moved=!0,this._lastPoint=l,this._move(p,l)}}mouseupWindow(r){this._lastPoint&&ft(r)===this._eventButton&&(this._moved&&Xe(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class bf extends Fc{mousedown(r,l){super.mousedown(r,l),this._lastPoint&&(this._active=!0)}_correctButton(r,l){return l===0&&!r.ctrlKey}_move(r,l){return{around:l,panDelta:l.sub(r)}}}class ld extends Fc{_correctButton(r,l){return l===0&&r.ctrlKey||l===2}_move(r,l){const p=.8*(l.x-r.x);if(p)return this._active=!0,{bearingDelta:p}}contextmenu(r){r.preventDefault()}}class Qa extends Fc{_correctButton(r,l){return l===0&&r.ctrlKey||l===2}_move(r,l){const p=-.5*(l.y-r.y);if(p)return this._active=!0,{pitchDelta:p}}contextmenu(r){r.preventDefault()}}class Cf{constructor(r,l){this._map=r,this._el=r.getCanvasContainer(),this._minTouches=1,this._clickTolerance=l.clickTolerance||1,this.reset(),s.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new s.pointGeometry(0,0)}touchstart(r,l,p){return this._calculateTransform(r,l,p)}touchmove(r,l,p){if(this._active&&!(p.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(p.length===1&&!s.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return r.cancelable&&r.preventDefault(),this._calculateTransform(r,l,p)}}touchend(r,l,p){this._calculateTransform(r,l,p),this._active&&p.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,l,p){p.length>0&&(this._active=!0);const g=Ts(p,l),x=new s.pointGeometry(0,0),b=new s.pointGeometry(0,0);let T=0;for(const k in g){const L=g[k],G=this._touches[k];G&&(x._add(L),b._add(L.sub(G)),T++,g[k]=L)}if(this._touches=g,T<this._minTouches||!b.mag())return;const S=b.div(T);return this._sum._add(S),this._sum.mag()<this._clickTolerance?void 0:{around:x.div(T),panDelta:S}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Ae("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class Ya{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(r){}_move(r,l,p){return{}}touchstart(r,l,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([l[0],l[1]]))}touchmove(r,l,p){const g=this._firstTwoTouches;if(!g)return;r.preventDefault();const[x,b]=g,T=Ss(p,l,x),S=Ss(p,l,b);if(!T||!S)return;const k=this._aroundCenter?null:T.add(S).div(2);return this._move([T,S],k,r)}touchend(r,l,p){if(!this._firstTwoTouches)return;const[g,x]=this._firstTwoTouches,b=Ss(p,l,g),T=Ss(p,l,x);b&&T||(this._active&&Xe(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Ss(h,r,l){for(let p=0;p<h.length;p++)if(h[p].identifier===l)return r[p]}function Rc(h,r){return Math.log(h/r)/Math.LN2}class K extends Ya{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,l){const p=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(Rc(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Rc(this._distance,p),pinchAround:l}}}function ha(h,r){return 180*h.angleWith(r)/Math.PI}class Nr extends Ya{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,l){const p=this._vector;if(this._vector=r[0].sub(r[1]),p&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:ha(this._vector,p),pinchAround:l}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const l=25/(Math.PI*this._minDiameter)*360,p=this._startVector;if(!p)return!1;const g=ha(r,p);return Math.abs(g)<l}}function Li(h){return Math.abs(h.y)>Math.abs(h.x)}class An extends Ya{constructor(r){super(),this._map=r}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(r){this._lastPoints=r,Li(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,l,p){const g=this._lastPoints;if(!g)return;const x=r[0].sub(g[0]),b=r[1].sub(g[1]);return this._map._cooperativeGestures&&!s.isFullscreen()&&p.touches.length<3||(this._valid=this.gestureBeginsVertically(x,b,p.timeStamp),!this._valid)?void 0:(this._lastPoints=r,this._active=!0,{pitchDelta:(x.y+b.y)/2*-.5})}gestureBeginsVertically(r,l,p){if(this._valid!==void 0)return this._valid;const g=r.mag()>=2,x=l.mag()>=2;if(!g&&!x)return;if(!g||!x)return this._firstMove==null&&(this._firstMove=p),p-this._firstMove<100&&void 0;const b=r.y>0==l.y>0;return Li(r)&&Li(l)&&b}}const ym={panStep:100,bearingStep:15,pitchStep:10};class vm{constructor(){const r=ym;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let l=0,p=0,g=0,x=0,b=0;switch(r.keyCode){case 61:case 107:case 171:case 187:l=1;break;case 189:case 109:case 173:l=-1;break;case 37:r.shiftKey?p=-1:(r.preventDefault(),x=-1);break;case 39:r.shiftKey?p=1:(r.preventDefault(),x=1);break;case 38:r.shiftKey?g=1:(r.preventDefault(),b=-1);break;case 40:r.shiftKey?g=-1:(r.preventDefault(),b=1);break;default:return}return this._rotationDisabled&&(p=0,g=0),{cameraAnimation:T=>{const S=T.getZoom();T.easeTo({duration:300,easeId:"keyboardHandler",easing:Is,zoom:l?Math.round(S)+l*(r.shiftKey?2:1):S,bearing:T.getBearing()+p*this._bearingStep,pitch:T.getPitch()+g*this._pitchStep,offset:[-x*this._panStep,-b*this._panStep],center:T.getCenter()},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Is(h){return h*(2-h)}const Ms=4.000244140625;class $l{constructor(r,l){this._map=r,this._el=r.getCanvasContainer(),this._handler=l,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,s.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!r&&r.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(r){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(r.ctrlKey||r.metaKey||this.isZooming()||s.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let l=r.deltaMode===s.window.WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const p=s.exported.now(),g=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,l!==0&&l%Ms==0?this._type="wheel":l!==0&&Math.abs(l)<4?this._type="trackpad":g>400?(this._type=null,this._lastValue=l,this._timeout=setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(g*l)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,l+=this._lastValue)),r.shiftKey&&l&&(l/=4),this._type&&(this._lastWheelEvent=r,this._delta-=l,this._active||this._start(r)),r.preventDefault()}_onTimeout(r){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const l=Ie(this._el,r);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:l,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._map.transform;this._type==="wheel"&&r.projection.wrap&&(r._center.lng>=180||r._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const l=()=>r._terrainEnabled()&&this._aroundCoord?r.computeZoomRelativeTo(this._aroundCoord):r.zoom;if(this._delta!==0){const S=this._type==="wheel"&&Math.abs(this._delta)>Ms?this._wheelZoomRate:this._defaultZoomRate;let k=2/(1+Math.exp(-Math.abs(this._delta*S)));this._delta<0&&k!==0&&(k=1/k);const L=l(),G=Math.pow(2,L),V=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):G;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(V*k))),this._type==="wheel"&&(this._startZoom=L,this._easing=this._smoothOutEasing(200)),this._delta=0}const p=typeof this._targetZoom=="number"?this._targetZoom:l(),g=this._startZoom,x=this._easing;let b,T=!1;if(this._type==="wheel"&&g&&x){const S=Math.min((s.exported.now()-this._lastWheelEventTime)/200,1),k=x(S);b=s.number(g,p,k),S<1?this._frameId||(this._frameId=!0):T=!0}else b=p,T=!0;return this._active=!0,T&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!T,zoomDelta:b-l(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let l=s.ease;if(this._prevEase){const p=this._prevEase,g=(s.exported.now()-p.start)/p.duration,x=p.easing(g+.01)-p.easing(g),b=.27/Math.sqrt(x*x+1e-4)*.01,T=Math.sqrt(.0729-b*b);l=s.bezier(b,T,.25,1)}return this._prevEase={start:s.exported.now(),duration:r,easing:l},l}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Ae("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(s.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class ts{constructor(r,l){this._clickZoom=r,this._tapZoom=l}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Oc{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(r,l){return r.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:p.getZoom()+(r.shiftKey?-1:1),around:p.unproject(l)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class wt{constructor(){this._tap=new Ds({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(r,l,p){this._swipePoint||(this._tapTime&&r.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?p.length>0&&(this._swipePoint=l[0],this._swipeTouch=p[0].identifier):this._tap.touchstart(r,l,p))}touchmove(r,l,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const g=l[0],x=g.y-this._swipePoint.y;return this._swipePoint=g,r.preventDefault(),this._active=!0,{zoomDelta:x/128}}}else this._tap.touchmove(r,l,p)}touchend(r,l,p){this._tapTime?this._swipePoint&&p.length===0&&this.reset():this._tap.touchend(r,l,p)&&(this._tapTime=r.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ef{constructor(r,l,p){this._el=r,this._mousePan=l,this._touchPan=p}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class ns{constructor(r,l,p){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=l,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Gu{constructor(r,l,p,g){this._el=r,this._touchZoom=l,this._touchRotate=p,this._tapDragZoom=g,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const da=h=>h.zoom||h.drag||h.pitch||h.rotate;class Bf extends s.Event{}class Tf{constructor(){this.constants=[1,1,.01],this.radius=0}setup(r,l){const p=s.sub([],l,r);this.radius=s.length(p[2]<0?s.div([],p,this.constants):[p[0],p[1],0])}projectRay(r){s.div(r,r,this.constants),s.normalize(r,r),s.mul$1(r,r,this.constants);const l=s.scale$2([],r,this.radius);if(l[2]>0){const p=s.scale$2([],[0,0,1],s.dot(l,[0,0,1])),g=s.scale$2([],s.normalize([],[l[0],l[1],0]),this.radius),x=s.add([],l,s.scale$2([],s.sub([],s.add([],g,p),l),2));l[0]=x[0],l[1]=x[1]}return l}}function Nu(h){return h.panDelta&&h.panDelta.mag()||h.zoomDelta||h.bearingDelta||h.pitchDelta}class rs{constructor(r,l){this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Sr(r),this._bearingSnap=l.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Tf,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(l),s.bindAll(["handleEvent","handleWindowEvent"],this);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[s.window.document,"mousemove",{capture:!0}],[s.window.document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[s.window,"blur",void 0]];for(const[g,x,b]of this._listeners)g.addEventListener(x,g===s.window.document?this.handleWindowEvent:this.handleEvent,b)}destroy(){for(const[r,l,p]of this._listeners)r.removeEventListener(l,r===s.window.document?this.handleWindowEvent:this.handleEvent,p)}_addDefaultHandlers(r){const l=this._map,p=l.getCanvasContainer();this._add("mapEvent",new Hl(l,r));const g=l.boxZoom=new zc(l,r);this._add("boxZoom",g);const x=new Ou,b=new Oc;l.doubleClickZoom=new ts(b,x),this._add("tapZoom",x),this._add("clickZoom",b);const T=new wt;this._add("tapDragZoom",T);const S=l.touchPitch=new An(l);this._add("touchPitch",S);const k=new ld(r),L=new Qa(r);l.dragRotate=new ns(r,k,L),this._add("mouseRotate",k,["mousePitch"]),this._add("mousePitch",L,["mouseRotate"]);const G=new bf(r),V=new Cf(l,r);l.dragPan=new Ef(p,G,V),this._add("mousePan",G),this._add("touchPan",V,["touchZoom","touchRotate"]);const X=new Nr,Z=new K;l.touchZoomRotate=new Gu(p,Z,X,T),this._add("touchRotate",X,["touchPan","touchZoom"]),this._add("touchZoom",Z,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Ja(l));const Y=l.scrollZoom=new $l(l,this);this._add("scrollZoom",Y,["mousePan"]);const W=l.keyboard=new vm;this._add("keyboard",W);for(const $ of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])r.interactive&&r[$]&&l[$].enable(r[$])}_add(r,l,p){this._handlers.push({handlerName:r,handler:l,allowed:p}),this._handlersById[r]=l}stop(r){if(!this._updatingCamera){for(const{handler:l}of this._handlers)l.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[]}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!da(this._eventsInProgress)||this.isZooming()}_blockedByActive(r,l,p){for(const g in r)if(g!==p&&(!l||l.indexOf(g)<0))return!0;return!1}handleWindowEvent(r){this.handleEvent(r,`${r.type}Window`)}_getMapTouches(r){const l=[];for(const p of r)this._el.contains(p.target)&&l.push(p);return l}handleEvent(r,l){this._updatingCamera=!0;const p=r.type==="renderFrame",g=p?void 0:r,x={needsRenderFrame:!1},b={},T={},S=r.touches?this._getMapTouches(r.touches):void 0,k=S?at(this._el,S):p?void 0:Ie(this._el,r);for(const{handlerName:V,handler:X,allowed:Z}of this._handlers){if(!X.isEnabled())continue;let Y;this._blockedByActive(T,Z,V)?X.reset():X[l||r.type]&&(Y=X[l||r.type](r,k,S),this.mergeHandlerResult(x,b,Y,V,g),Y&&Y.needsRenderFrame&&this._triggerRenderFrame()),(Y||X.isActive())&&(T[V]=X)}const L={};for(const V in this._previousActiveHandlers)T[V]||(L[V]=g);this._previousActiveHandlers=T,(Object.keys(L).length||Nu(x))&&(this._changes.push([x,b,L]),this._triggerRenderFrame()),(Object.keys(T).length||Nu(x))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:G}=x;G&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],G(this._map))}mergeHandlerResult(r,l,p,g,x){if(!p)return;s.extend(r,p);const b={handlerName:g,originalEvent:p.originalEvent||x};p.zoomDelta!==void 0&&(l.zoom=b),p.panDelta!==void 0&&(l.drag=b),p.pitchDelta!==void 0&&(l.pitch=b),p.bearingDelta!==void 0&&(l.rotate=b)}_applyChanges(){const r={},l={},p={};for(const[g,x,b]of this._changes)g.panDelta&&(r.panDelta=(r.panDelta||new s.pointGeometry(0,0))._add(g.panDelta)),g.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+g.zoomDelta),g.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+g.bearingDelta),g.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+g.pitchDelta),g.around!==void 0&&(r.around=g.around),g.aroundCoord!==void 0&&(r.aroundCoord=g.aroundCoord),g.pinchAround!==void 0&&(r.pinchAround=g.pinchAround),g.noInertia&&(r.noInertia=g.noInertia),s.extend(l,x),s.extend(p,b);this._updateMapTransform(r,l,p),this._changes=[]}_updateMapTransform(r,l,p){const g=this._map,x=g.transform,b=te=>[te.x,te.y,te.z];if((te=>{const J=this._eventsInProgress.drag;return J&&!this._handlersById[J.handlerName].isActive()})()&&!Nu(r)){const te=x.zoom;x.cameraElevationReference="sea",x.recenterOnTerrain(),x.cameraElevationReference="ground",te!==x.zoom&&this._map._update(!0)}if(!Nu(r))return void this._fireEvents(l,p,!0);let{panDelta:T,zoomDelta:S,bearingDelta:k,pitchDelta:L,around:G,aroundCoord:V,pinchAround:X}=r;X!==void 0&&(G=X),(te=>l.drag&&!this._eventsInProgress.drag)()&&G&&(this._dragOrigin=b(x.pointCoordinate3D(G)),this._trackingEllipsoid.setup(x._camera.position,this._dragOrigin)),x.cameraElevationReference="sea",g._stop(!0),G=G||g.transform.centerPoint,k&&(x.bearing+=k),L&&(x.pitch+=L),x._updateCameraState();const Z=[0,0,0];if(T)if(x.projection.name==="mercator"){const te=this._trackingEllipsoid.projectRay(x.screenPointToMercatorRay(G).dir),J=this._trackingEllipsoid.projectRay(x.screenPointToMercatorRay(G.sub(T)).dir);Z[0]=J[0]-te[0],Z[1]=J[1]-te[1]}else{const te=x.pointCoordinate(G);if(x.projection.name==="globe"){T=T.rotate(-x.angle);const J=x._pixelsPerMercatorPixel/x.worldSize;Z[0]=-T.x*s.mercatorScale(s.latFromMercatorY(te.y))*J,Z[1]=-T.y*s.mercatorScale(x.center.lat)*J}else{const J=x.pointCoordinate(G.sub(T));te&&J&&(Z[0]=J.x-te.x,Z[1]=J.y-te.y)}}const Y=x.zoom,W=[0,0,0];if(S){const te=b(V||x.pointCoordinate3D(G)),J={dir:s.normalize([],s.sub([],te,x._camera.position))};if(J.dir[2]<0){const le=x.zoomDeltaToMovement(te,S);s.scale$2(W,J.dir,le)}}const $=s.add(Z,Z,W);x._translateCameraConstrained($),S&&Math.abs(x.zoom-Y)>1e-4&&x.recenterOnTerrain(),x.cameraElevationReference="ground",this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(l,p,!0)}_fireEvents(r,l,p){const g=da(this._eventsInProgress),x=da(r),b={};for(const L in r){const{originalEvent:G}=r[L];this._eventsInProgress[L]||(b[`${L}start`]=G),this._eventsInProgress[L]=r[L]}!g&&x&&this._fireEvent("movestart",x.originalEvent);for(const L in b)this._fireEvent(L,b[L]);x&&this._fireEvent("move",x.originalEvent);for(const L in r){const{originalEvent:G}=r[L];this._fireEvent(L,G)}const T={};let S;for(const L in this._eventsInProgress){const{handlerName:G,originalEvent:V}=this._eventsInProgress[L];this._handlersById[G].isActive()||(delete this._eventsInProgress[L],S=l[G]||V,T[`${L}end`]=S)}for(const L in T)this._fireEvent(L,T[L]);const k=da(this._eventsInProgress);if(p&&(g||x)&&!k){this._updatingCamera=!0;const L=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),G=V=>V!==0&&-this._bearingSnap<V&&V<this._bearingSnap;L?(G(L.bearing||this._map.getBearing())&&(L.bearing=0),this._map.easeTo(L,{originalEvent:S})):(this._map.fire(new s.Event("moveend",{originalEvent:S})),G(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(r,l){this._map.fire(new s.Event(r,l?{originalEvent:l}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{this._frameId=void 0,this.handleEvent(new Bf("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const ud="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Df extends s.Evented{constructor(r,l){super(),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=l.bearingSnap,s.bindAll(["_renderFrameCallback"],this)}getCenter(){return new s.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(r,l){return this.jumpTo({center:r},l)}panBy(r,l,p){return r=s.pointGeometry.convert(r).mult(-1),this.panTo(this.transform.center,s.extend({offset:r},l),p)}panTo(r,l,p){return this.easeTo(s.extend({center:r},l),p)}getZoom(){return this.transform.zoom}setZoom(r,l){return this.jumpTo({zoom:r},l),this}zoomTo(r,l,p){return this.easeTo(s.extend({zoom:r},l),p)}zoomIn(r,l){return this.zoomTo(this.getZoom()+1,r,l),this}zoomOut(r,l){return this.zoomTo(this.getZoom()-1,r,l),this}getBearing(){return this.transform.bearing}setBearing(r,l){return this.jumpTo({bearing:r},l),this}getPadding(){return this.transform.padding}setPadding(r,l){return this.jumpTo({padding:r},l),this}rotateTo(r,l,p){return this.easeTo(s.extend({bearing:r},l),p)}resetNorth(r,l){return this.rotateTo(0,s.extend({duration:1e3},r),l),this}resetNorthPitch(r,l){return this.easeTo(s.extend({bearing:0,pitch:0,duration:1e3},r),l),this}snapToNorth(r,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,l):this}getPitch(){return this.transform.pitch}setPitch(r,l){return this.jumpTo({pitch:r},l),this}cameraForBounds(r,l){r=s.LngLatBounds.convert(r);const p=l&&l.bearing||0,g=r.getNorthWest(),x=r.getSouthEast();return this._cameraForBounds(this.transform,g,x,p,l)}_extendCameraOptions(r){const l={top:0,bottom:0,right:0,left:0};if(typeof(r=s.extend({padding:l,offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding=="number"){const p=r.padding;r.padding={top:p,bottom:p,right:p,left:p}}return r.padding=s.extend(l,r.padding),r}_minimumAABBFrustumDistance(r,l){const p=l.max[0]-l.min[0],g=l.max[1]-l.min[1];return p/g>r.aspect?p/(2*Math.tan(.5*r.fovX)*r.aspect):g/(2*Math.tan(.5*r.fovY)*r.aspect)}_cameraForBoundsOnGlobe(r,l,p,g,x){const b=r.clone(),T=this._extendCameraOptions(x);b.bearing=g;const S=s.LngLat.convert(l),k=s.LngLat.convert(p),L=.5*(S.lat+k.lat),G=.5*(S.lng+k.lng),V=s.latLngToECEF(L,G),X=s.normalize([],V),Z=s.normalize([],s.cross([],X,[0,1,0])),Y=s.cross([],Z,X),W=[Z[0],Z[1],Z[2],0,Y[0],Y[1],Y[2],0,X[0],X[1],X[2],0,0,0,0,1],$=[V,s.latLngToECEF(S.lat,S.lng),s.latLngToECEF(k.lat,S.lng),s.latLngToECEF(k.lat,k.lng),s.latLngToECEF(S.lat,k.lng),s.latLngToECEF(L,S.lng),s.latLngToECEF(L,k.lng),s.latLngToECEF(S.lat,G),s.latLngToECEF(k.lat,G)];let te=s.Aabb.fromPoints($.map(ut=>[s.dot(Z,ut),s.dot(Y,ut),s.dot(X,ut)]));const J=s.transformMat4([],te.center,W);s.squaredLength(J)===0&&s.set(J,0,0,1),s.normalize(J,J),s.scale$2(J,J,s.GLOBE_RADIUS),b.center=s.ecefToLatLng(J);const le=b.getWorldToCameraMatrix(),ue=s.invert(new Float64Array(16),le);te=s.Aabb.applyTransform(te,s.multiply([],le,W)),s.transformMat4(J,J,le);const oe=.5*(te.max[2]-te.min[2]),fe=this._minimumAABBFrustumDistance(b,te),Ee=s.scale$2([],[0,0,1],oe),Oe=s.add(Ee,J,Ee),Le=fe+(b.pitch===0?0:s.distance(J,Oe)),tt=b.globeCenterInViewSpace,Ce=s.sub([],J,[tt[0],tt[1],tt[2]]);s.normalize(Ce,Ce),s.scale$2(Ce,Ce,Le);const Ve=s.add([],J,Ce);s.transformMat4(Ve,Ve,ue);const He=s.earthRadius/s.GLOBE_RADIUS,Me=s.length(Ve),ve=s.mercatorZfromAltitude(Me*He-s.earthRadius,0),pt=Math.min(b.zoomFromMercatorZAdjusted(ve),T.maxZoom);return pt>.5*(s.GLOBE_ZOOM_THRESHOLD_MIN+s.GLOBE_ZOOM_THRESHOLD_MAX)?(b.setProjection({name:"mercator"}),b.zoom=pt,this._cameraForBounds(b,l,p,g,x)):{center:b.center,zoom:pt,bearing:g}}queryTerrainElevation(r,l){const p=this.transform.elevation;return p?(l=s.extend({},{exaggerated:!0},l),p.getAtPoint(s.MercatorCoordinate.fromLngLat(r),null,l.exaggerated)):null}_cameraForBounds(r,l,p,g,x){if(r.projection.name==="globe")return this._cameraForBoundsOnGlobe(r,l,p,g,x);const b=r.clone(),T=this._extendCameraOptions(x),S=b.padding;b.bearing=g;const k=s.LngLat.convert(l),L=s.LngLat.convert(p),G=new s.LngLat(k.lng,L.lat),V=new s.LngLat(L.lng,k.lat),X=b.project(k),Z=b.project(L),Y=this.queryTerrainElevation(k),W=this.queryTerrainElevation(L),$=this.queryTerrainElevation(G),te=this.queryTerrainElevation(V),J=[[X.x,X.y,Math.min(Y||0,W||0,$||0,te||0)],[Z.x,Z.y,Math.max(Y||0,W||0,$||0,te||0)]];let le=s.Aabb.fromPoints(J);const ue=b.getWorldToCameraMatrix(),oe=s.invert(new Float64Array(16),ue);le=s.Aabb.applyTransform(le,ue);const fe=s.sub([],le.max,le.min),Ee=S.left||0,Oe=S.right||0,Le=S.bottom||0,tt=S.top||0,{left:Ce,right:Ve,top:He,bottom:Me}=T.padding,ve=.5*(Ee+Oe),pt=.5*(tt+Le),ut=Math.min(b.scaleZoom(b.scale*Math.min((b.width-(Ee+Oe+Ce+Ve))/fe[0],(b.height-(Le+tt+Me+He))/fe[1])),T.maxZoom),dt=b.scale/b.zoomScale(ut);le=new s.Aabb([le.min[0]-(Ce+ve)*dt,le.min[1]-(Me+pt)*dt,le.min[2]],[le.max[0]+(Ve+ve)*dt,le.max[1]+(He+pt)*dt,le.max[2]]);const ct=.5*fe[2],Tt=this._minimumAABBFrustumDistance(b,le),Ht=[0,0,1,0];s.transformMat4$1(Ht,Ht,ue),s.normalize$2(Ht,Ht);const Gt=s.scale$2([],Ht,Tt+ct),kt=s.add([],le.center,Gt),ht=(typeof T.offset.x=="number"&&typeof T.offset.y=="number"?new s.pointGeometry(T.offset.x,T.offset.y):s.pointGeometry.convert(T.offset)).rotate(-s.degToRad(g));le.center[0]-=ht.x*dt,le.center[1]+=ht.y*dt,s.transformMat4(le.center,le.center,oe),s.transformMat4(kt,kt,oe);const Yt=[le.center[0],le.center[1],kt[2]*b.pixelsPerMeter];s.scale$2(Yt,Yt,1/b.worldSize);const on=s.lngFromMercatorX(Yt[0]),Fn=s.latFromMercatorY(Yt[1]),Nn=Math.min(b._zoomFromMercatorZ(Yt[2]),T.maxZoom),Dn=new s.LngLat(on,Fn);return b.mercatorFromTransition&&Nn<.5*(s.GLOBE_ZOOM_THRESHOLD_MIN+s.GLOBE_ZOOM_THRESHOLD_MAX)?(b.setProjection({name:"globe"}),b.zoom=Nn,this._cameraForBounds(b,l,p,g,x)):{center:Dn,zoom:Nn,bearing:g}}fitBounds(r,l,p){const g=this.cameraForBounds(r,l);return this._fitInternal(g,l,p)}fitScreenCoordinates(r,l,p,g,x){const b=s.pointGeometry.convert(r),T=s.pointGeometry.convert(l),S=new s.pointGeometry(Math.min(b.x,T.x),Math.min(b.y,T.y)),k=new s.pointGeometry(Math.max(b.x,T.x),Math.max(b.y,T.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(b,T))return this;const L=this.transform.pointLocation3D(S),G=this.transform.pointLocation3D(k),V=this.transform.pointLocation3D(new s.pointGeometry(S.x,k.y)),X=this.transform.pointLocation3D(new s.pointGeometry(k.x,S.y)),Z=[Math.min(L.lng,G.lng,V.lng,X.lng),Math.min(L.lat,G.lat,V.lat,X.lat)],Y=[Math.max(L.lng,G.lng,V.lng,X.lng),Math.max(L.lat,G.lat,V.lat,X.lat)],W=this._cameraForBounds(this.transform,Z,Y,p,g);return this._fitInternal(W,g,x)}_fitInternal(r,l,p){return r?(delete(l=s.extend(r,l)).padding,l.linear?this.easeTo(l,p):this.flyTo(l,p)):this}jumpTo(r,l){this.stop();const p=r.preloadOnly?this.transform.clone():this.transform;let g=!1,x=!1,b=!1;return"zoom"in r&&p.zoom!==+r.zoom&&(g=!0,p.zoom=+r.zoom),r.center!==void 0&&(p.center=s.LngLat.convert(r.center)),"bearing"in r&&p.bearing!==+r.bearing&&(x=!0,p.bearing=+r.bearing),"pitch"in r&&p.pitch!==+r.pitch&&(b=!0,p.pitch=+r.pitch),r.padding==null||p.isPaddingEqual(r.padding)||(p.padding=r.padding),r.preloadOnly?(this._preloadTiles(p),this):(this.fire(new s.Event("movestart",l)).fire(new s.Event("move",l)),g&&this.fire(new s.Event("zoomstart",l)).fire(new s.Event("zoom",l)).fire(new s.Event("zoomend",l)),x&&this.fire(new s.Event("rotatestart",l)).fire(new s.Event("rotate",l)).fire(new s.Event("rotateend",l)),b&&this.fire(new s.Event("pitchstart",l)).fire(new s.Event("pitch",l)).fire(new s.Event("pitchend",l)),this.fire(new s.Event("moveend",l)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||s.warnOnce(ud),this.transform.getFreeCameraOptions()}setFreeCameraOptions(r,l){const p=this.transform;if(!p.projection.supportsFreeCamera)return s.warnOnce(ud),this;this.stop();const g=p.zoom,x=p.pitch,b=p.bearing;p.setFreeCameraOptions(r);const T=g!==p.zoom,S=x!==p.pitch,k=b!==p.bearing;return this.fire(new s.Event("movestart",l)).fire(new s.Event("move",l)),T&&this.fire(new s.Event("zoomstart",l)).fire(new s.Event("zoom",l)).fire(new s.Event("zoomend",l)),k&&this.fire(new s.Event("rotatestart",l)).fire(new s.Event("rotate",l)).fire(new s.Event("rotateend",l)),S&&this.fire(new s.Event("pitchstart",l)).fire(new s.Event("pitch",l)).fire(new s.Event("pitchend",l)),this.fire(new s.Event("moveend",l)),this}easeTo(r,l){this._stop(!1,r.easeId),((r=s.extend({offset:[0,0],duration:500,easing:s.ease},r)).animate===!1||!r.essential&&s.exported.prefersReducedMotion)&&(r.duration=0);const p=this.transform,g=this.getZoom(),x=this.getBearing(),b=this.getPitch(),T=this.getPadding(),S="zoom"in r?+r.zoom:g,k="bearing"in r?this._normalizeBearing(r.bearing,x):x,L="pitch"in r?+r.pitch:b,G="padding"in r?r.padding:p.padding,V=s.pointGeometry.convert(r.offset);let X,Z,Y;if(p.projection.name==="globe"){const Oe=s.MercatorCoordinate.fromLngLat(p.center),Le=V.rotate(-p.angle);Oe.x+=Le.x/p.worldSize,Oe.y+=Le.y/p.worldSize;const tt=Oe.toLngLat(),Ce=s.LngLat.convert(r.center||tt);this._normalizeCenter(Ce),X=p.centerPoint.add(Le),Z=new s.pointGeometry(Oe.x,Oe.y).mult(p.worldSize),Y=new s.pointGeometry(s.mercatorXfromLng(Ce.lng),s.mercatorYfromLat(Ce.lat)).mult(p.worldSize).sub(Z)}else{X=p.centerPoint.add(V);const Oe=p.pointLocation(X),Le=s.LngLat.convert(r.center||Oe);this._normalizeCenter(Le),Z=p.project(Oe),Y=p.project(Le).sub(Z)}const W=p.zoomScale(S-g);let $,te;r.around&&($=s.LngLat.convert(r.around),te=p.locationPoint($));const J=this._zooming||S!==g,le=this._rotating||x!==k,ue=this._pitching||L!==b,oe=!p.isPaddingEqual(G),fe=Oe=>Le=>{if(J&&(Oe.zoom=s.number(g,S,Le)),le&&(Oe.bearing=s.number(x,k,Le)),ue&&(Oe.pitch=s.number(b,L,Le)),oe&&(Oe.interpolatePadding(T,G,Le),X=Oe.centerPoint.add(V)),$)Oe.setLocationAtPoint($,te);else{const tt=Oe.zoomScale(Oe.zoom-g),Ce=S>g?Math.min(2,W):Math.max(.5,W),Ve=Math.pow(Ce,1-Le),He=Oe.unproject(Z.add(Y.mult(Le*Ve)).mult(tt));Oe.setLocationAtPoint(Oe.renderWorldCopies?He.wrap():He,X)}return r.preloadOnly||this._fireMoveEvents(l),Oe};if(r.preloadOnly){const Oe=this._emulate(fe,r.duration,p);return this._preloadTiles(Oe),this}const Ee={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=J,this._rotating=le,this._pitching=ue,this._padding=oe,this._easeId=r.easeId,this._prepareEase(l,r.noMoveStart,Ee),this._ease(fe(p),Oe=>{p.recenterOnTerrain(),this._afterEase(l,Oe)},r),this}_prepareEase(r,l,p={}){this._moving=!0,this.transform.cameraElevationReference="sea",l||p.moving||this.fire(new s.Event("movestart",r)),this._zooming&&!p.zooming&&this.fire(new s.Event("zoomstart",r)),this._rotating&&!p.rotating&&this.fire(new s.Event("rotatestart",r)),this._pitching&&!p.pitching&&this.fire(new s.Event("pitchstart",r))}_fireMoveEvents(r){this.fire(new s.Event("move",r)),this._zooming&&this.fire(new s.Event("zoom",r)),this._rotating&&this.fire(new s.Event("rotate",r)),this._pitching&&this.fire(new s.Event("pitch",r))}_afterEase(r,l){if(this._easeId&&l&&this._easeId===l)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const p=this._zooming,g=this._rotating,x=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new s.Event("zoomend",r)),g&&this.fire(new s.Event("rotateend",r)),x&&this.fire(new s.Event("pitchend",r)),this.fire(new s.Event("moveend",r))}flyTo(r,l){if(!r.essential&&s.exported.prefersReducedMotion){const dt=s.pick(r,["center","zoom","bearing","pitch","around"]);return this.jumpTo(dt,l)}this.stop(),r=s.extend({offset:[0,0],speed:1.2,curve:1.42,easing:s.ease},r);const p=this.transform,g=this.getZoom(),x=this.getBearing(),b=this.getPitch(),T=this.getPadding(),S="zoom"in r?s.clamp(+r.zoom,p.minZoom,p.maxZoom):g,k="bearing"in r?this._normalizeBearing(r.bearing,x):x,L="pitch"in r?+r.pitch:b,G="padding"in r?r.padding:p.padding,V=p.zoomScale(S-g),X=s.pointGeometry.convert(r.offset);let Z=p.centerPoint.add(X);const Y=p.pointLocation(Z),W=s.LngLat.convert(r.center||Y);this._normalizeCenter(W);const $=p.project(Y),te=p.project(W).sub($);let J=r.curve;const le=Math.max(p.width,p.height),ue=le/V,oe=te.mag();if("minZoom"in r){const dt=s.clamp(Math.min(r.minZoom,g,S),p.minZoom,p.maxZoom),ct=le/p.zoomScale(dt-g);J=Math.sqrt(ct/oe*2)}const fe=J*J;function Ee(dt){const ct=(ue*ue-le*le+(dt?-1:1)*fe*fe*oe*oe)/(2*(dt?ue:le)*fe*oe);return Math.log(Math.sqrt(ct*ct+1)-ct)}function Oe(dt){return(Math.exp(dt)-Math.exp(-dt))/2}function Le(dt){return(Math.exp(dt)+Math.exp(-dt))/2}const tt=Ee(0);let Ce=function(dt){return Le(tt)/Le(tt+J*dt)},Ve=function(dt){return le*((Le(tt)*(Oe(ct=tt+J*dt)/Le(ct))-Oe(tt))/fe)/oe;var ct},He=(Ee(1)-tt)/J;if(Math.abs(oe)<1e-6||!isFinite(He)){if(Math.abs(le-ue)<1e-6)return this.easeTo(r,l);const dt=ue<le?-1:1;He=Math.abs(Math.log(ue/le))/J,Ve=function(){return 0},Ce=function(ct){return Math.exp(dt*J*ct)}}r.duration="duration"in r?+r.duration:1e3*He/("screenSpeed"in r?+r.screenSpeed/J:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0);const Me=x!==k,ve=L!==b,pt=!p.isPaddingEqual(G),ut=dt=>ct=>{const Tt=ct*He,Ht=1/Ce(Tt);dt.zoom=ct===1?S:g+dt.scaleZoom(Ht),Me&&(dt.bearing=s.number(x,k,ct)),ve&&(dt.pitch=s.number(b,L,ct)),pt&&(dt.interpolatePadding(T,G,ct),Z=dt.centerPoint.add(X));const Gt=ct===1?W:dt.unproject($.add(te.mult(Ve(Tt))).mult(Ht));return dt.setLocationAtPoint(dt.renderWorldCopies?Gt.wrap():Gt,Z),dt._updateCameraOnTerrain(),r.preloadOnly||this._fireMoveEvents(l),dt};if(r.preloadOnly){const dt=this._emulate(ut,r.duration,p);return this._preloadTiles(dt),this}return this._zooming=!0,this._rotating=Me,this._pitching=ve,this._padding=pt,this._prepareEase(l,!1),this._ease(ut(p),()=>this._afterEase(l),r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(r,l){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const p=this._onEaseEnd;this._onEaseEnd=void 0,p.call(this,l)}if(!r){const p=this.handlers;p&&p.stop(!1)}return this}_ease(r,l,p){p.animate===!1||p.duration===0?(r(1),l()):(this._easeStart=s.exported.now(),this._easeOptions=p,this._onEaseFrame=r,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const r=Math.min((s.exported.now()-this._easeStart)/this._easeOptions.duration,1),l=this._onEaseFrame;l&&l(this._easeOptions.easing(r)),r<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(r,l){r=s.wrap(r,-180,180);const p=Math.abs(r-l);return Math.abs(r-360-l)<p&&(r-=360),Math.abs(r+360-l)<p&&(r+=360),r}_normalizeCenter(r){const l=this.transform;if(!l.renderWorldCopies||l.maxBounds)return;const p=r.lng-l.center.lng;r.lng+=p>180?-360:p<-180?360:0}_emulate(r,l,p){const g=Math.ceil(15*l/1e3),x=[],b=r(p.clone());for(let T=0;T<=g;T++){const S=b(T/g);x.push(S.clone())}return x}}class cd{constructor(r={}){this.options=r,s.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(r){const l=this.options&&this.options.compact;return this._map=r,this._container=Ae("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Ae("button","mapboxgl-ctrl-attrib-button",this._container),Ae("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Ae("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),l&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),l===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(r,l){const p=this._map._getUIString(`AttributionControl.${l}`);r.setAttribute("aria-label",p),r.removeAttribute("title"),r.firstElementChild&&r.firstElementChild.setAttribute("title",p)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let r=this._editLink;r||(r=this._editLink=this._container.querySelector(".mapbox-improve-map"));const l=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||s.config.ACCESS_TOKEN}];if(r){const p=l.reduce((g,x,b)=>(x.value&&(g+=`${x.key}=${x.value}${b<l.length-1?"&":""}`),g),"?");r.href=`${s.config.FEEDBACK_URL}/${p}#${Vl(this._map,!0)}`,r.rel="noopener nofollow",this._setElementTitle(r,"MapFeedback")}}_updateData(r){!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let r=[];if(this._map.style.stylesheet){const g=this._map.style.stylesheet;this.styleOwner=g.owner,this.styleId=g.id}const l=this._map.style._sourceCaches;for(const g in l){const x=l[g];if(x.used){const b=x.getSource();b.attribution&&r.indexOf(b.attribution)<0&&r.push(b.attribution)}}r.sort((g,x)=>g.length-x.length),r=r.filter((g,x)=>{for(let b=x+1;b<r.length;b++)if(r[b].indexOf(g)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=[...this.options.customAttribution,...r]:r.unshift(this.options.customAttribution));const p=r.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,r.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Uu{constructor(){s.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(r){this._map=r,this._container=Ae("div","mapboxgl-ctrl");const l=Ae("a","mapboxgl-ctrl-logo");return l.target="_blank",l.rel="noopener nofollow",l.href="https://www.mapbox.com/",l.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),l.setAttribute("rel","noopener nofollow"),this._container.appendChild(l),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(r){r&&r.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const r=this._map.style._sourceCaches;if(Object.entries(r).length===0)return!0;for(const l in r){const p=r[l].getSource();if(p.hasOwnProperty("mapbox_logo")&&!p.mapbox_logo)return!1}return!0}_updateCompact(){const r=this._container.children;if(r.length){const l=r[0];this._map.getCanvasContainer().offsetWidth<250?l.classList.add("mapboxgl-compact"):l.classList.remove("mapboxgl-compact")}}}class Gc{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const l=++this._id;return this._queue.push({callback:r,id:l,cancelled:!1}),l}remove(r){const l=this._currentlyRunning,p=l?this._queue.concat(l):this._queue;for(const g of p)if(g.id===r)return void(g.cancelled=!0)}run(r=0){const l=this._currentlyRunning=this._queue;this._queue=[];for(const p of l)if(!p.cancelled&&(p.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function So(h,r,l){if(h=new s.LngLat(h.lng,h.lat),r){const p=new s.LngLat(h.lng-360,h.lat),g=new s.LngLat(h.lng+360,h.lat),x=360*Math.ceil(Math.abs(h.lng-l.center.lng)/360),b=l.locationPoint(h).distSqr(r),T=r.x<0||r.y<0||r.x>l.width||r.y>l.height;l.locationPoint(p).distSqr(r)<b&&(T||Math.abs(p.lng-l.center.lng)<x)?h=p:l.locationPoint(g).distSqr(r)<b&&(T||Math.abs(g.lng-l.center.lng)<x)&&(h=g)}for(;Math.abs(h.lng-l.center.lng)>180;){const p=l.locationPoint(h);if(p.x>=0&&p.y>=0&&p.x<=l.width&&p.y<=l.height)break;h.lng>l.center.lng?h.lng-=360:h.lng+=360}return h}const Nc={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Uc extends s.Evented{constructor(r,l){if(super(),(r instanceof s.window.HTMLElement||l)&&(r=s.extend({element:r},l)),s.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=r&&r.occludedOpacity||.2,r&&r.element)this._element=r.element,this._offset=s.pointGeometry.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=Ae("div");const g=41,x=27,b=$e("svg",{display:"block",height:g*this._scale+"px",width:x*this._scale+"px",viewBox:`0 0 ${x} ${g}`},this._element),T=$e("radialGradient",{id:"shadowGradient"},$e("defs",{},b));$e("stop",{offset:"10%","stop-opacity":.4},T),$e("stop",{offset:"100%","stop-opacity":.05},T),$e("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},b),$e("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},b),$e("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},b),$e("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},b),this._offset=s.pointGeometry.convert(r&&r.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",g=>{g.preventDefault()}),this._element.addEventListener("mousedown",g=>{g.preventDefault()});const p=this._element.classList;for(const g in Nc)p.remove(`mapboxgl-marker-anchor-${g}`);p.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(r){return r===this._map||(this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._updateMoving),r.on("moveend",this._update),r.on("remove",this._clearFadeTimer),r._addMarker(this),this.setDraggable(this._draggable),this._update(),r.on("click",this._onMapClick)),this}remove(){const r=this._map;return r&&(r.off("click",this._onMapClick),r.off("move",this._updateMoving),r.off("moveend",this._update),r.off("mousedown",this._addDragHandler),r.off("touchstart",this._addDragHandler),r.off("mouseup",this._onUp),r.off("touchend",this._onUp),r.off("mousemove",this._onMove),r.off("touchmove",this._onMove),r.off("remove",this._clearFadeTimer),r._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=s.LngLat.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const g=Math.sqrt(Math.pow(13.5,2)/2);r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[g,-1*(38.1-13.5+g)],"bottom-right":[-g,-1*(38.1-13.5+g)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,r._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(r){const l=r.code,p=r.charCode||r.keyCode;l!=="Space"&&l!=="Enter"&&p!==32&&p!==13||this.togglePopup()}_onMapClick(r){const l=r.originalEvent.target,p=this._element;this._popup&&(l===p||p.contains(l))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const r=this._popup;return r?(r.isOpen()?(r.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(r.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const r=this._map,l=this._pos;if(!r||!l)return!1;const p=r.unproject(l),g=r.getFreeCameraOptions();if(!g.position)return!1;const x=g.position.toLngLat();return x.distanceTo(p)<.9*x.distanceTo(this._lngLat)}_evaluateOpacity(){const r=this._map;if(!r)return;const l=this._pos;if(!l||l.x<0||l.x>r.transform.width||l.y<0||l.y>r.transform.height)return void this._clearFadeTimer();const p=r.unproject(l);let g;r._showingGlobe()&&s.isLngLatBehindGlobe(r.transform,this._lngLat)?g=0:(g=1-r._queryFogOpacity(p),r.transform._terrainEnabled()&&r.getTerrain()&&this._behindTerrain()&&(g*=this._occludedOpacity)),this._element.style.opacity=`${g}`,this._element.style.pointerEvents=g>0?"auto":"none",this._popup&&this._popup._setOpacity(g),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const r=this._pos;if(!r||!this._map)return;const l=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${r.x}px,${r.y}px)
            ${Nc[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${l.x}px,${l.y}px)
        `}_calculateXYTransform(){const r=this._pos,l=this._map,p=this.getPitchAlignment();if(!l||!r||p!=="map")return"";if(!l._showingGlobe()){const S=l.getPitch();return S?`rotateX(${S}deg)`:""}const g=s.radToDeg(s.globeTiltAtLngLat(l.transform,this._lngLat)),x=r.sub(s.globeCenterToScreenPoint(l.transform)),b=Math.abs(x.x)+Math.abs(x.y);if(b===0)return"";const T=g/b;return`rotateX(${-x.y*T}deg) rotateY(${x.x*T}deg)`}_calculateZTransform(){const r=this._pos,l=this._map;if(!l||!r)return"";let p=0;const g=this.getRotationAlignment();if(g==="map")if(l._showingGlobe()){const x=l.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),b=l.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(x);p=s.radToDeg(Math.atan2(b.y,b.x))-90}else p=-l.getBearing();else if(g==="horizon"){const x=s.smoothstep(4,6,l.getZoom()),b=s.globeCenterToScreenPoint(l.transform);b.y+=x*l.transform.height;const T=r.sub(b),S=s.radToDeg(Math.atan2(T.y,T.x));p=(S>90?S-270:S+90)*(1-x)}return p+=this._rotation,p?`rotateZ(${p}deg)`:""}_update(r){s.window.cancelAnimationFrame(this._updateFrameId);const l=this._map;l&&(l.transform.renderWorldCopies&&(this._lngLat=So(this._lngLat,this._pos,l.transform)),this._pos=l.project(this._lngLat),r===!0?this._updateFrameId=s.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),l._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(l._showingGlobe()||l.getTerrain()||l.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(r){return this._offset=s.pointGeometry.convert(r),this._update(),this}_onMove(r){const l=this._map;if(!l)return;const p=this._pointerdownPos,g=this._positionDelta;if(p&&g){if(!this._isDragging){const x=this._clickTolerance||l._clickTolerance;if(r.point.dist(p)<x)return;this._isDragging=!0}this._pos=r.point.sub(g),this._lngLat=l.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.Event("dragstart"))),this.fire(new s.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const r=this._map;r&&(r.off("mousemove",this._onMove),r.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new s.Event("dragend")),this._state="inactive"}_addDragHandler(r){const l=this._map,p=this._pos;l&&p&&this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(p),this._pointerdownPos=r.point,this._state="pending",l.on("mousemove",this._onMove),l.on("touchmove",this._onMove),l.once("mouseup",this._onUp),l.once("touchend",this._onUp))}setDraggable(r){this._draggable=!!r;const l=this._map;return l&&(r?(l.on("mousedown",this._addDragHandler),l.on("touchstart",this._addDragHandler)):(l.off("mousedown",this._addDragHandler),l.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(r){return this._occludedOpacity=r||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const so={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Sf=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function hd(h=new s.pointGeometry(0,0),r="bottom"){if(typeof h=="number"){const l=Math.round(Math.sqrt(.5*Math.pow(h,2)));switch(r){case"top":return new s.pointGeometry(0,h);case"top-left":return new s.pointGeometry(l,l);case"top-right":return new s.pointGeometry(-l,l);case"bottom":return new s.pointGeometry(0,-h);case"bottom-left":return new s.pointGeometry(l,-l);case"bottom-right":return new s.pointGeometry(-l,-l);case"left":return new s.pointGeometry(h,0);case"right":return new s.pointGeometry(-h,0)}return new s.pointGeometry(0,0)}return h instanceof s.pointGeometry||Array.isArray(h)?s.pointGeometry.convert(h):s.pointGeometry.convert(h[r]||[0,0])}class If{constructor(r){this.jumpTo(r)}getValue(r){if(r<=this._startTime)return this._start;if(r>=this._endTime)return this._end;const l=s.easeCubicInOut((r-this._startTime)/(this._endTime-this._startTime));return this._start*(1-l)+this._end*l}isEasing(r){return r>=this._startTime&&r<=this._endTime}jumpTo(r){this._startTime=-1/0,this._endTime=-1/0,this._start=r,this._end=r}easeTo(r,l,p){this._start=this.getValue(l),this._end=r,this._startTime=l,this._endTime=l+p}}const Mf={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},dd={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function qu(h){h.parentNode&&h.parentNode.removeChild(h)}const fd={showCompass:!0,showZoom:!0,visualizePitch:!1};class kf{constructor(r,l,p=!1){this._clickTolerance=10,this.element=l,this.mouseRotate=new ld({clickTolerance:r.dragRotate._mouseRotate._clickTolerance}),this.map=r,p&&(this.mousePitch=new Qa({clickTolerance:r.dragRotate._mousePitch._clickTolerance})),s.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),l.addEventListener("mousedown",this.mousedown),l.addEventListener("touchstart",this.touchstart,{passive:!1}),l.addEventListener("touchmove",this.touchmove),l.addEventListener("touchend",this.touchend),l.addEventListener("touchcancel",this.reset)}down(r,l){this.mouseRotate.mousedown(r,l),this.mousePitch&&this.mousePitch.mousedown(r,l),be()}move(r,l){const p=this.map,g=this.mouseRotate.mousemoveWindow(r,l),x=g&&g.bearingDelta;if(x&&p.setBearing(p.getBearing()+x),this.mousePitch){const b=this.mousePitch.mousemoveWindow(r,l),T=b&&b.pitchDelta;T&&p.setPitch(p.getPitch()+T)}}off(){const r=this.element;r.removeEventListener("mousedown",this.mousedown),r.removeEventListener("touchstart",this.touchstart,{passive:!1}),r.removeEventListener("touchmove",this.touchmove),r.removeEventListener("touchend",this.touchend),r.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){ge(),s.window.removeEventListener("mousemove",this.mousemove),s.window.removeEventListener("mouseup",this.mouseup)}mousedown(r){this.down(s.extend({},r,{ctrlKey:!0,preventDefault:()=>r.preventDefault()}),Ie(this.element,r)),s.window.addEventListener("mousemove",this.mousemove),s.window.addEventListener("mouseup",this.mouseup)}mousemove(r){this.move(r,Ie(this.element,r))}mouseup(r){this.mouseRotate.mouseupWindow(r),this.mousePitch&&this.mousePitch.mouseupWindow(r),this.offTemp()}touchstart(r){r.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=at(this.element,r.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>r.preventDefault()},this._startPos))}touchmove(r){r.targetTouches.length!==1?this.reset():(this._lastPos=at(this.element,r.targetTouches)[0],this.move({preventDefault:()=>r.preventDefault()},this._lastPos))}touchend(r){r.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Pf={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},ju={maxWidth:100,unit:"metric"};function Wl(h,r,l){const p=el(r),g=p/r,x={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[l];this._map._requestDomTask(()=>{this._container.style.width=h*g+"px",this._container.innerHTML=`${p}&nbsp;${x}`})}function el(h){const r=Math.pow(10,`${Math.floor(h)}`.length-1);let l=h/r;return l=l>=10?10:l>=5?5:l>=3?3:l>=2?2:l>=1?1:function(p){const g=Math.pow(10,Math.ceil(-Math.log(p)/Math.LN10));return Math.round(p*g)/g}(l),r*l}const Vu={version:s.version,supported:pe,setRTLTextPlugin:s.setRTLTextPlugin,getRTLTextPluginStatus:s.getRTLTextPluginStatus,Map:class extends Df{constructor(h){if(s.LivePerformanceUtils.mark(s.PerformanceMarkers.create),(h=s.extend({},dd,h)).minZoom!=null&&h.maxZoom!=null&&h.minZoom>h.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(h.minPitch!=null&&h.maxPitch!=null&&h.minPitch>h.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(h.minPitch!=null&&h.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(h.maxPitch!=null&&h.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(h.antialias&&s.isSafariWithAntialiasingBug(s.window)&&(h.antialias=!1,s.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new ji(h.minZoom,h.maxZoom,h.minPitch,h.maxPitch,h.renderWorldCopies),h),this._interactive=h.interactive,this._minTileCacheSize=h.minTileCacheSize,this._maxTileCacheSize=h.maxTileCacheSize,this._failIfMajorPerformanceCaveat=h.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=h.preserveDrawingBuffer,this._antialias=h.antialias,this._trackResize=h.trackResize,this._bearingSnap=h.bearingSnap,this._refreshExpiredTiles=h.refreshExpiredTiles,this._fadeDuration=h.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=h.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=h.collectResourceTiming,this._optimizeForTerrain=h.optimizeForTerrain,this._language=this._parseLanguage(h.language),this._worldview=h.worldview,this._renderTaskQueue=new Gc,this._domRenderTaskQueue=new Gc,this._controls=[],this._markers=[],this._popups=[],this._mapId=s.uniqueId(),this._locale=s.extend({},Mf,h.locale),this._clickTolerance=h.clickTolerance,this._cooperativeGestures=h.cooperativeGestures,this._performanceMetricsCollection=h.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new If(0),this._interactionRange=[1/0,-1/0],this._useExplicitProjection=!1,this._requestManager=new s.RequestManager(h.transformRequest,h.accessToken,h.testMode),this._silenceAuthErrors=!!h.testMode,typeof h.container=="string"){if(this._container=s.window.document.getElementById(h.container),!this._container)throw new Error(`Container '${h.container}' not found.`)}else{if(!(h.container instanceof s.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=h.container}if(this._container.childNodes.length>0&&s.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),h.maxBounds&&this.setMaxBounds(h.maxBounds),s.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),s.window!==void 0&&(s.window.addEventListener("online",this._onWindowOnline,!1),s.window.addEventListener("resize",this._onWindowResize,!1),s.window.addEventListener("orientationchange",this._onWindowResize,!1),s.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1)),this.handlers=new rs(this,h),this._localFontFamily=h.localFontFamily,this._localIdeographFontFamily=h.localIdeographFontFamily,h.style&&this.setStyle(h.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),h.projection&&this.setProjection(h.projection),this._hash=h.hash&&new zu(typeof h.hash=="string"&&h.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:h.center,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch}),h.bounds&&(this.resize(),this.fitBounds(h.bounds,s.extend({},h.fitBoundsOptions,{duration:0})))),this.resize(),h.attributionControl&&this.addControl(new cd({customAttribution:h.customAttribution})),this._logoControl=new Uu,this.addControl(this._logoControl,h.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",r=>{this._update(r.dataType==="style"),this.fire(new s.Event(`${r.dataType}data`,r))}),this.on("dataloading",r=>{this.fire(new s.Event(`${r.dataType}dataloading`,r))})}_getMapId(){return this._mapId}addControl(h,r){if(r===void 0&&(r=h.getDefaultPosition?h.getDefaultPosition():"top-right"),!h||!h.onAdd)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const l=h.onAdd(this);this._controls.push(h);const p=this._controlPositions[r];return r.indexOf("bottom")!==-1?p.insertBefore(l,p.firstChild):p.appendChild(l),this}removeControl(h){if(!h||!h.onRemove)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(h);return r>-1&&this._controls.splice(r,1),h.onRemove(this),this}hasControl(h){return this._controls.indexOf(h)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(h){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const r=!this._moving;return r&&this.fire(new s.Event("movestart",h)).fire(new s.Event("move",h)),this.fire(new s.Event("resize",h)),r&&this.fire(new s.Event("moveend",h)),this}getBounds(){return this.transform.projection.name==="globe"&&s.warnOnce('Globe projection does not support getBounds API, this API may behave unexpectedly when viewing the poles."'),this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(h){return this.transform.setMaxBounds(s.LngLatBounds.convert(h)),this._update()}setMinZoom(h){if((h=h==null?-2:h)>=-2&&h<=this.transform.maxZoom)return this.transform.minZoom=h,this._update(),this.getZoom()<h?this.setZoom(h):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(h){if((h=h==null?22:h)>=this.transform.minZoom)return this.transform.maxZoom=h,this._update(),this.getZoom()>h?this.setZoom(h):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(h){if((h=h==null?0:h)<0)throw new Error("minPitch must be greater than or equal to 0");if(h>=0&&h<=this.transform.maxPitch)return this.transform.minPitch=h,this._update(),this.getPitch()<h?this.setPitch(h):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(h){if((h=h==null?85:h)>85)throw new Error("maxPitch must be less than or equal to 85");if(h>=this.transform.minPitch)return this.transform.maxPitch=h,this._update(),this.getPitch()>h?this.setPitch(h):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(h){return this.transform.renderWorldCopies=h,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(h){return h==="auto"?s.window.navigator.language:Array.isArray(h)?h.length===0?void 0:h.map(r=>r==="auto"?s.window.navigator.language:r):h}setLanguage(h){const r=this._parseLanguage(h);if(!this.style||r===this._language)return this;this._language=r,this.style._reloadSources();for(const l of this._controls)l._setLanguage&&l._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(h){return this.style&&h!==this._worldview?(this._worldview=h,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(h){return this._lazyInitEmptyStyle(),h?typeof h=="string"&&(h={name:h}):h=null,this._useExplicitProjection=!!h,this._prioritizeAndUpdateProjection(h,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const h=this.transform,r=h.projection.name;let l;r==="globe"&&h.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?(h.setMercatorFromTransition(),l=!0):r==="mercator"&&h.zoom<s.GLOBE_ZOOM_THRESHOLD_MAX&&(h.setProjection({name:"globe"}),l=!0),l&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(h,r){return this._updateProjection(h||r||{name:"mercator"})}_updateProjection(h){let r;if(r=h.name==="globe"&&this.transform.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(h),this.style.applyProjectionUpdate(),r){this.painter.clearBackgroundTiles();for(const l in this.style._sourceCaches)this.style._sourceCaches[l].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(h){return this.transform.locationPoint3D(s.LngLat.convert(h))}unproject(h){return this.transform.pointLocation3D(s.pointGeometry.convert(h))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_createDelegatedListener(h,r,l){if(h==="mouseenter"||h==="mouseover"){let p=!1;const g=b=>{const T=r.filter(k=>this.getLayer(k)),S=T.length?this.queryRenderedFeatures(b.point,{layers:T}):[];S.length?p||(p=!0,l.call(this,new Vi(h,this,b.originalEvent,{features:S}))):p=!1},x=()=>{p=!1};return{layers:new Set(r),listener:l,delegates:{mousemove:g,mouseout:x}}}if(h==="mouseleave"||h==="mouseout"){let p=!1;const g=b=>{const T=r.filter(S=>this.getLayer(S));(T.length?this.queryRenderedFeatures(b.point,{layers:T}):[]).length?p=!0:p&&(p=!1,l.call(this,new Vi(h,this,b.originalEvent)))},x=b=>{p&&(p=!1,l.call(this,new Vi(h,this,b.originalEvent)))};return{layers:new Set(r),listener:l,delegates:{mousemove:g,mouseout:x}}}{const p=g=>{const x=r.filter(T=>this.getLayer(T)),b=x.length?this.queryRenderedFeatures(g.point,{layers:x}):[];b.length&&(g.features=b,l.call(this,g),delete g.features)};return{layers:new Set(r),listener:l,delegates:{[h]:p}}}}on(h,r,l){if(l===void 0)return super.on(h,r);Array.isArray(r)||(r=[r]);const p=this._createDelegatedListener(h,r,l);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[h]=this._delegatedListeners[h]||[],this._delegatedListeners[h].push(p);for(const g in p.delegates)this.on(g,p.delegates[g]);return this}once(h,r,l){if(l===void 0)return super.once(h,r);Array.isArray(r)||(r=[r]);const p=this._createDelegatedListener(h,r,l);for(const g in p.delegates)this.once(g,p.delegates[g]);return this}off(h,r,l){if(l===void 0)return super.off(h,r);r=new Set(Array.isArray(r)?r:[r]);const p=(x,b)=>{if(x.size!==b.size)return!1;for(const T of x)if(!b.has(T))return!1;return!0},g=this._delegatedListeners?this._delegatedListeners[h]:void 0;return g&&(x=>{for(let b=0;b<x.length;b++){const T=x[b];if(T.listener===l&&p(T.layers,r)){for(const S in T.delegates)this.off(S,T.delegates[S]);return x.splice(b,1),this}}})(g),this}queryRenderedFeatures(h,r){return this.style?(r!==void 0||h===void 0||h instanceof s.pointGeometry||Array.isArray(h)||(r=h,h=void 0),this.style.queryRenderedFeatures(h=h||[[0,0],[this.transform.width,this.transform.height]],r=r||{},this.transform)):[]}querySourceFeatures(h,r){return this.style.querySourceFeatures(h,r)}setStyle(h,r){return(r=s.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},r)).diff!==!1&&r.localIdeographFontFamily===this._localIdeographFontFamily&&r.localFontFamily===this._localFontFamily&&this.style&&h?(this._diffStyle(h,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._localFontFamily=r.localFontFamily,this._updateStyle(h,r))}_getUIString(h){const r=this._locale[h];if(r==null)throw new Error(`Missing UI string '${h}'`);return r}_updateStyle(h,r){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),h&&(this.style=new Co(this,r||{}),this.style.setEventedParent(this,{style:this.style}),typeof h=="string"?this.style.loadURL(h):this.style.loadJSON(h)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Co(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(h,r){if(typeof h=="string"){const l=this._requestManager.normalizeStyleURL(h),p=this._requestManager.transformRequest(l,s.ResourceType.Style);s.getJSON(p,(g,x)=>{g?this.fire(new s.ErrorEvent(g)):x&&this._updateDiff(x,r)})}else typeof h=="object"&&this._updateDiff(h,r)}_updateDiff(h,r){try{this.style.setState(h)&&this._update(!0)}catch(l){s.warnOnce(`Unable to perform style diff: ${l.message||l.error||l}.  Rebuilding the style from scratch.`),this._updateStyle(h,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(s.warnOnce("There is no style added to the map."),!1)}addSource(h,r){return this._lazyInitEmptyStyle(),this.style.addSource(h,r),this._update(!0)}isSourceLoaded(h){return!!this.style&&this.style._isSourceCacheLoaded(h)}areTilesLoaded(){const h=this.style&&this.style._sourceCaches;for(const r in h){const l=h[r]._tiles;for(const p in l){const g=l[p];if(g.state!=="loaded"&&g.state!=="errored")return!1}}return!0}addSourceType(h,r,l){this._lazyInitEmptyStyle(),this.style.addSourceType(h,r,l)}removeSource(h){return this.style.removeSource(h),this._updateTerrain(),this._update(!0)}getSource(h){return this.style.getSource(h)}addImage(h,r,{pixelRatio:l=1,sdf:p=!1,stretchX:g,stretchY:x,content:b}={}){if(this._lazyInitEmptyStyle(),r instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&r instanceof s.window.ImageBitmap){const{width:T,height:S,data:k}=s.exported.getImageData(r);this.style.addImage(h,{data:new s.RGBAImage({width:T,height:S},k),pixelRatio:l,stretchX:g,stretchY:x,content:b,sdf:p,version:0})}else if(r.width===void 0||r.height===void 0)this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:T,height:S}=r,k=r;this.style.addImage(h,{data:new s.RGBAImage({width:T,height:S},new Uint8Array(k.data)),pixelRatio:l,stretchX:g,stretchY:x,content:b,sdf:p,version:0,userImage:k}),k.onAdd&&k.onAdd(this,h)}}updateImage(h,r){const l=this.style.getImage(h);if(!l)return void this.fire(new s.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=r instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&r instanceof s.window.ImageBitmap?s.exported.getImageData(r):r,{width:g,height:x}=p;g!==void 0&&x!==void 0?g===l.data.width&&x===l.data.height?(l.data.replace(p.data,!(r instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&r instanceof s.window.ImageBitmap)),this.style.updateImage(h,l)):this.fire(new s.ErrorEvent(new Error(`The width and height of the updated image (${g}, ${x})
                must be that same as the previous version of the image
                (${l.data.width}, ${l.data.height})`))):this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(h){return h?!!this.style.getImage(h):(this.fire(new s.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(h){this.style.removeImage(h)}loadImage(h,r){s.getImage(this._requestManager.transformRequest(h,s.ResourceType.Image),(l,p)=>{r(l,p instanceof s.window.HTMLImageElement?s.exported.getImageData(p):p)})}listImages(){return this.style.listImages()}addLayer(h,r){return this._lazyInitEmptyStyle(),this.style.addLayer(h,r),this._update(!0)}moveLayer(h,r){return this.style.moveLayer(h,r),this._update(!0)}removeLayer(h){return this.style.removeLayer(h),this._update(!0)}getLayer(h){return this.style.getLayer(h)}setLayerZoomRange(h,r,l){return this.style.setLayerZoomRange(h,r,l),this._update(!0)}setFilter(h,r,l={}){return this.style.setFilter(h,r,l),this._update(!0)}getFilter(h){return this.style.getFilter(h)}setPaintProperty(h,r,l,p={}){return this.style.setPaintProperty(h,r,l,p),this._update(!0)}getPaintProperty(h,r){return this.style.getPaintProperty(h,r)}setLayoutProperty(h,r,l,p={}){return this.style.setLayoutProperty(h,r,l,p),this._update(!0)}getLayoutProperty(h,r){return this.style.getLayoutProperty(h,r)}setLight(h,r={}){return this._lazyInitEmptyStyle(),this.style.setLight(h,r),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(h){return this._lazyInitEmptyStyle(),!h&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(h),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(h){return this._lazyInitEmptyStyle(),this.style.setFog(h),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(h){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(s.LngLat.convert(h),this.transform):0}setFeatureState(h,r){return this.style.setFeatureState(h,r),this._update()}removeFeatureState(h,r){return this.style.removeFeatureState(h,r),this._update()}getFeatureState(h){return this.style.getFeatureState(h)}_updateContainerDimensions(){if(!this._container)return;const h=this._container.getBoundingClientRect().width||400,r=this._container.getBoundingClientRect().height||300;let l,p,g,x=this._container;for(;x&&(!p||!g);){const b=s.window.getComputedStyle(x).transform;b&&b!=="none"&&(l=b.match(/matrix.*\((.+)\)/)[1].split(", "),l[0]&&l[0]!=="0"&&l[0]!=="1"&&(p=l[0]),l[3]&&l[3]!=="0"&&l[3]!=="1"&&(g=l[3])),x=x.parentElement}this._containerWidth=p?Math.abs(h/p):h,this._containerHeight=g?Math.abs(r/g):r}_detectMissingCSS(){s.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&s.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const h=this._container;h.classList.add("mapboxgl-map"),(this._missingCSSCanary=Ae("div","mapboxgl-canary",h)).style.visibility="hidden",this._detectMissingCSS();const r=this._canvasContainer=Ae("div","mapboxgl-canvas-container",h);this._interactive&&r.classList.add("mapboxgl-interactive"),this._canvas=Ae("canvas","mapboxgl-canvas",r),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const l=this._controlContainer=Ae("div","mapboxgl-control-container",h),p=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(g=>{p[g]=Ae("div",`mapboxgl-ctrl-${g}`,l)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(h,r){const l=s.exported.devicePixelRatio||1;this._canvas.width=l*Math.ceil(h),this._canvas.height=l*Math.ceil(r),this._canvas.style.width=`${h}px`,this._canvas.style.height=`${r}px`}_addMarker(h){this._markers.push(h)}_removeMarker(h){const r=this._markers.indexOf(h);r!==-1&&this._markers.splice(r,1)}_addPopup(h){this._popups.push(h)}_removePopup(h){const r=this._popups.indexOf(h);r!==-1&&this._popups.splice(r,1)}_setupPainter(){const h=s.extend({},pe.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._canvas.getContext("webgl",h)||this._canvas.getContext("experimental-webgl",h);r?(s.storeAuthState(r,!0),this.painter=new kc(r,this.transform),this.on("data",l=>{l.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),s.exported$1.testSupport(r)):this.fire(new s.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(h){h.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.Event("webglcontextlost",{originalEvent:h}))}_contextRestored(h){this._setupPainter(),this.resize(),this._update(),this.fire(new s.Event("webglcontextrestored",{originalEvent:h}))}_onMapScroll(h){if(h.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(h){return this.style?(this._styleDirty=this._styleDirty||h,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(h){return this._update(),this._renderTaskQueue.add(h)}_cancelRenderFrame(h){this._renderTaskQueue.remove(h)}_requestDomTask(h){!this.loaded()||this.loaded()&&!this.isMoving()?h():this._domRenderTaskQueue.add(h)}_render(h){let r;const l=this.painter.context.extTimerQuery,p=s.exported.now();if(this.listens("gpu-timing-frame")&&(r=l.createQueryEXT(),l.beginQueryEXT(l.TIME_ELAPSED_EXT,r)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],s.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],s.window.performance.now())),this._renderTaskQueue.run(h),this._domRenderTaskQueue.run(h),this._removed)return;this._updateProjectionTransition();let g=!1;const x=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const S=this.transform.zoom,k=this.transform.pitch,L=s.exported.now();this.style.zoomHistory.update(S,L);const G=new s.EvaluationParameters(S,{now:L,fadeDuration:x,pitch:k,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),V=G.crossFadingFactor();V===1&&V===this._crossFadingFactor||(g=!0,this._crossFadingFactor=V),this.style.update(G)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let b=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),b=this._updateAverageElevation(p),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):b=this._updateAverageElevation(p),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,x,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:x,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new s.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new s.Event("load"))),this.style&&(this.style.hasTransitions()||g)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),r){const S=s.exported.now()-p;l.endQueryEXT(l.TIME_ELAPSED_EXT,r),setTimeout(()=>{const k=l.getQueryObjectEXT(r,l.QUERY_RESULT_EXT)/1e6;l.deleteQueryEXT(r),this.fire(new s.Event("gpu-timing-frame",{cpuTime:S,gpuTime:k})),s.window.performance.mark("frame-gpu",{startTime:p,detail:{gpuTime:k}})},50)}if(this.listens("gpu-timing-layer")){const S=this.painter.collectGpuTimers();setTimeout(()=>{const k=this.painter.queryGpuTimers(S);this.fire(new s.Event("gpu-timing-layer",{layerTimes:k}))},50)}if(this.listens("gpu-timing-deferred-render")){const S=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const k=this.painter.queryGpuTimeDeferredRender(S);this.fire(new s.Event("gpu-timing-deferred-render",{gpuTime:k}))},50)}const T=this._sourcesDirty||this._styleDirty||this._placementDirty||b;if(T||this._repaint)this.triggerRepaint();else{const S=!this.isMoving()&&this.loaded();if(S&&(b=this._updateAverageElevation(p,!0)),b)this.triggerRepaint();else if(this._triggerFrame(!1),S&&(this.fire(new s.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const k=this._calculateSpeedIndex();this.fire(new s.Event("speedindexcompleted",{speedIndex:k})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||T||(this._fullyLoaded=!0,s.LivePerformanceUtils.mark(s.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&s.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.painter.transform.projection,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(h){for(const r of this._markers)h&&!this.getRenderWorldCopies()&&(r._lngLat=r._lngLat.wrap()),r._update();for(const r of this._popups)!h||this.getRenderWorldCopies()||r._trackPointer||(r._lngLat=r._lngLat.wrap()),r._update()}_updateAverageElevation(h,r=!1){const l=p=>(this.transform.averageElevation=p,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&l(0);if((r||h-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(h)){const p=this.transform.averageElevation;let g=this.transform.sampleAverageElevation(),x=!1;this.transform.elevation&&(x=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(g)?g=0:this._averageElevationLastSampledAt=h;const b=Math.abs(p-g);if(b>1){if(this._isInitialLoad||x)return this._averageElevation.jumpTo(g),l(g);this._averageElevation.easeTo(g,h,300)}else if(b>1e-4)return this._averageElevation.jumpTo(g),l(g)}return!!this._averageElevation.isEasing(h)&&l(this._averageElevation.getValue(h))}_authenticate(){s.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,h=>{if(h&&(h.message===s.AUTH_ERR_MSG||h.status===401)){const r=this.painter.context.gl;s.storeAuthState(r,!1),this._logoControl instanceof Uu&&this._logoControl._updateLogo(),r&&r.clear(r.DEPTH_BUFFER_BIT|r.COLOR_BUFFER_BIT|r.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new s.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),s.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}_calculateSpeedIndex(){const h=this.painter.canvasCopy(),r=this.painter.getCanvasCopiesAndTimestamps();r.timeStamps.push(performance.now());const l=this.painter.context.gl,p=l.createFramebuffer();function g(x){l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,x,0);const b=new Uint8Array(l.drawingBufferWidth*l.drawingBufferHeight*4);return l.readPixels(0,0,l.drawingBufferWidth,l.drawingBufferHeight,l.RGBA,l.UNSIGNED_BYTE,b),b}return l.bindFramebuffer(l.FRAMEBUFFER,p),this._canvasPixelComparison(g(h),r.canvasCopies.map(g),r.timeStamps)}_canvasPixelComparison(h,r,l){let p=l[1]-l[0];const g=h.length/4;for(let x=0;x<r.length;x++){const b=r[x];let T=0;for(let S=0;S<b.length;S+=4)b[S]===h[S]&&b[S+1]===h[S+1]&&b[S+2]===h[S+2]&&b[S+3]===h[S+3]&&(T+=1);p+=(l[x+2]-l[x+1])*(1-T/g)}return p}remove(){this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),s.window!==void 0&&(s.window.removeEventListener("resize",this._onWindowResize,!1),s.window.removeEventListener("orientationchange",this._onWindowResize,!1),s.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.removeEventListener("online",this._onWindowOnline,!1));const h=this.painter.context.gl.getExtension("WEBGL_lose_context");h&&h.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),qu(this._canvasContainer),qu(this._controlContainer),qu(this._missingCSSCanary),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),s.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new s.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(h){this._renderNextFrame=this._renderNextFrame||h,this.style&&!this._frame&&(this._frame=s.exported.frame(r=>{const l=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,l&&this._render(r)}))}_preloadTiles(h){const r=this.style?Object.values(this.style._sourceCaches):[];return s.asyncAll(r,(l,p)=>l._preloadTiles(h,p),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(h){this._trackResize&&this.resize({originalEvent:h})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(h){this._showTileBoundaries!==h&&(this._showTileBoundaries=h,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(h){this._showTerrainWireframe!==h&&(this._showTerrainWireframe=h,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(h){this._speedIndexTiming!==h&&(this._speedIndexTiming=h,this._update())}get showPadding(){return!!this._showPadding}set showPadding(h){this._showPadding!==h&&(this._showPadding=h,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(h){this._showCollisionBoxes!==h&&(this._showCollisionBoxes=h,h?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(h){this._showOverdrawInspector!==h&&(this._showOverdrawInspector=h,this._update())}get repaint(){return!!this._repaint}set repaint(h){this._repaint!==h&&(this._repaint=h,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(h){this._vertices=h,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(h){this._showTileAABBs!==h&&(this._showTileAABBs=h,h&&this._update())}_setCacheLimits(h,r){s.setCacheLimits(h,r)}get version(){return s.version}},NavigationControl:class{constructor(h){this.options=s.extend({},fd,h),this._container=Ae("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(s.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",r=>{this._map&&this._map.zoomIn({},{originalEvent:r})}),Ae("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",r=>{this._map&&this._map.zoomOut({},{originalEvent:r})}),Ae("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(s.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",r=>{const l=this._map;l&&(this.options.visualizePitch?l.resetNorthPitch({},{originalEvent:r}):l.resetNorth({},{originalEvent:r}))}),this._compassIcon=Ae("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const h=this._map;if(!h)return;const r=h.getZoom(),l=r===h.getMaxZoom(),p=r===h.getMinZoom();this._zoomInButton.disabled=l,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",l.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())}_rotateCompassArrow(){const h=this._map;if(!h)return;const r=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(h.transform.pitch*(Math.PI/180)),.5)}) rotateX(${h.transform.pitch}deg) rotateZ(${h.transform.angle*(180/Math.PI)}deg)`:`rotate(${h.transform.angle*(180/Math.PI)}deg)`;h._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=r)})}onAdd(h){return this._map=h,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),h.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&h.on("pitch",this._rotateCompassArrow),h.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new kf(h,this._compass,this.options.visualizePitch)),this._container}onRemove(){const h=this._map;h&&(this._container.remove(),this.options.showZoom&&h.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&h.off("pitch",this._rotateCompassArrow),h.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(h,r){const l=Ae("button",h,this._container);return l.type="button",l.addEventListener("click",r),l}_setButtonTitle(h,r){if(!this._map)return;const l=this._map._getUIString(`NavigationControl.${r}`);h.setAttribute("aria-label",l),h.firstElementChild&&h.firstElementChild.setAttribute("title",l)}},GeolocateControl:class extends s.Evented{constructor(h){super(),this.options=s.extend({geolocation:s.window.navigator.geolocation},Pf,h),s.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=sd(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(h){return this._map=h,this._container=Ae("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(h){const r=(l=!!this.options.geolocation)=>{this._supportsGeolocation=l,h(l)};this._supportsGeolocation!==void 0?h(this._supportsGeolocation):s.window.navigator.permissions!==void 0?s.window.navigator.permissions.query({name:"geolocation"}).then(l=>r(l.state!=="denied")).catch(()=>r()):r()}_isOutOfMapMaxBounds(h){const r=this._map.getMaxBounds(),l=h.coords;return!!r&&(l.longitude<r.getWest()||l.longitude>r.getEast()||l.latitude<r.getSouth()||l.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(h){if(this._map){if(this._isOutOfMapMaxBounds(h))return this._setErrorState(),this.fire(new s.Event("outofmaxbounds",h)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=h,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(h),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(h),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("geolocate",h)),this._finish()}}_updateCamera(h){const r=new s.LngLat(h.coords.longitude,h.coords.latitude),l=h.coords.accuracy,p=this._map.getBearing(),g=s.extend({bearing:p},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(l),g,{geolocateSource:!0})}_updateMarker(h){if(h){const r=new s.LngLat(h.coords.longitude,h.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=h.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const h=this._map.transform,r=s.mercatorZfromAltitude(1,h._center.lat)*h.worldSize,l=Math.ceil(2*this._accuracy*r);this._circleElement.style.width=`${l}px`,this._circleElement.style.height=`${l}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(h){if(this._map){if(this.options.trackUserLocation)if(h.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(h.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("error",h)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(h){if(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=Ae("button","mapboxgl-ctrl-geolocate",this._container),Ae("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",h===!1){s.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Ae("div","mapboxgl-user-location"),this._dotElement.appendChild(Ae("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Ae("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Uc({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Ae("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Uc({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new s.Event("trackuserlocationend")))})}_onDeviceOrientation(h){this._userLocationDotMarker&&(h.webkitCompassHeading?this._heading=h.webkitCompassHeading:h.absolute===!0&&(this._heading=-1*h.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return s.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let h;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(h={maximumAge:6e5,timeout:0},this._noTimeout=!0):(h=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,h),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const h=()=>{s.window.addEventListener("ondeviceorientationabsolute"in s.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};s.window.DeviceMotionEvent!==void 0&&typeof s.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(r=>{r==="granted"&&h()}).catch(console.error):h()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),s.window.removeEventListener("deviceorientation",this._onDeviceOrientation),s.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:cd,ScaleControl:class{constructor(h){this.options=s.extend({},ju,h),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch{return!1}}()||(this._setScale=Wl.bind(this)),s.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const h=this.options.maxWidth||100,r=this._map,l=r._containerHeight/2,p=r._containerWidth/2-h/2,g=r.unproject([p,l]),x=r.unproject([p+h,l]),b=g.distanceTo(x);if(this.options.unit==="imperial"){const T=3.2808*b;T>5280?this._setScale(h,T/5280,"mile"):this._setScale(h,T,"foot")}else this.options.unit==="nautical"?this._setScale(h,b/1852,"nautical-mile"):b>=1e3?this._setScale(h,b/1e3,"kilometer"):this._setScale(h,b,"meter")}_setScale(h,r,l){const p=el(r),g=p/r;this._map._requestDomTask(()=>{this._container.style.width=h*g+"px",this._container.innerHTML=l!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:l}).format(p):`${p}&nbsp;nm`})}onAdd(h){return this._map=h,this._language=h.getLanguage(),this._container=Ae("div","mapboxgl-ctrl mapboxgl-ctrl-scale",h.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(h){this._language=h,this._update()}setUnit(h){this.options.unit=h,this._update()}},FullscreenControl:class{constructor(h){this._fullscreen=!1,h&&h.container&&(h.container instanceof s.window.HTMLElement?this._container=h.container:s.warnOnce("Full screen control 'container' must be a DOM element.")),s.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in s.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in s.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(h){return this._map=h,this._container||(this._container=this._map.getContainer()),this._controlContainer=Ae("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,s.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!s.window.document.fullscreenEnabled&&!s.window.document.webkitFullscreenEnabled)}_setupUI(){const h=this._fullscreenButton=Ae("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Ae("span","mapboxgl-ctrl-icon",h).setAttribute("aria-hidden","true"),h.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),s.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const h=this._getTitle();this._fullscreenButton.setAttribute("aria-label",h),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",h)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(s.window.document.fullscreenElement||s.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?s.window.document.exitFullscreen?s.window.document.exitFullscreen():s.window.document.webkitCancelFullScreen&&s.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends s.Evented{constructor(h){super(),this.options=s.extend(Object.create(so),h),s.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(h&&h.className?h.className.trim().split(/\s+/):[])}addTo(h){return this._map&&this.remove(),this._map=h,this.options.closeOnClick&&h.on("preclick",this._onClose),this.options.closeOnMove&&h.on("move",this._onClose),h.on("remove",this.remove),this._update(),h._addPopup(this),this._focusFirstElement(),this._trackPointer?(h.on("mousemove",this._onMouseEvent),h.on("mouseup",this._onMouseEvent),h._canvasContainer.classList.add("mapboxgl-track-pointer")):h.on("move",this._update),this.fire(new s.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const h=this._map;return h&&(h.off("move",this._update),h.off("move",this._onClose),h.off("preclick",this._onClose),h.off("click",this._onClose),h.off("remove",this.remove),h.off("mousemove",this._onMouseEvent),h.off("mouseup",this._onMouseEvent),h.off("drag",this._onMouseEvent),h._canvasContainer&&h._canvasContainer.classList.remove("mapboxgl-track-pointer"),h._removePopup(this),this._map=void 0),this.fire(new s.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(h){this._lngLat=s.LngLat.convert(h),this._pos=null,this._trackPointer=!1,this._update();const r=this._map;return r&&(r.on("move",this._update),r.off("mousemove",this._onMouseEvent),r._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const h=this._map;return h&&(h.off("move",this._update),h.on("mousemove",this._onMouseEvent),h.on("drag",this._onMouseEvent),h._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(h){return this.setDOMContent(s.window.document.createTextNode(h))}setHTML(h){const r=s.window.document.createDocumentFragment(),l=s.window.document.createElement("body");let p;for(l.innerHTML=h;p=l.firstChild,p;)r.appendChild(p);return this.setDOMContent(r)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(h){return this.options.maxWidth=h,this._update(),this}setDOMContent(h){let r=this._content;if(r)for(;r.hasChildNodes();)r.firstChild&&r.removeChild(r.firstChild);else r=this._content=Ae("div","mapboxgl-popup-content",this._container||void 0);if(r.appendChild(h),this.options.closeButton){const l=this._closeButton=Ae("button","mapboxgl-popup-close-button",r);l.type="button",l.setAttribute("aria-label","Close popup"),l.setAttribute("aria-hidden","true"),l.innerHTML="&#215;",l.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(h){return this._classList.add(h),this._updateClassList(),this}removeClassName(h){return this._classList.delete(h),this._updateClassList(),this}setOffset(h){return this.options.offset=h,this._update(),this}toggleClassName(h){let r;return this._classList.delete(h)?r=!1:(this._classList.add(h),r=!0),this._updateClassList(),r}_onMouseEvent(h){this._update(h.point)}_getAnchor(h){if(this.options.anchor)return this.options.anchor;const r=this._map,l=this._container,p=this._pos;if(!r||!l||!p)return"bottom";const g=l.offsetWidth,x=l.offsetHeight,b=p.x<g/2,T=p.x>r.transform.width-g/2;if(p.y+h<x)return b?"top-left":T?"top-right":"top";if(p.y>r.transform.height-x){if(b)return"bottom-left";if(T)return"bottom-right"}return b?"left":T?"right":"bottom"}_updateClassList(){const h=this._container;if(!h)return;const r=[...this._classList];r.push("mapboxgl-popup"),this._anchor&&r.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&r.push("mapboxgl-popup-track-pointer"),h.className=r.join(" ")}_update(h){const r=this._map,l=this._content;if(!r||!this._lngLat&&!this._trackPointer||!l)return;let p=this._container;if(p||(p=this._container=Ae("div","mapboxgl-popup",r.getContainer()),this._tip=Ae("div","mapboxgl-popup-tip",p),p.appendChild(l)),this.options.maxWidth&&p.style.maxWidth!==this.options.maxWidth&&(p.style.maxWidth=this.options.maxWidth),r.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=So(this._lngLat,this._pos,r.transform)),!this._trackPointer||h){const g=this._pos=this._trackPointer&&h?h:r.project(this._lngLat),x=hd(this.options.offset),b=this._anchor=this._getAnchor(x.y),T=hd(this.options.offset,b),S=g.add(T).round();r._requestDomTask(()=>{this._container&&b&&(this._container.style.transform=`${Nc[b]} translate(${S.x}px,${S.y}px)`)})}if(!this._marker&&r._showingGlobe()){const g=s.isLngLatBehindGlobe(r.transform,this._lngLat)?0:1;this._setOpacity(g)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const h=this._container.querySelector(Sf);h&&h.focus()}_onClose(){this.remove()}_setOpacity(h){this._container&&(this._container.style.opacity=`${h}`),this._content&&(this._content.style.pointerEvents=h?"auto":"none")}},Marker:Uc,Style:Co,LngLat:s.LngLat,LngLatBounds:s.LngLatBounds,Point:s.pointGeometry,MercatorCoordinate:s.MercatorCoordinate,FreeCameraOptions:jl,Evented:s.Evented,config:s.config,prewarm:function(){Wt().acquire(Nt)},clearPrewarmedResources:function(){const h=zt;h&&(h.isPreloaded()&&h.numActive()===1?(h.release(Nt),zt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return s.config.ACCESS_TOKEN},set accessToken(h){s.config.ACCESS_TOKEN=h},get baseApiUrl(){return s.config.API_URL},set baseApiUrl(h){s.config.API_URL=h},get workerCount(){return Ft.workerCount},set workerCount(h){Ft.workerCount=h},get maxParallelImageRequests(){return s.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(h){s.config.MAX_PARALLEL_IMAGE_REQUESTS=h},clearStorage(h){s.clearTileCache(h)},workerUrl:"",workerClass:null,setNow:s.exported.setNow,restoreNow:s.exported.restoreNow};return Vu});var F=E;return F})})(jB);const Wp=jB.exports;var hA={};for(var A0=32;A0<127;A0++)hA[A0]=String.fromCharCode(A0);function SS(i){var a=0,c=0;return IS(i,function(v,E,D){var F=Math.round(E*1e5),s=Math.round(D*1e5);return v+=jC(qC(F-a))+jC(qC(s-c)),a=F,c=s,v})}function IS(i,a){for(var c=null,v=0,E=0,D="",F=0;F<i.length;F++)c=i[F],v=c.lat||c.x||c[0],E=c.lng||c.y||c[1],D=a(D,v,E);return D}function qC(i){return i<0?~(i<<1):i<<1}function MS(i){return(i&31|32)+63}function jC(i){for(var a="";i>=32;)a+=hA[MS(i)],i=i>>5;return a+=hA[i+63],a}var kS=SS,VC=1e5;function em(i){var a=[],c=0,v=0;return em.integers(i,function(E,D){c+=E,v+=D,a.push([c/VC,v/VC])}),a}em.sign=function(i){return i&1?~(i>>>1):i>>>1};em.integers=function(i,a){for(var c=0,v=0,E=0,D=0,F=0,s=0,N=0;N<i.length;N++)D=i.charCodeAt(N)-63,F=F|(D&31)<<s,s=s+5,D<32&&(++c&1?v=em.sign(F):(E=em.sign(F),a(v,E)),F=0,s=0);return c};var PS=em,LS={encode:kS,decode:PS},dA={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(i,a){(function(){var c,v="4.17.21",E=200,D="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",F="Expected a function",s="Invalid `variable` option passed into `_.template`",N="__lodash_hash_undefined__",pe=500,Re="__lodash_placeholder__",we=1,Ae=2,$e=4,Qe=1,ot=2,Vt=1,be=2,ge=4,Be=8,Xe=16,Ie=32,at=64,ft=128,Ct=256,Et=512,Ot=30,dr="...",Wr=800,ir=16,hi=1,en=2,di=3,fr=1/0,xt=9007199254740991,Qt=17976931348623157e292,Mt=0/0,_n=4294967295,Ln=_n-1,Or=_n>>>1,Qn=[["ary",ft],["bind",Vt],["bindKey",be],["curry",Be],["curryRight",Xe],["flip",Et],["partial",Ie],["partialRight",at],["rearg",Ct]],wr="[object Arguments]",jt="[object Array]",St="[object AsyncFunction]",ar="[object Boolean]",pr="[object Date]",Ui="[object DOMException]",Fa="[object Error]",er="[object Function]",Qi="[object GeneratorFunction]",sn="[object Map]",fi="[object Number]",yu="[object Null]",Jr="[object Object]",Ra="[object Promise]",vu="[object Proxy]",Yi="[object RegExp]",Ii="[object Set]",Gr="[object String]",bo="[object Symbol]",yl="[object Undefined]",ws="[object WeakMap]",vl="[object WeakSet]",eo="[object ArrayBuffer]",qo="[object DataView]",Zs="[object Float32Array]",pi="[object Float64Array]",Oa="[object Int8Array]",Js="[object Int16Array]",jo="[object Int32Array]",Vo="[object Uint8Array]",Ga="[object Uint8ClampedArray]",xl="[object Uint16Array]",Xs="[object Uint32Array]",Qs=/\b__p \+= '';/g,wl=/\b(__p \+=) '' \+/g,Al=/(__e\(.*?\)|\b__t\)) \+\n'';/g,to=/&(?:amp|lt|gt|quot|#39);/g,Na=/[&<>"']/g,pc=RegExp(to.source),bl=RegExp(Na.source),Cl=/<%-([\s\S]+?)%>/g,Mi=/<%([\s\S]+?)%>/g,Ys=/<%=([\s\S]+?)%>/g,xu=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ua=/^\w*$/,ne=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,O=/[\\^$.*+?()[\]{}|]/g,j=RegExp(O.source),ee=/^\s+/,se=/\s/,me=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,De=/\{\n\/\* \[wrapped with (.+)\] \*/,Te=/,? & /,ye=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Pe=/[()=,{}\[\]\/\s]/,Je=/\\(\\)?/g,yt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,et=/\w*$/,Nt=/^[-+]0x[0-9a-f]+$/i,Ft=/^0b[01]+$/i,zt=/^\[object .+?Constructor\]$/,Wt=/^0o[0-7]+$/i,dn=/^(?:0|[1-9]\d*)$/,Tn=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ut=/($^)/,Gn=/['\n\r\u2028\u2029\\]/g,In="\\ud800-\\udfff",ea="\\u0300-\\u036f",As="\\ufe20-\\ufe2f",Ne="\\u20d0-\\u20ff",Ho=ea+As+Ne,yr="\\u2700-\\u27bf",bs="a-z\\xdf-\\xf6\\xf8-\\xff",hf="\\xac\\xb1\\xd7\\xf7",$o="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",El="\\u2000-\\u206f",df=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",qa="A-Z\\xc0-\\xd6\\xd8-\\xde",mt="\\ufe0e\\ufe0f",un=hf+$o+El+df,fn="['\u2019]",Wo="["+In+"]",ja="["+un+"]",cn="["+Ho+"]",Bl="\\d+",Tl="["+yr+"]",Va="["+bs+"]",ki="[^"+In+un+Bl+yr+bs+qa+"]",Hn="\\ud83c[\\udffb-\\udfff]",pm="(?:"+cn+"|"+Hn+")",no="[^"+In+"]",Dl="(?:\\ud83c[\\udde6-\\uddff]){2}",ri="[\\ud800-\\udbff][\\udc00-\\udfff]",ta="["+qa+"]",wu="\\u200d",Au="(?:"+Va+"|"+ki+")",bu="(?:"+ta+"|"+ki+")",Sl="(?:"+fn+"(?:d|ll|m|re|s|t|ve))?",na="(?:"+fn+"(?:D|LL|M|RE|S|T|VE))?",Xr=pm+"?",_r="["+mt+"]?",Nh="(?:"+wu+"(?:"+[no,Dl,ri].join("|")+")"+_r+Xr+")*",Uh="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",mi="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",_i=_r+Xr+Nh,ff="(?:"+[Tl,Dl,ri].join("|")+")"+_i,Ha="(?:"+[no+cn+"?",cn,Dl,ri,Wo].join("|")+")",Dr=RegExp(fn,"g"),Cu=RegExp(cn,"g"),Eu=RegExp(Hn+"(?="+Hn+")|"+Ha+_i,"g"),Bu=RegExp([ta+"?"+Va+"+"+Sl+"(?="+[ja,ta,"$"].join("|")+")",bu+"+"+na+"(?="+[ja,ta+Au,"$"].join("|")+")",ta+"?"+Au+"+"+Sl,ta+"+"+na,mi,Uh,Bl,ff].join("|"),"g"),Qr=RegExp("["+wu+In+Ho+mt+"]"),qh=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,jh=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ko=-1,Rn={};Rn[Zs]=Rn[pi]=Rn[Oa]=Rn[Js]=Rn[jo]=Rn[Vo]=Rn[Ga]=Rn[xl]=Rn[Xs]=!0,Rn[wr]=Rn[jt]=Rn[eo]=Rn[ar]=Rn[qo]=Rn[pr]=Rn[Fa]=Rn[er]=Rn[sn]=Rn[fi]=Rn[Jr]=Rn[Yi]=Rn[Ii]=Rn[Gr]=Rn[ws]=!1;var $n={};$n[wr]=$n[jt]=$n[eo]=$n[qo]=$n[ar]=$n[pr]=$n[Zs]=$n[pi]=$n[Oa]=$n[Js]=$n[jo]=$n[sn]=$n[fi]=$n[Jr]=$n[Yi]=$n[Ii]=$n[Gr]=$n[bo]=$n[Vo]=$n[Ga]=$n[xl]=$n[Xs]=!0,$n[Fa]=$n[er]=$n[ws]=!1;var mm={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Vh={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Il={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},_m={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},pf=parseFloat,$a=parseInt,ro=typeof du=="object"&&du&&du.Object===Object&&du,mc=typeof self=="object"&&self&&self.Object===Object&&self,mr=ro||mc||Function("return this")(),Tu=a&&!a.nodeType&&a,Zo=Tu&&!0&&i&&!i.nodeType&&i,Co=Zo&&Zo.exports===Tu,_c=Co&&ro.process,gi=function(){try{var Se=Zo&&Zo.require&&Zo.require("util").types;return Se||_c&&_c.binding&&_c.binding("util")}catch{}}(),Hh=gi&&gi.isArrayBuffer,gc=gi&&gi.isDate,$h=gi&&gi.isMap,yc=gi&&gi.isRegExp,vc=gi&&gi.isSet,ra=gi&&gi.isTypedArray;function yi(Se,Ke,Ue){switch(Ue.length){case 0:return Se.call(Ke);case 1:return Se.call(Ke,Ue[0]);case 2:return Se.call(Ke,Ue[0],Ue[1]);case 3:return Se.call(Ke,Ue[0],Ue[1],Ue[2])}return Se.apply(Ke,Ue)}function Wh(Se,Ke,Ue,Pt){for(var hn=-1,zn=Se==null?0:Se.length;++hn<zn;){var Ar=Se[hn];Ke(Pt,Ar,Ue(Ar),Se)}return Pt}function vi(Se,Ke){for(var Ue=-1,Pt=Se==null?0:Se.length;++Ue<Pt&&Ke(Se[Ue],Ue,Se)!==!1;);return Se}function Kh(Se,Ke){for(var Ue=Se==null?0:Se.length;Ue--&&Ke(Se[Ue],Ue,Se)!==!1;);return Se}function Eo(Se,Ke){for(var Ue=-1,Pt=Se==null?0:Se.length;++Ue<Pt;)if(!Ke(Se[Ue],Ue,Se))return!1;return!0}function gn(Se,Ke){for(var Ue=-1,Pt=Se==null?0:Se.length,hn=0,zn=[];++Ue<Pt;){var Ar=Se[Ue];Ke(Ar,Ue,Se)&&(zn[hn++]=Ar)}return zn}function ia(Se,Ke){var Ue=Se==null?0:Se.length;return!!Ue&&To(Se,Ke,0)>-1}function Ml(Se,Ke,Ue){for(var Pt=-1,hn=Se==null?0:Se.length;++Pt<hn;)if(Ue(Ke,Se[Pt]))return!0;return!1}function tr(Se,Ke){for(var Ue=-1,Pt=Se==null?0:Se.length,hn=Array(Pt);++Ue<Pt;)hn[Ue]=Ke(Se[Ue],Ue,Se);return hn}function Bo(Se,Ke){for(var Ue=-1,Pt=Ke.length,hn=Se.length;++Ue<Pt;)Se[hn+Ue]=Ke[Ue];return Se}function xc(Se,Ke,Ue,Pt){var hn=-1,zn=Se==null?0:Se.length;for(Pt&&zn&&(Ue=Se[++hn]);++hn<zn;)Ue=Ke(Ue,Se[hn],hn,Se);return Ue}function wc(Se,Ke,Ue,Pt){var hn=Se==null?0:Se.length;for(Pt&&hn&&(Ue=Se[--hn]);hn--;)Ue=Ke(Ue,Se[hn],hn,Se);return Ue}function Du(Se,Ke){for(var Ue=-1,Pt=Se==null?0:Se.length;++Ue<Pt;)if(Ke(Se[Ue],Ue,Se))return!0;return!1}var Ac=kl("length");function Su(Se){return Se.split("")}function oa(Se){return Se.match(ye)||[]}function Wa(Se,Ke,Ue){var Pt;return Ue(Se,function(hn,zn,Ar){if(Ke(hn,zn,Ar))return Pt=zn,!1}),Pt}function xn(Se,Ke,Ue,Pt){for(var hn=Se.length,zn=Ue+(Pt?1:-1);Pt?zn--:++zn<hn;)if(Ke(Se[zn],zn,Se))return zn;return-1}function To(Se,Ke,Ue){return Ke===Ke?gf(Se,Ke,Ue):xn(Se,Jh,Ue)}function Zh(Se,Ke,Ue,Pt){for(var hn=Ue-1,zn=Se.length;++hn<zn;)if(Pt(Se[hn],Ke))return hn;return-1}function Jh(Se){return Se!==Se}function Xh(Se,Ke){var Ue=Se==null?0:Se.length;return Ue?Iu(Se,Ke)/Ue:Mt}function kl(Se){return function(Ke){return Ke==null?c:Ke[Se]}}function bc(Se){return function(Ke){return Se==null?c:Se[Ke]}}function Qh(Se,Ke,Ue,Pt,hn){return hn(Se,function(zn,Ar,Yn){Ue=Pt?(Pt=!1,zn):Ke(Ue,zn,Ar,Yn)}),Ue}function mf(Se,Ke){var Ue=Se.length;for(Se.sort(Ke);Ue--;)Se[Ue]=Se[Ue].value;return Se}function Iu(Se,Ke){for(var Ue,Pt=-1,hn=Se.length;++Pt<hn;){var zn=Ke(Se[Pt]);zn!==c&&(Ue=Ue===c?zn:Ue+zn)}return Ue}function Pl(Se,Ke){for(var Ue=-1,Pt=Array(Se);++Ue<Se;)Pt[Ue]=Ke(Ue);return Pt}function Yh(Se,Ke){return tr(Ke,function(Ue){return[Ue,Se[Ue]]})}function Mu(Se){return Se&&Se.slice(0,yf(Se)+1).replace(ee,"")}function xi(Se){return function(Ke){return Se(Ke)}}function Cc(Se,Ke){return tr(Ke,function(Ue){return Se[Ue]})}function ku(Se,Ke){return Se.has(Ke)}function Ll(Se,Ke){for(var Ue=-1,Pt=Se.length;++Ue<Pt&&To(Ke,Se[Ue],0)>-1;);return Ue}function zl(Se,Ke){for(var Ue=Se.length;Ue--&&To(Ke,Se[Ue],0)>-1;);return Ue}function _f(Se,Ke){for(var Ue=Se.length,Pt=0;Ue--;)Se[Ue]===Ke&&++Pt;return Pt}var Ec=bc(mm),Bc=bc(Vh);function Jo(Se){return"\\"+_m[Se]}function ed(Se,Ke){return Se==null?c:Se[Ke]}function Ka(Se){return Qr.test(Se)}function td(Se){return qh.test(Se)}function nd(Se){for(var Ke,Ue=[];!(Ke=Se.next()).done;)Ue.push(Ke.value);return Ue}function Fl(Se){var Ke=-1,Ue=Array(Se.size);return Se.forEach(function(Pt,hn){Ue[++Ke]=[hn,Pt]}),Ue}function rd(Se,Ke){return function(Ue){return Se(Ke(Ue))}}function Xo(Se,Ke){for(var Ue=-1,Pt=Se.length,hn=0,zn=[];++Ue<Pt;){var Ar=Se[Ue];(Ar===Ke||Ar===Re)&&(Se[Ue]=Re,zn[hn++]=Ue)}return zn}function Tc(Se){var Ke=-1,Ue=Array(Se.size);return Se.forEach(function(Pt){Ue[++Ke]=Pt}),Ue}function Pu(Se){var Ke=-1,Ue=Array(Se.size);return Se.forEach(function(Pt){Ue[++Ke]=[Pt,Pt]}),Ue}function gf(Se,Ke,Ue){for(var Pt=Ue-1,hn=Se.length;++Pt<hn;)if(Se[Pt]===Ke)return Pt;return-1}function Dc(Se,Ke,Ue){for(var Pt=Ue+1;Pt--;)if(Se[Pt]===Ke)return Pt;return Pt}function Rl(Se){return Ka(Se)?Ic(Se):Ac(Se)}function qi(Se){return Ka(Se)?id(Se):Su(Se)}function yf(Se){for(var Ke=Se.length;Ke--&&se.test(Se.charAt(Ke)););return Ke}var Sc=bc(Il);function Ic(Se){for(var Ke=Eu.lastIndex=0;Eu.test(Se);)++Ke;return Ke}function id(Se){return Se.match(Eu)||[]}function od(Se){return Se.match(Bu)||[]}var Ol=function Se(Ke){Ke=Ke==null?mr:Gl.defaults(mr.Object(),Ke,Gl.pick(mr,jh));var Ue=Ke.Array,Pt=Ke.Date,hn=Ke.Error,zn=Ke.Function,Ar=Ke.Math,Yn=Ke.Object,Mc=Ke.RegExp,vf=Ke.String,Pi=Ke.TypeError,Qo=Ue.prototype,Nl=zn.prototype,sa=Yn.prototype,io=Ke["__core-js_shared__"],Cs=Nl.toString,qn=sa.hasOwnProperty,Yo=0,En=function(){var d=/[^.]+$/.exec(io&&io.keys&&io.keys.IE_PROTO||"");return d?"Symbol(src)_1."+d:""}(),oo=sa.toString,gm=Cs.call(Yn),xf=mr._,Ul=Mc("^"+Cs.call(qn).replace(O,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),kc=Co?Ke.Buffer:c,es=Ke.Symbol,ql=Ke.Uint8Array,Pc=kc?kc.allocUnsafe:c,aa=rd(Yn.getPrototypeOf,Yn),jl=Yn.create,la=sa.propertyIsEnumerable,Za=Qo.splice,Lu=es?es.isConcatSpreadable:c,Es=es?es.iterator:c,wi=es?es.toStringTag:c,ua=function(){try{var d=Hi(Yn,"defineProperty");return d({},"",{}),d}catch{}}(),vt=Ke.clearTimeout!==mr.clearTimeout&&Ke.clearTimeout,ji=Pt&&Pt.now!==mr.Date.now&&Pt.now,sd=Ke.setTimeout!==mr.setTimeout&&Ke.setTimeout,zu=Ar.ceil,Vl=Ar.floor,Do=Yn.getOwnPropertySymbols,wf=kc?kc.isBuffer:c,Fu=Ke.isFinite,ad=Qo.join,Lc=rd(Yn.keys,Yn),Sr=Ar.max,Ir=Ar.min,Bs=Pt.now,Vi=Ke.parseInt,Ru=Ar.random,Af=Qo.reverse,Hl=Hi(Ke,"DataView"),Ja=Hi(Ke,"Map"),zc=Hi(Ke,"Promise"),Ts=Hi(Ke,"Set"),ca=Hi(Ke,"WeakMap"),Ds=Hi(Yn,"create"),Ou=ca&&new ca,Xa={},Fc=Os(Hl),bf=Os(Ja),ld=Os(zc),Qa=Os(Ts),Cf=Os(ca),Ya=es?es.prototype:c,Ss=Ya?Ya.valueOf:c,Rc=Ya?Ya.toString:c;function K(d){if(Lr(d)&&!yn(d)&&!(d instanceof An)){if(d instanceof Li)return d;if(qn.call(d,"__wrapped__"))return xa(d)}return new Li(d)}var ha=function(){function d(){}return function(_){if(!Cr(_))return{};if(jl)return jl(_);d.prototype=_;var C=new d;return d.prototype=c,C}}();function Nr(){}function Li(d,_){this.__wrapped__=d,this.__actions__=[],this.__chain__=!!_,this.__index__=0,this.__values__=c}K.templateSettings={escape:Cl,evaluate:Mi,interpolate:Ys,variable:"",imports:{_:K}},K.prototype=Nr.prototype,K.prototype.constructor=K,Li.prototype=ha(Nr.prototype),Li.prototype.constructor=Li;function An(d){this.__wrapped__=d,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=_n,this.__views__=[]}function ym(){var d=new An(this.__wrapped__);return d.__actions__=uo(this.__actions__),d.__dir__=this.__dir__,d.__filtered__=this.__filtered__,d.__iteratees__=uo(this.__iteratees__),d.__takeCount__=this.__takeCount__,d.__views__=uo(this.__views__),d}function vm(){if(this.__filtered__){var d=new An(this);d.__dir__=-1,d.__filtered__=!0}else d=this.clone(),d.__dir__*=-1;return d}function Is(){var d=this.__wrapped__.value(),_=this.__dir__,C=yn(d),P=_<0,q=C?d.length:0,Q=Pg(0,q,this.__views__),he=Q.start,xe=Q.end,ke=xe-he,nt=P?xe:he-1,rt=this.__iteratees__,it=rt.length,At=0,Rt=Ir(ke,this.__takeCount__);if(!C||!P&&q==ke&&Rt==ke)return bm(d,this.__actions__);var Kt=[];e:for(;ke--&&At<Rt;){nt+=_;for(var pn=-1,nn=d[nt];++pn<it;){var Bn=rt[pn],Mn=Bn.iteratee,go=Bn.type,bi=Mn(nn);if(go==en)nn=bi;else if(!bi){if(go==hi)continue e;break e}}Kt[At++]=nn}return Kt}An.prototype=ha(Nr.prototype),An.prototype.constructor=An;function Ms(d){var _=-1,C=d==null?0:d.length;for(this.clear();++_<C;){var P=d[_];this.set(P[0],P[1])}}function $l(){this.__data__=Ds?Ds(null):{},this.size=0}function ts(d){var _=this.has(d)&&delete this.__data__[d];return this.size-=_?1:0,_}function Oc(d){var _=this.__data__;if(Ds){var C=_[d];return C===N?c:C}return qn.call(_,d)?_[d]:c}function wt(d){var _=this.__data__;return Ds?_[d]!==c:qn.call(_,d)}function Ef(d,_){var C=this.__data__;return this.size+=this.has(d)?0:1,C[d]=Ds&&_===c?N:_,this}Ms.prototype.clear=$l,Ms.prototype.delete=ts,Ms.prototype.get=Oc,Ms.prototype.has=wt,Ms.prototype.set=Ef;function ns(d){var _=-1,C=d==null?0:d.length;for(this.clear();++_<C;){var P=d[_];this.set(P[0],P[1])}}function Gu(){this.__data__=[],this.size=0}function da(d){var _=this.__data__,C=el(_,d);if(C<0)return!1;var P=_.length-1;return C==P?_.pop():Za.call(_,C,1),--this.size,!0}function Bf(d){var _=this.__data__,C=el(_,d);return C<0?c:_[C][1]}function Tf(d){return el(this.__data__,d)>-1}function Nu(d,_){var C=this.__data__,P=el(C,d);return P<0?(++this.size,C.push([d,_])):C[P][1]=_,this}ns.prototype.clear=Gu,ns.prototype.delete=da,ns.prototype.get=Bf,ns.prototype.has=Tf,ns.prototype.set=Nu;function rs(d){var _=-1,C=d==null?0:d.length;for(this.clear();++_<C;){var P=d[_];this.set(P[0],P[1])}}function ud(){this.size=0,this.__data__={hash:new Ms,map:new(Ja||ns),string:new Ms}}function Df(d){var _=wd(this,d).delete(d);return this.size-=_?1:0,_}function cd(d){return wd(this,d).get(d)}function Uu(d){return wd(this,d).has(d)}function Gc(d,_){var C=wd(this,d),P=C.size;return C.set(d,_),this.size+=C.size==P?0:1,this}rs.prototype.clear=ud,rs.prototype.delete=Df,rs.prototype.get=cd,rs.prototype.has=Uu,rs.prototype.set=Gc;function So(d){var _=-1,C=d==null?0:d.length;for(this.__data__=new rs;++_<C;)this.add(d[_])}function Nc(d){return this.__data__.set(d,N),this}function Uc(d){return this.__data__.has(d)}So.prototype.add=So.prototype.push=Nc,So.prototype.has=Uc;function so(d){var _=this.__data__=new ns(d);this.size=_.size}function Sf(){this.__data__=new ns,this.size=0}function hd(d){var _=this.__data__,C=_.delete(d);return this.size=_.size,C}function If(d){return this.__data__.get(d)}function Mf(d){return this.__data__.has(d)}function dd(d,_){var C=this.__data__;if(C instanceof ns){var P=C.__data__;if(!Ja||P.length<E-1)return P.push([d,_]),this.size=++C.size,this;C=this.__data__=new rs(P)}return C.set(d,_),this.size=C.size,this}so.prototype.clear=Sf,so.prototype.delete=hd,so.prototype.get=If,so.prototype.has=Mf,so.prototype.set=dd;function qu(d,_){var C=yn(d),P=!C&&nu(d),q=!C&&!P&&ru(d),Q=!C&&!P&&!q&&lh(d),he=C||P||q||Q,xe=he?Pl(d.length,vf):[],ke=xe.length;for(var nt in d)(_||qn.call(d,nt))&&!(he&&(nt=="length"||q&&(nt=="offset"||nt=="parent")||Q&&(nt=="buffer"||nt=="byteLength"||nt=="byteOffset")||va(nt,ke)))&&xe.push(nt);return xe}function fd(d){var _=d.length;return _?d[Yr(0,_-1)]:c}function kf(d,_){return Zf(uo(d),g(_,0,d.length))}function Pf(d){return Zf(uo(d))}function ju(d,_,C){(C!==c&&!mo(d[_],C)||C===c&&!(_ in d))&&l(d,_,C)}function Wl(d,_,C){var P=d[_];(!(qn.call(d,_)&&mo(P,C))||C===c&&!(_ in d))&&l(d,_,C)}function el(d,_){for(var C=d.length;C--;)if(mo(d[C][0],_))return C;return-1}function Vu(d,_,C,P){return L(d,function(q,Q,he){_(P,q,C(q),he)}),P}function h(d,_){return d&&ma(_,ui(_),d)}function r(d,_){return d&&ma(_,$i(_),d)}function l(d,_,C){_=="__proto__"&&ua?ua(d,_,{configurable:!0,enumerable:!0,value:C,writable:!0}):d[_]=C}function p(d,_){for(var C=-1,P=_.length,q=Ue(P),Q=d==null;++C<P;)q[C]=Q?c:Gs(d,_[C]);return q}function g(d,_,C){return d===d&&(C!==c&&(d=d<=C?d:C),_!==c&&(d=d>=_?d:_)),d}function x(d,_,C,P,q,Q){var he,xe=_&we,ke=_&Ae,nt=_&$e;if(C&&(he=q?C(d,P,q,Q):C(d)),he!==c)return he;if(!Cr(d))return d;var rt=yn(d);if(rt){if(he=rx(d),!xe)return uo(d,he)}else{var it=ai(d),At=it==er||it==Qi;if(ru(d))return Tm(d,xe);if(it==Jr||it==wr||At&&!q){if(he=ke||At?{}:Vf(d),!xe)return ke?km(d,r(he,d)):ex(d,h(he,d))}else{if(!$n[it])return q?d:{};he=ix(d,it,xe)}}Q||(Q=new so);var Rt=Q.get(d);if(Rt)return Rt;Q.set(d,he),by(d)?d.forEach(function(nn){he.add(x(nn,_,C,nn,d,Q))}):ah(d)&&d.forEach(function(nn,Bn){he.set(Bn,x(nn,_,C,Bn,d,Q))});var Kt=nt?ke?xd:Ql:ke?$i:ui,pn=rt?c:Kt(d);return vi(pn||d,function(nn,Bn){pn&&(Bn=nn,nn=d[Bn]),Wl(he,Bn,x(nn,_,C,Bn,d,Q))}),he}function b(d){var _=ui(d);return function(C){return T(C,d,_)}}function T(d,_,C){var P=C.length;if(d==null)return!P;for(d=Yn(d);P--;){var q=C[P],Q=_[q],he=d[q];if(he===c&&!(q in d)||!Q(he))return!1}return!0}function S(d,_,C){if(typeof d!="function")throw new Pi(F);return Wu(function(){d.apply(c,C)},_)}function k(d,_,C,P){var q=-1,Q=ia,he=!0,xe=d.length,ke=[],nt=_.length;if(!xe)return ke;C&&(_=tr(_,xi(C))),P?(Q=Ml,he=!1):_.length>=E&&(Q=ku,he=!1,_=new So(_));e:for(;++q<xe;){var rt=d[q],it=C==null?rt:C(rt);if(rt=P||rt!==0?rt:0,he&&it===it){for(var At=nt;At--;)if(_[At]===it)continue e;ke.push(rt)}else Q(_,it,P)||ke.push(rt)}return ke}var L=_a(J),G=_a(le,!0);function V(d,_){var C=!0;return L(d,function(P,q,Q){return C=!!_(P,q,Q),C}),C}function X(d,_,C){for(var P=-1,q=d.length;++P<q;){var Q=d[P],he=_(Q);if(he!=null&&(xe===c?he===he&&!zo(he):C(he,xe)))var xe=he,ke=Q}return ke}function Z(d,_,C,P){var q=d.length;for(C=wn(C),C<0&&(C=-C>q?0:q+C),P=P===c||P>q?q:wn(P),P<0&&(P+=q),P=C>P?0:Cy(P);C<P;)d[C++]=_;return d}function Y(d,_){var C=[];return L(d,function(P,q,Q){_(P,q,Q)&&C.push(P)}),C}function W(d,_,C,P,q){var Q=-1,he=d.length;for(C||(C=Lg),q||(q=[]);++Q<he;){var xe=d[Q];_>0&&C(xe)?_>1?W(xe,_-1,C,P,q):Bo(q,xe):P||(q[q.length]=xe)}return q}var $=ss(),te=ss(!0);function J(d,_){return d&&$(d,_,ui)}function le(d,_){return d&&te(d,_,ui)}function ue(d,_){return gn(_,function(C){return ol(d[C])})}function oe(d,_){_=Zl(_,d);for(var C=0,P=_.length;d!=null&&C<P;)d=d[Rs(_[C++])];return C&&C==P?d:c}function fe(d,_,C){var P=_(d);return yn(d)?P:Bo(P,C(d))}function Ee(d){return d==null?d===c?yl:yu:wi&&wi in Yn(d)?Hu(d):Gg(d)}function Oe(d,_){return d>_}function Le(d,_){return d!=null&&qn.call(d,_)}function tt(d,_){return d!=null&&_ in Yn(d)}function Ce(d,_,C){return d>=Ir(_,C)&&d<Sr(_,C)}function Ve(d,_,C){for(var P=C?Ml:ia,q=d[0].length,Q=d.length,he=Q,xe=Ue(Q),ke=1/0,nt=[];he--;){var rt=d[he];he&&_&&(rt=tr(rt,xi(_))),ke=Ir(rt.length,ke),xe[he]=!C&&(_||q>=120&&rt.length>=120)?new So(he&&rt):c}rt=d[0];var it=-1,At=xe[0];e:for(;++it<q&&nt.length<ke;){var Rt=rt[it],Kt=_?_(Rt):Rt;if(Rt=C||Rt!==0?Rt:0,!(At?ku(At,Kt):P(nt,Kt,C))){for(he=Q;--he;){var pn=xe[he];if(!(pn?ku(pn,Kt):P(d[he],Kt,C)))continue e}At&&At.push(Kt),nt.push(Rt)}}return nt}function He(d,_,C,P){return J(d,function(q,Q,he){_(P,C(q),Q,he)}),P}function Me(d,_,C){_=Zl(_,d),d=Kf(d,_);var P=d==null?d:d[Rs(fo(_))];return P==null?c:yi(P,d,C)}function ve(d){return Lr(d)&&Ee(d)==wr}function pt(d){return Lr(d)&&Ee(d)==eo}function ut(d){return Lr(d)&&Ee(d)==pr}function dt(d,_,C,P,q){return d===_?!0:d==null||_==null||!Lr(d)&&!Lr(_)?d!==d&&_!==_:ct(d,_,C,P,dt,q)}function ct(d,_,C,P,q,Q){var he=yn(d),xe=yn(_),ke=he?jt:ai(d),nt=xe?jt:ai(_);ke=ke==wr?Jr:ke,nt=nt==wr?Jr:nt;var rt=ke==Jr,it=nt==Jr,At=ke==nt;if(At&&ru(d)){if(!ru(_))return!1;he=!0,rt=!1}if(At&&!rt)return Q||(Q=new so),he||lh(d)?ei(d,_,C,P,q,Q):kg(d,_,ke,C,P,q,Q);if(!(C&Qe)){var Rt=rt&&qn.call(d,"__wrapped__"),Kt=it&&qn.call(_,"__wrapped__");if(Rt||Kt){var pn=Rt?d.value():d,nn=Kt?_.value():_;return Q||(Q=new so),q(pn,nn,C,P,Q)}}return At?(Q||(Q=new so),ga(d,_,C,P,q,Q)):!1}function Tt(d){return Lr(d)&&ai(d)==sn}function Ht(d,_,C,P){var q=C.length,Q=q,he=!P;if(d==null)return!Q;for(d=Yn(d);q--;){var xe=C[q];if(he&&xe[2]?xe[1]!==d[xe[0]]:!(xe[0]in d))return!1}for(;++q<Q;){xe=C[q];var ke=xe[0],nt=d[ke],rt=xe[1];if(he&&xe[2]){if(nt===c&&!(ke in d))return!1}else{var it=new so;if(P)var At=P(nt,rt,ke,d,_,it);if(!(At===c?dt(rt,nt,Qe|ot,P,it):At))return!1}}return!0}function Gt(d){if(!Cr(d)||$f(d))return!1;var _=ol(d)?Ul:zt;return _.test(Os(d))}function kt(d){return Lr(d)&&Ee(d)==Yi}function ht(d){return Lr(d)&&ai(d)==Ii}function Yt(d){return Lr(d)&&iu(d.length)&&!!Rn[Ee(d)]}function on(d){return typeof d=="function"?d:d==null?Wi:typeof d=="object"?yn(d)?Io(d[0],d[1]):ii(d):Xy(d)}function Fn(d){if(!Kc(d))return Lc(d);var _=[];for(var C in Yn(d))qn.call(d,C)&&C!="constructor"&&_.push(C);return _}function Nn(d){if(!Cr(d))return Og(d);var _=Kc(d),C=[];for(var P in d)P=="constructor"&&(_||!qn.call(d,P))||C.push(P);return C}function Dn(d,_){return d<_}function Mr(d,_){var C=-1,P=_o(d)?Ue(d.length):[];return L(d,function(q,Q,he){P[++C]=_(q,Q,he)}),P}function ii(d){var _=Lm(d);return _.length==1&&_[0][2]?Rg(_[0][0],_[0][1]):function(C){return C===d||Ht(C,d,_)}}function Io(d,_){return Hf(d)&&Fg(_)?Rg(Rs(d),_):function(C){var P=Gs(C,d);return P===c&&P===_?mp(C,d):dt(_,P,Qe|ot)}}function Un(d,_,C,P,q){d!==_&&$(_,function(Q,he){if(q||(q=new so),Cr(Q))lr(d,_,he,C,Un,P,q);else{var xe=P?P($u(d,he),Q,he+"",d,_,q):c;xe===c&&(xe=Q),ju(d,he,xe)}},$i)}function lr(d,_,C,P,q,Q,he){var xe=$u(d,C),ke=$u(_,C),nt=he.get(ke);if(nt){ju(d,C,nt);return}var rt=Q?Q(xe,ke,C+"",d,_,he):c,it=rt===c;if(it){var At=yn(ke),Rt=!At&&ru(ke),Kt=!At&&!Rt&&lh(ke);rt=ke,At||Rt||Kt?yn(xe)?rt=xe:qr(xe)?rt=uo(xe):Rt?(it=!1,rt=Tm(ke,!0)):Kt?(it=!1,rt=md(ke,!0)):rt=[]:ba(ke)||nu(ke)?(rt=xe,nu(xe)?rt=fp(xe):(!Cr(xe)||ol(xe))&&(rt=Vf(ke))):it=!1}it&&(he.set(ke,rt),q(rt,ke,P,Q,he),he.delete(ke)),ju(d,C,rt)}function Sn(d,_){var C=d.length;if(!!C)return _+=_<0?C:0,va(_,C)?d[_]:c}function vr(d,_,C){_.length?_=tr(_,function(Q){return yn(Q)?function(he){return oe(he,Q.length===1?Q[0]:Q)}:Q}):_=[Wi];var P=-1;_=tr(_,xi(tn()));var q=Mr(d,function(Q,he,xe){var ke=tr(_,function(nt){return nt(Q)});return{criteria:ke,index:++P,value:Q}});return mf(q,function(Q,he){return Nf(Q,he,C)})}function oi(d,_){return jn(d,_,function(C,P){return mp(d,P)})}function jn(d,_,C){for(var P=-1,q=_.length,Q={};++P<q;){var he=_[P],xe=oe(d,he);C(xe,he)&&Ai(Q,Zl(he,d),xe)}return Q}function zi(d){return function(_){return oe(_,d)}}function ks(d,_,C,P){var q=P?Zh:To,Q=-1,he=_.length,xe=d;for(d===_&&(_=uo(_)),C&&(xe=tr(d,xi(C)));++Q<he;)for(var ke=0,nt=_[Q],rt=C?C(nt):nt;(ke=q(xe,rt,ke,P))>-1;)xe!==d&&Za.call(xe,ke,1),Za.call(d,ke,1);return d}function ao(d,_){for(var C=d?_.length:0,P=C-1;C--;){var q=_[C];if(C==P||q!==Q){var Q=q;va(q)?Za.call(d,q,1):Ff(d,q)}}return d}function Yr(d,_){return d+Vl(Ru()*(_-d+1))}function Kl(d,_,C,P){for(var q=-1,Q=Sr(zu((_-d)/(C||1)),0),he=Ue(Q);Q--;)he[P?Q:++q]=d,d+=C;return he}function is(d,_){var C="";if(!d||_<1||_>xt)return C;do _%2&&(C+=d),_=Vl(_/2),_&&(d+=d);while(_);return C}function Jt(d,_){return Jc(Fs(d,_,Wi),d+"")}function os(d){return fd(ou(d))}function fa(d,_){var C=ou(d);return Zf(C,g(_,0,C.length))}function Ai(d,_,C,P){if(!Cr(d))return d;_=Zl(_,d);for(var q=-1,Q=_.length,he=Q-1,xe=d;xe!=null&&++q<Q;){var ke=Rs(_[q]),nt=C;if(ke==="__proto__"||ke==="constructor"||ke==="prototype")return d;if(q!=he){var rt=xe[ke];nt=P?P(rt,ke,xe):c,nt===c&&(nt=Cr(rt)?rt:va(_[q+1])?[]:{})}Wl(xe,ke,nt),xe=xe[ke]}return d}var qc=Ou?function(d,_){return Ou.set(d,_),d}:Wi,Lf=ua?function(d,_){return ua(d,"toString",{configurable:!0,enumerable:!1,value:Gd(_),writable:!0})}:Wi;function Bg(d){return Zf(ou(d))}function Mo(d,_,C){var P=-1,q=d.length;_<0&&(_=-_>q?0:q+_),C=C>q?q:C,C<0&&(C+=q),q=_>C?0:C-_>>>0,_>>>=0;for(var Q=Ue(q);++P<q;)Q[P]=d[P+_];return Q}function Tg(d,_){var C;return L(d,function(P,q,Q){return C=_(P,q,Q),!C}),!!C}function jc(d,_,C){var P=0,q=d==null?P:d.length;if(typeof _=="number"&&_===_&&q<=Or){for(;P<q;){var Q=P+q>>>1,he=d[Q];he!==null&&!zo(he)&&(C?he<=_:he<_)?P=Q+1:q=Q}return q}return zf(d,_,Wi,C)}function zf(d,_,C,P){var q=0,Q=d==null?0:d.length;if(Q===0)return 0;_=C(_);for(var he=_!==_,xe=_===null,ke=zo(_),nt=_===c;q<Q;){var rt=Vl((q+Q)/2),it=C(d[rt]),At=it!==c,Rt=it===null,Kt=it===it,pn=zo(it);if(he)var nn=P||Kt;else nt?nn=Kt&&(P||At):xe?nn=Kt&&At&&(P||!Rt):ke?nn=Kt&&At&&!Rt&&(P||!pn):Rt||pn?nn=!1:nn=P?it<=_:it<_;nn?q=rt+1:Q=rt}return Ir(Q,Ln)}function xm(d,_){for(var C=-1,P=d.length,q=0,Q=[];++C<P;){var he=d[C],xe=_?_(he):he;if(!C||!mo(xe,ke)){var ke=xe;Q[q++]=he===0?0:he}}return Q}function wm(d){return typeof d=="number"?d:zo(d)?Mt:+d}function lo(d){if(typeof d=="string")return d;if(yn(d))return tr(d,lo)+"";if(zo(d))return Rc?Rc.call(d):"";var _=d+"";return _=="0"&&1/d==-fr?"-0":_}function tl(d,_,C){var P=-1,q=ia,Q=d.length,he=!0,xe=[],ke=xe;if(C)he=!1,q=Ml;else if(Q>=E){var nt=_?null:Mg(d);if(nt)return Tc(nt);he=!1,q=ku,ke=new So}else ke=_?[]:xe;e:for(;++P<Q;){var rt=d[P],it=_?_(rt):rt;if(rt=C||rt!==0?rt:0,he&&it===it){for(var At=ke.length;At--;)if(ke[At]===it)continue e;_&&ke.push(it),xe.push(rt)}else q(ke,it,C)||(ke!==xe&&ke.push(it),xe.push(rt))}return xe}function Ff(d,_){return _=Zl(_,d),d=Kf(d,_),d==null||delete d[Rs(fo(_))]}function Am(d,_,C,P){return Ai(d,_,C(oe(d,_)),P)}function pd(d,_,C,P){for(var q=d.length,Q=P?q:-1;(P?Q--:++Q<q)&&_(d[Q],Q,d););return C?Mo(d,P?0:Q,P?Q+1:q):Mo(d,P?Q+1:0,P?q:Q)}function bm(d,_){var C=d;return C instanceof An&&(C=C.value()),xc(_,function(P,q){return q.func.apply(q.thisArg,Bo([P],q.args))},C)}function Rf(d,_,C){var P=d.length;if(P<2)return P?tl(d[0]):[];for(var q=-1,Q=Ue(P);++q<P;)for(var he=d[q],xe=-1;++xe<P;)xe!=q&&(Q[q]=k(Q[q]||he,d[xe],_,C));return tl(W(Q,1),_,C)}function Cm(d,_,C){for(var P=-1,q=d.length,Q=_.length,he={};++P<q;){var xe=P<Q?_[P]:c;C(he,d[P],xe)}return he}function Of(d){return qr(d)?d:[]}function Em(d){return typeof d=="function"?d:Wi}function Zl(d,_){return yn(d)?d:Hf(d,_)?[d]:Jf(Kn(d))}var Vc=Jt;function nl(d,_,C){var P=d.length;return C=C===c?P:C,!_&&C>=P?d:Mo(d,_,C)}var Bm=vt||function(d){return mr.clearTimeout(d)};function Tm(d,_){if(_)return d.slice();var C=d.length,P=Pc?Pc(C):new d.constructor(C);return d.copy(P),P}function Dm(d){var _=new d.constructor(d.byteLength);return new ql(_).set(new ql(d)),_}function Gf(d,_){var C=_?Dm(d.buffer):d.buffer;return new d.constructor(C,d.byteOffset,d.byteLength)}function Dg(d){var _=new d.constructor(d.source,et.exec(d));return _.lastIndex=d.lastIndex,_}function Sm(d){return Ss?Yn(Ss.call(d)):{}}function md(d,_){var C=_?Dm(d.buffer):d.buffer;return new d.constructor(C,d.byteOffset,d.length)}function pa(d,_){if(d!==_){var C=d!==c,P=d===null,q=d===d,Q=zo(d),he=_!==c,xe=_===null,ke=_===_,nt=zo(_);if(!xe&&!nt&&!Q&&d>_||Q&&he&&ke&&!xe&&!nt||P&&he&&ke||!C&&ke||!q)return 1;if(!P&&!Q&&!nt&&d<_||nt&&C&&q&&!P&&!Q||xe&&C&&q||!he&&q||!ke)return-1}return 0}function Nf(d,_,C){for(var P=-1,q=d.criteria,Q=_.criteria,he=q.length,xe=C.length;++P<he;){var ke=pa(q[P],Q[P]);if(ke){if(P>=xe)return ke;var nt=C[P];return ke*(nt=="desc"?-1:1)}}return d.index-_.index}function Im(d,_,C,P){for(var q=-1,Q=d.length,he=C.length,xe=-1,ke=_.length,nt=Sr(Q-he,0),rt=Ue(ke+nt),it=!P;++xe<ke;)rt[xe]=_[xe];for(;++q<he;)(it||q<Q)&&(rt[C[q]]=d[q]);for(;nt--;)rt[xe++]=d[q++];return rt}function Mm(d,_,C,P){for(var q=-1,Q=d.length,he=-1,xe=C.length,ke=-1,nt=_.length,rt=Sr(Q-xe,0),it=Ue(rt+nt),At=!P;++q<rt;)it[q]=d[q];for(var Rt=q;++ke<nt;)it[Rt+ke]=_[ke];for(;++he<xe;)(At||q<Q)&&(it[Rt+C[he]]=d[q++]);return it}function uo(d,_){var C=-1,P=d.length;for(_||(_=Ue(P));++C<P;)_[C]=d[C];return _}function ma(d,_,C,P){var q=!C;C||(C={});for(var Q=-1,he=_.length;++Q<he;){var xe=_[Q],ke=P?P(C[xe],d[xe],xe,C,d):c;ke===c&&(ke=d[xe]),q?l(C,xe,ke):Wl(C,xe,ke)}return C}function ex(d,_){return ma(d,Wc(d),_)}function km(d,_){return ma(d,Ad(d),_)}function Jl(d,_){return function(C,P){var q=yn(C)?Wh:Vu,Q=_?_():{};return q(C,d,tn(P,2),Q)}}function Ps(d){return Jt(function(_,C){var P=-1,q=C.length,Q=q>1?C[q-1]:c,he=q>2?C[2]:c;for(Q=d.length>3&&typeof Q=="function"?(q--,Q):c,he&&Ur(C[0],C[1],he)&&(Q=q<3?c:Q,q=1),_=Yn(_);++P<q;){var xe=C[P];xe&&d(_,xe,P,Q)}return _})}function _a(d,_){return function(C,P){if(C==null)return C;if(!_o(C))return d(C,P);for(var q=C.length,Q=_?q:-1,he=Yn(C);(_?Q--:++Q<q)&&P(he[Q],Q,he)!==!1;);return C}}function ss(d){return function(_,C,P){for(var q=-1,Q=Yn(_),he=P(_),xe=he.length;xe--;){var ke=he[d?xe:++q];if(C(Q[ke],ke,Q)===!1)break}return _}}function Xl(d,_,C){var P=_&Vt,q=_d(d);function Q(){var he=this&&this!==mr&&this instanceof Q?q:d;return he.apply(P?C:this,arguments)}return Q}function rl(d){return function(_){_=Kn(_);var C=Ka(_)?qi(_):c,P=C?C[0]:_.charAt(0),q=C?nl(C,1).join(""):_.slice(1);return P[d]()+q}}function as(d){return function(_){return xc(ph(d_(_).replace(Dr,"")),d,"")}}function _d(d){return function(){var _=arguments;switch(_.length){case 0:return new d;case 1:return new d(_[0]);case 2:return new d(_[0],_[1]);case 3:return new d(_[0],_[1],_[2]);case 4:return new d(_[0],_[1],_[2],_[3]);case 5:return new d(_[0],_[1],_[2],_[3],_[4]);case 6:return new d(_[0],_[1],_[2],_[3],_[4],_[5]);case 7:return new d(_[0],_[1],_[2],_[3],_[4],_[5],_[6])}var C=ha(d.prototype),P=d.apply(C,_);return Cr(P)?P:C}}function tx(d,_,C){var P=_d(d);function q(){for(var Q=arguments.length,he=Ue(Q),xe=Q,ke=$c(q);xe--;)he[xe]=arguments[xe];var nt=Q<3&&he[0]!==ke&&he[Q-1]!==ke?[]:Xo(he,ke);if(Q-=nt.length,Q<C)return vd(d,_,gd,q.placeholder,c,he,nt,c,c,C-Q);var rt=this&&this!==mr&&this instanceof q?P:d;return yi(rt,this,he)}return q}function Sg(d){return function(_,C,P){var q=Yn(_);if(!_o(_)){var Q=tn(C,3);_=ui(_),C=function(xe){return Q(q[xe],xe,q)}}var he=d(_,C,P);return he>-1?q[Q?_[he]:he]:c}}function Ig(d){return ya(function(_){var C=_.length,P=C,q=Li.prototype.thru;for(d&&_.reverse();P--;){var Q=_[P];if(typeof Q!="function")throw new Pi(F);if(q&&!he&&Hc(Q)=="wrapper")var he=new Li([],!0)}for(P=he?P:C;++P<C;){Q=_[P];var xe=Hc(Q),ke=xe=="wrapper"?jf(Q):c;ke&&Yl(ke[0])&&ke[1]==(ft|Be|Ie|Ct)&&!ke[4].length&&ke[9]==1?he=he[Hc(ke[0])].apply(he,ke[3]):he=Q.length==1&&Yl(Q)?he[xe]():he.thru(Q)}return function(){var nt=arguments,rt=nt[0];if(he&&nt.length==1&&yn(rt))return he.plant(rt).value();for(var it=0,At=C?_[it].apply(this,nt):rt;++it<C;)At=_[it].call(this,At);return At}})}function gd(d,_,C,P,q,Q,he,xe,ke,nt){var rt=_&ft,it=_&Vt,At=_&be,Rt=_&(Be|Xe),Kt=_&Et,pn=At?c:_d(d);function nn(){for(var Bn=arguments.length,Mn=Ue(Bn),go=Bn;go--;)Mn[go]=arguments[go];if(Rt)var bi=$c(nn),Ro=_f(Mn,bi);if(P&&(Mn=Im(Mn,P,q,Rt)),Q&&(Mn=Mm(Mn,Q,he,Rt)),Bn-=Ro,Rt&&Bn<nt){var zr=Xo(Mn,bi);return vd(d,_,gd,nn.placeholder,C,Mn,zr,xe,ke,nt-Bn)}var hs=it?C:this,Ta=At?hs[d]:d;return Bn=Mn.length,xe?Mn=Zc(Mn,xe):Kt&&Bn>1&&Mn.reverse(),rt&&ke<Bn&&(Mn.length=ke),this&&this!==mr&&this instanceof nn&&(Ta=pn||_d(Ta)),Ta.apply(hs,Mn)}return nn}function yd(d,_){return function(C,P){return He(C,d,_(P),{})}}function co(d,_){return function(C,P){var q;if(C===c&&P===c)return _;if(C!==c&&(q=C),P!==c){if(q===c)return P;typeof C=="string"||typeof P=="string"?(C=lo(C),P=lo(P)):(C=wm(C),P=wm(P)),q=d(C,P)}return q}}function Pm(d){return ya(function(_){return _=tr(_,xi(tn())),Jt(function(C){var P=this;return d(_,function(q){return yi(q,P,C)})})})}function Uf(d,_){_=_===c?" ":lo(_);var C=_.length;if(C<2)return C?is(_,d):_;var P=is(_,zu(d/Rl(_)));return Ka(_)?nl(qi(P),0,d).join(""):P.slice(0,d)}function kr(d,_,C,P){var q=_&Vt,Q=_d(d);function he(){for(var xe=-1,ke=arguments.length,nt=-1,rt=P.length,it=Ue(rt+ke),At=this&&this!==mr&&this instanceof he?Q:d;++nt<rt;)it[nt]=P[nt];for(;ke--;)it[nt++]=arguments[++xe];return yi(At,q?C:this,it)}return he}function $t(d){return function(_,C,P){return P&&typeof P!="number"&&Ur(_,C,P)&&(C=P=c),_=Ca(_),C===c?(C=_,_=0):C=Ca(C),P=P===c?_<C?1:-1:Ca(P),Kl(_,C,P,d)}}function Ls(d){return function(_,C){return typeof _=="string"&&typeof C=="string"||(_=cs(_),C=cs(C)),d(_,C)}}function vd(d,_,C,P,q,Q,he,xe,ke,nt){var rt=_&Be,it=rt?he:c,At=rt?c:he,Rt=rt?Q:c,Kt=rt?c:Q;_|=rt?Ie:at,_&=~(rt?at:Ie),_&ge||(_&=~(Vt|be));var pn=[d,_,q,Rt,it,Kt,At,xe,ke,nt],nn=C.apply(c,pn);return Yl(d)&&eu(nn,pn),nn.placeholder=P,Rm(nn,d,_)}function bn(d){var _=Ar[d];return function(C,P){if(C=cs(C),P=P==null?0:Ir(wn(P),292),P&&Fu(C)){var q=(Kn(C)+"e").split("e"),Q=_(q[0]+"e"+(+q[1]+P));return q=(Kn(Q)+"e").split("e"),+(q[0]+"e"+(+q[1]-P))}return _(C)}}var Mg=Ts&&1/Tc(new Ts([,-0]))[1]==fr?function(d){return new Ts(d)}:Yu;function qf(d){return function(_){var C=ai(_);return C==sn?Fl(_):C==Ii?Pu(_):Yh(_,d(_))}}function si(d,_,C,P,q,Q,he,xe){var ke=_&be;if(!ke&&typeof d!="function")throw new Pi(F);var nt=P?P.length:0;if(nt||(_&=~(Ie|at),P=q=c),he=he===c?he:Sr(wn(he),0),xe=xe===c?xe:wn(xe),nt-=q?q.length:0,_&at){var rt=P,it=q;P=q=c}var At=ke?c:jf(d),Rt=[d,_,C,P,q,rt,it,Q,he,xe];if(At&&ho(Rt,At),d=Rt[0],_=Rt[1],C=Rt[2],P=Rt[3],q=Rt[4],xe=Rt[9]=Rt[9]===c?ke?0:d.length:Sr(Rt[9]-nt,0),!xe&&_&(Be|Xe)&&(_&=~(Be|Xe)),!_||_==Vt)var Kt=Xl(d,_,C);else _==Be||_==Xe?Kt=tx(d,_,xe):(_==Ie||_==(Vt|Ie))&&!q.length?Kt=kr(d,_,C,P):Kt=gd.apply(c,Rt);var pn=At?qc:eu;return Rm(pn(Kt,Rt),d,_)}function zs(d,_,C,P){return d===c||mo(d,sa[C])&&!qn.call(P,C)?_:d}function ko(d,_,C,P,q,Q){return Cr(d)&&Cr(_)&&(Q.set(_,d),Un(d,_,c,ko,Q),Q.delete(_)),d}function Po(d){return ba(d)?c:d}function ei(d,_,C,P,q,Q){var he=C&Qe,xe=d.length,ke=_.length;if(xe!=ke&&!(he&&ke>xe))return!1;var nt=Q.get(d),rt=Q.get(_);if(nt&&rt)return nt==_&&rt==d;var it=-1,At=!0,Rt=C&ot?new So:c;for(Q.set(d,_),Q.set(_,d);++it<xe;){var Kt=d[it],pn=_[it];if(P)var nn=he?P(pn,Kt,it,_,d,Q):P(Kt,pn,it,d,_,Q);if(nn!==c){if(nn)continue;At=!1;break}if(Rt){if(!Du(_,function(Bn,Mn){if(!ku(Rt,Mn)&&(Kt===Bn||q(Kt,Bn,C,P,Q)))return Rt.push(Mn)})){At=!1;break}}else if(!(Kt===pn||q(Kt,pn,C,P,Q))){At=!1;break}}return Q.delete(d),Q.delete(_),At}function kg(d,_,C,P,q,Q,he){switch(C){case qo:if(d.byteLength!=_.byteLength||d.byteOffset!=_.byteOffset)return!1;d=d.buffer,_=_.buffer;case eo:return!(d.byteLength!=_.byteLength||!Q(new ql(d),new ql(_)));case ar:case pr:case fi:return mo(+d,+_);case Fa:return d.name==_.name&&d.message==_.message;case Yi:case Gr:return d==_+"";case sn:var xe=Fl;case Ii:var ke=P&Qe;if(xe||(xe=Tc),d.size!=_.size&&!ke)return!1;var nt=he.get(d);if(nt)return nt==_;P|=ot,he.set(d,_);var rt=ei(xe(d),xe(_),P,q,Q,he);return he.delete(d),rt;case bo:if(Ss)return Ss.call(d)==Ss.call(_)}return!1}function ga(d,_,C,P,q,Q){var he=C&Qe,xe=Ql(d),ke=xe.length,nt=Ql(_),rt=nt.length;if(ke!=rt&&!he)return!1;for(var it=ke;it--;){var At=xe[it];if(!(he?At in _:qn.call(_,At)))return!1}var Rt=Q.get(d),Kt=Q.get(_);if(Rt&&Kt)return Rt==_&&Kt==d;var pn=!0;Q.set(d,_),Q.set(_,d);for(var nn=he;++it<ke;){At=xe[it];var Bn=d[At],Mn=_[At];if(P)var go=he?P(Mn,Bn,At,_,d,Q):P(Bn,Mn,At,d,_,Q);if(!(go===c?Bn===Mn||q(Bn,Mn,C,P,Q):go)){pn=!1;break}nn||(nn=At=="constructor")}if(pn&&!nn){var bi=d.constructor,Ro=_.constructor;bi!=Ro&&"constructor"in d&&"constructor"in _&&!(typeof bi=="function"&&bi instanceof bi&&typeof Ro=="function"&&Ro instanceof Ro)&&(pn=!1)}return Q.delete(d),Q.delete(_),pn}function ya(d){return Jc(Fs(d,c,qg),d+"")}function Ql(d){return fe(d,ui,Wc)}function xd(d){return fe(d,$i,Ad)}var jf=Ou?function(d){return Ou.get(d)}:Yu;function Hc(d){for(var _=d.name+"",C=Xa[_],P=qn.call(Xa,_)?C.length:0;P--;){var q=C[P],Q=q.func;if(Q==null||Q==d)return q.name}return _}function $c(d){var _=qn.call(K,"placeholder")?K:d;return _.placeholder}function tn(){var d=K.iteratee||g_;return d=d===g_?on:d,arguments.length?d(arguments[0],arguments[1]):d}function wd(d,_){var C=d.__data__;return ox(_)?C[typeof _=="string"?"string":"hash"]:C.map}function Lm(d){for(var _=ui(d),C=_.length;C--;){var P=_[C],q=d[P];_[C]=[P,q,Fg(q)]}return _}function Hi(d,_){var C=ed(d,_);return Gt(C)?C:c}function Hu(d){var _=qn.call(d,wi),C=d[wi];try{d[wi]=c;var P=!0}catch{}var q=oo.call(d);return P&&(_?d[wi]=C:delete d[wi]),q}var Wc=Do?function(d){return d==null?[]:(d=Yn(d),gn(Do(d),function(_){return la.call(d,_)}))}:y_,Ad=Do?function(d){for(var _=[];d;)Bo(_,Wc(d)),d=aa(d);return _}:y_,ai=Ee;(Hl&&ai(new Hl(new ArrayBuffer(1)))!=qo||Ja&&ai(new Ja)!=sn||zc&&ai(zc.resolve())!=Ra||Ts&&ai(new Ts)!=Ii||ca&&ai(new ca)!=ws)&&(ai=function(d){var _=Ee(d),C=_==Jr?d.constructor:c,P=C?Os(C):"";if(P)switch(P){case Fc:return qo;case bf:return sn;case ld:return Ra;case Qa:return Ii;case Cf:return ws}return _});function Pg(d,_,C){for(var P=-1,q=C.length;++P<q;){var Q=C[P],he=Q.size;switch(Q.type){case"drop":d+=he;break;case"dropRight":_-=he;break;case"take":_=Ir(_,d+he);break;case"takeRight":d=Sr(d,_-he);break}}return{start:d,end:_}}function nx(d){var _=d.match(De);return _?_[1].split(Te):[]}function zm(d,_,C){_=Zl(_,d);for(var P=-1,q=_.length,Q=!1;++P<q;){var he=Rs(_[P]);if(!(Q=d!=null&&C(d,he)))break;d=d[he]}return Q||++P!=q?Q:(q=d==null?0:d.length,!!q&&iu(q)&&va(he,q)&&(yn(d)||nu(d)))}function rx(d){var _=d.length,C=new d.constructor(_);return _&&typeof d[0]=="string"&&qn.call(d,"index")&&(C.index=d.index,C.input=d.input),C}function Vf(d){return typeof d.constructor=="function"&&!Kc(d)?ha(aa(d)):{}}function ix(d,_,C){var P=d.constructor;switch(_){case eo:return Dm(d);case ar:case pr:return new P(+d);case qo:return Gf(d,C);case Zs:case pi:case Oa:case Js:case jo:case Vo:case Ga:case xl:case Xs:return md(d,C);case sn:return new P;case fi:case Gr:return new P(d);case Yi:return Dg(d);case Ii:return new P;case bo:return Sm(d)}}function Fm(d,_){var C=_.length;if(!C)return d;var P=C-1;return _[P]=(C>1?"& ":"")+_[P],_=_.join(C>2?", ":" "),d.replace(me,`{
/* [wrapped with `+_+`] */
`)}function Lg(d){return yn(d)||nu(d)||!!(Lu&&d&&d[Lu])}function va(d,_){var C=typeof d;return _=_==null?xt:_,!!_&&(C=="number"||C!="symbol"&&dn.test(d))&&d>-1&&d%1==0&&d<_}function Ur(d,_,C){if(!Cr(C))return!1;var P=typeof _;return(P=="number"?_o(C)&&va(_,C.length):P=="string"&&_ in C)?mo(C[_],d):!1}function Hf(d,_){if(yn(d))return!1;var C=typeof d;return C=="number"||C=="symbol"||C=="boolean"||d==null||zo(d)?!0:Ua.test(d)||!xu.test(d)||_!=null&&d in Yn(_)}function ox(d){var _=typeof d;return _=="string"||_=="number"||_=="symbol"||_=="boolean"?d!=="__proto__":d===null}function Yl(d){var _=Hc(d),C=K[_];if(typeof C!="function"||!(_ in An.prototype))return!1;if(d===C)return!0;var P=jf(C);return!!P&&d===P[0]}function $f(d){return!!En&&En in d}var zg=io?ol:bp;function Kc(d){var _=d&&d.constructor,C=typeof _=="function"&&_.prototype||sa;return d===C}function Fg(d){return d===d&&!Cr(d)}function Rg(d,_){return function(C){return C==null?!1:C[d]===_&&(_!==c||d in Yn(C))}}function Wf(d){var _=kd(d,function(P){return C.size===pe&&C.clear(),P}),C=_.cache;return _}function ho(d,_){var C=d[1],P=_[1],q=C|P,Q=q<(Vt|be|ft),he=P==ft&&C==Be||P==ft&&C==Ct&&d[7].length<=_[8]||P==(ft|Ct)&&_[7].length<=_[8]&&C==Be;if(!(Q||he))return d;P&Vt&&(d[2]=_[2],q|=C&Vt?0:ge);var xe=_[3];if(xe){var ke=d[3];d[3]=ke?Im(ke,xe,_[4]):xe,d[4]=ke?Xo(d[3],Re):_[4]}return xe=_[5],xe&&(ke=d[5],d[5]=ke?Mm(ke,xe,_[6]):xe,d[6]=ke?Xo(d[5],Re):_[6]),xe=_[7],xe&&(d[7]=xe),P&ft&&(d[8]=d[8]==null?_[8]:Ir(d[8],_[8])),d[9]==null&&(d[9]=_[9]),d[0]=_[0],d[1]=q,d}function Og(d){var _=[];if(d!=null)for(var C in Yn(d))_.push(C);return _}function Gg(d){return oo.call(d)}function Fs(d,_,C){return _=Sr(_===c?d.length-1:_,0),function(){for(var P=arguments,q=-1,Q=Sr(P.length-_,0),he=Ue(Q);++q<Q;)he[q]=P[_+q];q=-1;for(var xe=Ue(_+1);++q<_;)xe[q]=P[q];return xe[_]=C(he),yi(d,this,xe)}}function Kf(d,_){return _.length<2?d:oe(d,Mo(_,0,-1))}function Zc(d,_){for(var C=d.length,P=Ir(_.length,C),q=uo(d);P--;){var Q=_[P];d[P]=va(Q,C)?q[Q]:c}return d}function $u(d,_){if(!(_==="constructor"&&typeof d[_]=="function")&&_!="__proto__")return d[_]}var eu=Om(qc),Wu=sd||function(d,_){return mr.setTimeout(d,_)},Jc=Om(Lf);function Rm(d,_,C){var P=_+"";return Jc(d,Fm(P,Xc(nx(P),C)))}function Om(d){var _=0,C=0;return function(){var P=Bs(),q=ir-(P-C);if(C=P,q>0){if(++_>=Wr)return arguments[0]}else _=0;return d.apply(c,arguments)}}function Zf(d,_){var C=-1,P=d.length,q=P-1;for(_=_===c?P:_;++C<_;){var Q=Yr(C,q),he=d[Q];d[Q]=d[C],d[C]=he}return d.length=_,d}var Jf=Wf(function(d){var _=[];return d.charCodeAt(0)===46&&_.push(""),d.replace(ne,function(C,P,q,Q){_.push(q?Q.replace(Je,"$1"):P||C)}),_});function Rs(d){if(typeof d=="string"||zo(d))return d;var _=d+"";return _=="0"&&1/d==-fr?"-0":_}function Os(d){if(d!=null){try{return Cs.call(d)}catch{}try{return d+""}catch{}}return""}function Xc(d,_){return vi(Qn,function(C){var P="_."+C[0];_&C[1]&&!ia(d,P)&&d.push(P)}),d.sort()}function xa(d){if(d instanceof An)return d.clone();var _=new Li(d.__wrapped__,d.__chain__);return _.__actions__=uo(d.__actions__),_.__index__=d.__index__,_.__values__=d.__values__,_}function Gm(d,_,C){(C?Ur(d,_,C):_===c)?_=1:_=Sr(wn(_),0);var P=d==null?0:d.length;if(!P||_<1)return[];for(var q=0,Q=0,he=Ue(zu(P/_));q<P;)he[Q++]=Mo(d,q,q+=_);return he}function Ng(d){for(var _=-1,C=d==null?0:d.length,P=0,q=[];++_<C;){var Q=d[_];Q&&(q[P++]=Q)}return q}function bd(){var d=arguments.length;if(!d)return[];for(var _=Ue(d-1),C=arguments[0],P=d;P--;)_[P-1]=arguments[P];return Bo(yn(C)?uo(C):[C],W(_,1))}var Cd=Jt(function(d,_){return qr(d)?k(d,W(_,1,qr,!0)):[]}),Lo=Jt(function(d,_){var C=fo(_);return qr(C)&&(C=c),qr(d)?k(d,W(_,1,qr,!0),tn(C,2)):[]}),Ed=Jt(function(d,_){var C=fo(_);return qr(C)&&(C=c),qr(d)?k(d,W(_,1,qr,!0),c,C):[]});function Fi(d,_,C){var P=d==null?0:d.length;return P?(_=C||_===c?1:wn(_),Mo(d,_<0?0:_,P)):[]}function ls(d,_,C){var P=d==null?0:d.length;return P?(_=C||_===c?1:wn(_),_=P-_,Mo(d,0,_<0?0:_)):[]}function Nm(d,_){return d&&d.length?pd(d,tn(_,3),!0,!0):[]}function Pr(d,_){return d&&d.length?pd(d,tn(_,3),!0):[]}function Ug(d,_,C,P){var q=d==null?0:d.length;return q?(C&&typeof C!="number"&&Ur(d,_,C)&&(C=0,P=q),Z(d,_,C,P)):[]}function Qc(d,_,C){var P=d==null?0:d.length;if(!P)return-1;var q=C==null?0:wn(C);return q<0&&(q=Sr(P+q,0)),xn(d,tn(_,3),q)}function us(d,_,C){var P=d==null?0:d.length;if(!P)return-1;var q=P-1;return C!==c&&(q=wn(C),q=C<0?Sr(P+q,0):Ir(q,P-1)),xn(d,tn(_,3),q,!0)}function qg(d){var _=d==null?0:d.length;return _?W(d,1):[]}function sx(d){var _=d==null?0:d.length;return _?W(d,fr):[]}function jg(d,_){var C=d==null?0:d.length;return C?(_=_===c?1:wn(_),W(d,_)):[]}function Vg(d){for(var _=-1,C=d==null?0:d.length,P={};++_<C;){var q=d[_];P[q[0]]=q[1]}return P}function tu(d){return d&&d.length?d[0]:c}function Hg(d,_,C){var P=d==null?0:d.length;if(!P)return-1;var q=C==null?0:wn(C);return q<0&&(q=Sr(P+q,0)),To(d,_,q)}function $g(d){var _=d==null?0:d.length;return _?Mo(d,0,-1):[]}var Wg=Jt(function(d){var _=tr(d,Of);return _.length&&_[0]===d[0]?Ve(_):[]}),Kg=Jt(function(d){var _=fo(d),C=tr(d,Of);return _===fo(C)?_=c:C.pop(),C.length&&C[0]===d[0]?Ve(C,tn(_,2)):[]}),ax=Jt(function(d){var _=fo(d),C=tr(d,Of);return _=typeof _=="function"?_:c,_&&C.pop(),C.length&&C[0]===d[0]?Ve(C,c,_):[]});function Um(d,_){return d==null?"":ad.call(d,_)}function fo(d){var _=d==null?0:d.length;return _?d[_-1]:c}function qm(d,_,C){var P=d==null?0:d.length;if(!P)return-1;var q=P;return C!==c&&(q=wn(C),q=q<0?Sr(P+q,0):Ir(q,P-1)),_===_?Dc(d,_,q):xn(d,Jh,q,!0)}function Ri(d,_){return d&&d.length?Sn(d,wn(_)):c}var Zg=Jt(Jg);function Jg(d,_){return d&&d.length&&_&&_.length?ks(d,_):d}function Xg(d,_,C){return d&&d.length&&_&&_.length?ks(d,_,tn(C,2)):d}function lx(d,_,C){return d&&d.length&&_&&_.length?ks(d,_,c,C):d}var ux=ya(function(d,_){var C=d==null?0:d.length,P=p(d,_);return ao(d,tr(_,function(q){return va(q,C)?+q:q}).sort(pa)),P});function Qg(d,_){var C=[];if(!(d&&d.length))return C;var P=-1,q=[],Q=d.length;for(_=tn(_,3);++P<Q;){var he=d[P];_(he,P,d)&&(C.push(he),q.push(P))}return ao(d,q),C}function Xf(d){return d==null?d:Af.call(d)}function Yg(d,_,C){var P=d==null?0:d.length;return P?(C&&typeof C!="number"&&Ur(d,_,C)?(_=0,C=P):(_=_==null?0:wn(_),C=C===c?P:wn(C)),Mo(d,_,C)):[]}function jm(d,_){return jc(d,_)}function il(d,_,C){return zf(d,_,tn(C,2))}function po(d,_){var C=d==null?0:d.length;if(C){var P=jc(d,_);if(P<C&&mo(d[P],_))return P}return-1}function cx(d,_){return jc(d,_,!0)}function Vm(d,_,C){return zf(d,_,tn(C,2),!0)}function hx(d,_){var C=d==null?0:d.length;if(C){var P=jc(d,_,!0)-1;if(mo(d[P],_))return P}return-1}function dx(d){return d&&d.length?xm(d):[]}function fx(d,_){return d&&d.length?xm(d,tn(_,2)):[]}function Bd(d){var _=d==null?0:d.length;return _?Mo(d,1,_):[]}function Qf(d,_,C){return d&&d.length?(_=C||_===c?1:wn(_),Mo(d,0,_<0?0:_)):[]}function ey(d,_,C){var P=d==null?0:d.length;return P?(_=C||_===c?1:wn(_),_=P-_,Mo(d,_<0?0:_,P)):[]}function Ku(d,_){return d&&d.length?pd(d,tn(_,3),!1,!0):[]}function Td(d,_){return d&&d.length?pd(d,tn(_,3)):[]}var px=Jt(function(d){return tl(W(d,1,qr,!0))}),mx=Jt(function(d){var _=fo(d);return qr(_)&&(_=c),tl(W(d,1,qr,!0),tn(_,2))}),_x=Jt(function(d){var _=fo(d);return _=typeof _=="function"?_:c,tl(W(d,1,qr,!0),c,_)});function gx(d){return d&&d.length?tl(d):[]}function yx(d,_){return d&&d.length?tl(d,tn(_,2)):[]}function vx(d,_){return _=typeof _=="function"?_:c,d&&d.length?tl(d,c,_):[]}function Hm(d){if(!(d&&d.length))return[];var _=0;return d=gn(d,function(C){if(qr(C))return _=Sr(C.length,_),!0}),Pl(_,function(C){return tr(d,kl(C))})}function Yf(d,_){if(!(d&&d.length))return[];var C=Hm(d);return _==null?C:tr(C,function(P){return yi(_,c,P)})}var xx=Jt(function(d,_){return qr(d)?k(d,_):[]}),Yc=Jt(function(d){return Rf(gn(d,qr))}),wx=Jt(function(d){var _=fo(d);return qr(_)&&(_=c),Rf(gn(d,qr),tn(_,2))}),br=Jt(function(d){var _=fo(d);return _=typeof _=="function"?_:c,Rf(gn(d,qr),c,_)}),ep=Jt(Hm);function ty(d,_){return Cm(d||[],_||[],Wl)}function tp(d,_){return Cm(d||[],_||[],Ai)}var np=Jt(function(d){var _=d.length,C=_>1?d[_-1]:c;return C=typeof C=="function"?(d.pop(),C):c,Yf(d,C)});function eh(d){var _=K(d);return _.__chain__=!0,_}function ny(d,_){return _(d),d}function Dd(d,_){return _(d)}var Sd=ya(function(d){var _=d.length,C=_?d[0]:0,P=this.__wrapped__,q=function(Q){return p(Q,d)};return _>1||this.__actions__.length||!(P instanceof An)||!va(C)?this.thru(q):(P=P.slice(C,+C+(_?1:0)),P.__actions__.push({func:Dd,args:[q],thisArg:c}),new Li(P,this.__chain__).thru(function(Q){return _&&!Q.length&&Q.push(c),Q}))});function $m(){return eh(this)}function Wm(){return new Li(this.value(),this.__chain__)}function Ax(){this.__values__===c&&(this.__values__=Ju(this.value()));var d=this.__index__>=this.__values__.length,_=d?c:this.__values__[this.__index__++];return{done:d,value:_}}function ry(){return this}function Id(d){for(var _,C=this;C instanceof Nr;){var P=xa(C);P.__index__=0,P.__values__=c,_?q.__wrapped__=P:_=P;var q=P;C=C.__wrapped__}return q.__wrapped__=d,_}function bx(){var d=this.__wrapped__;if(d instanceof An){var _=d;return this.__actions__.length&&(_=new An(this)),_=_.reverse(),_.__actions__.push({func:Dd,args:[Xf],thisArg:c}),new Li(_,this.__chain__)}return this.thru(Xf)}function Km(){return bm(this.__wrapped__,this.__actions__)}var Cx=Jl(function(d,_,C){qn.call(d,C)?++d[C]:l(d,C,1)});function Zm(d,_,C){var P=yn(d)?Eo:V;return C&&Ur(d,_,C)&&(_=c),P(d,tn(_,3))}function Jm(d,_){var C=yn(d)?gn:Y;return C(d,tn(_,3))}var rp=Sg(Qc),Ex=Sg(us);function Bx(d,_){return W(op(d,_),1)}function Tx(d,_){return W(op(d,_),fr)}function Dx(d,_,C){return C=C===c?1:wn(C),W(op(d,_),C)}function iy(d,_){var C=yn(d)?vi:L;return C(d,tn(_,3))}function oy(d,_){var C=yn(d)?Kh:G;return C(d,tn(_,3))}var ip=Jl(function(d,_,C){qn.call(d,C)?d[C].push(_):l(d,C,[_])});function Sx(d,_,C,P){d=_o(d)?d:ou(d),C=C&&!P?wn(C):0;var q=d.length;return C<0&&(C=Sr(q+C,0)),hp(d)?C<=q&&d.indexOf(_,C)>-1:!!q&&To(d,_,C)>-1}var sy=Jt(function(d,_,C){var P=-1,q=typeof _=="function",Q=_o(d)?Ue(d.length):[];return L(d,function(he){Q[++P]=q?yi(_,he,C):Me(he,_,C)}),Q}),th=Jl(function(d,_,C){l(d,C,_)});function op(d,_){var C=yn(d)?tr:Mr;return C(d,tn(_,3))}function Ix(d,_,C,P){return d==null?[]:(yn(_)||(_=_==null?[]:[_]),C=P?c:C,yn(C)||(C=C==null?[]:[C]),vr(d,_,C))}var Mx=Jl(function(d,_,C){d[C?0:1].push(_)},function(){return[[],[]]});function ay(d,_,C){var P=yn(d)?xc:Qh,q=arguments.length<3;return P(d,tn(_,4),C,q,L)}function ly(d,_,C){var P=yn(d)?wc:Qh,q=arguments.length<3;return P(d,tn(_,4),C,q,G)}function kx(d,_){var C=yn(d)?gn:Y;return C(d,up(tn(_,3)))}function Px(d){var _=yn(d)?fd:os;return _(d)}function Lx(d,_,C){(C?Ur(d,_,C):_===c)?_=1:_=wn(_);var P=yn(d)?kf:fa;return P(d,_)}function Xm(d){var _=yn(d)?Pf:Bg;return _(d)}function sp(d){if(d==null)return 0;if(_o(d))return hp(d)?Rl(d):d.length;var _=ai(d);return _==sn||_==Ii?d.size:Fn(d).length}function ap(d,_,C){var P=yn(d)?Du:Tg;return C&&Ur(d,_,C)&&(_=c),P(d,tn(_,3))}var zx=Jt(function(d,_){if(d==null)return[];var C=_.length;return C>1&&Ur(d,_[0],_[1])?_=[]:C>2&&Ur(_[0],_[1],_[2])&&(_=[_[0]]),vr(d,W(_,1),[])}),lp=ji||function(){return mr.Date.now()};function Md(d,_){if(typeof _!="function")throw new Pi(F);return d=wn(d),function(){if(--d<1)return _.apply(this,arguments)}}function nh(d,_,C){return _=C?c:_,_=d&&_==null?d.length:_,si(d,ft,c,c,c,c,_)}function Qm(d,_){var C;if(typeof _!="function")throw new Pi(F);return d=wn(d),function(){return--d>0&&(C=_.apply(this,arguments)),d<=1&&(_=c),C}}var Zu=Jt(function(d,_,C){var P=Vt;if(C.length){var q=Xo(C,$c(Zu));P|=Ie}return si(d,P,_,C,q)}),Ym=Jt(function(d,_,C){var P=Vt|be;if(C.length){var q=Xo(C,$c(Ym));P|=Ie}return si(_,P,d,C,q)});function uy(d,_,C){_=C?c:_;var P=si(d,Be,c,c,c,c,c,_);return P.placeholder=uy.placeholder,P}function e_(d,_,C){_=C?c:_;var P=si(d,Xe,c,c,c,c,c,_);return P.placeholder=e_.placeholder,P}function t_(d,_,C){var P,q,Q,he,xe,ke,nt=0,rt=!1,it=!1,At=!0;if(typeof d!="function")throw new Pi(F);_=cs(_)||0,Cr(C)&&(rt=!!C.leading,it="maxWait"in C,Q=it?Sr(cs(C.maxWait)||0,_):Q,At="trailing"in C?!!C.trailing:At);function Rt(zr){var hs=P,Ta=q;return P=q=c,nt=zr,he=d.apply(Ta,hs),he}function Kt(zr){return nt=zr,xe=Wu(Bn,_),rt?Rt(zr):he}function pn(zr){var hs=zr-ke,Ta=zr-nt,A_=_-hs;return it?Ir(A_,Q-Ta):A_}function nn(zr){var hs=zr-ke,Ta=zr-nt;return ke===c||hs>=_||hs<0||it&&Ta>=Q}function Bn(){var zr=lp();if(nn(zr))return Mn(zr);xe=Wu(Bn,pn(zr))}function Mn(zr){return xe=c,At&&P?Rt(zr):(P=q=c,he)}function go(){xe!==c&&Bm(xe),nt=0,P=ke=q=xe=c}function bi(){return xe===c?he:Mn(lp())}function Ro(){var zr=lp(),hs=nn(zr);if(P=arguments,q=this,ke=zr,hs){if(xe===c)return Kt(ke);if(it)return Bm(xe),xe=Wu(Bn,_),Rt(ke)}return xe===c&&(xe=Wu(Bn,_)),he}return Ro.cancel=go,Ro.flush=bi,Ro}var cy=Jt(function(d,_){return S(d,1,_)}),hy=Jt(function(d,_,C){return S(d,cs(_)||0,C)});function dy(d){return si(d,Et)}function kd(d,_){if(typeof d!="function"||_!=null&&typeof _!="function")throw new Pi(F);var C=function(){var P=arguments,q=_?_.apply(this,P):P[0],Q=C.cache;if(Q.has(q))return Q.get(q);var he=d.apply(this,P);return C.cache=Q.set(q,he)||Q,he};return C.cache=new(kd.Cache||rs),C}kd.Cache=rs;function up(d){if(typeof d!="function")throw new Pi(F);return function(){var _=arguments;switch(_.length){case 0:return!d.call(this);case 1:return!d.call(this,_[0]);case 2:return!d.call(this,_[0],_[1]);case 3:return!d.call(this,_[0],_[1],_[2])}return!d.apply(this,_)}}function Fx(d){return Qm(2,d)}var fy=Vc(function(d,_){_=_.length==1&&yn(_[0])?tr(_[0],xi(tn())):tr(W(_,1),xi(tn()));var C=_.length;return Jt(function(P){for(var q=-1,Q=Ir(P.length,C);++q<Q;)P[q]=_[q].call(this,P[q]);return yi(d,this,P)})}),rh=Jt(function(d,_){var C=Xo(_,$c(rh));return si(d,Ie,c,_,C)}),n_=Jt(function(d,_){var C=Xo(_,$c(n_));return si(d,at,c,_,C)}),Oi=ya(function(d,_){return si(d,Ct,c,c,c,_)});function Pd(d,_){if(typeof d!="function")throw new Pi(F);return _=_===c?_:wn(_),Jt(d,_)}function ih(d,_){if(typeof d!="function")throw new Pi(F);return _=_==null?0:Sr(wn(_),0),Jt(function(C){var P=C[_],q=nl(C,0,_);return P&&Bo(q,P),yi(d,this,q)})}function Ld(d,_,C){var P=!0,q=!0;if(typeof d!="function")throw new Pi(F);return Cr(C)&&(P="leading"in C?!!C.leading:P,q="trailing"in C?!!C.trailing:q),t_(d,_,{leading:P,maxWait:_,trailing:q})}function py(d){return nh(d,1)}function my(d,_){return rh(Em(_),d)}function Rx(){if(!arguments.length)return[];var d=arguments[0];return yn(d)?d:[d]}function Ox(d){return x(d,$e)}function Gx(d,_){return _=typeof _=="function"?_:c,x(d,$e,_)}function Nx(d){return x(d,we|$e)}function Ux(d,_){return _=typeof _=="function"?_:c,x(d,we|$e,_)}function qx(d,_){return _==null||T(d,_,ui(_))}function mo(d,_){return d===_||d!==d&&_!==_}var jx=Ls(Oe),_y=Ls(function(d,_){return d>=_}),nu=ve(function(){return arguments}())?ve:function(d){return Lr(d)&&qn.call(d,"callee")&&!la.call(d,"callee")},yn=Ue.isArray,Vx=Hh?xi(Hh):pt;function _o(d){return d!=null&&iu(d.length)&&!ol(d)}function qr(d){return Lr(d)&&_o(d)}function Hx(d){return d===!0||d===!1||Lr(d)&&Ee(d)==ar}var ru=wf||bp,gy=gc?xi(gc):ut;function $x(d){return Lr(d)&&d.nodeType===1&&!ba(d)}function li(d){if(d==null)return!0;if(_o(d)&&(yn(d)||typeof d=="string"||typeof d.splice=="function"||ru(d)||lh(d)||nu(d)))return!d.length;var _=ai(d);if(_==sn||_==Ii)return!d.size;if(Kc(d))return!Fn(d).length;for(var C in d)if(qn.call(d,C))return!1;return!0}function wa(d,_){return dt(d,_)}function r_(d,_,C){C=typeof C=="function"?C:c;var P=C?C(d,_):c;return P===c?dt(d,_,c,C):!!P}function oh(d){if(!Lr(d))return!1;var _=Ee(d);return _==Fa||_==Ui||typeof d.message=="string"&&typeof d.name=="string"&&!ba(d)}function sh(d){return typeof d=="number"&&Fu(d)}function ol(d){if(!Cr(d))return!1;var _=Ee(d);return _==er||_==Qi||_==St||_==vu}function yy(d){return typeof d=="number"&&d==wn(d)}function iu(d){return typeof d=="number"&&d>-1&&d%1==0&&d<=xt}function Cr(d){var _=typeof d;return d!=null&&(_=="object"||_=="function")}function Lr(d){return d!=null&&typeof d=="object"}var ah=$h?xi($h):Tt;function vy(d,_){return d===_||Ht(d,_,Lm(_))}function xy(d,_,C){return C=typeof C=="function"?C:c,Ht(d,_,Lm(_),C)}function Wn(d){return Aa(d)&&d!=+d}function i_(d){if(zg(d))throw new hn(D);return Gt(d)}function wy(d){return d===null}function Ay(d){return d==null}function Aa(d){return typeof d=="number"||Lr(d)&&Ee(d)==fi}function ba(d){if(!Lr(d)||Ee(d)!=Jr)return!1;var _=aa(d);if(_===null)return!0;var C=qn.call(_,"constructor")&&_.constructor;return typeof C=="function"&&C instanceof C&&Cs.call(C)==gm}var cp=yc?xi(yc):kt;function Wx(d){return yy(d)&&d>=-xt&&d<=xt}var by=vc?xi(vc):ht;function hp(d){return typeof d=="string"||!yn(d)&&Lr(d)&&Ee(d)==Gr}function zo(d){return typeof d=="symbol"||Lr(d)&&Ee(d)==bo}var lh=ra?xi(ra):Yt;function Kx(d){return d===c}function Zx(d){return Lr(d)&&ai(d)==ws}function Jx(d){return Lr(d)&&Ee(d)==vl}var Xx=Ls(Dn),dp=Ls(function(d,_){return d<=_});function Ju(d){if(!d)return[];if(_o(d))return hp(d)?qi(d):uo(d);if(Es&&d[Es])return nd(d[Es]());var _=ai(d),C=_==sn?Fl:_==Ii?Tc:ou;return C(d)}function Ca(d){if(!d)return d===0?d:0;if(d=cs(d),d===fr||d===-fr){var _=d<0?-1:1;return _*Qt}return d===d?d:0}function wn(d){var _=Ca(d),C=_%1;return _===_?C?_-C:_:0}function Cy(d){return d?g(wn(d),0,_n):0}function cs(d){if(typeof d=="number")return d;if(zo(d))return Mt;if(Cr(d)){var _=typeof d.valueOf=="function"?d.valueOf():d;d=Cr(_)?_+"":_}if(typeof d!="string")return d===0?d:+d;d=Mu(d);var C=Ft.test(d);return C||Wt.test(d)?$a(d.slice(2),C?2:8):Nt.test(d)?Mt:+d}function fp(d){return ma(d,$i(d))}function o_(d){return d?g(wn(d),-xt,xt):d===0?d:0}function Kn(d){return d==null?"":lo(d)}var Fo=Ps(function(d,_){if(Kc(_)||_o(_)){ma(_,ui(_),d);return}for(var C in _)qn.call(_,C)&&Wl(d,C,_[C])}),uh=Ps(function(d,_){ma(_,$i(_),d)}),sl=Ps(function(d,_,C,P){ma(_,$i(_),d,P)}),s_=Ps(function(d,_,C,P){ma(_,ui(_),d,P)}),pp=ya(p);function Qx(d,_){var C=ha(d);return _==null?C:h(C,_)}var Ey=Jt(function(d,_){d=Yn(d);var C=-1,P=_.length,q=P>2?_[2]:c;for(q&&Ur(_[0],_[1],q)&&(P=1);++C<P;)for(var Q=_[C],he=$i(Q),xe=-1,ke=he.length;++xe<ke;){var nt=he[xe],rt=d[nt];(rt===c||mo(rt,sa[nt])&&!qn.call(d,nt))&&(d[nt]=Q[nt])}return d}),By=Jt(function(d){return d.push(c,ko),yi(u_,c,d)});function Yx(d,_){return Wa(d,tn(_,3),J)}function Ty(d,_){return Wa(d,tn(_,3),le)}function Dy(d,_){return d==null?d:$(d,tn(_,3),$i)}function a_(d,_){return d==null?d:te(d,tn(_,3),$i)}function l_(d,_){return d&&J(d,tn(_,3))}function Sy(d,_){return d&&le(d,tn(_,3))}function e1(d){return d==null?[]:ue(d,ui(d))}function Iy(d){return d==null?[]:ue(d,$i(d))}function Gs(d,_,C){var P=d==null?c:oe(d,_);return P===c?C:P}function My(d,_){return d!=null&&zm(d,_,Le)}function mp(d,_){return d!=null&&zm(d,_,tt)}var ky=yd(function(d,_,C){_!=null&&typeof _.toString!="function"&&(_=oo.call(_)),d[_]=C},Gd(Wi)),Py=yd(function(d,_,C){_!=null&&typeof _.toString!="function"&&(_=oo.call(_)),qn.call(d,_)?d[_].push(C):d[_]=[C]},tn),t1=Jt(Me);function ui(d){return _o(d)?qu(d):Fn(d)}function $i(d){return _o(d)?qu(d,!0):Nn(d)}function Ly(d,_){var C={};return _=tn(_,3),J(d,function(P,q,Q){l(C,_(P,q,Q),P)}),C}function zd(d,_){var C={};return _=tn(_,3),J(d,function(P,q,Q){l(C,q,_(P,q,Q))}),C}var zy=Ps(function(d,_,C){Un(d,_,C)}),u_=Ps(function(d,_,C,P){Un(d,_,C,P)}),c_=ya(function(d,_){var C={};if(d==null)return C;var P=!1;_=tr(_,function(Q){return Q=Zl(Q,d),P||(P=Q.length>1),Q}),ma(d,xd(d),C),P&&(C=x(C,we|Ae|$e,Po));for(var q=_.length;q--;)Ff(C,_[q]);return C});function ch(d,_){return Fd(d,up(tn(_)))}var Fy=ya(function(d,_){return d==null?{}:oi(d,_)});function Fd(d,_){if(d==null)return{};var C=tr(xd(d),function(P){return[P]});return _=tn(_),jn(d,C,function(P,q){return _(P,q[0])})}function Ry(d,_,C){_=Zl(_,d);var P=-1,q=_.length;for(q||(q=1,d=c);++P<q;){var Q=d==null?c:d[Rs(_[P])];Q===c&&(P=q,Q=C),d=ol(Q)?Q.call(d):Q}return d}function _p(d,_,C){return d==null?d:Ai(d,_,C)}function gp(d,_,C,P){return P=typeof P=="function"?P:c,d==null?d:Ai(d,_,C,P)}var Oy=qf(ui),Gy=qf($i);function n1(d,_,C){var P=yn(d),q=P||ru(d)||lh(d);if(_=tn(_,4),C==null){var Q=d&&d.constructor;q?C=P?new Q:[]:Cr(d)?C=ol(Q)?ha(aa(d)):{}:C={}}return(q?vi:J)(d,function(he,xe,ke){return _(C,he,xe,ke)}),C}function r1(d,_){return d==null?!0:Ff(d,_)}function i1(d,_,C){return d==null?d:Am(d,_,Em(C))}function hh(d,_,C,P){return P=typeof P=="function"?P:c,d==null?d:Am(d,_,Em(C),P)}function ou(d){return d==null?[]:Cc(d,ui(d))}function o1(d){return d==null?[]:Cc(d,$i(d))}function Ny(d,_,C){return C===c&&(C=_,_=c),C!==c&&(C=cs(C),C=C===C?C:0),_!==c&&(_=cs(_),_=_===_?_:0),g(cs(d),_,C)}function s1(d,_,C){return _=Ca(_),C===c?(C=_,_=0):C=Ca(C),d=cs(d),Ce(d,_,C)}function h_(d,_,C){if(C&&typeof C!="boolean"&&Ur(d,_,C)&&(_=C=c),C===c&&(typeof _=="boolean"?(C=_,_=c):typeof d=="boolean"&&(C=d,d=c)),d===c&&_===c?(d=0,_=1):(d=Ca(d),_===c?(_=d,d=0):_=Ca(_)),d>_){var P=d;d=_,_=P}if(C||d%1||_%1){var q=Ru();return Ir(d+q*(_-d+pf("1e-"+((q+"").length-1))),_)}return Yr(d,_)}var a1=as(function(d,_,C){return _=_.toLowerCase(),d+(C?al(_):_)});function al(d){return su(Kn(d).toLowerCase())}function d_(d){return d=Kn(d),d&&d.replace(Tn,Ec).replace(Cu,"")}function Uy(d,_,C){d=Kn(d),_=lo(_);var P=d.length;C=C===c?P:g(wn(C),0,P);var q=C;return C-=_.length,C>=0&&d.slice(C,q)==_}function yp(d){return d=Kn(d),d&&bl.test(d)?d.replace(Na,Bc):d}function f_(d){return d=Kn(d),d&&j.test(d)?d.replace(O,"\\$&"):d}var l1=as(function(d,_,C){return d+(C?"-":"")+_.toLowerCase()}),u1=as(function(d,_,C){return d+(C?" ":"")+_.toLowerCase()}),qy=rl("toLowerCase");function jy(d,_,C){d=Kn(d),_=wn(_);var P=_?Rl(d):0;if(!_||P>=_)return d;var q=(_-P)/2;return Uf(Vl(q),C)+d+Uf(zu(q),C)}function Rd(d,_,C){d=Kn(d),_=wn(_);var P=_?Rl(d):0;return _&&P<_?d+Uf(_-P,C):d}function ll(d,_,C){d=Kn(d),_=wn(_);var P=_?Rl(d):0;return _&&P<_?Uf(_-P,C)+d:d}function p_(d,_,C){return C||_==null?_=0:_&&(_=+_),Vi(Kn(d).replace(ee,""),_||0)}function dh(d,_,C){return(C?Ur(d,_,C):_===c)?_=1:_=wn(_),is(Kn(d),_)}function fh(){var d=arguments,_=Kn(d[0]);return d.length<3?_:_.replace(d[1],d[2])}var Ns=as(function(d,_,C){return d+(C?"_":"")+_.toLowerCase()});function Us(d,_,C){return C&&typeof C!="number"&&Ur(d,_,C)&&(_=C=c),C=C===c?_n:C>>>0,C?(d=Kn(d),d&&(typeof _=="string"||_!=null&&!cp(_))&&(_=lo(_),!_&&Ka(d))?nl(qi(d),0,C):d.split(_,C)):[]}var c1=as(function(d,_,C){return d+(C?" ":"")+su(_)});function Vy(d,_,C){return d=Kn(d),C=C==null?0:g(wn(C),0,d.length),_=lo(_),d.slice(C,C+_.length)==_}function h1(d,_,C){var P=K.templateSettings;C&&Ur(d,_,C)&&(_=c),d=Kn(d),_=sl({},_,P,zs);var q=sl({},_.imports,P.imports,zs),Q=ui(q),he=Cc(q,Q),xe,ke,nt=0,rt=_.interpolate||Ut,it="__p += '",At=Mc((_.escape||Ut).source+"|"+rt.source+"|"+(rt===Ys?yt:Ut).source+"|"+(_.evaluate||Ut).source+"|$","g"),Rt="//# sourceURL="+(qn.call(_,"sourceURL")?(_.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ko+"]")+`
`;d.replace(At,function(nn,Bn,Mn,go,bi,Ro){return Mn||(Mn=go),it+=d.slice(nt,Ro).replace(Gn,Jo),Bn&&(xe=!0,it+=`' +
__e(`+Bn+`) +
'`),bi&&(ke=!0,it+=`';
`+bi+`;
__p += '`),Mn&&(it+=`' +
((__t = (`+Mn+`)) == null ? '' : __t) +
'`),nt=Ro+nn.length,nn}),it+=`';
`;var Kt=qn.call(_,"variable")&&_.variable;if(!Kt)it=`with (obj) {
`+it+`
}
`;else if(Pe.test(Kt))throw new hn(s);it=(ke?it.replace(Qs,""):it).replace(wl,"$1").replace(Al,"$1;"),it="function("+(Kt||"obj")+`) {
`+(Kt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(xe?", __e = _.escape":"")+(ke?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+it+`return __p
}`;var pn=mh(function(){return zn(Q,Rt+"return "+it).apply(c,he)});if(pn.source=it,oh(pn))throw pn;return pn}function m_(d){return Kn(d).toLowerCase()}function Ea(d){return Kn(d).toUpperCase()}function Xu(d,_,C){if(d=Kn(d),d&&(C||_===c))return Mu(d);if(!d||!(_=lo(_)))return d;var P=qi(d),q=qi(_),Q=Ll(P,q),he=zl(P,q)+1;return nl(P,Q,he).join("")}function Hy(d,_,C){if(d=Kn(d),d&&(C||_===c))return d.slice(0,yf(d)+1);if(!d||!(_=lo(_)))return d;var P=qi(d),q=zl(P,qi(_))+1;return nl(P,0,q).join("")}function $y(d,_,C){if(d=Kn(d),d&&(C||_===c))return d.replace(ee,"");if(!d||!(_=lo(_)))return d;var P=qi(d),q=Ll(P,qi(_));return nl(P,q).join("")}function d1(d,_){var C=Ot,P=dr;if(Cr(_)){var q="separator"in _?_.separator:q;C="length"in _?wn(_.length):C,P="omission"in _?lo(_.omission):P}d=Kn(d);var Q=d.length;if(Ka(d)){var he=qi(d);Q=he.length}if(C>=Q)return d;var xe=C-Rl(P);if(xe<1)return P;var ke=he?nl(he,0,xe).join(""):d.slice(0,xe);if(q===c)return ke+P;if(he&&(xe+=ke.length-xe),cp(q)){if(d.slice(xe).search(q)){var nt,rt=ke;for(q.global||(q=Mc(q.source,Kn(et.exec(q))+"g")),q.lastIndex=0;nt=q.exec(rt);)var it=nt.index;ke=ke.slice(0,it===c?xe:it)}}else if(d.indexOf(lo(q),xe)!=xe){var At=ke.lastIndexOf(q);At>-1&&(ke=ke.slice(0,At))}return ke+P}function vp(d){return d=Kn(d),d&&pc.test(d)?d.replace(to,Sc):d}var __=as(function(d,_,C){return d+(C?" ":"")+_.toUpperCase()}),su=rl("toUpperCase");function ph(d,_,C){return d=Kn(d),_=C?c:_,_===c?td(d)?od(d):oa(d):d.match(_)||[]}var mh=Jt(function(d,_){try{return yi(d,c,_)}catch(C){return oh(C)?C:new hn(C)}}),xp=ya(function(d,_){return vi(_,function(C){C=Rs(C),l(d,C,Zu(d[C],d))}),d});function Wy(d){var _=d==null?0:d.length,C=tn();return d=_?tr(d,function(P){if(typeof P[1]!="function")throw new Pi(F);return[C(P[0]),P[1]]}):[],Jt(function(P){for(var q=-1;++q<_;){var Q=d[q];if(yi(Q[0],this,P))return yi(Q[1],this,P)}})}function Od(d){return b(x(d,we))}function Gd(d){return function(){return d}}function Ky(d,_){return d==null||d!==d?_:d}var _h=Ig(),Zy=Ig(!0);function Wi(d){return d}function g_(d){return on(typeof d=="function"?d:x(d,we))}function f1(d){return ii(x(d,we))}function Jy(d,_){return Io(d,x(_,we))}var Qu=Jt(function(d,_){return function(C){return Me(C,d,_)}}),p1=Jt(function(d,_){return function(C){return Me(d,C,_)}});function Ba(d,_,C){var P=ui(_),q=ue(_,P);C==null&&!(Cr(_)&&(q.length||!P.length))&&(C=_,_=d,d=this,q=ue(_,ui(_)));var Q=!(Cr(C)&&"chain"in C)||!!C.chain,he=ol(d);return vi(q,function(xe){var ke=_[xe];d[xe]=ke,he&&(d.prototype[xe]=function(){var nt=this.__chain__;if(Q||nt){var rt=d(this.__wrapped__),it=rt.__actions__=uo(this.__actions__);return it.push({func:ke,args:arguments,thisArg:d}),rt.__chain__=nt,rt}return ke.apply(d,Bo([this.value()],arguments))})}),d}function m1(){return mr._===this&&(mr._=xf),this}function Yu(){}function Nd(d){return d=wn(d),Jt(function(_){return Sn(_,d)})}var Ud=Pm(tr),qd=Pm(Eo),wp=Pm(Du);function Xy(d){return Hf(d)?kl(Rs(d)):zi(d)}function _1(d){return function(_){return d==null?c:oe(d,_)}}var gh=$t(),Ap=$t(!0);function y_(){return[]}function bp(){return!1}function Qy(){return{}}function g1(){return""}function Yy(){return!0}function y1(d,_){if(d=wn(d),d<1||d>xt)return[];var C=_n,P=Ir(d,_n);_=tn(_),d-=_n;for(var q=Pl(P,_);++C<d;)_(C);return q}function e0(d){return yn(d)?tr(d,Rs):zo(d)?[d]:uo(Jf(Kn(d)))}function v1(d){var _=++Yo;return Kn(d)+_}var t0=co(function(d,_){return d+_},0),x1=bn("ceil"),w1=co(function(d,_){return d/_},1),Cp=bn("floor");function Ep(d){return d&&d.length?X(d,Wi,Oe):c}function Bp(d,_){return d&&d.length?X(d,tn(_,2),Oe):c}function A1(d){return Xh(d,Wi)}function v_(d,_){return Xh(d,tn(_,2))}function x_(d){return d&&d.length?X(d,Wi,Dn):c}function au(d,_){return d&&d.length?X(d,tn(_,2),Dn):c}var b1=co(function(d,_){return d*_},1),w_=bn("round"),n0=co(function(d,_){return d-_},0);function Tp(d){return d&&d.length?Iu(d,Wi):0}function C1(d,_){return d&&d.length?Iu(d,tn(_,2)):0}return K.after=Md,K.ary=nh,K.assign=Fo,K.assignIn=uh,K.assignInWith=sl,K.assignWith=s_,K.at=pp,K.before=Qm,K.bind=Zu,K.bindAll=xp,K.bindKey=Ym,K.castArray=Rx,K.chain=eh,K.chunk=Gm,K.compact=Ng,K.concat=bd,K.cond=Wy,K.conforms=Od,K.constant=Gd,K.countBy=Cx,K.create=Qx,K.curry=uy,K.curryRight=e_,K.debounce=t_,K.defaults=Ey,K.defaultsDeep=By,K.defer=cy,K.delay=hy,K.difference=Cd,K.differenceBy=Lo,K.differenceWith=Ed,K.drop=Fi,K.dropRight=ls,K.dropRightWhile=Nm,K.dropWhile=Pr,K.fill=Ug,K.filter=Jm,K.flatMap=Bx,K.flatMapDeep=Tx,K.flatMapDepth=Dx,K.flatten=qg,K.flattenDeep=sx,K.flattenDepth=jg,K.flip=dy,K.flow=_h,K.flowRight=Zy,K.fromPairs=Vg,K.functions=e1,K.functionsIn=Iy,K.groupBy=ip,K.initial=$g,K.intersection=Wg,K.intersectionBy=Kg,K.intersectionWith=ax,K.invert=ky,K.invertBy=Py,K.invokeMap=sy,K.iteratee=g_,K.keyBy=th,K.keys=ui,K.keysIn=$i,K.map=op,K.mapKeys=Ly,K.mapValues=zd,K.matches=f1,K.matchesProperty=Jy,K.memoize=kd,K.merge=zy,K.mergeWith=u_,K.method=Qu,K.methodOf=p1,K.mixin=Ba,K.negate=up,K.nthArg=Nd,K.omit=c_,K.omitBy=ch,K.once=Fx,K.orderBy=Ix,K.over=Ud,K.overArgs=fy,K.overEvery=qd,K.overSome=wp,K.partial=rh,K.partialRight=n_,K.partition=Mx,K.pick=Fy,K.pickBy=Fd,K.property=Xy,K.propertyOf=_1,K.pull=Zg,K.pullAll=Jg,K.pullAllBy=Xg,K.pullAllWith=lx,K.pullAt=ux,K.range=gh,K.rangeRight=Ap,K.rearg=Oi,K.reject=kx,K.remove=Qg,K.rest=Pd,K.reverse=Xf,K.sampleSize=Lx,K.set=_p,K.setWith=gp,K.shuffle=Xm,K.slice=Yg,K.sortBy=zx,K.sortedUniq=dx,K.sortedUniqBy=fx,K.split=Us,K.spread=ih,K.tail=Bd,K.take=Qf,K.takeRight=ey,K.takeRightWhile=Ku,K.takeWhile=Td,K.tap=ny,K.throttle=Ld,K.thru=Dd,K.toArray=Ju,K.toPairs=Oy,K.toPairsIn=Gy,K.toPath=e0,K.toPlainObject=fp,K.transform=n1,K.unary=py,K.union=px,K.unionBy=mx,K.unionWith=_x,K.uniq=gx,K.uniqBy=yx,K.uniqWith=vx,K.unset=r1,K.unzip=Hm,K.unzipWith=Yf,K.update=i1,K.updateWith=hh,K.values=ou,K.valuesIn=o1,K.without=xx,K.words=ph,K.wrap=my,K.xor=Yc,K.xorBy=wx,K.xorWith=br,K.zip=ep,K.zipObject=ty,K.zipObjectDeep=tp,K.zipWith=np,K.entries=Oy,K.entriesIn=Gy,K.extend=uh,K.extendWith=sl,Ba(K,K),K.add=t0,K.attempt=mh,K.camelCase=a1,K.capitalize=al,K.ceil=x1,K.clamp=Ny,K.clone=Ox,K.cloneDeep=Nx,K.cloneDeepWith=Ux,K.cloneWith=Gx,K.conformsTo=qx,K.deburr=d_,K.defaultTo=Ky,K.divide=w1,K.endsWith=Uy,K.eq=mo,K.escape=yp,K.escapeRegExp=f_,K.every=Zm,K.find=rp,K.findIndex=Qc,K.findKey=Yx,K.findLast=Ex,K.findLastIndex=us,K.findLastKey=Ty,K.floor=Cp,K.forEach=iy,K.forEachRight=oy,K.forIn=Dy,K.forInRight=a_,K.forOwn=l_,K.forOwnRight=Sy,K.get=Gs,K.gt=jx,K.gte=_y,K.has=My,K.hasIn=mp,K.head=tu,K.identity=Wi,K.includes=Sx,K.indexOf=Hg,K.inRange=s1,K.invoke=t1,K.isArguments=nu,K.isArray=yn,K.isArrayBuffer=Vx,K.isArrayLike=_o,K.isArrayLikeObject=qr,K.isBoolean=Hx,K.isBuffer=ru,K.isDate=gy,K.isElement=$x,K.isEmpty=li,K.isEqual=wa,K.isEqualWith=r_,K.isError=oh,K.isFinite=sh,K.isFunction=ol,K.isInteger=yy,K.isLength=iu,K.isMap=ah,K.isMatch=vy,K.isMatchWith=xy,K.isNaN=Wn,K.isNative=i_,K.isNil=Ay,K.isNull=wy,K.isNumber=Aa,K.isObject=Cr,K.isObjectLike=Lr,K.isPlainObject=ba,K.isRegExp=cp,K.isSafeInteger=Wx,K.isSet=by,K.isString=hp,K.isSymbol=zo,K.isTypedArray=lh,K.isUndefined=Kx,K.isWeakMap=Zx,K.isWeakSet=Jx,K.join=Um,K.kebabCase=l1,K.last=fo,K.lastIndexOf=qm,K.lowerCase=u1,K.lowerFirst=qy,K.lt=Xx,K.lte=dp,K.max=Ep,K.maxBy=Bp,K.mean=A1,K.meanBy=v_,K.min=x_,K.minBy=au,K.stubArray=y_,K.stubFalse=bp,K.stubObject=Qy,K.stubString=g1,K.stubTrue=Yy,K.multiply=b1,K.nth=Ri,K.noConflict=m1,K.noop=Yu,K.now=lp,K.pad=jy,K.padEnd=Rd,K.padStart=ll,K.parseInt=p_,K.random=h_,K.reduce=ay,K.reduceRight=ly,K.repeat=dh,K.replace=fh,K.result=Ry,K.round=w_,K.runInContext=Se,K.sample=Px,K.size=sp,K.snakeCase=Ns,K.some=ap,K.sortedIndex=jm,K.sortedIndexBy=il,K.sortedIndexOf=po,K.sortedLastIndex=cx,K.sortedLastIndexBy=Vm,K.sortedLastIndexOf=hx,K.startCase=c1,K.startsWith=Vy,K.subtract=n0,K.sum=Tp,K.sumBy=C1,K.template=h1,K.times=y1,K.toFinite=Ca,K.toInteger=wn,K.toLength=Cy,K.toLower=m_,K.toNumber=cs,K.toSafeInteger=o_,K.toString=Kn,K.toUpper=Ea,K.trim=Xu,K.trimEnd=Hy,K.trimStart=$y,K.truncate=d1,K.unescape=vp,K.uniqueId=v1,K.upperCase=__,K.upperFirst=su,K.each=iy,K.eachRight=oy,K.first=tu,Ba(K,function(){var d={};return J(K,function(_,C){qn.call(K.prototype,C)||(d[C]=_)}),d}(),{chain:!1}),K.VERSION=v,vi(["bind","bindKey","curry","curryRight","partial","partialRight"],function(d){K[d].placeholder=K}),vi(["drop","take"],function(d,_){An.prototype[d]=function(C){C=C===c?1:Sr(wn(C),0);var P=this.__filtered__&&!_?new An(this):this.clone();return P.__filtered__?P.__takeCount__=Ir(C,P.__takeCount__):P.__views__.push({size:Ir(C,_n),type:d+(P.__dir__<0?"Right":"")}),P},An.prototype[d+"Right"]=function(C){return this.reverse()[d](C).reverse()}}),vi(["filter","map","takeWhile"],function(d,_){var C=_+1,P=C==hi||C==di;An.prototype[d]=function(q){var Q=this.clone();return Q.__iteratees__.push({iteratee:tn(q,3),type:C}),Q.__filtered__=Q.__filtered__||P,Q}}),vi(["head","last"],function(d,_){var C="take"+(_?"Right":"");An.prototype[d]=function(){return this[C](1).value()[0]}}),vi(["initial","tail"],function(d,_){var C="drop"+(_?"":"Right");An.prototype[d]=function(){return this.__filtered__?new An(this):this[C](1)}}),An.prototype.compact=function(){return this.filter(Wi)},An.prototype.find=function(d){return this.filter(d).head()},An.prototype.findLast=function(d){return this.reverse().find(d)},An.prototype.invokeMap=Jt(function(d,_){return typeof d=="function"?new An(this):this.map(function(C){return Me(C,d,_)})}),An.prototype.reject=function(d){return this.filter(up(tn(d)))},An.prototype.slice=function(d,_){d=wn(d);var C=this;return C.__filtered__&&(d>0||_<0)?new An(C):(d<0?C=C.takeRight(-d):d&&(C=C.drop(d)),_!==c&&(_=wn(_),C=_<0?C.dropRight(-_):C.take(_-d)),C)},An.prototype.takeRightWhile=function(d){return this.reverse().takeWhile(d).reverse()},An.prototype.toArray=function(){return this.take(_n)},J(An.prototype,function(d,_){var C=/^(?:filter|find|map|reject)|While$/.test(_),P=/^(?:head|last)$/.test(_),q=K[P?"take"+(_=="last"?"Right":""):_],Q=P||/^find/.test(_);!q||(K.prototype[_]=function(){var he=this.__wrapped__,xe=P?[1]:arguments,ke=he instanceof An,nt=xe[0],rt=ke||yn(he),it=function(Bn){var Mn=q.apply(K,Bo([Bn],xe));return P&&At?Mn[0]:Mn};rt&&C&&typeof nt=="function"&&nt.length!=1&&(ke=rt=!1);var At=this.__chain__,Rt=!!this.__actions__.length,Kt=Q&&!At,pn=ke&&!Rt;if(!Q&&rt){he=pn?he:new An(this);var nn=d.apply(he,xe);return nn.__actions__.push({func:Dd,args:[it],thisArg:c}),new Li(nn,At)}return Kt&&pn?d.apply(this,xe):(nn=this.thru(it),Kt?P?nn.value()[0]:nn.value():nn)})}),vi(["pop","push","shift","sort","splice","unshift"],function(d){var _=Qo[d],C=/^(?:push|sort|unshift)$/.test(d)?"tap":"thru",P=/^(?:pop|shift)$/.test(d);K.prototype[d]=function(){var q=arguments;if(P&&!this.__chain__){var Q=this.value();return _.apply(yn(Q)?Q:[],q)}return this[C](function(he){return _.apply(yn(he)?he:[],q)})}}),J(An.prototype,function(d,_){var C=K[_];if(C){var P=C.name+"";qn.call(Xa,P)||(Xa[P]=[]),Xa[P].push({name:_,func:C})}}),Xa[gd(c,be).name]=[{name:"wrapper",func:c}],An.prototype.clone=ym,An.prototype.reverse=vm,An.prototype.value=Is,K.prototype.at=Sd,K.prototype.chain=$m,K.prototype.commit=Wm,K.prototype.next=Ax,K.prototype.plant=Id,K.prototype.reverse=bx,K.prototype.toJSON=K.prototype.valueOf=K.prototype.value=Km,K.prototype.first=K.prototype.head,Es&&(K.prototype[Es]=ry),K},Gl=Ol();Zo?((Zo.exports=Gl)._=Gl,Tu._=Gl):mr._=Gl}).call(du)})(dA,dA.exports);const HB=dA.exports,fA=[{text:"To airport",id:"ta"},{text:"From airport",id:"fa"}],HC="1800 425 1663",pu={INITIAL:"INITIAL",LOCATION_TEXT:"LOCATION_TEXT",LOCATION_MAP:"LOCATION_MAP"},b0={PENDING:"PENDING",UNAVAILABLE:"UNAVAILABLE",DENIED:"DENIED",APPROVED:"APPROVED"},Bt={majestic:{name:"Majestic Bus Stand",loc:[12.977529081680132,77.57247169985196]},silk_institute:{name:"Silk Institute Metro Station",loc:[12.862231132000229,77.53020557184188]},airport:{name:"Airport Bus Stand",loc:[13.199110535079635,77.70822021568426]},hal:{name:"HAL Main Gate",loc:[12.958498117866407,77.66518619680876]},whitefield:{name:"Whitefield TTMC",loc:[12.976874051754933,77.72680679219907]},banashankari:{name:"Banashankari TTMC",loc:[12.917668361661741,77.5729031044554]},kadugodi:{name:"Kadugodi Bus Stop",loc:[12.995682104394492,77.75933511787484]},hsr:{name:"HSR BDA Shopping Complex",loc:[12.912696250372736,77.63815235881127]},ecity:{name:"Electronic City Bus Stop",loc:[12.846820291920075,77.67194606999932]},btm:{name:"BTM Layout Kuvempu Nagar TTMC",loc:[12.916077213466505,77.61613653753079]},chandapura:{name:"Chandapura Circle",loc:[12.802273131607688,77.70456150337426]},sarjapur:{name:"Sarjapur Road Wipro Gate",loc:[12.910761671396754,77.68409625549441]},ecity_wipro:{name:"Electronic City Wipro Gate Depot",loc:[12.836107341675932,77.65779655065786]},mysore_road:{name:"Mysore Road Satellite Bus Stand",loc:[12.953555019494152,77.54382623524201]},royal_meenakshi:{name:"Royal Meenakshi Mall",loc:[12.876412761573464,77.59560880964153]},kengeri:{name:"Kengeri Bus Terminal",loc:[12.913656066139644,77.48714794975331]}},$C={to:[{name:"KIA-4",route:"ka`yMg`bnAiA~A}@JGwCHiCVsA|AmCxBgCzDuGxHmMfCwDjAuBL@zDMpi@qDtLiAfNeBfGk@JSb@{CnBiQ\\_HHeDZyMNgFpDDrBB`UTtRVpYVfGFvCIdFUjF[zDGjAjAf@TrAp@`Al@VVvAfCbD|Er@r@dDlBhFjChCvAxCrAlElA|BTbCLBiBAaBF_@@_AIeC_@{CEy@?]B{FD{BMy@Uo@g@_AUOmBe@o@e@y@uBaBcFaAeAsAoAFML_@rAuJHqCM_P?[LUf@YdABtIz@r@j@d@~@r@_@^_@NSn@]xCyAfBqAfBmAx@m@`BcAv@_@pDgBbJkEvB}@bA[zB_@zBm@hAe@~A}@lDcCpCgB`AYtEKh@ExA_@fEgAfDeAzJoClCg@v@I@Sf@gAx@wAzAgEf@wArCaHt@yBh@cCv@aERk@RSrAcApCsAzHyCtQ{Lh@Gl@sBtC{F|JsQnCwE`BiCzA}BlCiDn@i@zCgAvAYvE]bEG~AF`@?ASGwF@k@Aa@OQH_N@sFGsBmA_Hg@aEAg@e@}CsAaIIm@HSEa@WeBk@yCe@}BiBqFu@mCyAsEqE{LYoAM{Ac@eC_CgIK_ACcAMeG?k@M{@QE_AeJg@wCcAaFy@iCu@qBw@iCc@{CMiB[sDoCsH_A_Ci@iBU{A?_@DY{AgJg@cEB_DTcGDcHKkN?{BEcCL{JNsAJuGBoBB_Fb@cN~@i]FkFCyFwAs^SsGEaBu@wEaEkN_BgEcCsHsCoJo@gDOsAu@oIY_BcBuHuBgHuBkHw@cD}BmMaBcK_@eBSo@Yy@o@{B}@uBmE{IyBuEyEgJuHuNiPe[oGqNcEmKaFyMiI_U_@u@u@w@oDqJcCwGi@{AcCuGgCaH{AyEs@_DKeAA}AFqGNQNkDFeTCyAQiEu@kMg@{CW}@}GePkA{CwB_FeBaEy@yAqC}EgFuIwDiFyGqJ_HgK}HeKwFiIc@u@{AuDsFkO}CoImAgDmByFcAgDe@{Am@sAqCeEwBuCu@UcGoJ_Ww_@uKuP_IwLVMKOsHeL[c@mD_DiA[}CcCcHqF_E{BqCeA{BiA_@i@kA}@}HqE{B_AsNqIuBsB{@uAo@cB{AiIe@cAm@k@{@]aAIoANgAn@oBlCyFzI_CdCsAz@iC|@}B^gDJw|@ZgYQe@K[Uc@Ic@HSTo@PkRJccBZy@_@_@Oa@BWNw@X}YHgAa@i@q@Yy@aAq@oKCg@a@",start:Bt.hal,end:Bt.airport,stops:[],contact:"",timings:[370,430,460,490,560,640,1020,1050,1140,1160,1210,1330,1380]},{name:"KIA-4A",route:"k_lyM{penAFdBr@CvAIxNs@`Uw@xT{@^JlF[dAi@zEYnRkA~BPb@T{C|LmFvSgBhG{@zCqChIw@jBi@p@aA^qGToEPqCv@cBx@q@p@u@nA]`CJ`Bv@fC`ChFzApCp@|Cl@vFlCjLpBjHn@|CaHj@D^`IGdEWpAKtOm@tc@{AbSq@zFQjEOvADzMrAxGn@~a@hEzLhA~]zAjKR~@IvBq@pG_C`RkHdKaDhDa@~Ic@bJKdBMZK?VzCEbDWRAEs@?cAAwCZoBj@qApE_GpMuT~BuDhAoBL@RAlAGdF[dL_ArRsAvOiAtMgBhJ_A\\gBd@{D`A}H`@uEZwHn@oWf^^bi@j@dJJjHWvMk@fA?NGIO{AgCgBsCaD_EsAmAcAw@l@@tCP~B?xFm@pEg@fD[nCFfHb@bCLxBn@h@gArAuJHqCM_PLq@f@YdABtIz@r@j@d@~@r@_@^_@~@q@`GkD~CyBxBsAhD_BpKgFfCgAxE}@pDwArGgE|BwAhASzEI~Cw@zIkC|IaC`Eo@Nw@rA{BpC_IlCqG~AsGn@{Cf@_ArAcAzBgA|EkBhE{BfL}HvA{@h@Gl@sBvBmEtIuOvHmMhFgHtA_A~C_AdGi@bH?`@?ASGwF?mAOQFyIDoFEgE_@uC}@{Fa@kE_CoN@aAUyAqAwG_D_KcEoLgB_Fg@kDc@eCgA_Ew@gCOcCMqHM{@QEgB}NcAaFy@iCu@qBw@iCc@{CMiBG}@SuBoCsHiBiFU{A?_@DYu@kEmA_JB_DTcG?yOKuNL{J^yMZaPH[VkGt@mZDuG_@_Om@_Oc@qMe@oDcAgEgBgGsCiIeF}OaBmHeAcLy@iEoByHiC{IqAsE{@mE_FcY}AeFcB_EwF_LqKwSaLaTkKoSmKoWuOkb@_@u@u@w@oDqJcCwGi@{AcCuGcF{Ns@_DMcDFqGNQFg@NcUCsCq@sOk@{GUy@{FmNcEcK{CcHkC_F{IoNaI_LyIsMqGqI_JqMyIqUgIcU{BqHm@sAqCeEwBuCu@UcRqY_LuPiCmEaAeC}NwT{IyMaC}B}@c@k@IgAaAeEyCsAaAcCqBkAq@aFuBuLaHiB_AeAg@Ua@e@WmFaDsFcDmBaBqBgDq@oCs@kEu@iBs@k@aAY_AE_ANgAn@qA`BsHhLkAnAyAdAsBx@}Bd@eDRuL@ui@T_a@Le@?_@p@e@~AeCdKeA`Am@Vg@ToC?uKDq[Hi]Lon@NqJHeBG{@QgAq@c@i@{DcIYuAGmBCi@[cBgAcBsAgBeFDiA?AdA",start:Bt.whitefield,end:Bt.airport,stops:[],contact:"",timings:[330,610,680,760,800,830,870,900,960,1040,1070]},{name:"KIA-5",route:"i~mxMo}ymAaBC?UAWOJ?XKjBEfD?jCFpA\\zE|AnJHxCGzFQnIs@lIFp@O?kD?kIDcN@cZNcAKwODFe@DoAGiI@uJBqEOcFCwF?{IBkA^?`FU`AIzAK?_CDe@Bc@AoHIeMKcI?_C?MO@qEHuEBMwQa@{@e@yDPgBZeAd@c@hG?hDAOsDIeOE}F_@uJ?gBHwDcEAAACCEAQw\\CyIF_AHI?YUM_@qCa@gAcAwAu@k@oC}@s@[cDo@yCKwEMsAeAcDwCoFmBsDuBsAs@[t@{AzDWx@yA~BoCdCc@\\s@qAyJgOzC_DpB{AnEmDpCoC}AsAwAyAjAcAnCcCxDuC|CkCvB_BRIK]IWIc@cC}ImCqIuDwMWm@m@i@{DyCcAaAcBsCm@gBg@{Ag@i@yC{BwAuAiAy@sCcCkFmDeAi@uBkA{C_CoI}EcC}@XcAhAcENWjD{A|F]bCSTk@y@yLC}@~CuCrAAfFEZiAzIwU~@aBVK~D_AdJsBxB_@nD_Ap@[Pa@D]dCs@zOqFbBi@h@i@e@gA{@}CScAFm@FGxAsAxKuIx@}@Vy@d@cFL_Cr@gITw@^u@FgAYy@TcCv@{F|@cHTmBpAeJ]mC?oCDsHOoDf@eWVsOEaKOkPC}JJqNMoGuAkIa@kEu@cEiAkHHWMkA[cBg@aCe@cCqBeGyCiJaCqGmA}DQuBk@oC}BgIUyJCu@Mg@CAWuA}@_IiBaJoCcIu@kFKkAGeAMaA[wAsCwHuAoESsAHO?_@iByKYmDJoDPiFDsIMyOAiIHuDZiJFuHHuCf@{Ov@u[?qDK}HsAq\\UmGUqCcAgEgBgGsCiIeF}OaBmHeAcLy@iEcAkEk@mBiC{IqAsE{@mEkD_SS}A_@eBY{@cAiDcB_EwF_LqKwSaLaTeF}JoEaJsJeVqOcb@iAoAuGiQqAqDaGaPwBgHc@wCDoJTc@PyRIyJ_@eHa@uGg@{CmCeHaFqLoFiMmFiJyFeJ_EyFcIeLuEeHgLsOuCmEuF_OgGwPyD{KgAuDg@qAgAqBcDmEw@kAQCc@QgBmCmMcSyPkW{KyPmE}GVMKOsHeL[c@iCeCmBu@aMuJ{FyCqEqBkBgBwIaFkA_@uM}HoCyBqBgDq@oCeA}Fc@w@s@k@aAYcB?oAf@eBrBqFtImCbDyAdAsBx@}Bd@eDRmd@PaUD_\\Kw@Ia@Wo@Ke@RILw@PwuBf@kAe@u@I]Nm@Xk@ByY?w@c@o@sAc@g@u@]{J@i@a@A?",start:Bt.banashankari,end:Bt.airport,stops:[],contact:"",timings:[240,300,330,360,420,480,510,540,570,600,630,665,690,720,750,780,825,855,885,915,930,945,960,975,1005,1035,1065,1095,1125,1155,1185,1215,1245,1275,1380]},{name:"KIA-5D",route:"ihexMwsnmASJOW_@y@eBaEcBuCw@yBwA{A_JmFiCiC_D_EkI{LcDaF}TwYiBoBgBsA}Aq@{EcB}DyAmBkByAiDJo@}AqEo@m@Uu@wDiMkCuI{@oAwAy@iO}BoTmEyRiEiOgDaFkBiHkEwFwEyEyE{QmOmLkLkLcOqByCgAkBu@_CgAuEi@cEDuC`@}FCoAQuFHwAn@cJ^iPBcEe@{FqAaIW}GF{DBoAhA@zACBiAEkBMIs@Ia@h@sAp@UpJNtDp@pHlA|H@nBYtPs@lIFp@O?aB?cGBiN@g_@HcQ@JaBGqH@sKMiRAwC@sHNk@fCIjGc@FyNUiWEgSv@yE?}Bc@oCSo@OsDIeOE}F_@}MHwDcEAAAAAECGyCKkd@Nc@_@eBmAoEaA{@gF_BmFy@oFImAQ}@y@cDwCkIaDcCqB]Be@t@e@lAaC}@kN}FoDgDvRwPbJmH\\If@p@XpAn@dBx@b@vAc@}@iEmB_IaCcIgC_KoDeM}Ao@sE{DoC_GNSj@El@KnAm@vC{FvCqD|@m@~Bq@|Hy@|Cb@dFh@jBHvDbApBnBL@f@QP[P{BdA}AbE}DlDsCfIaHlGiFtEkCVKa@m@wBiDeJcNgByCuGmNsFqJyEwLwBsFy@uC]yADs@JMxLqJ|BeCf@cEhAcOr@mBBkBQs@bCmQx@cIt@_EIyAQaDA}DDuDO}Dz@k`@I}YMoMLkWOoEoBgM[{Cq@mDm@}D?aAOyAkA}FeD}KyCeJyDcLaAoGuAyEe@_CQaJSuA_@uBgA{I{AmH{CeJu@{GKsAw@kDcDqIi@iBBu@YeADY{AgJg@cEB_DZgPKkNE_GL{J^yMB_Fb@cN~@i]BeNwAs^SsGEaBu@wEaEkNcF{NsCoJ_A{FoAoLcBuHuBgHmDoM_FqYmAoEmBqFmE{IsI}PuHuNiPe[oGqNcEmKaFyMiI_U_@u@u@w@oDqJcCwGi@{AgJqWs@_DMcDVcHNkDB_WgAuS_AyE}GePcE{J_D{GqC}E_L_QyGqJ_HgK}HeKwFiI_CkFqK{Y{DaLwCwIiG{Iu@UcGoJ_Ww_@iCmE_@eA}KiQuLsQ_CkCgBiAk@IgAaAeEyCsDyC_E}ByEkBwLgHeBy@e@i@aJoFgDqBuBsBkByDa@kBsAqGsAkAaCUcATgAv@qHfLeDvDsAz@iC|@}B^gDJyp@VqMB{XHmCtIk@nCi@hAy@p@iAd@wLB}c@Lku@Rc_@NeCm@kB_CaDeHOkAMyCk@yBo@_@o@AiIPOeA",start:Bt.silk_institute,end:Bt.airport,stops:[],contact:"",timings:[245,430,555,615,1005,1200,1270,1330]},{name:"KIA-6",route:"qeryMcfinAd@KLf@HX~@tCz@|CPjBXjAjDxEjEdGzBhEbD~KlF~PpAnEd@dClB|PnEt_@tBb[^jEt@xGdFjV~C`OBx@nAhD|E`LzAjEnApAlAh@z@@nDe@tCKrKEfLE`IGnCFl[tCxKd@fLZp\\P~RJvOB|BDrAMxOc@dOe@vQq@ba@oAtK_@jEOvADzMrAtTxBtU~BlJbA|H\\f`@|A`CO|FoBnZkLhFyAvDi@|F[nOWbAW?V`AA~DOpAMnDe@|Cg@tJuAjGi@x@AnGp@`L[vJWjOU`Vw@pWyApP_AbDOdAU`CE~SoAlOcBbDS~@DdGtAv@HbDu@pEiA~FeAlCc@rAg@`HiDv@{ArEeLT[fG_CxDgAzCWrANjDjATFFMj@i@^u@j@{Cf@yGd@oHPgDDqC@WYCm@GUCKAO@FeFQoFYaCBa@IaAL_GAwAcAqCi@[mBg@i@i@aBaFy@wBmCiCX}@rA_KBkEK_NTe@j@SlF`@jDd@TPx@rAfAq@Za@hEwBbEsCdBsAlIeElMaGxE}@lBm@`DgBrHaFhASzEItJgCnGqBrEkA`Eo@Nw@rA{BpC_IlCqG~AsGv@qDf@o@hBoAfCmArDsArBy@tAaAnKkHfAq@`Aa@NAf@eBL_@tDkHzEwIfIqNzEyGpBkBnDiAnD]|DS`DB`A@EuAAyFEOKK@uADiHDgEAkCKcCWoA}@{Fa@kE_CoNHWMkA[cBmAeG}DaMoE_MmA}DQuBk@oCyAcFc@cBKmFMaEMg@CAWuA}@_Ii@wC_AiEmAsDaAoCu@kFSqCMaA[wAsCwHuAoESsAHO?_@_AqFi@gDYmD\\yKEsSCcPHuDZiJFuH\\uL~@e\\J}KK}Hg@{Lw@kSIwBUqCkDoMsCiIeF}OaBmHeAcLy@iEcAkEk@mBiC{IqAsEgFmYs@cEY{@cAiDcB_EqJqRqJyQmPk[oEaJ_GsNmEmLoJmWgAyCiAoAqIiUwGsQwBgHc@wCDoJTc@PyRA{Eg@cMa@uGg@{CmCeHuHwQ{CcHkC_F{IoNaI_LgJcNoHyJ}HiLmMm]mEcMkCiIgAqBcDmEw@kAQCc@QgBmCmMcS}GcKmLsQiGmJmE}GVMKOsHeL[c@iCeCmBu@aMuJ{FyCqEqBkBgBwIaFaD}A_K_GoCyBqBgDmAaGi@kCc@w@s@k@aAYcB?oAf@eBrBqFtI{BrCqCjBsCz@}E`@iw@Ve_@KiASUQi@Go@`@w@PmFBulARga@Js@]g@Oc@FOLaAX{YD_@KaA{@Wu@c@g@u@]{J@i@c@A@",start:Bt.kadugodi,end:Bt.airport,stops:[],contact:"",timings:[360,420,480,520,540,600,810,890,920,940,1030,1080,1120,1170,1200,1260,1410]},{name:"KIA-6A",route:"qeryMcfinALE%5EbAPA%5CjA%5EbAZ%7C%40d%40~BPrBp%40hAfFdH~DbGx%40vBlAdEzDbMzDtMFNL%3FzA%5DjJsBbM%7BCjKsC~Bq%40fJ%7DAtGaA%7CKcB~O%3FdE%40bEKbIy%40bKw%40~P%7DA%7COwBz%40UdCuAtAg%40dI_B~Bg%40zBg%40~CsAbHkDbCKpE%40bIIv%40Rb%40Z%60C%7CBxEvDpA%60AvFrC%7C%40n%40h%40r%40lClAv%40PlAV~%40d%40fAh%40nAv%40l%40z%40nArChApDNrA%40N%60%40%3FZsAvCiNrBiJlAsFnB%7BIBYZ%3Fx%40CbAIjB%5DxJeBzIaBxEq%40lHeBfEo%40xDQpDc%40jDcAdF_BzA%5DlJ%7DB%7CH_DrBy%40xAgAbBqBjAiA%7C%40o%40~BgAjASzBMfJYpPIVD%60%40L%7C%40CbCEzB%3FvCHzFGxA%5ElAf%40lBl%40lCx%40jG%7CB%60WlJz%40BjBz%40xMdEnBf%40rA%40dAUbAgA~CgGzAwCXo%40Ls%40D%7DBf%40yUXoKtAwN%5EkFR%7BHh%40qRVwHL%7BCXoBVg%40f%40%5DvNyElVcIxJeCvi%40sQ%7Ce%40aPrC%7B%40bAMpKiAvEm%40hHoAvNoEdA%7B%40fBgF%7CKoYtE_LpBcEr%40u%40zBcBzD_CtEcHrBwCdAkApAq%40pBUzB%3FnW%5CxDJvAIzCg%40zEiAbBc%40hB%7B%40xAc%40tLgBrDk%40FA%40RfHkAnEi%40bGg%40xODfUEdCHnARjAj%40vBtAvBzAnBdAd%40LfBRvKCzAKj%40GTSlE_AlCe%40jDg%40n%40FvBScByEQwD_%40aDyAmD_FsMi%40iBU%7BA%3F_%40DKGk%40kAeHa%40oCOcD%5C%7DK%3FwKGaGEiFHkJRiDLgIDuG%60%40gM%7C%40g%5CHsNu%40%7BSu%40%7BRIuBS%7DBScAuAiF%7DAkFmJiYuAmGoAoMwAgH%7DAcF_CcIoA%7BE_CoMkB%7DKYqBOWa%40oAoAyDcD%7DGgIqPkJiQwOiZmEeJgHeQsD%7BJ%7BJeXa%40iAs%40u%40_AwByFmOk%40%7DAkImUkAgEYmCBkCBiEHKHMBSNoUCsCIqDg%40aJk%40%7BGUy%40aAqCyD%7BIyBsFsAaD%7DCeHuCkFyIiNyJkN%7DGaK%7DHiK_GqIkA%7BBwLi%5CmE_McC%7BHgCcE%7BByCg%40m%40UEWM%7BA%7DBsA%7DB%7BKuPsLmQmIsMgF%7DHcDcFVMmE%7DGqBwCmAuAwAsA_Ai%40m%40KgAaAyG%7BEgCsBwC_ByEmBs%40a%40_%40i%40uIiFiBaAeCqA%7BMeImB%7BBsAeDiAuGc%40qAk%40q%40%7D%40c%40cAMkBVgAv%40sJzN%7BBtBoAt%40sCz%40aCZ_u%40%5CqMBeWSiAi%40e%40D%5BVc%40PcGF%7DnB%5EkAk%40w%40Hu%40%5EsZHs%40Ym%40m%40g%40kAiAo%40%7BJ%40YQQO",start:Bt.kadugodi,end:Bt.airport,stops:[],contact:"",timings:[240,300,660,730,990,1100]},{name:"KIA-7",route:"%7DuzxMa%60ymA%5CA%40%7CAH%3FAaAE%40ImCG%7BDFM%40sCEwCGaD_%40sS%7B%40gEe%40qB_DkIo%40sBlBm%40dCw%40j%40UxAaAnB_AfAWfAGtQzAnMpApIl%40lB%40vAM%60%40MxHaCtRqGfQqFf%5CcJdCq%40d%40Bx%40FFO~B_ErA%7BCnAwA%60DcC~QkMzD%7DBfDgBpAa%40hEiAlAKdNgAxTcBbCo%40%60By%40ZG%7C%40mApB_DpAmDVwCt%40wN%7C%40oHZy%40%60%40_%40nBoA~Ay%40%7BBcEcEcGsBaDjAqAjDsCnAoAvB_B~%40w%40rAoAZ%5BYS%7BCyCfB%7DA%60DoCrFkEbCsB%7C%40e%40Mc%40a%40%7DAaEqNuCwJiBkGS_%40iBqAcDoCeBkCk%40qA_%40gAk%40%7BA_EaDMQwAaAmAiA%7BGkFeE%7BBmAo%40qHmFkDgBcC%7D%40dAqDb%40aBTSlD%7BAlGW%60BOJGNm%40_AoNjDuCvGIV%40%3FQ~BkGvEqMtAiCtCy%40pEeAfCk%40mFsGiGwETo%40jI_KlJuMvAaBt%40w%40h%40p%40tAfBl%40h%40zGzIjGdGrCxCNRZ%5Be%40gAq%40aC%5DyADs%40JMBItLgJ%7CAsA%5Eq%40f%40cEhAcOPu%40%60%40w%40JcAGg%40OYAYbCmQx%40cIt%40_EKaBQ%7B%40%40%7B%40AqAB%7BGI%7BACeF%7C%40y_%40%3FcNOwJIaOJsUGsBO%7D%40%7D%40aFi%40iFyB_NIm%40HSEa%40WeBqAwGiBqFu%40mCcEoLgB_FYoAM%7BAc%40eCgA_Ew%40gCOcCMqHM%7B%40QE_AeJg%40wCcAaFy%40iCu%40qBw%40iCc%40%7BCMiBG%7D%40SuBoCsHiBiFU%7BA%3F_%40DYu%40kEe%40%7BCg%40cEB_DTcGDcHE%7BGKkQHiDRiDRsOXeLx%40aYVsOCsF%5DeJiAyYE_BYiDi%40gCwBmHqBkGgG_RsAgF%5BgBi%40sGe%40%7BDc%40qBs%40uDaA_DsBcHwA_FgAkFeCmNwAeJ%5D%7B%40c%40%7DAgCoGgJcR%7D%5Bcn%40sDgHuFwMuE%7DLsJsWmBgF%7B%40gA_AwB_CmGqCsHgFgNmDsKg%40oCCmEBiEHKHMN_L%40oLCyAc%40wJw%40eKwAkEcHmPm%40_BoCmGkCqF%7BJePkImLgJeNqGqI_JqMsDoJ%7DF%7BOuB%7DFsD%7DKkAsDw%40%7DAmC%7BDoBcCUEWM%7BA%7DBsA%7DBeBmCyLyQaOcU_GcJcBeCcDcFVMmE%7DGqBwCwB_CqAcAiA%5BuHyFkC%7BBkBiAeFwB%7BBiA_%40i%40iKoGoAe%40_PkJuBsB%7B%40uAo%40cBiAsGa%40yAi%40w%40uAq%40_BGoA%5CuAnA%7DHxLeBnB%7DCjBkCr%40qCViUL%7Br%40NsPSc%40Yi%40Mk%40PKLo%40PkRJccBZiAi%40%7D%40Bk%40Zm%40H%7BYBs%40%5Di%40q%40Yy%40g%40c%40i%40SqJBs%40e%40A%40",start:Bt.hsr,end:Bt.airport,stops:[],contact:"",timings:[365,450,510,620,710,770,950,1035,1100,1210,1295,1360]},{name:"KIA-7A",route:"%7DuzxMa%60ymA%5CAJ%7CAG_AImC%40%7DIMyH_%40sS%7B%40gEe%40qB_DkIo%40sBlBm%40dCw%40j%40UxAaAnB_AfAWfAGtQzANBBSP_CdAuUZ%7BFl%40oC%60%40%7B%40vCuCpIoItSiTcCeBgBy%40iBs%40aDo%40oFEiG%3F_D%40%7BE%3FqAK%7BA%5D_CaAiBqAeAoAoDmG_LcTiDyGcCaFUsAR_BVi%40z%40%7B%40nD_Dn%40yAHiAYuAkAyC%7BDuHiC%7DF%5DsMFiF%40m%40%40a%40%5ECnG%5BlH_%40MmAw%40wJGc%40fBKtBOfGk%40dGw%40bDS~%40DdGtAv%40HbDu%40pEiA~FeAlCc%40rAg%40%60HiDv%40%7BArEeLT%5BfG_CxDgAzCWrANjDjATFFMj%40i%40%5Eu%40j%40%7BCf%40yGd%40oHPgDDqCtBApG%7B%40tRkCdc%40sGjBYRCAUs%40aDU%7D%40eAkDxK_CvXmGTEGWg%40_BeBmHQu%40i%40yBDe%40Z_B%3FOy%40sESUPAlAWTp%40f%40hAZdBEF_AZUT%5C~ArFcAlHyAcAcDhBo%40h%40YdEf%40lBRdC%40p%40%40v%40j%40HdCIpAR%60CPN%7CAx%40xAn%40jLgCdFmAv%40YTWJo%40tS_HxA%5Db%40_%40Z%5B%5Ds%40k%40qBQm%40YoADs%40JMBItLgJ%7CAsA%5Eq%40f%40cEhAcOPu%40%60%40w%40JcAGg%40Qs%40bCmQx%40cIt%40_EKaBOwBAqAB%7BGI%7BACeF%7C%40y_%40%3FcNOwJIaOJsUWqD%7D%40aFi%40iFyB_NIm%40HSEa%40WeBqAwG_D_KcEoLgB_FYoAM%7BAc%40eCgA_Ew%40gCOcCMqHM%7B%40QE_AeJg%40wCcAaFy%40iCu%40qBw%40iCc%40%7BCMiBG%7D%40SuBoCsHiBiFU%7BA%3F_%40DYu%40kEe%40%7BCg%40cEB_DTcGDcHE%7BGKkQHiDRiDRsOXeLx%40aYVsOCsF%5DeJiAyYE_BYiDi%40gCwBmHyJkZsAgF%5BgBi%40sGiAmHs%40uDaA_DsBcHwA_FmEyUwAeJ%5D%7B%40c%40%7DAgCoGgJcR%7D%5Bcn%40sDgHuFwMuE%7DLsJsWmBgF%7B%40gA_AwB_CmGqCsHgFgNmDsKg%40oCCmEBiEHKHMN_L%40oLCyAc%40wJw%40eKwAkEqImSoCmGkCqF%7BJePkImLgJeNqGqI_JqMsDoJ%7DF%7BOuB%7DFsD%7DKkAsDw%40%7DAmC%7BDoBcCUEWM%7BA%7DBsA%7DBeBmCyLyQaOcU_GcJcBeCcDcFVMmE%7DGqBwCwB_CqAcAiA%5BuHyFkC%7BBkBiAeFwB%7BBiA_%40i%40iKoGoAe%40_PkJuBsBkByDiAsGa%40yAi%40w%40uAq%40_BGoA%5CuAnA%7DHxLeBnB%7DCjBkCr%40qCViUL%7Br%40NsPSc%40Yi%40Mk%40P%7B%40%5EkRJccBZiAi%40%7D%40Bk%40Zm%40H%7BYBs%40%5Di%40q%40Yy%40g%40c%40i%40SqJBs%40e%40A%40",start:Bt.hsr,end:Bt.airport,stops:[],contact:"",timings:[270,330,380,420,480,530,560,590,640,680,740,805,855,915,965,1005,1060,1110,1140,1170,1220,1260,1320,1380]},{name:"KIA-8",route:"efayMoblmAOKd@s@hA_B~BeCdU_[zYma@bc@ql@lZoa@tEuGjFoG|LsNjDeFdEcI`Ra^fUec@|N}Xr[em@`GcLhC{EPm@fSa`@dQw\\h@g@lC{F~BcF{Ce@uIi@wBDaKhBwEv@gCHkHV_HTgPn@wCHqKt@oA?uBUkDaAkAo@kDkCoEwEgNaRsA{AaHgGmA_AaCkAkCi@yF_@wDKgCF}N|AyGp@mGbAcYbHiS`DeAb@iEd@gAAg@c@qAg@k@Yq@EaLkEqX{JoKuDgHsCsJsDiVwIuQmHeEiCoG_F{OgNuTyRcJoJiB{C}FwKqB_EgAcEkGgWaAiGiAqLeA}H{BaOiAuFQoCE{CMuGwAgPy@eJa@yLf@wD~@wClPy[bGiL|HuNnMcWvN{XfK_SjCgFdBiCjBwCpGsJpLuQnCqE`JwPb@c@d@[j@IhEItEDzGEvB`@`GpBbQrG|M`FvAXVAl@\\rBv@vNlEdAH~@EvAs@f@u@dDuGlBcE`Aq`@FqDh@wFpAaQp@uTh@yQLsB\\oA\\_@|Ak@rRmGzQcGbDw@zJ{Ch]eLt_@gMnOaFvOcBzEs@bF}@rCw@hH{BdB{@l@_A|DaLtKoXdFeL|A{AdEeCzAkA`GiJ`BsBx@o@`Bc@xAIdPLdOZbEg@fB[fG{ApCoAzScDHPfHkApJgAxIK`QJfLIdCHnARr@Zj@\\zEbDtCrAfBRxFAxFM`A[lE_AtGgAr@E~ADv@Qq@eBq@sBMsCQeCg@qBsA{CyF}OU{A?_@DY{AgJg@cEB_DTcGDcHKiPE}H\\sITmSf@cO~@y^AwJmB_h@YiDi@gCwBmHqBkGgG_RsAgF[gBi@sGiAmHs@uDaA_DsBcHwA_FgAkF}EsYaAyCgCoGiFeK_JkQoZ}k@mKoWwFiOgHwR{@gA_AwB_CmGqCsH]}@iEiLmDsKg@oCCmELuEHMN_LAiOc@wJw@eKwAkEcHmP}DmJkCqFsCwEgFmIsDgFqHkKkGqJkIyKgFwHsDoJsIuU_AgC}D_MyAkDmC{DoBcCUEsBkCyDkGqWo`@iLqQcBeCcDcFVMmE}GqBwCmAuAwC}Bm@KgAaAyG{EgCsBwC_ByEmBsAkAuIiFyCuAqPcKmB{BsAeDiAuGc@qAk@q@}@c@}AMqAVgAv@uB~C}FzI{BtB}CxAgEr@ig@Vg[HeWSs@a@i@Go@`@w@PmFBulARga@J{@c@q@GYJq@\\sZHiAi@a@s@]u@i@a@_@MkFBwCCc@_@",start:Bt.ecity,end:Bt.airport,stops:[],contact:"",timings:[5,30,60,90,210,440,480,520,560,570,600,620,650,670,680,700,710,740,750,780,800,860,920,980,1110,1040,1180,1200,1210,1220,1240,1260,1280,1300,1320,1330,1340,1360,1380,1420,1430]},{name:"KIA-8C",route:"_tgyM}lcmATKlC_@zEeApAe@nC}AxAoAbA_Bxk@_w@pRkWpG_Jr\\m^rFiIrE_LdBkHfAkFdCuLhBiHlFwR~@cCvBmDrUe\\|L_Q~A_CzBkCbBuBbQ{UdMkQfLwOh]ae@bPsTxOeTpKyNfNcPtDaF|DeHzJkRh]gp@pl@{hAvKqSPm@lKaSfVme@`CqDlC{F~BcF{Ce@uIi@wBDyQ`D{d@`ByLj@yFXwAKyDaAkAi@iDgCcE_EaCeD}IsLwCgDcI_HgCsAoFcA}HWwAAiGd@uN~AuFp@iQjEkJvBgKzAcC`@_Dl@YTyDj@iA@c@A]YSUcBk@q@MaX{JmWaJuKkEgWiJoPqGiL}EaHiF}P{NkE{DcOuMyJ_K}DcHqGyLwA}EiEcQyBoKm@kGeB}NyBaOs@sDk@eESqLgC}Ye@cHM_GXcC`AqDjHqNzJuRjHgNfG}K`D_H`HsM|EsJhV{d@zPsWjLkQrHkNxBsDp@a@nDOvJHfEKt@JzCfAfGnBtYxKfDbAz@LdBv@~InChFtApAAjAc@xBgDdEsIRcA^oQb@uQfBiSr@wQf@sSX_I`@mB\\g@vGwBhZwJlHyBzF_BzVoIjO_FpRqG~N_FvDsAxBi@dEa@lHw@hDe@~JoBzGuBxCgAt@{@dBmF~G{PlDmJfFoLbAcBn@k@bDwBdC_BtAoB|F{I`A}@|Ao@lBMzC@zYf@jDQrK{BhDwAfBa@jOyBbAS@RdCc@pHeAbD_@zGUdLFnVExBNfAZ|@d@pCjBpChBnAd@rBRrLCbBQbD_ApFaApC_@dAFhAOLCg@gAy@kCEi@SaE_@aCkEwKaCuGk@aDJWe@aDyAuJEuBZkH@yOMwOL{J^yMZaPj@uRf@aVWuNoAg[MeFu@wEqB_HoAkEcF{NsCoJ_A{FoAoLcBuHkFsQw@cD}BmMaBcKs@uCYy@mBqFgIqPyZkl@_EwHoGqNcGwOkOea@u@w@oDqJcCwGmDqJcF{Ns@_DMcDFqGNQNkDFeTUcHu@kMg@{CW}@}GePkA{CwG{NyJsPoTg[wRkX_CkFsFkOkEqLiDaKmAaEm@sAqCeEwBuCu@UcRqYub@cp@VMKOsHeLeDiDmBu@mG{EsDyCoBkA}I_EkBgBwIaFaD}A_K_GoCyBqBgDwBmKc@w@s@k@aAYcB?oAf@eBrBqFtI{BrCqCjBsCz@}E`@uL@si@Te_@KiASUQi@G_@NOPw@PmFBulARga@J{Am@s@TaAX{YD_@KaA{@Wu@c@g@u@]{J@i@c@A@",start:Bt.chandapura,end:Bt.airport,stops:[],contact:"",timings:[300,360,460,510,990,1050,1130,1230]},{name:"KIA-8D",route:"stcyMk|xmAjArC\\fAFPKB_B`@HRK[~Aa@hE{AlN_GrGkCvGgBlEu@dBg@jH{DbAaA~@uAf@wBB?DC@C`Ae@`GgCnDyAjCq@vHgBpH}C~D}AdCm@b@ICu@]YSUcBk@q@MmHoCyZ_LkMoEgHsCsJsDiVwIuQmHuBiAoA_AoG_F{OgNuTyRcJoJiB{C}FwKqB_EgAcEkGgWaAiGiAqLeA}H{BaOiAuFQoCE{CMuGwAgPy@eJa@yLf@wD~@wClPy[bGiL|HuNxDyHtGiMvN{XfK_SjCgFdBiCjBwCpGsJpLuQnCqE`JwPb@c@d@[j@IhEItED|@B|EIvB`@`GpBbQrG|M`FvAXVAl@\\rBv@vNlEdAH~@En@Qf@a@f@u@dDuGrAgCX{@RyIRsJXcJFqDh@wFbAkLLuCRgH\\mKh@yQLsB\\oA\\_@|Ak@xDkAxLaEzQcGbDw@zJ{Ch]eLt_@gMtFkBxGuBvOcBzEs@bF}@rCw@hH{BdB{@l@_A|DaLtKoXdFeL|A{ApA}@rBgAzAkA`GiJ`BsBx@o@`Bc@xAIdPLdOZvAIjB]fB[fG{ApCoAzScDFA@RfHkApJgAxIK`QJfLIdCHnARr@Zj@\\zEbDnBdAd@LfBRxFAxFMj@GTSlE_AtGgAr@E^F~@Av@Qq@eBq@sBMsCQeCg@qBsA{CoCsHiBiFU{A?_@DY{AgJg@cEB_DTcGDcHKiPE}HHiDRiDRsO@yBf@cO~@y^AwJmB_h@YiDi@gCwBmHqBkGgG_RsAgF[gBi@sGe@{Dc@qBs@uDaA_DsBcHwA_FgAkF}EsY]{@c@}AgCoGiFeK_JkQoZ}k@uFwMwCwHwFiOgHwR{@gA_AwB_CmGqCsH]}@iEiLmDsKg@oCCmEBiEHKHMN_LAiOc@wJw@eKwAkEcHmP}DmJkCqFsCwEgFmIsDgFqHkKkGqJkIyKgFwHsDoJsIuU_AgC}D_MyAkDmC{DoBcCUEWM{A}BsA}BeBmCyLyQwIuMiLqQcBeCcDcFVMmE}GqBwCmAuAwAsA_Ai@m@KgAaAyG{EgCsBwC_ByEmBs@a@_@i@uIiFmAu@kA_@aJoFoEsCmB{BsAeDiAuGc@qAk@q@}@c@}AMqAVgAv@uB~C}FzI{BtB}CxAgEr@ig@Vg[HeWSs@a@i@Go@`@w@PmFBulARga@J{@c@q@GYJq@\\sZHiAi@a@s@]u@i@a@_@MkFBwCCc@_@",start:Bt.sarjapur,end:Bt.airport,stops:[],contact:"",timings:[540,640,960,1060,1380]},{name:"KIA-8E",route:"il~xMmajmAaAB`@bA`@Oa@Na@cAo@_B}AcDcC_GMe@y@]{@m@o@iCiBiJMkBJ_Cb@_KGc@SCk@KgDs@cFCmSDiESaGmAwFuBqGyCKa@x@{A|L}P|P{U~D{FfHaKfFgH^_AhHsJpPcUpV}\\jJiMhUuXnEuGrNuX`Yki@vVoe@hx@{{AbAeB`FsJrS{`@@w@u@MmHc@sGFqNhCoXhAmTv@qKt@eEUwFqBkDkCoEwE{A{ByMeQeJ}HiEwB_HcBkDJYTkABqDT{Q|BuFp@iQjEkJvBgKzAqIzA}Dh@cBUyEsAoYuKeRoGeJqDwHyCuUoIwPwGmIyD_LwImRuPyNmMyJ_K}DcHqGyLwA}EiEcQyBoKm@kGyCgVcDoRSgLoBmV_A_MKqGx@yE`AeCvOwZ`Q_\\nMcW`NwWrJaRdE_IpDqFjGmJ~LmRpKiR~BaEp@e@pJSvCHzFGtGtBxKvD`WlJz@BjBz@vLvDbCr@jADfAMlAaA|CcG|BqETaCh@qVXgLnBmTl@cRd@uQf@cJ|@sAhc@sNtGmBzF_BzVoIjO_FpRqG~N_FvDsA~HkAlHw@tDo@pIiBfI_Cf@Um@{@Y_@w@cA{BeCwLoNqIiHkG}G{D_HiBkBsBoASe@_@gEKsLY}Ca@wAuAaG}@oBuDqE}BiE{@qD]sCa@iAeAiAyAeCKkBOiF]uFmBcLgBwGiBwDoBqCmAiAq@mBWsBO}Kk@qIq@wAgEoHwBk@mCc@o@k@G{HbAcb@AsPKmCa@aBoE}H}CuCg@w@SqBdBmNGsA}AyFcAeEYqC{@}Iu@}DOcBH{@`@{Cf@mDCkBKoCW{A[aDf@y@r@e@NmAi@}Nw@qCuB{CgDkDeAaC{CgHoDmG_DeEwBsGgFoK{@o@qKz@uIXs@_AcA{CwKyf@aF{UUaEXaDd@}EVqLU_IVgBv@sCXwD\\{A|AgB|AuEJuEh@cIc@aDm@aE`@kEuBkDk@a@y@Ms@[u@_Hg@qAyCiCeEsImDyNsAeDuGkHQ]aAqJcBqHsC{GeEaIoGqKwAeBePeMsD{DqNeU{KmSeNsZgBqBmFaHcDwL}@{D_AiCc@mBkE_Pi@uH}@mHw@kAs@sC}@yCcG_IgCwCu@q@XOLCbDg@hJq@rEVfLXh@DdEdAnXh@vI\\vBI`FHZ@xFAp@OBo@y@aNaA{FuAeUo@iIA{JNmA`DkMl@sBRw@[i@{@AuAl@kvBTeBi@_Bt@i[EqAeBg@q@aCmAeAsA{GABfB",start:Bt.ecity_wipro,end:Bt.airport,stops:[],contact:"",timings:[270,325,380,410,940,1070,1110,1150]},{name:"KIA-9",route:"wvmxMutenAB\\~C?@hCEh@If@GlABh@V|Af@hBZCCQ_@cA]eAMy@Ao@R{AR_C@o@?mAKcEUmEGa@@GCUKGq@M_DOeFi@_Fg@}@[[Wg@w@{@uBYe@[c@}BuB[MwAiA}AiA{@W{Bg@iAKcAC}Id@gA@[C_@Ks@_@uAu@Fs@Pi@lBsBpA{@IW~A_Et@_CgAoBS]yAsCkDqHeBeDcC{DeBqCw@iA{@cAe@c@UMI?oACGOCEEQTyB^oCVkBr@oEHsAJkA`@uDHIHa@d@uC?OIcASiA@}AA}DDuDKs@CmB?[?{ALuCH_Fb@yQFeJQwNMoMFyNDqGG{CEi@Ki@e@{Cc@eC[uCEu@[iBoAiHS{AHWUeBoAoGQ_AcAwCkAsDm@uBi@cBeAsCeCuGg@oBK}@MuAc@qBo@_C_A{CMk@E_AEmDImB?o@IaAKKI?MuA]aD_@}CUqAo@iDc@eBa@qA_AiCm@gBe@gCW_DGs@QcBCc@Ws@oAcDaCuGWmASsAJWAWc@iCu@mEc@gDEgA?m@ZkH@mBDeHEeCGgF?mBE{B?aEHiDBuANsALgIDuGTuH`@uMf@cRHoE?cHOkFqAk\\I_CIuB@SUiBScAUcA_AeD}AkFY_Aq@gBm@_By@qC_DmJYaAy@eD[gBi@sGe@{DwAgH}EgPo@{B_@_Bg@kCwAcIm@iD}@sFYqBOWa@oAOq@_AgCgAgC{AuCsDwHsCyFeGcLmMmVoDaHqCsF{@qByDeJmB_FgAwC{FqOmGaQs@u@OOo@gB_CmGyB_Gk@}AaBkEqBqFwBoGu@cCUcAQkAGaABkCBiEHKHMBSFoCB{FBcICsCIqDg@aJUmDUmBUy@aAqCyD{IyBsFsAaD}CeHgAuBmAuBsCuE}BwD[a@k@y@gCmDiAeBgDwE_AmAaCuD{A}BeBaCwEgG_GqIc@s@g@gAuFeO{F{OeB}EaA}CoAiE_@}@m@kAyAwB{ByC_@k@GAUEWM{A}BsA}B{KuPsLmQoCkEeLeQcDcFVMmE}GqBwC[c@{A{AqAcA[Om@K}CcCwCuBkC{B_E{BqCeA{BiA_@i@kA}@}HqE{B_AsNqImAeAg@m@{@uAo@cBa@kBy@}Ee@cAm@k@{@]aAI]@q@L]Ni@^k@n@cA|AyFzIaAlA}@v@sAz@o@XyAb@}B^gDJgRHoi@PkHA{OOe@K[Uc@Ic@HSTo@PkRJaaALaa@Le@Qs@]a@BWNw@X}YHa@Ie@Wi@q@Yy@g@c@YMOEoA?oH@g@c@?@",start:Bt.majestic,end:Bt.airport,stops:[],contact:"",timings:[5,25,50,80,100,120,260,280,305,320,340,360,375,390,405,425,445,465,480,495,510,525,540,555,570,585,600,620,640,660,680,705,720,740,760,780,795,810,820,830,840,855,870,885,900,915,930,945,955,965,975,990,1005,1020,1035,1050,1065,1080,1090,1100,1115,1110,1140,1155,1170,1185,1200,1215,1230,1245,1260,1275,1290,1305,1320,1340,1360,1380,1400,1440]},{name:"KIA-10",route:"ufhxM}w`nArAeG~Bf@tAl@dEjDzEpClD`CdA`@bCf@`An@n@WTaAdCaL`@_Ab@QnB{AlEoEj@qAz@uF|AuFz@_CdBiFNm@FoAKoAiBcGsEkNyAeEiCaHuBiGqBwHqCwKMa@a@cAg@s@yAuAaA_@cCe@gJmAoJgA}D[{GAyEAeDE_AWo@m@kAeBs@gA[}@OkAG{@AmOCwIC_NAiFSaCw@uEqA{Fs@gD_CuKg@qCOsBCiABMG}@GgE?{B`CwQjAgIbBwO\\{C\\iDz@eJJiBVaDNcBBsA[{GMoA_@aBaAcCK[iAoAkAqAiAkAoBy@kMeF[Wa@m@]o@QQKi@CcALuCFeAPuAOEMMMYE_@F}Bd@gETaATCa@vBI|@InBEz@Yl@[\\k@\\]FuA@w@Mw@[eBiAs@{@e@aABM?CQi@yByEaAuBq@S]A_@HmCrAw@f@OVeAj@sKdFcEhBgHrDcAl@O?ODqD`BgAb@]B}JSqTm@}FSiKWyDGmHAiSN{NVqCFYKy@o@AyFEOKK@uADiHDgEAkCKcCWoA}@{Fa@kEu@cEiAkHHWGi@UyAk@yCe@}BiBqFu@mCyAsEqE{LYoAM{Ac@eC_CgIK_ACcAMeG?k@M{@QE_AeJg@wCcAaFy@iCu@qBw@iCc@{CMiB[sDoCsH_A_Ci@iBU{A?_@DY{AgJg@cEB_DTcGDcHKiPE{B?aEHiDRiDRsO@yBf@cO~@y^AwJ{A{_@QcGEk@S}Bi@gCwBmHe@cBkAgDgG_RsAgF[gBi@sGe@{Dc@qBs@uDaA_DsBcHwA_FgAkFeCmNwAeJ]{@c@}A_AgCgAgCiFeK}B}EaFmJaJ_QmO}YuFwMwCwHwFiOgHwR{@gAOOo@gB_CmGqCsH]}@iEiLwBoGu@cCg@oCGaABkCBiEHKHMBSJkK@oLCyAc@wJKiBk@{GwAkEcHmP}DmJkCqFsCwEgFmIsDgFqHkKkGqJkIyKgFwHsDoJsIuUyD}KcAiDa@mAw@}AmC{DgAuAg@m@UEWM{A}BsA}BeBmCyLyQwIuMiLqQcBeCcDcFVMmE}GqBwCmAuAwAsA_Ai@m@KgAaAyG{EgCsBwC_ByEmBs@a@_@i@kA}@iGkDiBaAo@SuA}@{MeImB{Bw@_B[eAiAuGc@qAk@q@}@c@cAM}@Dm@PgAv@eDbFmEvG{BtBoAt@sCz@aCZqOF_s@XeWSc@Ue@Se@D[Vc@PcGFulARga@Jq@[YOw@Hu@^sZHs@Ym@m@g@kAiAo@{J@YQQO",start:Bt.mysore_road,end:Bt.airport,stops:[],contact:"",timings:[240,300,330,360,390,420,480,510,540,570,600,630,660,690,750,780,810,855,885,915,945,975,1005,1035,1065,1095,1125,1155,1185,1215,1245,1275,1320,1380]},{name:"KIA-12",route:"okvxMwrymAGoAVApCO~GWrZOzt@_@b@AlBA@N@f@AXCbBEdCCzAJd@LjMOjF_@vHWvFk@tC[l@aD|Ds@dA]jAJNVk@bAgBrA}AnBeCX@c@CRy@L_ABc@Zk@h@aMZ}FFuBB}@SCDcABw@AyDN_HEsCGa@tEC~GGtAA`EGfOAdROpCE?Y?wAIyEGsKDeAAqHCqLEoN?AfBaBp@SjDKx@Yp@y@Ru@^QxFShG?hDAOsDIeOE}F_@uJ?gBHwDcEAAACCEAQw\\CyIF_AHI?YUM_@qCa@gAcAwAu@k@oC}@s@[cDo@yCKwEMsAeAcDwCoFmBsDuBsAs@[t@{AzDWx@yA~BoCdCc@\\s@qAyJgOzC_DpB{AnEmDpCoC}AsAwAyAjAcAnCcCxDuC|CkCvB_BRIK]IWIc@cC}IcCoIgCqJaA}C@WUOcBu@aEqDgB}Ck@kBn@C~@Eh@Qp@m@`BmCt@oBhA_BlAgAx@i@hCq@hEk@hBIvCb@vAXlCNjBHvDbApBnBL@f@QP[P{BdA}AvAeBjBwAlDsCfIaHhGgFdCcBjBu@aBkCsBkDwGoJuBeDcGoMgEqHqByDsAwDoDkJwAiE[mA@}@LMnI{GzEgEd@kCr@}Jp@_Gb@y@HkBUo@`CeQv@uIRk@d@eDIcASiA@}AA}DDuDO}Dz@k`@FeJQwNMoMLkWG{CQsAeBwLa@_DoAiHS{AHWUeBoAoGaDkK}CmJeCuGs@mDMuAsAqF_A{CSkBO{G?]S@KaB_AeJkByJoB{Fw@iCc@{CMiB[sDyF}OU{A?_@DY{AgJg@cEB_DTcGDcHKiPE}H\\sITmSf@cO~@y^AwJmB_h@YiDi@gCwBmHqBkGgG_RsAgF[gBi@sGiAmHs@uDaA_DsBcHwA_FgAkF}EsYaAyCgCoGiFeK_JkQoZ}k@mKoWwFiOgHwR{@gA_AwB_CmGqCsH]}@iEiLmDsKg@oCCmELuEHMN_LAiOc@wJw@eKwAkEcHmP}DmJkCqFsCwEgFmIsDgFqHkKkGqJkIyKgFwHsDoJsIuU_AgC}D_MyAkDmC{DoBcCUEsBkCyDkGqWo`@iLqQcBeCcDcFVMmE}GqBwCmAuAwC}Bm@KgAaAyG{EgCsBwC_ByEmBsAkAuIiFiBaAeCqA{MeImB{BsAeDiAuGc@qAk@q@}@c@cAMkBVgAv@eDbFmEvG{BtBoAt@sCz@aCZqOF_s@XeWSc@Ue@Se@D_Ah@ytAZga@Jq@[YOw@Hu@^sZHs@Ym@m@g@kAiAo@{J@YQQO",start:Bt.btm,end:Bt.airport,stops:[],contact:"",timings:[340,400,460,590,650,710,925,985,1045,1175,1235,1315]},{name:"KIA-14",route:"}jrxMk|qmADObBIi@gFi@iEg@yEs@sCMmD@[RHWm@M{ASwBs@wHoAmPYeA_@mCiAaEyCkJkA{Dk@oD{AcLAmAUiAm@qC]g@eBaIqAuF{@sIc@wG{A_Jm@}CAmAf@oAbFyGd@iBLcATk@j@iMSAB]HoAX{IHaBCoDOcA@gHU}Oi@wUk@}WIsJ@i@S{@GuDFiBMcCCu@Pu@I_De@sDyAgKCqBSq@q@oEk@qCu@qF{AaRm@gF?aF\\wCXgEjC{@xDcA~@QTn@dGaBfBg@vAcAhEuBtB{CdD}GlAqC~IqIjBqAzBy@|EkA}BcIgAeEuDqMiEePu@sB@Y?Qq@SgAg@aEqDgB}Ck@kBn@Ch@CVCnAm@n@mAjAqBZ{@z@sAzBwBdBs@fCe@rEe@x@@`HfAbDJvBd@hA^x@`Av@l@b@CXWHOP{B|CcErTqQrFqEhAu@jBu@eDmFqBgDgFeHgByC_GgMgEqHqByDsAwDoDkJiAeDi@qB@}@LM@QYYE_A^}Kf@cKC{BWeCo@kCu@wCqAmDUiAHUd@iAhIuDtE}CpA_@vHi@|DD~AFpAMb@O`CcC@?D@B?HEFSQIIBABA@}CeCiCQo@_@Qc@KqAOwBAqAB{GI{ACeF|@y_@?cNOwJIaOJsUWmDeBwLa@_DoAiHS{AHWOuAkA}Fu@}CoB_GyCeJiB_FmA}DQuBk@oC}BgIUyJQ}ACAWuA?{@aA_Ia@wBoAyF]{@NGa@aBWq@SaE_@aCmImTk@aDJWe@aDyAuJEuBZkH@yOMqMHkJRiDLgIDuGTuH`@uMp@iX?qDK}HsAq\\KuCAu@Fc@Lc@@m@eBoHOqAEkCm@ePg@eRe@{PQcJ_@@IGcKwNiHsLmFeK{DeIs@q@cAiDcB_EqJqRqJyQmPk[eDqGuFwMaEsKeGcPeGaPu@w@oDqJcCwGmDqJcF{Ns@_DMcDFqGNQNkDFeTUcHu@kMg@{CW}@}GePkA{CiFuLiHaMwKgPiJ{MiC{DgLsOuCmEuF_OgGuP_AgC}D_MyAkDmC{DoBcCUEsBkCyDkGqWo`@gBqC@Q_@}@_FeI}DcGcI{LiE{FsBeBgAU}CcCcHqF_E}ByEkBwLgHuOkIwIeFaMyGuW{NwCsByK_LUPD\\LX~F|GdEdDbOvIh@x@VrAE`A_@dAqB`C}AnAeE|AyF\\sKR{g@T{P@mPQs@a@i@Go@`@w@Pmc@Jem@Bwc@Do@WSK}@Bk@^m@NsZBKYw@{@[u@aAo@yAw@eAyAyG@@hB",start:Bt.royal_meenakshi,end:Bt.airport,stops:[],contact:"",timings:[240,280,330,390,420,450,510,540,580,615,660,690,735,780,930,1050,1090,1120,1185,1240,1270,1310,1340,1410]},{name:"KIA-15",route:"k_lyM{penA}@BEuBMyGKkGq@mDe@oEk@qAsAyC}@iBy@uAsAaBsCwC}@i@uFsCWOFOH[Bq@B{E?QUDwBP_Gf@}Gd@sDLcDDaAAWYGE]?}E?IDWV{@AyEDeC\\wXnEqGvA}QbFwJ`CmARwCr@[FUw@e@eBGOa@sBu@aCkDgLqBcGwAcDiDgFwGaJ_@cDsByHa@qDQaCPyBbBwOvBePj@}EN}A@kB[gD_@kAuBeEqLmWuF}Lu@gCeAyE_AyIEoA\\G?i@QKO?CgA?wBNyLdAkRXaDnA{GjAgDrAyC`DiHxAeDjAgD^iDDgCOoB_AwH{CoS_B{Km@oEIcBJkHR{FGiGEoDSkGy@sHuEuUCe@@I@Sf@ThAh@fHbDpPbIxNrIrTrNtBrAFYlAcDrAaDd@q@bDsHlOo\\tBwEdJuRnI_QlEgDbC{BpCuD`FkHhAwCb@mB`@cCXeE`@qOXqJXqKf@sMJgDYsEiA_DmBoEmBoEgBiEQcAWwDUyCkBwH}@iG}BiHcDoLc@iBiAyDeAwBcAoCm@uCSoAM{B?cCIsBw@_Eo@cHc@_Fc@uFi@sM_@gGgBiPWuDAwF_@eXO_USeM@oBn@{A`C_GxA}Ej@yCVcDK_BwAuJkAmHo@cD{@kCcAoESoBQq@y@AkBRc@EOWYsA}@cH]iAQWWqBOqDRe@\\IzIgBdF}@h@Ix@o@`AgApBwA`DaBjCkA|DyAxGgBjCi@rCc@lCq@`I}BpH_BrUsEtD{@f@a@Pg@GcECaETs@hBcDVw@LgJ?sJGcFAm@XaAHWX{@~@aB|EgGnEqFpFuGn@_BZ_BF}CZwA@q@_@_I@u@hC_F~@sBlAoE~DsIbD}HrAiHt@wAxAkA~@mAv@aB~@cC`CqIb@cAPKt@kAxFaJXq@ASNuCdAqGn@eDxAgEx@_CxA`@|C|@dCn@~@DTK\\q@h@[pBa@hBORMDWBIjASdEo@~CYrFm@xA}A`AaAbCmArAq@xA_ARi@?mAbHIpE[~BEpAG`F}@dImAbCYp@]|Bq@x@LR^bApBn@dBd@r@f@SbDg@tDe@rDKrEVfFV~D@X@NBrA^pBd@bBFzLNfRn@pGMbBNdCGvB@v@GJSeAaMcB{Ks@_Mi@iNMaKNmAnA}EpAmFZ}APURw@Oa@a@Os@NOPw@Pmc@Jem@Bwc@Do@Wu@QgAh@m@NsZBKYw@{@[u@aAo@yAw@eAyAyG@@hB",start:Bt.whitefield,end:Bt.airport,stops:[],contact:"",timings:[255,315,375,495,555,615,675,810,870,930,990,1050,1110,1170,1230]},{name:"KIA-17",route:"}e}wM{eymAw@VFRJZx@CdCq@b@AdC|B~@fAbCxJf@p@bBp@nFK~BDjDfAjE|@f@\\lFlAb@SFa@Y_@oGsBQi@Cm@BUDg@YaAk@qBiBuGkDiMiBkG}EwQoE}PkAmFOg@e@{BmCwJaDaMgEwRq@aCm@k@g@MqKlBc@Cy@eAoAiBq@cBy@iCgAmBi@}EUgB_A}Mu@iHaCmIqAsDaD_HmCmEwE_JaB_JeByCyEwCaCcBYeBi@_CwAwCmA_C_FsGaDuFiBeFsGqToAkI[sBCsB`@oCHmFUcCy@sCeFsOw@wCsAeCcGiKuBcEiA_D{AqFcBwJwAoJm@iDGeFGcENq@Ru@PoAF{CU{Ay@{Aq@mAaAwB_A}CcA}DaGh@oD?}E_AgBc@kAEoBTgJbCqA`@qFmUk@qAg@yBs@wCiAoDcNa_@oKoYsAcEa@wBKiBAmD@{FQ_Hq@mDuA}C{EiFkB_C}CgFqBmEgAqDuBoJmAmGu@aGk@cGmAgGuA{DsFaLmNyYiAcCO[OHoBn@aA`@iItD_@J[w@sBuRiCeS}A{MWy@{LkKcBgA}DmAuI_CyNiDuK_CmIkBcDm@{@MSSo@EmHf@e@ESa@`@eCr@gBBADEBMIM[@q@`Cm@lB{@jA[Zq@JkLJkFKqAQaE{B_@C{L}H_DoAmAU}Kq@sLo@mNa@?McEGsACsCI}DI}DSwH[{BT_@LFNsA\\[Pg@XkJ|GqCvB{GtD_FpCyBp@kOhBqADeC_@qDy@c@QKQ@?HZS@i@NgAVNv@@Nq@FEWr@E~ADv@Qq@eBq@sBMsCQeCg@qBcFoMiBiFU{A?_@DYu@kEmA_JB_DTcG?_QKkQ\\sIRsOXeLx@aYVsOa@yQiAyYE_BYiDaDuLyJkZsAgFeA{JiAmHuBuIkEcOmEyUwAeJ]{@c@}AgCoGgJcR}[cn@sDgHuFwMuE}LsJsWmBgF{@gA_EeKqCsHgFgNmDsKg@oCCmELuEHMN_L@oLg@qMw@eKwAkEqImSoCmGkCqF{JePkImLgJeNqGqI_JqMgPic@sD}KkAsDeEyGoBcCUEsBkCyDkGyLyQaOcU_GcJcBeCcDcFVMmE}GqBwCmAuAwC}Bm@KgAaAyG{EgCsBwC_ByEmBsAkAuIiFyCuAqPcKmB{BsAeDiAuGc@qAk@q@}@c@}AMqAVgAv@uB~C}FzI{BtB}CxAgEr@ig@Vg[HeWSiAi@}@V}@Zmc@JiqAZaA[MKq@GkAh@sZHiAi@_AiBi@a@_@MkFBwCCc@_@",start:Bt.kengeri,end:Bt.airport,stops:[],contact:"",timings:[430,600,690,725,1065,1200,1270,1320]}],from:[{name:"KIA-4",route:"m}poAkkhyM?_Fr@?xD?@uBsIC@{HFKdG?nFFr@Xd@f@Rv@Cl[WfA}@z@}Bz@[^]jAA|XLj@b@|@C`@IN[j@ER]vqAMpc@Pl@XVHXC^OZ_@j@E^Nb_@M~Q?jVH~A?jIIlCY|Bo@tBqAdCoE`F]r@WhACzAXrAvJhQbGfKtArClTv_@`HdLnA`BzBtBDBTa@dCbBOd@jBlAvMpItE|C~HlFrNdJnPtKrKbHnM`JzAz@rAf@hErA`j@|RdCfAdH~EjO|K`HtEzPnLpIlFxFfD|Ax@nHbDzJdEbH|C|CjAlCp@zBRfO~@vGFbNKxMMnDFzAPrAZlEnAbMpErDtAbDhAhRbH|f@dRzJzDxEpBbGlC|KzFbT`L`L|FbYnN|DzAfD|@pE|@vWvE`FnA`PvE|Cl@xHhAlG|@|IrB|NbFnFbBdN`ElCd@nAJ|DPfXv@nHZvDF|ECbb@mA~COhEQjFE|FGnT_@fPDvL?tHQdC@pBPnIlAvF|@pAX`Bj@|D|AzBt@lA`@|@RlE^l@FxAT`B`@nE~AvErAxB^nC`@|BVxBN|CVxBJrCDnC@r@HrG|BpBb@x@JnAHzAT`Cz@|JlDrH~B`F~AbE|@lCl@xBTf@FdIxArC`@zCRvDp@xARfBVpBFjH?fHIx@@XMVEt@EpCB~@@\\\\Sh@m@D}Cd@}GTcAd@oAh@kAZa@hDoC|DmCbFuCpDwBrIcFjDeBhBcAzBiAn@MlAYDYPYfJeN`AuAx@sBrAsDlAgCnAiBPS\\\\SpDw@t@MrBc@hBm@bBo@lD}A~HqCzBsAb@M`@aC`@iB^eBTeAf@gBjAqDfAmD~@kEHmBBaAN{AHa@NQr@aAnDkFh@gAd@y@f@yAj@yCXsA^w@r@{AbCmFtBmE|AaDlByCpC{DbAmBr@qBCe@Iw@FENGZC~@d@q@fAa@ZSG@QCe@[}C{@qKLSTG`@ChLHhF@hJkAdAO^MLGO]Qs@QsAEcCi@mKF}@t@{Gn@yEHiDMcCE{AEa@LIhAxAlAvAh@h@jChB~CnBp@b@nAp@CMAU?QHiC`@eHNqDFgCAy@CcBGwIIsGEmGQqNAcEU{TIeH?QNA~Tg@dGM`CCxBMzAShEe@rB[tBSdAQrAORMFm@`@wEn@kEJ{AZiBn@cFt@}Jn@yJl@wIh@uHCWHwA`@gGDm@AUEMLIvD{BhBkArM_IjGsDlEgD~Aw@r@Mn@EfDCxB?Y~B[xBELF@",start:Bt.airport,end:Bt.hal,stops:[],contact:"",timings:[360,420,480,870,910,990,1030,1060,1160,1180,1220,1260,1335]},{name:"KIA-4A",route:"k_lyM{penAFdBr@CvAIxNs@`Uw@xT{@^JlF[dAi@zEYnRkA~BPb@T{C|LmFvSgBhG{@zCqChIw@jBi@p@aA^qGToEPqCv@cBx@q@p@u@nA]`CJ`Bv@fC`ChFzApCp@|Cl@vFlCjLpBjHn@|CaHj@D^`IGdEWpAKtOm@tc@{AbSq@zFQjEOvADzMrAxGn@~a@hEzLhA~]zAjKR~@IvBq@pG_C`RkHdKaDhDa@~Ic@bJKdBMZK?VzCEbDWRAEs@?cAAwCZoBj@qApE_GpMuT~BuDhAoBL@RAlAGdF[dL_ArRsAvOiAtMgBhJ_A\\gBd@{D`A}H`@uEZwHn@oWf^^bi@j@dJJjHWvMk@fA?NGIO{AgCgBsCaD_EsAmAcAw@l@@tCP~B?xFm@pEg@fD[nCFfHb@bCLxBn@h@gArAuJHqCM_PLq@f@YdABtIz@r@j@d@~@r@_@^_@~@q@`GkD~CyBxBsAhD_BpKgFfCgAxE}@pDwArGgE|BwAhASzEI~Cw@zIkC|IaC`Eo@Nw@rA{BpC_IlCqG~AsGn@{Cf@_ArAcAzBgA|EkBhE{BfL}HvA{@h@Gl@sBvBmEtIuOvHmMhFgHtA_A~C_AdGi@bH?`@?ASGwF?mAOQFyIDoFEgE_@uC}@{Fa@kE_CoN@aAUyAqAwG_D_KcEoLgB_Fg@kDc@eCgA_Ew@gCOcCMqHM{@QEgB}NcAaFy@iCu@qBw@iCc@{CMiBG}@SuBoCsHiBiFU{A?_@DYu@kEmA_JB_DTcG?yOKuNL{J^yMZaPH[VkGt@mZDuG_@_Om@_Oc@qMe@oDcAgEgBgGsCiIeF}OaBmHeAcLy@iEoByHiC{IqAsE{@mE_FcY}AeFcB_EwF_LqKwSaLaTkKoSmKoWuOkb@_@u@u@w@oDqJcCwGi@{AcCuGcF{Ns@_DMcDFqGNQFg@NcUCsCq@sOk@{GUy@{FmNcEcK{CcHkC_F{IoNaI_LyIsMqGqI_JqMyIqUgIcU{BqHm@sAqCeEwBuCu@UcRqY_LuPiCmEaAeC}NwT{IyMaC}B}@c@k@IgAaAeEyCsAaAcCqBkAq@aFuBuLaHiB_AeAg@Ua@e@WmFaDsFcDmBaBqBgDq@oCs@kEu@iBs@k@aAY_AE_ANgAn@qA`BsHhLkAnAyAdAsBx@}Bd@eDRuL@ui@T_a@Le@?_@p@e@~AeCdKeA`Am@Vg@ToC?uKDq[Hi]Lon@NqJHeBG{@QgAq@c@i@{DcIYuAGmBCi@[cBgAcBsAgBeFDiA?AdA",start:Bt.airport,end:Bt.whitefield,stops:[],contact:"",timings:[510,525,555,585,610,690,720,765,825,925,1130,1280]},{name:"KIA-5",route:"i~mxMo}ymAaBC?UAWOJ?XKjBEfD?jCFpA\\zE|AnJHxCGzFQnIs@lIFp@O?kD?kIDcN@cZNcAKwODFe@DoAGiI@uJBqEOcFCwF?{IBkA^?`FU`AIzAK?_CDe@Bc@AoHIeMKcI?_C?MO@qEHuEBMwQa@{@e@yDPgBZeAd@c@hG?hDAOsDIeOE}F_@uJ?gBHwDcEAAACCEAQw\\CyIF_AHI?YUM_@qCa@gAcAwAu@k@oC}@s@[cDo@yCKwEMsAeAcDwCoFmBsDuBsAs@[t@{AzDWx@yA~BoCdCc@\\s@qAyJgOzC_DpB{AnEmDpCoC}AsAwAyAjAcAnCcCxDuC|CkCvB_BRIK]IWIc@cC}ImCqIuDwMWm@m@i@{DyCcAaAcBsCm@gBg@{Ag@i@yC{BwAuAiAy@sCcCkFmDeAi@uBkA{C_CoI}EcC}@XcAhAcENWjD{A|F]bCSTk@y@yLC}@~CuCrAAfFEZiAzIwU~@aBVK~D_AdJsBxB_@nD_Ap@[Pa@D]dCs@zOqFbBi@h@i@e@gA{@}CScAFm@FGxAsAxKuIx@}@Vy@d@cFL_Cr@gITw@^u@FgAYy@TcCv@{F|@cHTmBpAeJ]mC?oCDsHOoDf@eWVsOEaKOkPC}JJqNMoGuAkIa@kEu@cEiAkHHWMkA[cBg@aCe@cCqBeGyCiJaCqGmA}DQuBk@oC}BgIUyJCu@Mg@CAWuA}@_IiBaJoCcIu@kFKkAGeAMaA[wAsCwHuAoESsAHO?_@iByKYmDJoDPiFDsIMyOAiIHuDZiJFuHHuCf@{Ov@u[?qDK}HsAq\\UmGUqCcAgEgBgGsCiIeF}OaBmHeAcLy@iEcAkEk@mBiC{IqAsE{@mEkD_SS}A_@eBY{@cAiDcB_EwF_LqKwSaLaTeF}JoEaJsJeVqOcb@iAoAuGiQqAqDaGaPwBgHc@wCDoJTc@PyRIyJ_@eHa@uGg@{CmCeHaFqLoFiMmFiJyFeJ_EyFcIeLuEeHgLsOuCmEuF_OgGwPyD{KgAuDg@qAgAqBcDmEw@kAQCc@QgBmCmMcSyPkW{KyPmE}GVMKOsHeL[c@iCeCmBu@aMuJ{FyCqEqBkBgBwIaFkA_@uM}HoCyBqBgDq@oCeA}Fc@w@s@k@aAYcB?oAf@eBrBqFtImCbDyAdAsBx@}Bd@eDRmd@PaUD_\\Kw@Ia@Wo@Ke@RILw@PwuBf@kAe@u@I]Nm@Xk@ByY?w@c@o@sAc@g@u@]{J@i@a@A?",start:Bt.airport,end:Bt.banashankari,stops:[],contact:"",timings:[50,360,420,460,480,500,520,560,580,600,640,680,700,720,735,750,780,810,840,870,900,960,1e3,1020,1040,1080,1140,1200,1230,1260,1280,1320,1340,1380,1400]},{name:"KIA-5D",route:"ihexMwsnmASJOW_@y@eBaEcBuCw@yBwA{A_JmFiCiC_D_EkI{LcDaF}TwYiBoBgBsA}Aq@{EcB}DyAmBkByAiDJo@}AqEo@m@Uu@wDiMkCuI{@oAwAy@iO}BoTmEyRiEiOgDaFkBiHkEwFwEyEyE{QmOmLkLkLcOqByCgAkBu@_CgAuEi@cEDuC`@}FCoAQuFHwAn@cJ^iPBcEe@{FqAaIW}GF{DBoAhA@zACBiAEkBMIs@Ia@h@sAp@UpJNtDp@pHlA|H@nBYtPs@lIFp@O?aB?cGBiN@g_@HcQ@JaBGqH@sKMiRAwC@sHNk@fCIjGc@FyNUiWEgSv@yE?}Bc@oCSo@OsDIeOE}F_@}MHwDcEAAAAAECGyCKkd@Nc@_@eBmAoEaA{@gF_BmFy@oFImAQ}@y@cDwCkIaDcCqB]Be@t@e@lAaC}@kN}FoDgDvRwPbJmH\\If@p@XpAn@dBx@b@vAc@}@iEmB_IaCcIgC_KoDeM}Ao@sE{DoC_GNSj@El@KnAm@vC{FvCqD|@m@~Bq@|Hy@|Cb@dFh@jBHvDbApBnBL@f@QP[P{BdA}AbE}DlDsCfIaHlGiFtEkCVKa@m@wBiDeJcNgByCuGmNsFqJyEwLwBsFy@uC]yADs@JMxLqJ|BeCf@cEhAcOr@mBBkBQs@bCmQx@cIt@_EIyAQaDA}DDuDO}Dz@k`@I}YMoMLkWOoEoBgM[{Cq@mDm@}D?aAOyAkA}FeD}KyCeJyDcLaAoGuAyEe@_CQaJSuA_@uBgA{I{AmH{CeJu@{GKsAw@kDcDqIi@iBBu@YeADY{AgJg@cEB_DZgPKkNE_GL{J^yMB_Fb@cN~@i]BeNwAs^SsGEaBu@wEaEkNcF{NsCoJ_A{FoAoLcBuHuBgHmDoM_FqYmAoEmBqFmE{IsI}PuHuNiPe[oGqNcEmKaFyMiI_U_@u@u@w@oDqJcCwGi@{AgJqWs@_DMcDVcHNkDB_WgAuS_AyE}GePcE{J_D{GqC}E_L_QyGqJ_HgK}HeKwFiI_CkFqK{Y{DaLwCwIiG{Iu@UcGoJ_Ww_@iCmE_@eA}KiQuLsQ_CkCgBiAk@IgAaAeEyCsDyC_E}ByEkBwLgHeBy@e@i@aJoFgDqBuBsBkByDa@kBsAqGsAkAaCUcATgAv@qHfLeDvDsAz@iC|@}B^gDJyp@VqMB{XHmCtIk@nCi@hAy@p@iAd@wLB}c@Lku@Rc_@NeCm@kB_CaDeHOkAMyCk@yBo@_@o@AiIPOeA",start:Bt.airport,end:Bt.silk_institute,stops:[],contact:"",timings:[110,300,390,440,820,1060,1120,1170]},{name:"KIA-6",route:"qeryMcfinAd@KLf@HX~@tCz@|CPjBXjAjDxEjEdGzBhEbD~KlF~PpAnEd@dClB|PnEt_@tBb[^jEt@xGdFjV~C`OBx@nAhD|E`LzAjEnApAlAh@z@@nDe@tCKrKEfLE`IGnCFl[tCxKd@fLZp\\P~RJvOB|BDrAMxOc@dOe@vQq@ba@oAtK_@jEOvADzMrAtTxBtU~BlJbA|H\\f`@|A`CO|FoBnZkLhFyAvDi@|F[nOWbAW?V`AA~DOpAMnDe@|Cg@tJuAjGi@x@AnGp@`L[vJWjOU`Vw@pWyApP_AbDOdAU`CE~SoAlOcBbDS~@DdGtAv@HbDu@pEiA~FeAlCc@rAg@`HiDv@{ArEeLT[fG_CxDgAzCWrANjDjATFFMj@i@^u@j@{Cf@yGd@oHPgDDqC@WYCm@GUCKAO@FeFQoFYaCBa@IaAL_GAwAcAqCi@[mBg@i@i@aBaFy@wBmCiCX}@rA_KBkEK_NTe@j@SlF`@jDd@TPx@rAfAq@Za@hEwBbEsCdBsAlIeElMaGxE}@lBm@`DgBrHaFhASzEItJgCnGqBrEkA`Eo@Nw@rA{BpC_IlCqG~AsGv@qDf@o@hBoAfCmArDsArBy@tAaAnKkHfAq@`Aa@NAf@eBL_@tDkHzEwIfIqNzEyGpBkBnDiAnD]|DS`DB`A@EuAAyFEOKK@uADiHDgEAkCKcCWoA}@{Fa@kE_CoNHWMkA[cBmAeG}DaMoE_MmA}DQuBk@oCyAcFc@cBKmFMaEMg@CAWuA}@_Ii@wC_AiEmAsDaAoCu@kFSqCMaA[wAsCwHuAoESsAHO?_@_AqFi@gDYmD\\yKEsSCcPHuDZiJFuH\\uL~@e\\J}KK}Hg@{Lw@kSIwBUqCkDoMsCiIeF}OaBmHeAcLy@iEcAkEk@mBiC{IqAsEgFmYs@cEY{@cAiDcB_EqJqRqJyQmPk[oEaJ_GsNmEmLoJmWgAyCiAoAqIiUwGsQwBgHc@wCDoJTc@PyRA{Eg@cMa@uGg@{CmCeHuHwQ{CcHkC_F{IoNaI_LgJcNoHyJ}HiLmMm]mEcMkCiIgAqBcDmEw@kAQCc@QgBmCmMcS}GcKmLsQiGmJmE}GVMKOsHeL[c@iCeCmBu@aMuJ{FyCqEqBkBgBwIaFaD}A_K_GoCyBqBgDmAaGi@kCc@w@s@k@aAYcB?oAf@eBrBqFtI{BrCqCjBsCz@}E`@iw@Ve_@KiASUQi@Go@`@w@PmFBulARga@Js@]g@Oc@FOLaAX{YD_@KaA{@Wu@c@g@u@]{J@i@c@A@",start:Bt.airport,end:Bt.kadugodi,stops:[],contact:"",timings:[30,60,180,600,660,705,750,780,960,1020,1050,1105,1200,1305,1350,1365,1390,1410]},{name:"KIA-6A",route:"qeryMcfinALE%5EbAPA%5CjA%5EbAZ%7C%40d%40~BPrBp%40hAfFdH~DbGx%40vBlAdEzDbMzDtMFNL%3FzA%5DjJsBbM%7BCjKsC~Bq%40fJ%7DAtGaA%7CKcB~O%3FdE%40bEKbIy%40bKw%40~P%7DA%7COwBz%40UdCuAtAg%40dI_B~Bg%40zBg%40~CsAbHkDbCKpE%40bIIv%40Rb%40Z%60C%7CBxEvDpA%60AvFrC%7C%40n%40h%40r%40lClAv%40PlAV~%40d%40fAh%40nAv%40l%40z%40nArChApDNrA%40N%60%40%3FZsAvCiNrBiJlAsFnB%7BIBYZ%3Fx%40CbAIjB%5DxJeBzIaBxEq%40lHeBfEo%40xDQpDc%40jDcAdF_BzA%5DlJ%7DB%7CH_DrBy%40xAgAbBqBjAiA%7C%40o%40~BgAjASzBMfJYpPIVD%60%40L%7C%40CbCEzB%3FvCHzFGxA%5ElAf%40lBl%40lCx%40jG%7CB%60WlJz%40BjBz%40xMdEnBf%40rA%40dAUbAgA~CgGzAwCXo%40Ls%40D%7DBf%40yUXoKtAwN%5EkFR%7BHh%40qRVwHL%7BCXoBVg%40f%40%5DvNyElVcIxJeCvi%40sQ%7Ce%40aPrC%7B%40bAMpKiAvEm%40hHoAvNoEdA%7B%40fBgF%7CKoYtE_LpBcEr%40u%40zBcBzD_CtEcHrBwCdAkApAq%40pBUzB%3FnW%5CxDJvAIzCg%40zEiAbBc%40hB%7B%40xAc%40tLgBrDk%40FA%40RfHkAnEi%40bGg%40xODfUEdCHnARjAj%40vBtAvBzAnBdAd%40LfBRvKCzAKj%40GTSlE_AlCe%40jDg%40n%40FvBScByEQwD_%40aDyAmD_FsMi%40iBU%7BA%3F_%40DKGk%40kAeHa%40oCOcD%5C%7DK%3FwKGaGEiFHkJRiDLgIDuG%60%40gM%7C%40g%5CHsNu%40%7BSu%40%7BRIuBS%7DBScAuAiF%7DAkFmJiYuAmGoAoMwAgH%7DAcF_CcIoA%7BE_CoMkB%7DKYqBOWa%40oAoAyDcD%7DGgIqPkJiQwOiZmEeJgHeQsD%7BJ%7BJeXa%40iAs%40u%40_AwByFmOk%40%7DAkImUkAgEYmCBkCBiEHKHMBSNoUCsCIqDg%40aJk%40%7BGUy%40aAqCyD%7BIyBsFsAaD%7DCeHuCkFyIiNyJkN%7DGaK%7DHiK_GqIkA%7BBwLi%5CmE_McC%7BHgCcE%7BByCg%40m%40UEWM%7BA%7DBsA%7DB%7BKuPsLmQmIsMgF%7DHcDcFVMmE%7DGqBwCmAuAwAsA_Ai%40m%40KgAaAyG%7BEgCsBwC_ByEmBs%40a%40_%40i%40uIiFiBaAeCqA%7BMeImB%7BBsAeDiAuGc%40qAk%40q%40%7D%40c%40cAMkBVgAv%40sJzN%7BBtBoAt%40sCz%40aCZ_u%40%5CqMBeWSiAi%40e%40D%5BVc%40PcGF%7DnB%5EkAk%40w%40Hu%40%5EsZHs%40Ym%40m%40g%40kAiAo%40%7BJ%40YQQO",start:Bt.airport,end:Bt.kadugodi,stops:[],contact:"",timings:[390,450,800,890]},{name:"KIA-7",route:"%7DuzxMa%60ymA%5CA%40%7CAH%3FAaAE%40ImCG%7BDFM%40sCEwCGaD_%40sS%7B%40gEe%40qB_DkIo%40sBlBm%40dCw%40j%40UxAaAnB_AfAWfAGtQzAnMpApIl%40lB%40vAM%60%40MxHaCtRqGfQqFf%5CcJdCq%40d%40Bx%40FFO~B_ErA%7BCnAwA%60DcC~QkMzD%7DBfDgBpAa%40hEiAlAKdNgAxTcBbCo%40%60By%40ZG%7C%40mApB_DpAmDVwCt%40wN%7C%40oHZy%40%60%40_%40nBoA~Ay%40%7BBcEcEcGsBaDjAqAjDsCnAoAvB_B~%40w%40rAoAZ%5BYS%7BCyCfB%7DA%60DoCrFkEbCsB%7C%40e%40Mc%40a%40%7DAaEqNuCwJiBkGS_%40iBqAcDoCeBkCk%40qA_%40gAk%40%7BA_EaDMQwAaAmAiA%7BGkFeE%7BBmAo%40qHmFkDgBcC%7D%40dAqDb%40aBTSlD%7BAlGW%60BOJGNm%40_AoNjDuCvGIV%40%3FQ~BkGvEqMtAiCtCy%40pEeAfCk%40mFsGiGwETo%40jI_KlJuMvAaBt%40w%40h%40p%40tAfBl%40h%40zGzIjGdGrCxCNRZ%5Be%40gAq%40aC%5DyADs%40JMBItLgJ%7CAsA%5Eq%40f%40cEhAcOPu%40%60%40w%40JcAGg%40OYAYbCmQx%40cIt%40_EKaBQ%7B%40%40%7B%40AqAB%7BGI%7BACeF%7C%40y_%40%3FcNOwJIaOJsUGsBO%7D%40%7D%40aFi%40iFyB_NIm%40HSEa%40WeBqAwGiBqFu%40mCcEoLgB_FYoAM%7BAc%40eCgA_Ew%40gCOcCMqHM%7B%40QE_AeJg%40wCcAaFy%40iCu%40qBw%40iCc%40%7BCMiBG%7D%40SuBoCsHiBiFU%7BA%3F_%40DYu%40kEe%40%7BCg%40cEB_DTcGDcHE%7BGKkQHiDRiDRsOXeLx%40aYVsOCsF%5DeJiAyYE_BYiDi%40gCwBmHqBkGgG_RsAgF%5BgBi%40sGe%40%7BDc%40qBs%40uDaA_DsBcHwA_FgAkFeCmNwAeJ%5D%7B%40c%40%7DAgCoGgJcR%7D%5Bcn%40sDgHuFwMuE%7DLsJsWmBgF%7B%40gA_AwB_CmGqCsHgFgNmDsKg%40oCCmEBiEHKHMN_L%40oLCyAc%40wJw%40eKwAkEcHmPm%40_BoCmGkCqF%7BJePkImLgJeNqGqI_JqMsDoJ%7DF%7BOuB%7DFsD%7DKkAsDw%40%7DAmC%7BDoBcCUEWM%7BA%7DBsA%7DBeBmCyLyQaOcU_GcJcBeCcDcFVMmE%7DGqBwCwB_CqAcAiA%5BuHyFkC%7BBkBiAeFwB%7BBiA_%40i%40iKoGoAe%40_PkJuBsB%7B%40uAo%40cBiAsGa%40yAi%40w%40uAq%40_BGoA%5CuAnA%7DHxLeBnB%7DCjBkCr%40qCViUL%7Br%40NsPSc%40Yi%40Mk%40PKLo%40PkRJccBZiAi%40%7D%40Bk%40Zm%40H%7BYBs%40%5Di%40q%40Yy%40g%40c%40i%40SqJBs%40e%40A%40",start:Bt.airport,end:Bt.hsr,stops:[],contact:"",timings:[45,490,580,630,750,840,900,1080,1165,1230,1375,1420]},{name:"KIA-7A",route:"%7DuzxMa%60ymA%5CAJ%7CAG_AImC%40%7DIMyH_%40sS%7B%40gEe%40qB_DkIo%40sBlBm%40dCw%40j%40UxAaAnB_AfAWfAGtQzANBBSP_CdAuUZ%7BFl%40oC%60%40%7B%40vCuCpIoItSiTcCeBgBy%40iBs%40aDo%40oFEiG%3F_D%40%7BE%3FqAK%7BA%5D_CaAiBqAeAoAoDmG_LcTiDyGcCaFUsAR_BVi%40z%40%7B%40nD_Dn%40yAHiAYuAkAyC%7BDuHiC%7DF%5DsMFiF%40m%40%40a%40%5ECnG%5BlH_%40MmAw%40wJGc%40fBKtBOfGk%40dGw%40bDS~%40DdGtAv%40HbDu%40pEiA~FeAlCc%40rAg%40%60HiDv%40%7BArEeLT%5BfG_CxDgAzCWrANjDjATFFMj%40i%40%5Eu%40j%40%7BCf%40yGd%40oHPgDDqCtBApG%7B%40tRkCdc%40sGjBYRCAUs%40aDU%7D%40eAkDxK_CvXmGTEGWg%40_BeBmHQu%40i%40yBDe%40Z_B%3FOy%40sESUPAlAWTp%40f%40hAZdBEF_AZUT%5C~ArFcAlHyAcAcDhBo%40h%40YdEf%40lBRdC%40p%40%40v%40j%40HdCIpAR%60CPN%7CAx%40xAn%40jLgCdFmAv%40YTWJo%40tS_HxA%5Db%40_%40Z%5B%5Ds%40k%40qBQm%40YoADs%40JMBItLgJ%7CAsA%5Eq%40f%40cEhAcOPu%40%60%40w%40JcAGg%40Qs%40bCmQx%40cIt%40_EKaBOwBAqAB%7BGI%7BACeF%7C%40y_%40%3FcNOwJIaOJsUWqD%7D%40aFi%40iFyB_NIm%40HSEa%40WeBqAwG_D_KcEoLgB_FYoAM%7BAc%40eCgA_Ew%40gCOcCMqHM%7B%40QE_AeJg%40wCcAaFy%40iCu%40qBw%40iCc%40%7BCMiBG%7D%40SuBoCsHiBiFU%7BA%3F_%40DYu%40kEe%40%7BCg%40cEB_DTcGDcHE%7BGKkQHiDRiDRsOXeLx%40aYVsOCsF%5DeJiAyYE_BYiDi%40gCwBmHyJkZsAgF%5BgBi%40sGiAmHs%40uDaA_DsBcHwA_FmEyUwAeJ%5D%7B%40c%40%7DAgCoGgJcR%7D%5Bcn%40sDgHuFwMuE%7DLsJsWmBgF%7B%40gA_AwB_CmGqCsHgFgNmDsKg%40oCCmEBiEHKHMN_L%40oLCyAc%40wJw%40eKwAkEqImSoCmGkCqF%7BJePkImLgJeNqGqI_JqMsDoJ%7DF%7BOuB%7DFsD%7DKkAsDw%40%7DAmC%7BDoBcCUEWM%7BA%7DBsA%7DBeBmCyLyQaOcU_GcJcBeCcDcFVMmE%7DGqBwCwB_CqAcAiA%5BuHyFkC%7BBkBiAeFwB%7BBiA_%40i%40iKoGoAe%40_PkJuBsBkByDiAsGa%40yAi%40w%40uAq%40_BGoA%5CuAnA%7DHxLeBnB%7DCjBkCr%40qCViUL%7Br%40NsPSc%40Yi%40Mk%40P%7B%40%5EkRJccBZiAi%40%7D%40Bk%40Zm%40H%7BYBs%40%5Di%40q%40Yy%40g%40c%40i%40SqJBs%40e%40A%40",start:Bt.airport,end:Bt.hsr,stops:[],contact:"",timings:[5,60,390,450,500,540,600,660,690,720,770,810,870,930,980,1040,1090,1185,1235,1265,1295,1340,1385]},{name:"KIA-8",route:"efayMoblmAOKd@s@hA_B~BeCdU_[zYma@bc@ql@lZoa@tEuGjFoG|LsNjDeFdEcI`Ra^fUec@|N}Xr[em@`GcLhC{EPm@fSa`@dQw\\h@g@lC{F~BcF{Ce@uIi@wBDaKhBwEv@gCHkHV_HTgPn@wCHqKt@oA?uBUkDaAkAo@kDkCoEwEgNaRsA{AaHgGmA_AaCkAkCi@yF_@wDKgCF}N|AyGp@mGbAcYbHiS`DeAb@iEd@gAAg@c@qAg@k@Yq@EaLkEqX{JoKuDgHsCsJsDiVwIuQmHeEiCoG_F{OgNuTyRcJoJiB{C}FwKqB_EgAcEkGgWaAiGiAqLeA}H{BaOiAuFQoCE{CMuGwAgPy@eJa@yLf@wD~@wClPy[bGiL|HuNnMcWvN{XfK_SjCgFdBiCjBwCpGsJpLuQnCqE`JwPb@c@d@[j@IhEItEDzGEvB`@`GpBbQrG|M`FvAXVAl@\\rBv@vNlEdAH~@EvAs@f@u@dDuGlBcE`Aq`@FqDh@wFpAaQp@uTh@yQLsB\\oA\\_@|Ak@rRmGzQcGbDw@zJ{Ch]eLt_@gMnOaFvOcBzEs@bF}@rCw@hH{BdB{@l@_A|DaLtKoXdFeL|A{AdEeCzAkA`GiJ`BsBx@o@`Bc@xAIdPLdOZbEg@fB[fG{ApCoAzScDHPfHkApJgAxIK`QJfLIdCHnARr@Zj@\\zEbDtCrAfBRxFAxFM`A[lE_AtGgAr@E~ADv@Qq@eBq@sBMsCQeCg@qBsA{CyF}OU{A?_@DY{AgJg@cEB_DTcGDcHKiPE}H\\sITmSf@cO~@y^AwJmB_h@YiDi@gCwBmHqBkGgG_RsAgF[gBi@sGiAmHs@uDaA_DsBcHwA_FgAkF}EsYaAyCgCoGiFeK_JkQoZ}k@mKoWwFiOgHwR{@gA_AwB_CmGqCsH]}@iEiLmDsKg@oCCmELuEHMN_LAiOc@wJw@eKwAkEcHmP}DmJkCqFsCwEgFmIsDgFqHkKkGqJkIyKgFwHsDoJsIuU_AgC}D_MyAkDmC{DoBcCUEsBkCyDkGqWo`@iLqQcBeCcDcFVMmE}GqBwCmAuAwC}Bm@KgAaAyG{EgCsBwC_ByEmBsAkAuIiFyCuAqPcKmB{BsAeDiAuGc@qAk@q@}@c@}AMqAVgAv@uB~C}FzI{BtB}CxAgEr@ig@Vg[HeWSs@a@i@Go@`@w@PmFBulARga@J{@c@q@GYJq@\\sZHiAi@a@s@]u@i@a@_@MkFBwCCc@_@",start:Bt.airport,end:Bt.ecity,stops:[],contact:"",timings:[5,20,60,100,140,180,220,255,300,315,330,360,380,410,430,440,460,485,500,520,560,575,600,625,800,815,845,875,890,915,945,960,990,1020,1035,1065,1280,1320,1360,1400]},{name:"KIA-8C",route:"_tgyM}lcmATKlC_@zEeApAe@nC}AxAoAbA_Bxk@_w@pRkWpG_Jr\\m^rFiIrE_LdBkHfAkFdCuLhBiHlFwR~@cCvBmDrUe\\|L_Q~A_CzBkCbBuBbQ{UdMkQfLwOh]ae@bPsTxOeTpKyNfNcPtDaF|DeHzJkRh]gp@pl@{hAvKqSPm@lKaSfVme@`CqDlC{F~BcF{Ce@uIi@wBDyQ`D{d@`ByLj@yFXwAKyDaAkAi@iDgCcE_EaCeD}IsLwCgDcI_HgCsAoFcA}HWwAAiGd@uN~AuFp@iQjEkJvBgKzAcC`@_Dl@YTyDj@iA@c@A]YSUcBk@q@MaX{JmWaJuKkEgWiJoPqGiL}EaHiF}P{NkE{DcOuMyJ_K}DcHqGyLwA}EiEcQyBoKm@kGeB}NyBaOs@sDk@eESqLgC}Ye@cHM_GXcC`AqDjHqNzJuRjHgNfG}K`D_H`HsM|EsJhV{d@zPsWjLkQrHkNxBsDp@a@nDOvJHfEKt@JzCfAfGnBtYxKfDbAz@LdBv@~InChFtApAAjAc@xBgDdEsIRcA^oQb@uQfBiSr@wQf@sSX_I`@mB\\g@vGwBhZwJlHyBzF_BzVoIjO_FpRqG~N_FvDsAxBi@dEa@lHw@hDe@~JoBzGuBxCgAt@{@dBmF~G{PlDmJfFoLbAcBn@k@bDwBdC_BtAoB|F{I`A}@|Ao@lBMzC@zYf@jDQrK{BhDwAfBa@jOyBbAS@RdCc@pHeAbD_@zGUdLFnVExBNfAZ|@d@pCjBpChBnAd@rBRrLCbBQbD_ApFaApC_@dAFhAOLCg@gAy@kCEi@SaE_@aCkEwKaCuGk@aDJWe@aDyAuJEuBZkH@yOMwOL{J^yMZaPj@uRf@aVWuNoAg[MeFu@wEqB_HoAkEcF{NsCoJ_A{FoAoLcBuHkFsQw@cD}BmMaBcKs@uCYy@mBqFgIqPyZkl@_EwHoGqNcGwOkOea@u@w@oDqJcCwGmDqJcF{Ns@_DMcDFqGNQNkDFeTUcHu@kMg@{CW}@}GePkA{CwG{NyJsPoTg[wRkX_CkFsFkOkEqLiDaKmAaEm@sAqCeEwBuCu@UcRqYub@cp@VMKOsHeLeDiDmBu@mG{EsDyCoBkA}I_EkBgBwIaFaD}A_K_GoCyBqBgDwBmKc@w@s@k@aAYcB?oAf@eBrBqFtI{BrCqCjBsCz@}E`@uL@si@Te_@KiASUQi@G_@NOPw@PmFBulARga@J{Am@s@TaAX{YD_@KaA{@Wu@c@g@u@]{J@i@c@A@",start:Bt.airport,end:Bt.chandapura,stops:[],contact:"",timings:[80,160,240,285,765,860,930,1005]},{name:"KIA-8D",route:"stcyMk|xmAjArC\\fAFPKB_B`@HRK[~Aa@hE{AlN_GrGkCvGgBlEu@dBg@jH{DbAaA~@uAf@wBB?DC@C`Ae@`GgCnDyAjCq@vHgBpH}C~D}AdCm@b@ICu@]YSUcBk@q@MmHoCyZ_LkMoEgHsCsJsDiVwIuQmHuBiAoA_AoG_F{OgNuTyRcJoJiB{C}FwKqB_EgAcEkGgWaAiGiAqLeA}H{BaOiAuFQoCE{CMuGwAgPy@eJa@yLf@wD~@wClPy[bGiL|HuNxDyHtGiMvN{XfK_SjCgFdBiCjBwCpGsJpLuQnCqE`JwPb@c@d@[j@IhEItED|@B|EIvB`@`GpBbQrG|M`FvAXVAl@\\rBv@vNlEdAH~@En@Qf@a@f@u@dDuGrAgCX{@RyIRsJXcJFqDh@wFbAkLLuCRgH\\mKh@yQLsB\\oA\\_@|Ak@xDkAxLaEzQcGbDw@zJ{Ch]eLt_@gMtFkBxGuBvOcBzEs@bF}@rCw@hH{BdB{@l@_A|DaLtKoXdFeL|A{ApA}@rBgAzAkA`GiJ`BsBx@o@`Bc@xAIdPLdOZvAIjB]fB[fG{ApCoAzScDFA@RfHkApJgAxIK`QJfLIdCHnARr@Zj@\\zEbDnBdAd@LfBRxFAxFMj@GTSlE_AtGgAr@E^F~@Av@Qq@eBq@sBMsCQeCg@qBsA{CoCsHiBiFU{A?_@DY{AgJg@cEB_DTcGDcHKiPE}HHiDRiDRsO@yBf@cO~@y^AwJmB_h@YiDi@gCwBmHqBkGgG_RsAgF[gBi@sGe@{Dc@qBs@uDaA_DsBcHwA_FgAkF}EsY]{@c@}AgCoGiFeK_JkQoZ}k@uFwMwCwHwFiOgHwR{@gA_AwB_CmGqCsH]}@iEiLmDsKg@oCCmEBiEHKHMN_LAiOc@wJw@eKwAkEcHmP}DmJkCqFsCwEgFmIsDgFqHkKkGqJkIyKgFwHsDoJsIuU_AgC}D_MyAkDmC{DoBcCUEWM{A}BsA}BeBmCyLyQwIuMiLqQcBeCcDcFVMmE}GqBwCmAuAwAsA_Ai@m@KgAaAyG{EgCsBwC_ByEmBs@a@_@i@uIiFmAu@kA_@aJoFoEsCmB{BsAeDiAuGc@qAk@q@}@c@}AMqAVgAv@uB~C}FzI{BtB}CxAgEr@ig@Vg[HeWSs@a@i@Go@`@w@PmFBulARga@J{@c@q@GYJq@\\sZHiAi@a@s@]u@i@a@_@MkFBwCCc@_@",start:Bt.airport,end:Bt.sarjapur,stops:[],contact:"",timings:[370,450,690,750,1220]},{name:"KIA-8E",route:"il~xMmajmAaAB`@bA`@Oa@Na@cAo@_B}AcDcC_GMe@y@]{@m@o@iCiBiJMkBJ_Cb@_KGc@SCk@KgDs@cFCmSDiESaGmAwFuBqGyCKa@x@{A|L}P|P{U~D{FfHaKfFgH^_AhHsJpPcUpV}\\jJiMhUuXnEuGrNuX`Yki@vVoe@hx@{{AbAeB`FsJrS{`@@w@u@MmHc@sGFqNhCoXhAmTv@qKt@eEUwFqBkDkCoEwE{A{ByMeQeJ}HiEwB_HcBkDJYTkABqDT{Q|BuFp@iQjEkJvBgKzAqIzA}Dh@cBUyEsAoYuKeRoGeJqDwHyCuUoIwPwGmIyD_LwImRuPyNmMyJ_K}DcHqGyLwA}EiEcQyBoKm@kGyCgVcDoRSgLoBmV_A_MKqGx@yE`AeCvOwZ`Q_\\nMcW`NwWrJaRdE_IpDqFjGmJ~LmRpKiR~BaEp@e@pJSvCHzFGtGtBxKvD`WlJz@BjBz@vLvDbCr@jADfAMlAaA|CcG|BqETaCh@qVXgLnBmTl@cRd@uQf@cJ|@sAhc@sNtGmBzF_BzVoIjO_FpRqG~N_FvDsA~HkAlHw@tDo@pIiBfI_Cf@Um@{@Y_@w@cA{BeCwLoNqIiHkG}G{D_HiBkBsBoASe@_@gEKsLY}Ca@wAuAaG}@oBuDqE}BiE{@qD]sCa@iAeAiAyAeCKkBOiF]uFmBcLgBwGiBwDoBqCmAiAq@mBWsBO}Kk@qIq@wAgEoHwBk@mCc@o@k@G{HbAcb@AsPKmCa@aBoE}H}CuCg@w@SqBdBmNGsA}AyFcAeEYqC{@}Iu@}DOcBH{@`@{Cf@mDCkBKoCW{A[aDf@y@r@e@NmAi@}Nw@qCuB{CgDkDeAaC{CgHoDmG_DeEwBsGgFoK{@o@qKz@uIXs@_AcA{CwKyf@aF{UUaEXaDd@}EVqLU_IVgBv@sCXwD\\{A|AgB|AuEJuEh@cIc@aDm@aE`@kEuBkDk@a@y@Ms@[u@_Hg@qAyCiCeEsImDyNsAeDuGkHQ]aAqJcBqHsC{GeEaIoGqKwAeBePeMsD{DqNeU{KmSeNsZgBqBmFaHcDwL}@{D_AiCc@mBkE_Pi@uH}@mHw@kAs@sC}@yCcG_IgCwCu@q@XOLCbDg@hJq@rEVfLXh@DdEdAnXh@vI\\vBI`FHZ@xFAp@OBo@y@aNaA{FuAeUo@iIA{JNmA`DkMl@sBRw@[i@{@AuAl@kvBTeBi@_Bt@i[EqAeBg@q@aCmAeAsA{GABfB",start:Bt.airport,end:Bt.ecity_wipro,stops:[],contact:"",timings:[40,120,200,270,790,830,980,1080]},{name:"KIA-9",route:"wvmxMutenAB\\~C?@hCEh@If@GlABh@V|Af@hBZCCQ_@cA]eAMy@Ao@R{AR_C@o@?mAKcEUmEGa@@GCUKGq@M_DOeFi@_Fg@}@[[Wg@w@{@uBYe@[c@}BuB[MwAiA}AiA{@W{Bg@iAKcAC}Id@gA@[C_@Ks@_@uAu@Fs@Pi@lBsBpA{@IW~A_Et@_CgAoBS]yAsCkDqHeBeDcC{DeBqCw@iA{@cAe@c@UMI?oACGOCEEQTyB^oCVkBr@oEHsAJkA`@uDHIHa@d@uC?OIcASiA@}AA}DDuDKs@CmB?[?{ALuCH_Fb@yQFeJQwNMoMFyNDqGG{CEi@Ki@e@{Cc@eC[uCEu@[iBoAiHS{AHWUeBoAoGQ_AcAwCkAsDm@uBi@cBeAsCeCuGg@oBK}@MuAc@qBo@_C_A{CMk@E_AEmDImB?o@IaAKKI?MuA]aD_@}CUqAo@iDc@eBa@qA_AiCm@gBe@gCW_DGs@QcBCc@Ws@oAcDaCuGWmASsAJWAWc@iCu@mEc@gDEgA?m@ZkH@mBDeHEeCGgF?mBE{B?aEHiDBuANsALgIDuGTuH`@uMf@cRHoE?cHOkFqAk\\I_CIuB@SUiBScAUcA_AeD}AkFY_Aq@gBm@_By@qC_DmJYaAy@eD[gBi@sGe@{DwAgH}EgPo@{B_@_Bg@kCwAcIm@iD}@sFYqBOWa@oAOq@_AgCgAgC{AuCsDwHsCyFeGcLmMmVoDaHqCsF{@qByDeJmB_FgAwC{FqOmGaQs@u@OOo@gB_CmGyB_Gk@}AaBkEqBqFwBoGu@cCUcAQkAGaABkCBiEHKHMBSFoCB{FBcICsCIqDg@aJUmDUmBUy@aAqCyD{IyBsFsAaD}CeHgAuBmAuBsCuE}BwD[a@k@y@gCmDiAeBgDwE_AmAaCuD{A}BeBaCwEgG_GqIc@s@g@gAuFeO{F{OeB}EaA}CoAiE_@}@m@kAyAwB{ByC_@k@GAUEWM{A}BsA}B{KuPsLmQoCkEeLeQcDcFVMmE}GqBwC[c@{A{AqAcA[Om@K}CcCwCuBkC{B_E{BqCeA{BiA_@i@kA}@}HqE{B_AsNqImAeAg@m@{@uAo@cBa@kBy@}Ee@cAm@k@{@]aAI]@q@L]Ni@^k@n@cA|AyFzIaAlA}@v@sAz@o@XyAb@}B^gDJgRHoi@PkHA{OOe@K[Uc@Ic@HSTo@PkRJaaALaa@Le@Qs@]a@BWNw@X}YHa@Ie@Wi@q@Yy@g@c@YMOEoA?oH@g@c@?@",start:Bt.airport,end:Bt.majestic,stops:[],contact:"",timings:[10,30,50,70,90,110,130,150,170,190,220,240,260,280,300,320,340,360,380,400,420,435,450,465,480,495,515,535,555,570,585,600,615,625,640,655,670,685,700,715,730,745,760,775,790,805,820,835,850,865,880,895,910,925,940,960,980,1e3,1020,1040,1060,1080,1100,1120,1140,1160,1175,1190,1205,1220,1235,1250,1265,1280,1295,1310,1325,1340,1355,1370,1385,1400,1415,1430]},{name:"KIA-10",route:"ufhxM}w`nArAeG~Bf@tAl@dEjDzEpClD`CdA`@bCf@`An@n@WTaAdCaL`@_Ab@QnB{AlEoEj@qAz@uF|AuFz@_CdBiFNm@FoAKoAiBcGsEkNyAeEiCaHuBiGqBwHqCwKMa@a@cAg@s@yAuAaA_@cCe@gJmAoJgA}D[{GAyEAeDE_AWo@m@kAeBs@gA[}@OkAG{@AmOCwIC_NAiFSaCw@uEqA{Fs@gD_CuKg@qCOsBCiABMG}@GgE?{B`CwQjAgIbBwO\\{C\\iDz@eJJiBVaDNcBBsA[{GMoA_@aBaAcCK[iAoAkAqAiAkAoBy@kMeF[Wa@m@]o@QQKi@CcALuCFeAPuAOEMMMYE_@F}Bd@gETaATCa@vBI|@InBEz@Yl@[\\k@\\]FuA@w@Mw@[eBiAs@{@e@aABM?CQi@yByEaAuBq@S]A_@HmCrAw@f@OVeAj@sKdFcEhBgHrDcAl@O?ODqD`BgAb@]B}JSqTm@}FSiKWyDGmHAiSN{NVqCFYKy@o@AyFEOKK@uADiHDgEAkCKcCWoA}@{Fa@kEu@cEiAkHHWGi@UyAk@yCe@}BiBqFu@mCyAsEqE{LYoAM{Ac@eC_CgIK_ACcAMeG?k@M{@QE_AeJg@wCcAaFy@iCu@qBw@iCc@{CMiB[sDoCsH_A_Ci@iBU{A?_@DY{AgJg@cEB_DTcGDcHKiPE{B?aEHiDRiDRsO@yBf@cO~@y^AwJ{A{_@QcGEk@S}Bi@gCwBmHe@cBkAgDgG_RsAgF[gBi@sGe@{Dc@qBs@uDaA_DsBcHwA_FgAkFeCmNwAeJ]{@c@}A_AgCgAgCiFeK}B}EaFmJaJ_QmO}YuFwMwCwHwFiOgHwR{@gAOOo@gB_CmGqCsH]}@iEiLwBoGu@cCg@oCGaABkCBiEHKHMBSJkK@oLCyAc@wJKiBk@{GwAkEcHmP}DmJkCqFsCwEgFmIsDgFqHkKkGqJkIyKgFwHsDoJsIuUyD}KcAiDa@mAw@}AmC{DgAuAg@m@UEWM{A}BsA}BeBmCyLyQwIuMiLqQcBeCcDcFVMmE}GqBwCmAuAwAsA_Ai@m@KgAaAyG{EgCsBwC_ByEmBs@a@_@i@kA}@iGkDiBaAo@SuA}@{MeImB{Bw@_B[eAiAuGc@qAk@q@}@c@cAM}@Dm@PgAv@eDbFmEvG{BtBoAt@sCz@aCZqOF_s@XeWSc@Ue@Se@D[Vc@PcGFulARga@Jq@[YOw@Hu@^sZHs@Ym@m@g@kAiAo@{J@YQQO",start:Bt.airport,end:Bt.mysore_road,stops:[],contact:"",timings:[5,40,360,420,450,480,510,540,570,600,630,660,690,720,750,780,810,840,870,900,960,990,1020,1050,1080,1110,1140,1170,1200,1230,1260,1290,1320,1350,1380,1410]},{name:"KIA-14",route:"}jrxMk|qmADObBIi@gFi@iEg@yEs@sCMmD@[RHWm@M{ASwBs@wHoAmPYeA_@mCiAaEyCkJkA{Dk@oD{AcLAmAUiAm@qC]g@eBaIqAuF{@sIc@wG{A_Jm@}CAmAf@oAbFyGd@iBLcATk@j@iMSAB]HoAX{IHaBCoDOcA@gHU}Oi@wUk@}WIsJ@i@S{@GuDFiBMcCCu@Pu@I_De@sDyAgKCqBSq@q@oEk@qCu@qF{AaRm@gF?aF\\wCXgEjC{@xDcA~@QTn@dGaBfBg@vAcAhEuBtB{CdD}GlAqC~IqIjBqAzBy@|EkA}BcIgAeEuDqMiEePu@sB@Y?Qq@SgAg@aEqDgB}Ck@kBn@Ch@CVCnAm@n@mAjAqBZ{@z@sAzBwBdBs@fCe@rEe@x@@`HfAbDJvBd@hA^x@`Av@l@b@CXWHOP{B|CcErTqQrFqEhAu@jBu@eDmFqBgDgFeHgByC_GgMgEqHqByDsAwDoDkJiAeDi@qB@}@LM@QYYE_A^}Kf@cKC{BWeCo@kCu@wCqAmDUiAHUd@iAhIuDtE}CpA_@vHi@|DD~AFpAMb@O`CcC@?D@B?HEFSQIIBABA@}CeCiCQo@_@Qc@KqAOwBAqAB{GI{ACeF|@y_@?cNOwJIaOJsUWmDeBwLa@_DoAiHS{AHWOuAkA}Fu@}CoB_GyCeJiB_FmA}DQuBk@oC}BgIUyJQ}ACAWuA?{@aA_Ia@wBoAyF]{@NGa@aBWq@SaE_@aCmImTk@aDJWe@aDyAuJEuBZkH@yOMqMHkJRiDLgIDuGTuH`@uMp@iX?qDK}HsAq\\KuCAu@Fc@Lc@@m@eBoHOqAEkCm@ePg@eRe@{PQcJ_@@IGcKwNiHsLmFeK{DeIs@q@cAiDcB_EqJqRqJyQmPk[eDqGuFwMaEsKeGcPeGaPu@w@oDqJcCwGmDqJcF{Ns@_DMcDFqGNQNkDFeTUcHu@kMg@{CW}@}GePkA{CiFuLiHaMwKgPiJ{MiC{DgLsOuCmEuF_OgGuP_AgC}D_MyAkDmC{DoBcCUEsBkCyDkGqWo`@gBqC@Q_@}@_FeI}DcGcI{LiE{FsBeBgAU}CcCcHqF_E}ByEkBwLgHuOkIwIeFaMyGuW{NwCsByK_LUPD\\LX~F|GdEdDbOvIh@x@VrAE`A_@dAqB`C}AnAeE|AyF\\sKR{g@T{P@mPQs@a@i@Go@`@w@Pmc@Jem@Bwc@Do@WSK}@Bk@^m@NsZBKYw@{@[u@aAo@yAw@eAyAyG@@hB",start:Bt.airport,end:Bt.royal_meenakshi,stops:[],contact:"",timings:[25,300,380,440,470,500,540,590,620,660,740,920,980,1060,1090,1120,1160,1180,1220,1250,1270,1300,1360,1425]},{name:"KIA-15",route:"k_lyM{penA}@BEuBMyGKkGq@mDe@oEk@qAsAyC}@iBy@uAsAaBsCwC}@i@uFsCWOFOH[Bq@B{E?QUDwBP_Gf@}Gd@sDLcDDaAAWYGE]?}E?IDWV{@AyEDeC\\wXnEqGvA}QbFwJ`CmARwCr@[FUw@e@eBGOa@sBu@aCkDgLqBcGwAcDiDgFwGaJ_@cDsByHa@qDQaCPyBbBwOvBePj@}EN}A@kB[gD_@kAuBeEqLmWuF}Lu@gCeAyE_AyIEoA\\G?i@QKO?CgA?wBNyLdAkRXaDnA{GjAgDrAyC`DiHxAeDjAgD^iDDgCOoB_AwH{CoS_B{Km@oEIcBJkHR{FGiGEoDSkGy@sHuEuUCe@@I@Sf@ThAh@fHbDpPbIxNrIrTrNtBrAFYlAcDrAaDd@q@bDsHlOo\\tBwEdJuRnI_QlEgDbC{BpCuD`FkHhAwCb@mB`@cCXeE`@qOXqJXqKf@sMJgDYsEiA_DmBoEmBoEgBiEQcAWwDUyCkBwH}@iG}BiHcDoLc@iBiAyDeAwBcAoCm@uCSoAM{B?cCIsBw@_Eo@cHc@_Fc@uFi@sM_@gGgBiPWuDAwF_@eXO_USeM@oBn@{A`C_GxA}Ej@yCVcDK_BwAuJkAmHo@cD{@kCcAoESoBQq@y@AkBRc@EOWYsA}@cH]iAQWWqBOqDRe@\\IzIgBdF}@h@Ix@o@`AgApBwA`DaBjCkA|DyAxGgBjCi@rCc@lCq@`I}BpH_BrUsEtD{@f@a@Pg@GcECaETs@hBcDVw@LgJ?sJGcFAm@XaAHWX{@~@aB|EgGnEqFpFuGn@_BZ_BF}CZwA@q@_@_I@u@hC_F~@sBlAoE~DsIbD}HrAiHt@wAxAkA~@mAv@aB~@cC`CqIb@cAPKt@kAxFaJXq@ASNuCdAqGn@eDxAgEx@_CxA`@|C|@dCn@~@DTK\\q@h@[pBa@hBORMDWBIjASdEo@~CYrFm@xA}A`AaAbCmArAq@xA_ARi@?mAbHIpE[~BEpAG`F}@dImAbCYp@]|Bq@x@LR^bApBn@dBd@r@f@SbDg@tDe@rDKrEVfFV~D@X@NBrA^pBd@bBFzLNfRn@pGMbBNdCGvB@v@GJSeAaMcB{Ks@_Mi@iNMaKNmAnA}EpAmFZ}APURw@Oa@a@Os@NOPw@Pmc@Jem@Bwc@Do@Wu@QgAh@m@NsZBKYw@{@[u@aAo@yAw@eAyAyG@@hB",start:Bt.airport,end:Bt.whitefield,stops:[],contact:"",timings:[375,435,495,555,615,675,735,795,945,1005,1065,1125]},{name:"KIA-17",route:"}e}wM{eymAw@VFRJZx@CdCq@b@AdC|B~@fAbCxJf@p@bBp@nFK~BDjDfAjE|@f@\\lFlAb@SFa@Y_@oGsBQi@Cm@BUDg@YaAk@qBiBuGkDiMiBkG}EwQoE}PkAmFOg@e@{BmCwJaDaMgEwRq@aCm@k@g@MqKlBc@Cy@eAoAiBq@cBy@iCgAmBi@}EUgB_A}Mu@iHaCmIqAsDaD_HmCmEwE_JaB_JeByCyEwCaCcBYeBi@_CwAwCmA_C_FsGaDuFiBeFsGqToAkI[sBCsB`@oCHmFUcCy@sCeFsOw@wCsAeCcGiKuBcEiA_D{AqFcBwJwAoJm@iDGeFGcENq@Ru@PoAF{CU{Ay@{Aq@mAaAwB_A}CcA}DaGh@oD?}E_AgBc@kAEoBTgJbCqA`@qFmUk@qAg@yBs@wCiAoDcNa_@oKoYsAcEa@wBKiBAmD@{FQ_Hq@mDuA}C{EiFkB_C}CgFqBmEgAqDuBoJmAmGu@aGk@cGmAgGuA{DsFaLmNyYiAcCO[OHoBn@aA`@iItD_@J[w@sBuRiCeS}A{MWy@{LkKcBgA}DmAuI_CyNiDuK_CmIkBcDm@{@MSSo@EmHf@e@ESa@`@eCr@gBBADEBMIM[@q@`Cm@lB{@jA[Zq@JkLJkFKqAQaE{B_@C{L}H_DoAmAU}Kq@sLo@mNa@?McEGsACsCI}DI}DSwH[{BT_@LFNsA\\[Pg@XkJ|GqCvB{GtD_FpCyBp@kOhBqADeC_@qDy@c@QKQ@?HZS@i@NgAVNv@@Nq@FEWr@E~ADv@Qq@eBq@sBMsCQeCg@qBcFoMiBiFU{A?_@DYu@kEmA_JB_DTcG?_QKkQ\\sIRsOXeLx@aYVsOa@yQiAyYE_BYiDaDuLyJkZsAgFeA{JiAmHuBuIkEcOmEyUwAeJ]{@c@}AgCoGgJcR}[cn@sDgHuFwMuE}LsJsWmBgF{@gA_EeKqCsHgFgNmDsKg@oCCmELuEHMN_L@oLg@qMw@eKwAkEqImSoCmGkCqF{JePkImLgJeNqGqI_JqMgPic@sD}KkAsDeEyGoBcCUEsBkCyDkGyLyQaOcU_GcJcBeCcDcFVMmE}GqBwCmAuAwC}Bm@KgAaAyG{EgCsBwC_ByEmBsAkAuIiFyCuAqPcKmB{BsAeDiAuGc@qAk@q@}@c@}AMqAVgAv@uB~C}FzI{BtB}CxAgEr@ig@Vg[HeWSiAi@}@V}@Zmc@JiqAZaA[MKq@GkAh@sZHiAi@_AiBi@a@_@MkFBwCCc@_@",start:Bt.airport,end:Bt.kengeri,stops:[],contact:"",timings:[280,450,545,580,915,1055,1130,1175]}]},$B="#4264fb",zS="#aaaaaa",FS={type:"circle",paint:{"circle-color":$B,"circle-radius":8,"circle-stroke-width":2,"circle-stroke-color":"#ffffff"}},pA={type:"line",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":zS,"line-width":{type:"exponential",base:1,stops:[[10,3],[14,8],[18,3]]}}},RS={...pA,paint:{...pA.paint,"line-color":$B}};var WB={},Bv={},vs={},Cn={};Object.defineProperty(Cn,"__esModule",{value:!0});Cn.areaConversion=Cn.timeConversion=Cn.distanceConversion=Cn.altitudeKeys=Cn.latitudeKeys=Cn.longitudeKeys=Cn.MAXLON=Cn.MINLON=Cn.MAXLAT=Cn.MINLAT=Cn.earthRadius=Cn.sexagesimalPattern=void 0;var OS=/^([0-9]{1,3})\s*([0-9]{1,3}(?:\.(?:[0-9]{1,}))?)[']\s*(([0-9]{1,3}(\.([0-9]{1,}))?)["]\s*)?([NEOSW]?)$/;Cn.sexagesimalPattern=OS;var GS=6378137;Cn.earthRadius=GS;var NS=-90;Cn.MINLAT=NS;var US=90;Cn.MAXLAT=US;var qS=-180;Cn.MINLON=qS;var jS=180;Cn.MAXLON=jS;var VS=["lng","lon","longitude",0];Cn.longitudeKeys=VS;var HS=["lat","latitude",1];Cn.latitudeKeys=HS;var $S=["alt","altitude","elevation","elev",2];Cn.altitudeKeys=$S;var WS={m:1,km:.001,cm:100,mm:1e3,mi:1/1609.344,sm:1/1852.216,ft:100/30.48,in:100/2.54,yd:1/.9144};Cn.distanceConversion=WS;var KS={m:60,h:3600,d:86400};Cn.timeConversion=KS;var gl={m2:1,km2:1e-6,ha:1e-4,a:.01,ft2:10.763911,yd2:1.19599,in2:1550.0031};Cn.areaConversion=gl;gl.sqm=gl.m2;gl.sqkm=gl.km2;gl.sqft=gl.ft2;gl.sqyd=gl.yd2;gl.sqin=gl.in2;var af={};Object.defineProperty(af,"__esModule",{value:!0});af.default=void 0;var ZS=function(a,c){return c.reduce(function(v,E){if(typeof a>"u"||a===null)throw new Error("'".concat(a,"' is no valid coordinate."));return Object.prototype.hasOwnProperty.call(a,E)&&typeof E<"u"&&typeof v>"u"?(v=E,E):v},void 0)},JS=ZS;af.default=JS;var dm={},lf={};Object.defineProperty(lf,"__esModule",{value:!0});lf.default=void 0;var XS=function(a){var c=a.toString().trim();return isNaN(parseFloat(c))?!1:parseFloat(c)===Number(c)},QS=XS;lf.default=QS;var uf={};Object.defineProperty(uf,"__esModule",{value:!0});uf.default=void 0;var YS=Cn,eI=function(a){return YS.sexagesimalPattern.test(a.toString().trim())},tI=eI;uf.default=tI;var cf={};Object.defineProperty(cf,"__esModule",{value:!0});cf.default=void 0;var nI=Cn,rI=function(a){var c=new RegExp(nI.sexagesimalPattern).exec(a.toString().trim());if(typeof c>"u"||c===null)throw new Error("Given value is not in sexagesimal format");var v=Number(c[2])/60||0,E=Number(c[4])/3600||0,D=parseFloat(c[1])+v+E;return["S","W"].includes(c[7])?-D:D},iI=rI;cf.default=iI;var gg={},fm={};Object.defineProperty(fm,"__esModule",{value:!0});fm.default=void 0;var lw=Cn,uw=oI(af);function oI(i){return i&&i.__esModule?i:{default:i}}function WC(i,a){var c=Object.keys(i);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(i);a&&(v=v.filter(function(E){return Object.getOwnPropertyDescriptor(i,E).enumerable})),c.push.apply(c,v)}return c}function sI(i){for(var a=1;a<arguments.length;a++){var c=arguments[a]!=null?arguments[a]:{};a%2?WC(Object(c),!0).forEach(function(v){aI(i,v,c[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(c)):WC(Object(c)).forEach(function(v){Object.defineProperty(i,v,Object.getOwnPropertyDescriptor(c,v))})}return i}function aI(i,a,c){return a in i?Object.defineProperty(i,a,{value:c,enumerable:!0,configurable:!0,writable:!0}):i[a]=c,i}var lI=function(a){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{longitude:lw.longitudeKeys,latitude:lw.latitudeKeys,altitude:lw.altitudeKeys},v=(0,uw.default)(a,c.longitude),E=(0,uw.default)(a,c.latitude),D=(0,uw.default)(a,c.altitude);return sI({latitude:E,longitude:v},D?{altitude:D}:{})},uI=lI;fm.default=uI;var yg={};Object.defineProperty(yg,"__esModule",{value:!0});yg.default=void 0;var cI=hb(lf),hI=hb(uf),dI=hb(cf),KC=Cn;function hb(i){return i&&i.__esModule?i:{default:i}}var fI=function i(a){return(0,cI.default)(a)?!(parseFloat(a)>KC.MAXLAT||a<KC.MINLAT):(0,hI.default)(a)?i((0,dI.default)(a)):!1},pI=fI;yg.default=pI;var vg={};Object.defineProperty(vg,"__esModule",{value:!0});vg.default=void 0;var mI=db(lf),_I=db(uf),gI=db(cf),ZC=Cn;function db(i){return i&&i.__esModule?i:{default:i}}var yI=function i(a){return(0,mI.default)(a)?!(parseFloat(a)>ZC.MAXLON||a<ZC.MINLON):(0,_I.default)(a)?i((0,gI.default)(a)):!1},vI=yI;vg.default=vI;Object.defineProperty(gg,"__esModule",{value:!0});gg.default=void 0;var xI=fb(fm),JC=fb(yg),XC=fb(vg);function fb(i){return i&&i.__esModule?i:{default:i}}var wI=function(a){var c=(0,xI.default)(a),v=c.latitude,E=c.longitude;if(Array.isArray(a)&&a.length>=2)return(0,XC.default)(a[0])&&(0,JC.default)(a[1]);if(typeof v>"u"||typeof E>"u")return!1;var D=a[E],F=a[v];return!(typeof F>"u"||typeof D>"u"||(0,JC.default)(F)===!1||(0,XC.default)(D)===!1)},AI=wI;gg.default=AI;Object.defineProperty(dm,"__esModule",{value:!0});dm.default=void 0;var bI=xg(lf),CI=xg(uf),EI=xg(cf),QC=xg(gg),BI=xg(fm);function xg(i){return i&&i.__esModule?i:{default:i}}function YC(i,a){var c=Object.keys(i);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(i);a&&(v=v.filter(function(E){return Object.getOwnPropertyDescriptor(i,E).enumerable})),c.push.apply(c,v)}return c}function cw(i){for(var a=1;a<arguments.length;a++){var c=arguments[a]!=null?arguments[a]:{};a%2?YC(Object(c),!0).forEach(function(v){mA(i,v,c[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(c)):YC(Object(c)).forEach(function(v){Object.defineProperty(i,v,Object.getOwnPropertyDescriptor(c,v))})}return i}function mA(i,a,c){return a in i?Object.defineProperty(i,a,{value:c,enumerable:!0,configurable:!0,writable:!0}):i[a]=c,i}var TI=function i(a){if((0,bI.default)(a))return Number(a);if((0,CI.default)(a))return(0,EI.default)(a);if((0,QC.default)(a)){var c=(0,BI.default)(a);return Array.isArray(a)?a.map(function(v,E){return[0,1].includes(E)?i(v):v}):cw(cw(cw({},a),c.latitude&&mA({},c.latitude,i(a[c.latitude]))),c.longitude&&mA({},c.longitude,i(a[c.longitude])))}return Array.isArray(a)?a.map(function(v){return(0,QC.default)(v)?i(v):v}):a},DI=TI;dm.default=DI;Object.defineProperty(vs,"__esModule",{value:!0});vs.default=void 0;var SI=Cn,II=KB(af),MI=KB(dm);function KB(i){return i&&i.__esModule?i:{default:i}}var kI=function(a,c){var v=(0,II.default)(a,SI.latitudeKeys);if(!(typeof v>"u"||v===null)){var E=a[v];return c===!0?E:(0,MI.default)(E)}},PI=kI;vs.default=PI;var xs={};Object.defineProperty(xs,"__esModule",{value:!0});xs.default=void 0;var LI=Cn,zI=ZB(af),FI=ZB(dm);function ZB(i){return i&&i.__esModule?i:{default:i}}var RI=function(a,c){var v=(0,zI.default)(a,LI.longitudeKeys);if(!(typeof v>"u"||v===null)){var E=a[v];return c===!0?E:(0,FI.default)(E)}},OI=RI;xs.default=OI;var za={};Object.defineProperty(za,"__esModule",{value:!0});za.default=void 0;var GI=function(a){return a*Math.PI/180},NI=GI;za.default=NI;var fc={};Object.defineProperty(fc,"__esModule",{value:!0});fc.default=void 0;var UI=function(a){return a*180/Math.PI},qI=UI;fc.default=qI;Object.defineProperty(Bv,"__esModule",{value:!0});Bv.default=void 0;var jI=Tv(vs),VI=Tv(xs),hw=Tv(za),dw=Tv(fc),eE=Cn;function Tv(i){return i&&i.__esModule?i:{default:i}}var HI=function(a,c,v){var E=arguments.length>3&&arguments[3]!==void 0?arguments[3]:6371e3,D=(0,jI.default)(a),F=(0,VI.default)(a),s=c/E,N=(0,hw.default)(v),pe=(0,hw.default)(D),Re=(0,hw.default)(F),we=Math.asin(Math.sin(pe)*Math.cos(s)+Math.cos(pe)*Math.sin(s)*Math.cos(N)),Ae=Re+Math.atan2(Math.sin(N)*Math.sin(s)*Math.cos(pe),Math.cos(s)-Math.sin(pe)*Math.sin(we)),$e=(0,dw.default)(Ae);return($e<eE.MINLON||$e>eE.MAXLON)&&(Ae=(Ae+3*Math.PI)%(2*Math.PI)-Math.PI,$e=(0,dw.default)(Ae)),{latitude:(0,dw.default)(we),longitude:$e}},$I=HI;Bv.default=$I;var Dv={};Object.defineProperty(Dv,"__esModule",{value:!0});Dv.default=void 0;var WI=Cn,KI=function(a){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"m",v=WI.areaConversion[c];if(v)return a*v;throw new Error("Invalid unit used for area conversion.")},ZI=KI;Dv.default=ZI;var Sv={};Object.defineProperty(Sv,"__esModule",{value:!0});Sv.default=void 0;var JI=Cn,XI=function(a){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"m",v=JI.distanceConversion[c];if(v)return a*v;throw new Error("Invalid unit used for distance conversion.")},QI=XI;Sv.default=QI;var Iv={};Object.defineProperty(Iv,"__esModule",{value:!0});Iv.default=void 0;var C0=Cn,YI=function(a){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"kmh";switch(c){case"kmh":return a*C0.timeConversion.h*C0.distanceConversion.km;case"mph":return a*C0.timeConversion.h*C0.distanceConversion.mi;default:return a}},eM=YI;Iv.default=eM;var Mv={};Object.defineProperty(Mv,"__esModule",{value:!0});Mv.default=void 0;function tE(i,a){return iM(i)||rM(i,a)||nM(i,a)||tM()}function tM(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nM(i,a){if(!!i){if(typeof i=="string")return nE(i,a);var c=Object.prototype.toString.call(i).slice(8,-1);if(c==="Object"&&i.constructor&&(c=i.constructor.name),c==="Map"||c==="Set")return Array.from(i);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return nE(i,a)}}function nE(i,a){(a==null||a>i.length)&&(a=i.length);for(var c=0,v=new Array(a);c<a;c++)v[c]=i[c];return v}function rM(i,a){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(i)))){var c=[],v=!0,E=!1,D=void 0;try{for(var F=i[Symbol.iterator](),s;!(v=(s=F.next()).done)&&(c.push(s.value),!(a&&c.length===a));v=!0);}catch(N){E=!0,D=N}finally{try{!v&&F.return!=null&&F.return()}finally{if(E)throw D}}return c}}function iM(i){if(Array.isArray(i))return i}var oM=function(a){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,v=Math.pow(10,c);return Math.round(a*v)/v},sM=function(a){var c=a.toString().split("."),v=tE(c,2),E=v[0],D=v[1],F=Math.abs(Number(E)),s=Number("0."+(D||0))*60,N=s.toString().split("."),pe=Math.floor(s),Re=oM(Number("0."+(N[1]||0))*60).toString(),we=Re.split("."),Ae=tE(we,2),$e=Ae[0],Qe=Ae[1],ot=Qe===void 0?"0":Qe;return F+"\xB0 "+pe.toString().padStart(2,"0")+"' "+$e.padStart(2,"0")+"."+ot.padEnd(1,"0")+'"'},aM=sM;Mv.default=aM;var kv={},wg={},gu={},Ag={};Object.defineProperty(Ag,"__esModule",{value:!0});Ag.default=void 0;var lM=function(a){return a>1?1:a<-1?-1:a},uM=lM;Ag.default=uM;Object.defineProperty(gu,"__esModule",{value:!0});var JB=gu.default=void 0,rE=Pv(vs),iE=Pv(xs),Mp=Pv(za),cM=Pv(Ag),hM=Cn;function Pv(i){return i&&i.__esModule?i:{default:i}}var dM=function(a,c){var v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;v=typeof v<"u"&&!isNaN(v)?v:1;var E=(0,rE.default)(a),D=(0,iE.default)(a),F=(0,rE.default)(c),s=(0,iE.default)(c),N=Math.acos((0,cM.default)(Math.sin((0,Mp.default)(F))*Math.sin((0,Mp.default)(E))+Math.cos((0,Mp.default)(F))*Math.cos((0,Mp.default)(E))*Math.cos((0,Mp.default)(D)-(0,Mp.default)(s))))*hM.earthRadius;return Math.round(N/v)*v},fM=dM;JB=gu.default=fM;Object.defineProperty(wg,"__esModule",{value:!0});wg.default=void 0;var oE=pM(gu);function pM(i){return i&&i.__esModule?i:{default:i}}var mM=function(a,c){var v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:oE.default;return v=typeof v=="function"?v:oE.default,c.slice().sort(function(E,D){return v(a,E)-v(a,D)})},_M=mM;wg.default=_M;Object.defineProperty(kv,"__esModule",{value:!0});kv.default=void 0;var gM=yM(wg);function yM(i){return i&&i.__esModule?i:{default:i}}var vM=function(a,c){return(0,gM.default)(a,c)[0]},xM=vM;kv.default=xM;var Lv={};Object.defineProperty(Lv,"__esModule",{value:!0});Lv.default=void 0;var fw=pb(za),wM=pb(vs),sE=pb(xs),aE=Cn;function pb(i){return i&&i.__esModule?i:{default:i}}var AM=function(a){var c=0;if(a.length>2){for(var v,E,D,F=0;F<a.length;F++){F===a.length-2?(v=a.length-2,E=a.length-1,D=0):F===a.length-1?(v=a.length-1,E=0,D=1):(v=F,E=F+1,D=F+2);var s=(0,sE.default)(a[v]),N=(0,wM.default)(a[E]),pe=(0,sE.default)(a[D]);c+=((0,fw.default)(pe)-(0,fw.default)(s))*Math.sin((0,fw.default)(N))}c=c*aE.earthRadius*aE.earthRadius/2}return Math.abs(c)},bM=AM;Lv.default=bM;var bg={};Object.defineProperty(bg,"__esModule",{value:!0});bg.default=void 0;var CM=XB(vs),EM=XB(xs);function XB(i){return i&&i.__esModule?i:{default:i}}var BM=function(a){if(Array.isArray(a)===!1||a.length===0)throw new Error("No points were given.");return a.reduce(function(c,v){var E=(0,CM.default)(v),D=(0,EM.default)(v);return{maxLat:Math.max(E,c.maxLat),minLat:Math.min(E,c.minLat),maxLng:Math.max(D,c.maxLng),minLng:Math.min(D,c.minLng)}},{maxLat:-1/0,minLat:1/0,maxLng:-1/0,minLng:1/0})},TM=BM;bg.default=TM;var zv={};Object.defineProperty(zv,"__esModule",{value:!0});zv.default=void 0;var DM=Fv(vs),SM=Fv(xs),kp=Fv(za),E0=Fv(fc),z_=Cn;function Fv(i){return i&&i.__esModule?i:{default:i}}var IM=function(a,c){var v=(0,DM.default)(a),E=(0,SM.default)(a),D=(0,kp.default)(v),F=(0,kp.default)(E),s=c/z_.earthRadius,N=D-s,pe=D+s,Re=(0,kp.default)(z_.MAXLAT),we=(0,kp.default)(z_.MINLAT),Ae=(0,kp.default)(z_.MAXLON),$e=(0,kp.default)(z_.MINLON),Qe,ot;if(N>we&&pe<Re){var Vt=Math.asin(Math.sin(s)/Math.cos(D));Qe=F-Vt,Qe<$e&&(Qe+=Math.PI*2),ot=F+Vt,ot>Ae&&(ot-=Math.PI*2)}else N=Math.max(N,we),pe=Math.min(pe,Re),Qe=$e,ot=Ae;return[{latitude:(0,E0.default)(N),longitude:(0,E0.default)(Qe)},{latitude:(0,E0.default)(pe),longitude:(0,E0.default)(ot)}]},MM=IM;zv.default=MM;var Rv={};Object.defineProperty(Rv,"__esModule",{value:!0});Rv.default=void 0;var kM=Ov(vs),PM=Ov(xs),lE=Ov(za),uE=Ov(fc);function Ov(i){return i&&i.__esModule?i:{default:i}}var LM=function(a){if(Array.isArray(a)===!1||a.length===0)return!1;var c=a.length,v=a.reduce(function(s,N){var pe=(0,lE.default)((0,kM.default)(N)),Re=(0,lE.default)((0,PM.default)(N));return{X:s.X+Math.cos(pe)*Math.cos(Re),Y:s.Y+Math.cos(pe)*Math.sin(Re),Z:s.Z+Math.sin(pe)}},{X:0,Y:0,Z:0}),E=v.X/c,D=v.Y/c,F=v.Z/c;return{longitude:(0,uE.default)(Math.atan2(D,E)),latitude:(0,uE.default)(Math.atan2(F,Math.sqrt(E*E+D*D)))}},zM=LM;Rv.default=zM;var Gv={};Object.defineProperty(Gv,"__esModule",{value:!0});Gv.default=void 0;var FM=RM(bg);function RM(i){return i&&i.__esModule?i:{default:i}}var OM=function(a){var c=(0,FM.default)(a),v=c.minLat+(c.maxLat-c.minLat)/2,E=c.minLng+(c.maxLng-c.minLng)/2;return{latitude:parseFloat(v.toFixed(6)),longitude:parseFloat(E.toFixed(6))}},GM=OM;Gv.default=GM;var Nv={},Cg={};Object.defineProperty(Cg,"__esModule",{value:!0});Cg.default=void 0;var cE=Uv(vs),hE=Uv(xs),B0=Uv(za),NM=Uv(fc);function Uv(i){return i&&i.__esModule?i:{default:i}}var UM=function(a,c){var v=(0,B0.default)((0,hE.default)(c))-(0,B0.default)((0,hE.default)(a)),E=Math.log(Math.tan((0,B0.default)((0,cE.default)(c))/2+Math.PI/4)/Math.tan((0,B0.default)((0,cE.default)(a))/2+Math.PI/4));return Math.abs(v)>Math.PI&&(v>0?v=(Math.PI*2-v)*-1:v=Math.PI*2+v),((0,NM.default)(Math.atan2(v,E))+360)%360},qM=UM;Cg.default=qM;Object.defineProperty(Nv,"__esModule",{value:!0});Nv.default=void 0;var dE=jM(Cg);function jM(i){return i&&i.__esModule?i:{default:i}}var VM=function(a,c){var v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:dE.default,E=typeof v=="function"?v(a,c):(0,dE.default)(a,c);if(isNaN(E))throw new Error("Could not calculate bearing for given points. Check your bearing function");switch(Math.round(E/22.5)){case 1:return"NNE";case 2:return"NE";case 3:return"ENE";case 4:return"E";case 5:return"ESE";case 6:return"SE";case 7:return"SSE";case 8:return"S";case 9:return"SSW";case 10:return"SW";case 11:return"WSW";case 12:return"W";case 13:return"WNW";case 14:return"NW";case 15:return"NNW";default:return"N"}},HM=VM;Nv.default=HM;var Eg={};Object.defineProperty(Eg,"__esModule",{value:!0});Eg.default=void 0;var pw=QB(gu),fE=QB(Ag);function QB(i){return i&&i.__esModule?i:{default:i}}var $M=function(a,c,v){var E=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,D=(0,pw.default)(c,a,E),F=(0,pw.default)(a,v,E),s=(0,pw.default)(c,v,E),N=Math.acos((0,fE.default)((D*D+s*s-F*F)/(2*D*s))),pe=Math.acos((0,fE.default)((F*F+s*s-D*D)/(2*F*s)));return N>Math.PI/2?D:pe>Math.PI/2?F:Math.sin(N)*D},WM=$M;Eg.default=WM;var qv={};Object.defineProperty(qv,"__esModule",{value:!0});qv.default=void 0;var pE=jv(vs),mE=jv(xs),nc=jv(za),KM=jv(fc);function jv(i){return i&&i.__esModule?i:{default:i}}var ZM=function(a,c){var v=(0,pE.default)(c),E=(0,mE.default)(c),D=(0,pE.default)(a),F=(0,mE.default)(a),s=((0,KM.default)(Math.atan2(Math.sin((0,nc.default)(E)-(0,nc.default)(F))*Math.cos((0,nc.default)(v)),Math.cos((0,nc.default)(D))*Math.sin((0,nc.default)(v))-Math.sin((0,nc.default)(D))*Math.cos((0,nc.default)(v))*Math.cos((0,nc.default)(E)-(0,nc.default)(F))))+360)%360;return s},JM=ZM;qv.default=JM;var Vv={};Object.defineProperty(Vv,"__esModule",{value:!0});Vv.default=void 0;var XM=QM(gu);function QM(i){return i&&i.__esModule?i:{default:i}}function N0(i){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?N0=function(c){return typeof c}:N0=function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},N0(i)}var YM=function(a){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:XM.default;return a.reduce(function(v,E){return N0(v)==="object"&&v.last!==null&&(v.distance+=c(E,v.last)),v.last=E,v},{last:null,distance:0}).distance},ek=YM;Vv.default=ek;var Hv={};Object.defineProperty(Hv,"__esModule",{value:!0});Hv.default=void 0;var _E=mb(vs),gE=mb(xs),mw=mb(za),yE=Cn;function mb(i){return i&&i.__esModule?i:{default:i}}var tk=function(a,c){var v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;v=typeof v<"u"&&!isNaN(v)?v:1;var E=(0,_E.default)(a),D=(0,gE.default)(a),F=(0,_E.default)(c),s=(0,gE.default)(c),N=6356752314245e-6,pe=1/298.257223563,Re=(0,mw.default)(s-D),we,Ae,$e,Qe,ot,Vt,be=Math.atan((1-pe)*Math.tan((0,mw.default)(parseFloat(E)))),ge=Math.atan((1-pe)*Math.tan((0,mw.default)(parseFloat(F)))),Be=Math.sin(be),Xe=Math.cos(be),Ie=Math.sin(ge),at=Math.cos(ge),ft=Re,Ct,Et=100;do{var Ot=Math.sin(ft),dr=Math.cos(ft);if(Vt=Math.sqrt(at*Ot*(at*Ot)+(Xe*Ie-Be*at*dr)*(Xe*Ie-Be*at*dr)),Vt===0)return 0;we=Be*Ie+Xe*at*dr,Ae=Math.atan2(Vt,we),$e=Xe*at*Ot/Vt,Qe=1-$e*$e,ot=we-2*Be*Ie/Qe,isNaN(ot)&&(ot=0);var Wr=pe/16*Qe*(4+pe*(4-3*Qe));Ct=ft,ft=Re+(1-Wr)*pe*$e*(Ae+Wr*Vt*(ot+Wr*we*(-1+2*ot*ot)))}while(Math.abs(ft-Ct)>1e-12&&--Et>0);if(Et===0)return NaN;var ir=Qe*(yE.earthRadius*yE.earthRadius-N*N)/(N*N),hi=1+ir/16384*(4096+ir*(-768+ir*(320-175*ir))),en=ir/1024*(256+ir*(-128+ir*(74-47*ir))),di=en*Vt*(ot+en/4*(we*(-1+2*ot*ot)-en/6*ot*(-3+4*Vt*Vt)*(-3+4*ot*ot))),fr=N*hi*(Ae-di);return Math.round(fr/v)*v},nk=tk;Hv.default=nk;var $v={};Object.defineProperty($v,"__esModule",{value:!0});$v.default=void 0;var rk=function(a){if(/^NNE|NE|NNW|N$/.test(a))return"N";if(/^ENE|E|ESE|SE$/.test(a))return"E";if(/^SSE|S|SSW|SW$/.test(a))return"S";if(/^WSW|W|WNW|NW$/.test(a))return"W"},ik=rk;$v.default=ik;var Wv={};Object.defineProperty(Wv,"__esModule",{value:!0});Wv.default=void 0;var ok=sk(gu);function sk(i){return i&&i.__esModule?i:{default:i}}var ak=function(a,c){var v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ok.default,E=v(a,c),D=Number(c.time)-Number(a.time),F=E/D*1e3;return F},lk=ak;Wv.default=lk;var Kv={};Object.defineProperty(Kv,"__esModule",{value:!0});Kv.default=void 0;var _w=uk(gu);function uk(i){return i&&i.__esModule?i:{default:i}}var ck=function(a,c,v){return(0,_w.default)(c,a)+(0,_w.default)(a,v)===(0,_w.default)(c,v)},hk=ck;Kv.default=hk;var Zv={};Object.defineProperty(Zv,"__esModule",{value:!0});Zv.default=void 0;var T0=YB(vs),Da=YB(xs);function YB(i){return i&&i.__esModule?i:{default:i}}var dk=function(a,c){for(var v=!1,E=c.length,D=-1,F=E-1;++D<E;F=D)((0,Da.default)(c[D])<=(0,Da.default)(a)&&(0,Da.default)(a)<(0,Da.default)(c[F])||(0,Da.default)(c[F])<=(0,Da.default)(a)&&(0,Da.default)(a)<(0,Da.default)(c[D]))&&(0,T0.default)(a)<((0,T0.default)(c[F])-(0,T0.default)(c[D]))*((0,Da.default)(a)-(0,Da.default)(c[D]))/((0,Da.default)(c[F])-(0,Da.default)(c[D]))+(0,T0.default)(c[D])&&(v=!v);return v},fk=dk;Zv.default=fk;var Jv={};Object.defineProperty(Jv,"__esModule",{value:!0});Jv.default=void 0;var pk=mk(Eg);function mk(i){return i&&i.__esModule?i:{default:i}}var _k=function(a,c,v,E){return(0,pk.default)(a,c,v)<E},gk=_k;Jv.default=gk;var Xv={};Object.defineProperty(Xv,"__esModule",{value:!0});Xv.default=void 0;var yk=vk(gu);function vk(i){return i&&i.__esModule?i:{default:i}}var xk=function(a,c,v){return(0,yk.default)(a,c)<v},wk=xk;Xv.default=wk;var Qv={};Object.defineProperty(Qv,"__esModule",{value:!0});Qv.default=void 0;function Ak(i,a){return Bk(i)||Ek(i,a)||Ck(i,a)||bk()}function bk(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ck(i,a){if(!!i){if(typeof i=="string")return vE(i,a);var c=Object.prototype.toString.call(i).slice(8,-1);if(c==="Object"&&i.constructor&&(c=i.constructor.name),c==="Map"||c==="Set")return Array.from(i);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return vE(i,a)}}function vE(i,a){(a==null||a>i.length)&&(a=i.length);for(var c=0,v=new Array(a);c<a;c++)v[c]=i[c];return v}function Ek(i,a){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(i)))){var c=[],v=!0,E=!1,D=void 0;try{for(var F=i[Symbol.iterator](),s;!(v=(s=F.next()).done)&&(c.push(s.value),!(a&&c.length===a));v=!0);}catch(N){E=!0,D=N}finally{try{!v&&F.return!=null&&F.return()}finally{if(E)throw D}}return c}}function Bk(i){if(Array.isArray(i))return i}var Tk=function(a){if(!a.startsWith("POLYGON"))throw new Error("Invalid wkt.");var c=a.slice(a.indexOf("(")+2,a.indexOf(")")).split(", "),v=c.map(function(E){var D=E.split(" "),F=Ak(D,2),s=F[0],N=F[1];return{longitude:parseFloat(s),latitude:parseFloat(N)}});return v},Dk=Tk;Qv.default=Dk;(function(i){Object.defineProperty(i,"__esModule",{value:!0});var a={computeDestinationPoint:!0,convertArea:!0,convertDistance:!0,convertSpeed:!0,decimalToSexagesimal:!0,findNearest:!0,getAreaOfPolygon:!0,getBounds:!0,getBoundsOfDistance:!0,getCenter:!0,getCenterOfBounds:!0,getCompassDirection:!0,getCoordinateKey:!0,getCoordinateKeys:!0,getDistance:!0,getDistanceFromLine:!0,getGreatCircleBearing:!0,getLatitude:!0,getLongitude:!0,getPathLength:!0,getPreciseDistance:!0,getRhumbLineBearing:!0,getRoughCompassDirection:!0,getSpeed:!0,isDecimal:!0,isPointInLine:!0,isPointInPolygon:!0,isPointNearLine:!0,isPointWithinRadius:!0,isSexagesimal:!0,isValidCoordinate:!0,isValidLatitude:!0,isValidLongitude:!0,orderByDistance:!0,sexagesimalToDecimal:!0,toDecimal:!0,toRad:!0,toDeg:!0,wktToPolygon:!0};Object.defineProperty(i,"computeDestinationPoint",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(i,"convertArea",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(i,"convertDistance",{enumerable:!0,get:function(){return E.default}}),Object.defineProperty(i,"convertSpeed",{enumerable:!0,get:function(){return D.default}}),Object.defineProperty(i,"decimalToSexagesimal",{enumerable:!0,get:function(){return F.default}}),Object.defineProperty(i,"findNearest",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(i,"getAreaOfPolygon",{enumerable:!0,get:function(){return N.default}}),Object.defineProperty(i,"getBounds",{enumerable:!0,get:function(){return pe.default}}),Object.defineProperty(i,"getBoundsOfDistance",{enumerable:!0,get:function(){return Re.default}}),Object.defineProperty(i,"getCenter",{enumerable:!0,get:function(){return we.default}}),Object.defineProperty(i,"getCenterOfBounds",{enumerable:!0,get:function(){return Ae.default}}),Object.defineProperty(i,"getCompassDirection",{enumerable:!0,get:function(){return $e.default}}),Object.defineProperty(i,"getCoordinateKey",{enumerable:!0,get:function(){return Qe.default}}),Object.defineProperty(i,"getCoordinateKeys",{enumerable:!0,get:function(){return ot.default}}),Object.defineProperty(i,"getDistance",{enumerable:!0,get:function(){return Vt.default}}),Object.defineProperty(i,"getDistanceFromLine",{enumerable:!0,get:function(){return be.default}}),Object.defineProperty(i,"getGreatCircleBearing",{enumerable:!0,get:function(){return ge.default}}),Object.defineProperty(i,"getLatitude",{enumerable:!0,get:function(){return Be.default}}),Object.defineProperty(i,"getLongitude",{enumerable:!0,get:function(){return Xe.default}}),Object.defineProperty(i,"getPathLength",{enumerable:!0,get:function(){return Ie.default}}),Object.defineProperty(i,"getPreciseDistance",{enumerable:!0,get:function(){return at.default}}),Object.defineProperty(i,"getRhumbLineBearing",{enumerable:!0,get:function(){return ft.default}}),Object.defineProperty(i,"getRoughCompassDirection",{enumerable:!0,get:function(){return Ct.default}}),Object.defineProperty(i,"getSpeed",{enumerable:!0,get:function(){return Et.default}}),Object.defineProperty(i,"isDecimal",{enumerable:!0,get:function(){return Ot.default}}),Object.defineProperty(i,"isPointInLine",{enumerable:!0,get:function(){return dr.default}}),Object.defineProperty(i,"isPointInPolygon",{enumerable:!0,get:function(){return Wr.default}}),Object.defineProperty(i,"isPointNearLine",{enumerable:!0,get:function(){return ir.default}}),Object.defineProperty(i,"isPointWithinRadius",{enumerable:!0,get:function(){return hi.default}}),Object.defineProperty(i,"isSexagesimal",{enumerable:!0,get:function(){return en.default}}),Object.defineProperty(i,"isValidCoordinate",{enumerable:!0,get:function(){return di.default}}),Object.defineProperty(i,"isValidLatitude",{enumerable:!0,get:function(){return fr.default}}),Object.defineProperty(i,"isValidLongitude",{enumerable:!0,get:function(){return xt.default}}),Object.defineProperty(i,"orderByDistance",{enumerable:!0,get:function(){return Qt.default}}),Object.defineProperty(i,"sexagesimalToDecimal",{enumerable:!0,get:function(){return Mt.default}}),Object.defineProperty(i,"toDecimal",{enumerable:!0,get:function(){return _n.default}}),Object.defineProperty(i,"toRad",{enumerable:!0,get:function(){return Ln.default}}),Object.defineProperty(i,"toDeg",{enumerable:!0,get:function(){return Or.default}}),Object.defineProperty(i,"wktToPolygon",{enumerable:!0,get:function(){return Qn.default}});var c=jt(Bv),v=jt(Dv),E=jt(Sv),D=jt(Iv),F=jt(Mv),s=jt(kv),N=jt(Lv),pe=jt(bg),Re=jt(zv),we=jt(Rv),Ae=jt(Gv),$e=jt(Nv),Qe=jt(af),ot=jt(fm),Vt=jt(gu),be=jt(Eg),ge=jt(qv),Be=jt(vs),Xe=jt(xs),Ie=jt(Vv),at=jt(Hv),ft=jt(Cg),Ct=jt($v),Et=jt(Wv),Ot=jt(lf),dr=jt(Kv),Wr=jt(Zv),ir=jt(Jv),hi=jt(Xv),en=jt(uf),di=jt(gg),fr=jt(yg),xt=jt(vg),Qt=jt(wg),Mt=jt(cf),_n=jt(dm),Ln=jt(za),Or=jt(fc),Qn=jt(Qv),wr=Cn;Object.keys(wr).forEach(function(St){St==="default"||St==="__esModule"||Object.prototype.hasOwnProperty.call(a,St)||Object.defineProperty(i,St,{enumerable:!0,get:function(){return wr[St]}})});function jt(St){return St&&St.__esModule?St:{default:St}}})(WB);const Sk=(i,a)=>{if(!a)return null;const c=i[0].start===Bt.airport?"end":"start";return HB.minBy(i,v=>WB.getDistance({latitude:a.lat,longitude:a.lng},{latitude:v[c].loc[0],longitude:v[c].loc[1]})).name},xE=i=>({type:"geojson",data:{type:"FeatureCollection",features:i.map(a=>({type:"Feature",properties:{name:a.name},geometry:{type:"LineString",coordinates:LS.decode(decodeURIComponent(a.route))}}))}}),wE=(i,a)=>({type:"geojson",data:{type:"FeatureCollection",features:i.map(c=>({type:"Feature",properties:{name:a==="ta"?c.start.name:c.end.name},geometry:{type:"Point",coordinates:a==="ta"?Array.from(c.start.loc).reverse():Array.from(c.end.loc).reverse()}}))}}),AE=()=>Math.floor((new Date-new Date().setHours(0,0,0,0))/6e4);Wp.accessToken="pk.eyJ1Ijoic2VhZGVlcCIsImEiOiJjbDliYW1wZzUwczJtM29xdHpzcnEyMjFpIn0.t_6sNxBfaIvu6C5XqjT5ww";class Ik extends rr.exports.PureComponent{constructor(c){super(c);tc(this,"initMap",()=>{const{lng:c,lat:v,zoom:E}=this.state,D=new Wp.Map({container:this.mapContainer.current,style:"mapbox://styles/mapbox/streets-v11",center:[c,v],zoom:E,minZoom:10,maxZoom:18});D.dragRotate.disable(),D.touchZoomRotate.disableRotation(),D.on("move",()=>{this.setState({lng:D.getCenter().lng.toFixed(4),lat:D.getCenter().lat.toFixed(4),zoom:D.getZoom().toFixed(2)})}),this.map=D});tc(this,"renderMapData",()=>{const{busData:c,selectedBus:v,selectedTab:E,userLocation:D,inputLocation:F}=this.props;this.map.addSource("routes",xE(c)),this.map.addLayer({id:"routes",source:"routes",...pA}),this.map.addLayer({id:"routes-highlighted",source:"routes",...RS,filter:["==","name",v||""]}),this.map.addSource("stops",wE(c,E)),this.map.addLayer({id:"stops",source:"stops",...FS});const s=document.createElement("div");s.className="user-location-indicator",this.userLocationMarker=new Wp.Marker(s).setLngLat({lat:0,lng:0}).addTo(this.map),D&&this.userLocationMarker.setLngLat(D);const N=document.createElement("div");N.className="input-location-indicator",this.inputLocationMarker=new Wp.Marker(N).setLngLat({lat:0,lng:0}).addTo(this.map),F&&this.inputLocationMarker.setLngLat(F)});tc(this,"addMapEvents",()=>{const c=new Wp.Popup({closeButton:!1,closeOnClick:!1});this.map.on("mouseenter","stops",v=>{this.map.getCanvas().style.cursor="pointer";const E=v.features[0].geometry.coordinates.slice(),D=v.features[0].properties.name;for(;Math.abs(v.lngLat.lng-E[0])>180;)E[0]+=v.lngLat.lng>E[0]?360:-360;c.setLngLat(E).setHTML(D).addTo(this.map)}),this.map.on("mouseleave","stops",()=>{this.map.getCanvas().style.cursor="",c.remove()}),this.map.on("mouseenter","routes",v=>{const{selectedBus:E}=this.props;this.map.getCanvas().style.cursor="pointer";const D=v.features[0],{name:F}=D.properties;this.map.setFilter("routes-highlighted",["==","name",F||E||""])}),this.map.on("click","routes",v=>{const{setSelectedBus:E}=this.props,D=v.features[0],{name:F}=D.properties;E(F)}),this.map.on("mouseleave","routes",()=>{const{selectedBus:v}=this.props;this.map.getCanvas().style.cursor="",this.map.setFilter("routes-highlighted",["==","name",v||""])})});tc(this,"refreshMapData",()=>{const{busData:c,selectedTab:v}=this.props,E=this.map.getSource("routes"),D=this.map.getSource("stops");E.setData(xE(c).data),D.setData(wE(c,v).data)});this.state={lat:Bt.majestic.loc[0],lng:Bt.majestic.loc[1],zoom:11},this.mapContainer=rr.exports.createRef()}componentDidMount(){this.initMap(),this.map.on("load",()=>{this.renderMapData(),this.addMapEvents()})}componentDidUpdate(c,v,E){const{userLocation:D,inputLocation:F,selectedBus:s,selectedTab:N}=this.props,{userLocation:pe,selectedBus:Re,selectedTab:we,inputLocation:Ae}=c;if(we!==N&&this.refreshMapData(),D&&!pe){const $e=document.createElement("div");$e.className="location-indicator",this.userLocationMarker.setLngLat(D)}if(F&&!Ae){const $e=document.createElement("div");$e.className="input-location-indicator",this.inputLocationMarker.setLngLat(F)}s!==Re&&this.map.setFilter("routes-highlighted",["==","name",s||""])}render(){return rr.exports.createElement("div",{id:"map",ref:this.mapContainer,className:"map-container"})}}var eT={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(i){(function(){var a={}.hasOwnProperty;function c(){for(var v=[],E=0;E<arguments.length;E++){var D=arguments[E];if(!!D){var F=typeof D;if(F==="string"||F==="number")v.push(D);else if(Array.isArray(D)){if(D.length){var s=c.apply(null,D);s&&v.push(s)}}else if(F==="object"){if(D.toString!==Object.prototype.toString&&!D.toString.toString().includes("[native code]")){v.push(D.toString());continue}for(var N in D)a.call(D,N)&&D[N]&&v.push(N)}}}return v.join(" ")}i.exports?(c.default=c,i.exports=c):window.classNames=c})()})(eT);const tT=eT.exports,Mk="/assets/icon-call.62de2272.svg",kk=({selected:i})=>Lt.createElement("svg",{width:"10",height:"12",viewBox:"0 0 10 12",className:"route-item-icon"},Lt.createElement("path",{fill:i?"#ffffff":"#000000",d:"M72.75,32h-7.5A1.268,1.268,0,0,0,64,33.286v8.571a1.3,1.3,0,0,0,.417.957V43.3a.687.687,0,0,0,.677.7h.729a.687.687,0,0,0,.677-.7v-.161h5V43.3a.687.687,0,0,0,.677.7h.729a.687.687,0,0,0,.677-.7v-.489A1.3,1.3,0,0,0,74,41.857V33.286A1.268,1.268,0,0,0,72.75,32Zm-6.576,9.852a.829.829,0,0,1-.842-.482.875.875,0,0,1,.162-.977.816.816,0,0,1,.949-.167.862.862,0,0,1,.468.866A.846.846,0,0,1,66.174,41.852Zm2.305-3H65.25a.423.423,0,0,1-.417-.429V35a.423.423,0,0,1,.417-.429h3.229a.106.106,0,0,1,.1.107V38.75A.106.106,0,0,1,68.479,38.857ZM69,33.714H65.262a.43.43,0,0,1-.428-.407.436.436,0,0,1,.114-.317.411.411,0,0,1,.3-.133h7.488a.43.43,0,0,1,.428.407.436.436,0,0,1-.114.317.411.411,0,0,1-.3.133Zm.521.857H72.75a.423.423,0,0,1,.417.429v3.429a.423.423,0,0,1-.417.429H69.521a.106.106,0,0,1-.1-.107V34.679A.106.106,0,0,1,69.521,34.571Zm1.567,6.522a.862.862,0,0,1,.468-.866.816.816,0,0,1,.949.167.875.875,0,0,1,.162.977.829.829,0,0,1-.842.482A.846.846,0,0,1,71.088,41.093Z",transform:"translate(-64 -32)"})),bE="/assets/icon-open-link.387f1079.svg",CE=i=>i<10?`0${i}`:i,Pk=({msm:i,currentTime:a})=>{const c=Math.floor(i/60),v=i-c*60;return Lt.createElement("div",{className:`route-item-time ${i<a?"disabled":""}`},CE(c),":",CE(v))},EE=({busDetails:i,selectedBus:a,setSelectedBus:c,toAirport:v,currentTime:E})=>{const{name:D,start:F,end:s,timings:N}=i,pe=D===a;return Lt.createElement("div",{className:`route-item ${pe?"selected":""}`},Lt.createElement("div",{className:"route-item-header",onClick:()=>c(pe?null:D)},Lt.createElement(kk,{selected:pe}),Lt.createElement("div",{className:"route-item-bus-name"},D),Lt.createElement("div",{className:"route-item-bus-route"},Lt.createElement("span",{className:"text-light"},"from")," ",v?F.name:Bt.airport.name,Lt.createElement("br",null),Lt.createElement("span",{className:"text-light"},"to")," ",v?Bt.airport.name:s.name)),Lt.createElement("div",{className:"route-item-details"},Lt.createElement("h3",{className:"mb-2"},"Departure times"),Lt.createElement("div",{className:"flex"},N.map(Re=>Lt.createElement(Pk,{msm:Re,currentTime:E,key:Re}))),Lt.createElement("h3",null,v?"Boarding point":"Final stop"),v?Lt.createElement("a",{className:"route-item-location",href:`https://www.google.com/maps/search/?api=1&query=${F.loc[0]},${F.loc[1]}`,target:"_blank"},F.name,Lt.createElement("img",{src:bE,alt:"Open"})):Lt.createElement("a",{className:"route-item-location",href:`https://www.google.com/maps/search/?api=1&query=${s.loc[0]},${s.loc[1]}`,target:"_blank"},s.name,Lt.createElement("img",{src:bE,alt:"Open"}))))},gw=120,BE=i=>{let[a,c]=[0,0];return i.clientX?(a=i.clientX,c=i.clientY):i.touches&&(a=i.touches[0].clientX,c=i.touches[0].clientY),[a,c]};class Lk extends Lt.PureComponent{constructor(c){super(c);tc(this,"onResize",()=>{this.setState(({resized:c})=>({resized:c+1}))});tc(this,"onPointerDown",c=>{if(window.innerWidth>999)return;const[v,E]=BE(c);this.setState({x:v,y:E})});tc(this,"onPointerMove",c=>{if(c.stopPropagation(),this.state.x===null)return;const[v,E]=BE(c);this.setState(({move:D})=>({move:Math.max(D+E-this.state.y,-window.innerHeight+gw),y:E}))});tc(this,"onPointerUp",()=>{this.state.x!==null&&(this.setState({x:null,y:null}),this.state.move<-200?this.setState({move:-window.innerHeight+gw}):this.setState({move:0}))});this.state={x:null,y:null,move:0,currentTime:AE(),resized:0},this.secondInterval=null}componentDidMount(){this.secondInterval=setInterval(()=>{this.setState({currentTime:AE()})},1e4),window.addEventListener("mousemove",this.onPointerMove,{passive:!0}),window.addEventListener("touchmove",this.onPointerMove,{passive:!0}),window.addEventListener("mouseup",this.onPointerUp,{passive:!0}),window.addEventListener("touchend",this.onPointerUp,{passive:!0}),window.addEventListener("resize",this.onResize)}componentWillUnmount(){clearInterval(this.secondInterval),window.removeEventListener("mousemove",this.onPointerMove,{passive:!0}),window.removeEventListener("touchmove",this.onPointerMove,{passive:!0}),window.removeEventListener("mouseup",this.onPointerUp,{passive:!0}),window.removeEventListener("touchend",this.onPointerUp,{passive:!0}),window.removeEventListener("resize",this.onResize)}render(){const{selectedTab:c,setSelectedTab:v,sortedTabData:E,selectedBus:D,setSelectedBus:F,suggestedBus:s,suggestedBusDetails:N}=this.props,{currentTime:pe,move:Re}=this.state;return Lt.createElement("div",{id:"sidebar",style:{top:`calc(100% - ${gw-Re}px)`},className:tT({"sharp-corners":Re<-200})},Lt.createElement("div",{id:"sidebar-drag-indicator"}),Lt.createElement("div",{id:"sidebar-header",className:"padding",onMouseDown:this.onPointerDown,onTouchStart:this.onPointerDown},Lt.createElement("div",{id:"logo-banner",className:"mb-4"},Lt.createElement("img",{src:"/bmtc_logo.svg",alt:"BMTC logo",id:"bmtc-logo"}),"BMTC VAYU VAJRA"),Lt.createElement("div",{className:"tabs"},fA.map(we=>Lt.createElement("div",{key:we.id,className:`tab-item ${c===we.id?"selected":""}`,onClick:()=>v(we.id)},we.text)))),Lt.createElement("div",{id:"sidebar-content"},s&&Lt.createElement(Lt.Fragment,null,Lt.createElement("h4",{className:"mb-4"},"Suggested bus"),Lt.createElement(EE,{busDetails:N,selectedBus:D,setSelectedBus:F,toAirport:c==="ta",currentTime:pe})),Lt.createElement("h4",{className:"mb-4"},s?"Other Buses":"Routes and Schedules"),E.map(we=>we.name===s?null:Lt.createElement(EE,{key:we.name,busDetails:we,selectedBus:D,setSelectedBus:F,toAirport:c==="ta",currentTime:pe}))),Lt.createElement("div",{className:"padding text"},Lt.createElement("h4",{className:"mb-2"},"BMTC Vayu Vajra Helpline"),Lt.createElement("a",{href:`tel:${HC}`,id:"sidebar-tel"},Lt.createElement("img",{src:Mk,alt:""}),HC)))}}const zk=({inputLocation:i,setCurrentScreen:a})=>Lt.createElement("div",{id:"li-wrapper"},Lt.createElement("input",{id:"li-input",className:tT({empty:!i}),placeholder:i?`${i.lat}, ${i.lng}`:"Select a starting point",onClick:()=>a(pu.LOCATION_TEXT)})),Fk=({selectedTab:i,setSelectedTab:a,userLocation:c,inputLocation:v,setCurrentScreen:E})=>{const[D,F]=rr.exports.useState(null),s=i==="ta"?$C.to:$C.from,N=Sk(s,v),pe=HB.find(s,{name:N});return rr.exports.createElement(rr.exports.Fragment,null,rr.exports.createElement(Lk,{suggestedBusDetails:pe,selectedTab:i,setSelectedTab:a,selectedBus:D,setSelectedBus:F,suggestedBus:N,sortedTabData:s}),rr.exports.createElement(Ik,{inputLocation:v,busData:s,userLocation:c,selectedBus:D,setSelectedBus:F,selectedTab:i}),rr.exports.createElement(zk,{setCurrentScreen:E,inputLocation:v}))},nT="/assets/icon-back.45521716.svg",Rk="/assets/icon-cross.1d92296a.svg",Ok="/assets/icon-grey-pin.db6d1f1b.svg",Gk="/assets/logo-google.a33a47a2.svg";var rT={},Nk="Expected a function",TE=0/0,Uk="[object Symbol]",qk=/^\s+|\s+$/g,jk=/^[-+]0x[0-9a-f]+$/i,Vk=/^0b[01]+$/i,Hk=/^0o[0-7]+$/i,$k=parseInt,Wk=typeof du=="object"&&du&&du.Object===Object&&du,Kk=typeof self=="object"&&self&&self.Object===Object&&self,Zk=Wk||Kk||Function("return this")(),Jk=Object.prototype,Xk=Jk.toString,Qk=Math.max,Yk=Math.min,yw=function(){return Zk.Date.now()};function eP(i,a,c){var v,E,D,F,s,N,pe=0,Re=!1,we=!1,Ae=!0;if(typeof i!="function")throw new TypeError(Nk);a=DE(a)||0,_A(c)&&(Re=!!c.leading,we="maxWait"in c,D=we?Qk(DE(c.maxWait)||0,a):D,Ae="trailing"in c?!!c.trailing:Ae);function $e(at){var ft=v,Ct=E;return v=E=void 0,pe=at,F=i.apply(Ct,ft),F}function Qe(at){return pe=at,s=setTimeout(be,a),Re?$e(at):F}function ot(at){var ft=at-N,Ct=at-pe,Et=a-ft;return we?Yk(Et,D-Ct):Et}function Vt(at){var ft=at-N,Ct=at-pe;return N===void 0||ft>=a||ft<0||we&&Ct>=D}function be(){var at=yw();if(Vt(at))return ge(at);s=setTimeout(be,ot(at))}function ge(at){return s=void 0,Ae&&v?$e(at):(v=E=void 0,F)}function Be(){s!==void 0&&clearTimeout(s),pe=0,v=N=E=s=void 0}function Xe(){return s===void 0?F:ge(yw())}function Ie(){var at=yw(),ft=Vt(at);if(v=arguments,E=this,N=at,ft){if(s===void 0)return Qe(N);if(we)return s=setTimeout(be,a),$e(N)}return s===void 0&&(s=setTimeout(be,a)),F}return Ie.cancel=Be,Ie.flush=Xe,Ie}function _A(i){var a=typeof i;return!!i&&(a=="object"||a=="function")}function tP(i){return!!i&&typeof i=="object"}function nP(i){return typeof i=="symbol"||tP(i)&&Xk.call(i)==Uk}function DE(i){if(typeof i=="number")return i;if(nP(i))return TE;if(_A(i)){var a=typeof i.valueOf=="function"?i.valueOf():i;i=_A(a)?a+"":a}if(typeof i!="string")return i===0?i:+i;i=i.replace(qk,"");var c=Vk.test(i);return c||Hk.test(i)?$k(i.slice(2),c?2:8):jk.test(i)?TE:+i}var rP=eP,lm={};Object.defineProperty(lm,"__esModule",{value:!0});lm.loadGoogleMapScript=lm.isBrowser=void 0;var iT=typeof window<"u"&&window.document;lm.isBrowser=iT;var iP=function(a,c){if(!iT||typeof google<"u"&&google.maps&&google.maps.api)return Promise.resolve();var v=document.querySelectorAll('script[src*="'.concat(a,'"]'));if(v&&v.length)return new Promise(function(D){if(typeof google<"u")return D();v[0].addEventListener("load",function(){return D()})});var E=document.createElement("script");return E.src=c,document.body.appendChild(E),new Promise(function(D){E.addEventListener("load",function(){return D()})})};lm.loadGoogleMapScript=iP;var Yv={};Object.defineProperty(Yv,"__esModule",{value:!0});Yv.GOOGLE_MAP_SCRIPT_BASE_URL=void 0;var oP="https://maps.googleapis.com/maps/api/js";Yv.GOOGLE_MAP_SCRIPT_BASE_URL=oP;Object.defineProperty(rT,"__esModule",{value:!0});var sP=rT.default=pP,qs=rr.exports,SE=lP(rP),IE=lm,aP=Yv;function lP(i){return i&&i.__esModule?i:{default:i}}function ME(i,a){var c=Object.keys(i);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(i);a&&(v=v.filter(function(E){return Object.getOwnPropertyDescriptor(i,E).enumerable})),c.push.apply(c,v)}return c}function Pp(i){for(var a=1;a<arguments.length;a++){var c=arguments[a]!=null?arguments[a]:{};a%2?ME(Object(c),!0).forEach(function(v){uP(i,v,c[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(c)):ME(Object(c)).forEach(function(v){Object.defineProperty(i,v,Object.getOwnPropertyDescriptor(c,v))})}return i}function uP(i,a,c){return a in i?Object.defineProperty(i,a,{value:c,enumerable:!0,configurable:!0,writable:!0}):i[a]=c,i}function Lp(i,a){return fP(i)||dP(i,a)||hP(i,a)||cP()}function cP(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hP(i,a){if(!!i){if(typeof i=="string")return kE(i,a);var c=Object.prototype.toString.call(i).slice(8,-1);if(c==="Object"&&i.constructor&&(c=i.constructor.name),c==="Map"||c==="Set")return Array.from(i);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return kE(i,a)}}function kE(i,a){(a==null||a>i.length)&&(a=i.length);for(var c=0,v=new Array(a);c<a;c++)v[c]=i[c];return v}function dP(i,a){var c=i&&(typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"]);if(c!=null){var v=[],E=!0,D=!1,F,s;try{for(c=c.call(i);!(E=(F=c.next()).done)&&(v.push(F.value),!(a&&v.length===a));E=!0);}catch(N){D=!0,s=N}finally{try{!E&&c.return!=null&&c.return()}finally{if(D)throw s}}return v}}function fP(i){if(Array.isArray(i))return i}function pP(i){var a=i.apiKey,c=i.libraries,v=c===void 0?"places":c,E=i.googleMapsScriptBaseUrl,D=E===void 0?aP.GOOGLE_MAP_SCRIPT_BASE_URL:E,F=i.debounce,s=F===void 0?300:F,N=i.options,pe=N===void 0?{}:N,Re=i.sessionToken,we=i.language,Ae=we?"&language=".concat(we):"",$e="".concat(D,"?key=").concat(a,"&libraries=").concat(v).concat(Ae),Qe=(0,qs.useState)([]),ot=Lp(Qe,2),Vt=ot[0],be=ot[1],ge=(0,qs.useState)(!1),Be=Lp(ge,2),Xe=Be[0],Ie=Be[1],at=(0,qs.useState)(null),ft=Lp(at,2),Ct=ft[0],Et=ft[1],Ot=(0,qs.useState)(!1),dr=Lp(Ot,2),Wr=dr[0],ir=dr[1],hi=(0,qs.useState)(!1),en=Lp(hi,2),di=en[0],fr=en[1],xt=(0,qs.useState)([]),Qt=Lp(xt,2),Mt=Qt[0],_n=Qt[1],Ln=(0,qs.useRef)(null),Or=(0,qs.useRef)(null),Qn=(0,qs.useRef)(null),wr=(0,qs.useCallback)(function(){return(0,IE.loadGoogleMapScript)(D,$e)},[D,$e]),jt=(0,qs.useCallback)((0,SE.default)(function(ar){Ln.current&&ar.input&&Ln.current.getPlacePredictions(Pp(Pp(Pp({},Re&&Qn.current?{sessionToken:Qn.current}:{}),pe),ar),function(pr){Ie(!1),be(pr||[])})},s),[s]),St=(0,qs.useCallback)((0,SE.default)(function(ar){Ln.current&&ar.input&&Ln.current.getQueryPredictions(Pp(Pp(Pp({},Re&&Qn.current?{sessionToken:Qn.current}:{}),pe),ar),function(pr){ir(!1),_n(pr||[])})},s),[s]);return(0,qs.useEffect)(function(){if(!!IE.isBrowser){var ar=function(){if(!google)return console.error("Google has not been found. Make sure your provide apiKey prop.");Ln.current=new google.maps.places.AutocompleteService,Or.current=new google.maps.places.PlacesService(document.createElement("div")),Re&&(Qn.current=new google.maps.places.AutocompleteSessionToken)};a?wr().then(function(){return ar()}):ar()}},[]),{placesService:Or.current,autocompleteSessionToken:Qn.current,placesAutocompleteService:Ln.current,placePredictions:Ct?Vt:[],isPlacePredictionsLoading:Xe,getPlacePredictions:function(pr){if(pr.input){Et(pr.input),Ie(!0),jt(pr);return}be([]),Et(null),jt(pr),Ie(!1)},queryPredictions:di?Mt:[],isQueryPredictionsLoading:Wr,getQueryPredictions:function(pr){if(pr.input){fr(pr.input),ir(!0),St(pr);return}_n([]),fr(null),St(pr),ir(!1)},refreshSessionToken:function(){Qn.current=new google.maps.places.AutocompleteSessionToken}}}const mP=({selectedTab:i,setCurrentScreen:a,setInputLocation:c})=>{const[v,E]=rr.exports.useState(""),{placesService:D,placePredictions:F,getPlacePredictions:s,isPlacePredictionsLoading:N}=sP({apiKey:"AIzaSyDJI2fcgQj8ArV0p2QfSj6JO8ZQCexdavQ",debounce:1e3,options:{componentRestrictions:{country:"in"}}});rr.exports.useEffect(()=>{s({input:v})},[v]);const pe=Re=>{D==null||D.getDetails({placeId:Re},we=>{const{lat:Ae,lng:$e}=we.geometry.location;c({lat:Ae(),lng:$e()}),a(pu.LOCATION_MAP)})};return Lt.createElement("div",{id:"search-page"},Lt.createElement("div",{id:"search-heading"},Lt.createElement("button",{id:"search-back",onClick:()=>a(pu.INITIAL)},Lt.createElement("img",{src:nT,alt:"Back"})),Lt.createElement("h3",{id:"search-heading-text"},i==="ta"?"Enter starting point":"Enter destination")),Lt.createElement("div",{id:"search-input-wrapper"},Lt.createElement("input",{id:"search-input",placeholder:"Search...",value:v,onChange:Re=>E(Re.target.value),autoFocus:!0}),v.length>0&&Lt.createElement("button",{id:"search-clear",onClick:()=>E("")},Lt.createElement("img",{src:Rk,alt:"Cancel"}))),Lt.createElement("div",{id:"search-results"},N&&Lt.createElement("div",{id:"search-loading"},Lt.createElement("div",{className:"spin"}),"Loading..."),!N&&F.map(Re=>Lt.createElement("div",{className:"search-result-item",key:Re.place_id,onClick:()=>pe(Re.place_id)},Lt.createElement("p",{className:"search-result-main-text"},Re.structured_formatting.main_text),Lt.createElement("p",{className:"search-result-secondary-text"},Re.structured_formatting.secondary_text))),!N&&v&&F.length<1&&Lt.createElement("div",null,"No results found")),Lt.createElement("div",{id:"search-powered-by"},"Powered by\xA0",Lt.createElement("img",{src:Gk,alt:"Google"})),Lt.createElement("div",{id:"search-footer"},Lt.createElement("button",{className:"search-footer-item",onClick:()=>a(pu.LOCATION_MAP)},Lt.createElement("img",{src:Ok,alt:""}),"Locate on map")))},_P="/assets/icon-marker.d8fd9f00.svg",gP=({selectedTab:i,inputLocation:a,setCurrentScreen:c,setInputLocation:v})=>{const E=rr.exports.useRef(null),D=rr.exports.useRef(null),[F,s]=rr.exports.useState(16),[N,pe]=rr.exports.useState(a||{lat:Bt.majestic.loc[0],lng:Bt.majestic.loc[1]});rr.exports.useEffect(()=>{D.current||(D.current=new Wp.Map({container:E.current,style:"mapbox://styles/mapbox/streets-v12",center:[N.lng,N.lat],zoom:F}))});const Re=()=>{const{lat:we,lng:Ae}=D.current.getCenter();v({lat:we,lng:Ae}),c(pu.INITIAL)};return Lt.createElement("div",{id:"search-page"},Lt.createElement("div",{id:"search-heading"},Lt.createElement("button",{id:"search-back",onClick:()=>c(pu.LOCATION_TEXT)},Lt.createElement("img",{src:nT,alt:"Back"})),Lt.createElement("h3",{id:"search-heading-text"},i==="ta"?"Adjust start location":"Adjust destination location")),Lt.createElement("div",{id:"search-map",ref:E},Lt.createElement("div",{id:"search-marker"},Lt.createElement("img",{src:_P,alt:""}))),Lt.createElement("button",{id:"search-confirm-button",onClick:Re},"Confirm"))},yP=()=>{const[i,a]=rr.exports.useState(pu.INITIAL),[c,v]=rr.exports.useState(fA[0].id),[E,D]=rr.exports.useState(null),[F,s]=rr.exports.useState(b0.PENDING),[N,pe]=rr.exports.useState(null),Re=()=>{navigator.geolocation.getCurrentPosition(we=>{const{latitude:Ae,longitude:$e}=we.coords;JB({latitude:Ae,longitude:$e},{latitude:Bt.airport.loc[0],longitude:Bt.airport.loc[1]})<1e3?v(fA[1].id):D({lat:Ae,lng:$e}),pe({lat:Ae,lng:$e}),s(b0.APPROVED)},we=>{we.code===1?s(b0.DENIED):console.log(we)})};return rr.exports.useEffect(()=>{"geolocation"in navigator?Re():s(b0.UNAVAILABLE)},[]),rr.exports.createElement("div",{id:"app-container"},i===pu.INITIAL&&rr.exports.createElement(Fk,{userLocation:N,selectedTab:c,setSelectedTab:v,inputLocation:E,setCurrentScreen:a}),i===pu.LOCATION_TEXT&&rr.exports.createElement(mP,{selectedTab:c,setCurrentScreen:a,setInputLocation:D}),i===pu.LOCATION_MAP&&rr.exports.createElement(gP,{selectedTab:c,inputLocation:E,setInputLocation:D,setCurrentScreen:a}))},vP=qB(document.getElementById("root"));vP.render(rr.exports.createElement(yP,null));
