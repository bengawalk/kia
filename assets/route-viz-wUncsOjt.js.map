{"version":3,"file":"route-viz-wUncsOjt.js","sources":["../../src/route-viz/main.jsx"],"sourcesContent":["import * as React from \"react\";\nimport { createRoot } from \"react-dom/client\";\nimport { MAP_STYLE_ROUTE, STOPS_DATA } from \"../utils/constants\";\nimport maplibregl from \"maplibre-gl\";\nimport { getRoutesGeojson } from \"../utils\";\n\nconst getLineGeoJson = (points) => ({\n  type: \"geojson\",\n  data: {\n    type: \"FeatureCollection\",\n    features: [\n      {\n        type: \"Feature\",\n        geometry: {\n          type: \"LineString\",\n          coordinates: (points || []).map((p) => [p.lng, p.lat]),\n        },\n      },\n    ],\n  },\n});\n\nclass Container extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      lat: STOPS_DATA.majestic.loc[0],\n      lng: STOPS_DATA.majestic.loc[1],\n      zoom: 11,\n      points: [],\n    };\n    this.mapContainer = React.createRef();\n  }\n\n  componentDidMount() {\n    this.initMap();\n    this.map.on(\"load\", () => {\n      this.map.addSource(\"route\", getRoutesGeojson([]));\n      this.map.addLayer({\n        id: \"route\",\n        source: \"route\",\n        type: \"line\",\n        paint: {\n          \"line-color\": \"#4264fb\",\n          \"line-width\": 8,\n        },\n      });\n    });\n  }\n\n  componentDidUpdate(prevProps, prevState, snapshot) {\n    const { points } = this.state;\n    if (prevState.points !== points) {\n      const routeSource = this.map.getSource(\"route\");\n      routeSource.setData(getLineGeoJson(points).data);\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.map && this.map.getLayer(\"route\")) {\n      this.map.removeLayer(\"route\");\n    }\n    if (this.map && this.map.getSource(\"route\")) {\n      this.map.removeSource(\"route\");\n    }\n  }\n\n  initMap = () => {\n    const { lng, lat, zoom } = this.state;\n    const map = new maplibregl.Map({\n      container: this.mapContainer.current,\n      style: \"https://basemaps.cartocdn.com/gl/voyager-gl-style/style.json\",\n      center: [lng, lat],\n      zoom: zoom,\n      minZoom: 10,\n      maxZoom: 18,\n    });\n    map.dragRotate.disable();\n    map.touchZoomRotate.disableRotation();\n\n    map.getCanvas().style.cursor = \"crosshair\";\n\n    map.on(\"move\", () => {\n      this.setState({\n        lng: map.getCenter().lng.toFixed(4),\n        lat: map.getCenter().lat.toFixed(4),\n        zoom: map.getZoom().toFixed(2),\n      });\n    });\n    map.on(\"click\", (e) => {\n      this.setState({\n        points: [...this.state.points, e.lngLat],\n      });\n    });\n    this.map = map;\n  };\n\n  render() {\n    const { points } = this.state;\n    return (\n      <div id=\"route-viz-wrapper\">\n        <div id=\"route-viz-map\" ref={this.mapContainer} />\n        <div id=\"route-viz-info\">\n          <h3>Route</h3>\n          {points.length === 0 ? (\n            <p>Click on a point on the map to add to the route</p>\n          ) : (\n            <>\n              <button>Copy</button>\n              <div id=\"route-viz-points\">\n                {points.map((p, index) => (\n                  <div key={index}>\n                    {p.lng.toFixed(6)}, {p.lat.toFixed(6)}\n                  </div>\n                ))}\n              </div>\n            </>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nconst root = createRoot(document.getElementById(\"root\"));\nroot.render(<Container />);\n"],"names":["getLineGeoJson","points","p","Container","React.Component","props","__publicField","lng","lat","zoom","map","maplibregl","e","STOPS_DATA","React.createRef","getRoutesGeojson","prevProps","prevState","snapshot","React.createElement","React.Fragment","index","root","createRoot"],"mappings":"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"}